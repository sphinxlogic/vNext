; Listing generated by Microsoft (R) Optimizing Compiler Version 14.00.50727.762 

	TITLE	D:\OSes\VERVE\verify\src\Trusted\BootLoader\SingLdrPc\blmm.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?BlMmInitialGdtr@@3U_GDTR@@A			; BlMmInitialGdtr
PUBLIC	?BlMmPgTable@@3PAU_BL_MM_PAGE_TABLE@@A		; BlMmPgTable
PUBLIC	?BlMmPhysicalRegionLookaside@@3U<unnamed-tag>@@A ; BlMmPhysicalRegionLookaside
PUBLIC	?BlMmPdTable@@3PAU_BL_MM_PAGE_TABLE@@A		; BlMmPdTable
PUBLIC	?BlMmBootCr3@@3KA				; BlMmBootCr3
PUBLIC	?BlMmPhysicalRegionList@@3U_LIST_ENTRY@@A	; BlMmPhysicalRegionList
PUBLIC	?BlMmLegacyCr3@@3KA				; BlMmLegacyCr3
PUBLIC	?BlMmPdpTable@@3PAU_BL_MM_PAGE_TABLE@@A		; BlMmPdpTable
PUBLIC	?BlMmExtendedBiosDataArea@@3PAXA		; BlMmExtendedBiosDataArea
_BSS	SEGMENT
?BlMmInitialGdtr@@3U_GDTR@@A DT 01H DUP (?)		; BlMmInitialGdtr
	ALIGN	4

?BlMmPgTable@@3PAU_BL_MM_PAGE_TABLE@@A DB 01000H DUP (?) ; BlMmPgTable
?BlMmPhysicalRegionLookaside@@3U<unnamed-tag>@@A DB 0288H DUP (?) ; BlMmPhysicalRegionLookaside
?BlMmPdTable@@3PAU_BL_MM_PAGE_TABLE@@A DB 04000H DUP (?) ; BlMmPdTable
?BlMmBootCr3@@3KA DD 01H DUP (?)			; BlMmBootCr3
?BlMmPhysicalRegionList@@3U_LIST_ENTRY@@A DQ 01H DUP (?) ; BlMmPhysicalRegionList
?BlMmLegacyCr3@@3KA DD 01H DUP (?)			; BlMmLegacyCr3
?BlMmPdpTable@@3PAU_BL_MM_PAGE_TABLE@@A DB 01000H DUP (?) ; BlMmPdpTable
?BlMmExtendedBiosDataArea@@3PAXA DD 01H DUP (?)		; BlMmExtendedBiosDataArea
_BSS	ENDS
PUBLIC	??_C@_08JOIABOAI@blmm?4cpp?$AA@			; `string'
PUBLIC	?BlMmCompactPhysicalRegionList@@YIXXZ		; BlMmCompactPhysicalRegionList
EXTRN	?BlRtlInsertTailList@@YIXPAU_LIST_ENTRY@@0@Z:PROC ; BlRtlInsertTailList
EXTRN	?BlRtlRemoveEntryList@@YIEPAU_LIST_ENTRY@@@Z:PROC ; BlRtlRemoveEntryList
EXTRN	?BlRtlAssertFailed@@YIXPBDK@Z:PROC		; BlRtlAssertFailed
EXTRN	?BlRtlIsListEmpty@@YIEPAU_LIST_ENTRY@@@Z:PROC	; BlRtlIsListEmpty
;	COMDAT ??_C@_08JOIABOAI@blmm?4cpp?$AA@
; File d:\oses\verve\verify\src\trusted\bootloader\singldrpc\blmm.cpp
CONST	SEGMENT
??_C@_08JOIABOAI@blmm?4cpp?$AA@ DB 'blmm.cpp', 00H	; `string'
; Function compile flags: /Odtp
CONST	ENDS
;	COMDAT ?BlMmCompactPhysicalRegionList@@YIXXZ
_TEXT	SEGMENT
tv187 = -44						; size = 4
tv186 = -40						; size = 4
tv175 = -36						; size = 4
tv174 = -32						; size = 4
tv160 = -28						; size = 4
tv157 = -24						; size = 8
tv142 = -16						; size = 4
_Next$ = -12						; size = 4
_Head$ = -8						; size = 4
_Current$ = -4						; size = 4
?BlMmCompactPhysicalRegionList@@YIXXZ PROC		; BlMmCompactPhysicalRegionList, COMDAT

; 59   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 2c	 sub	 esp, 44			; 0000002cH

; 60   :     PBL_MM_PHYSICAL_REGION Current;
; 61   :     PLIST_ENTRY Head;
; 62   :     PBL_MM_PHYSICAL_REGION Next;
; 63   : 
; 64   :     Head = &BlMmPhysicalRegionList;

  00006	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _Head$[ebp], OFFSET ?BlMmPhysicalRegionList@@3U_LIST_ENTRY@@A ; BlMmPhysicalRegionList

; 65   : 
; 66   :     if (BlRtlIsListEmpty(Head) != FALSE) {

  0000d	8b 4d f8	 mov	 ecx, DWORD PTR _Head$[ebp]
  00010	e8 00 00 00 00	 call	 ?BlRtlIsListEmpty@@YIEPAU_LIST_ENTRY@@@Z ; BlRtlIsListEmpty
  00015	0f b6 c0	 movzx	 eax, al
  00018	85 c0		 test	 eax, eax
  0001a	74 05		 je	 SHORT $LN10@BlMmCompac

; 67   : 
; 68   :         return;

  0001c	e9 6d 01 00 00	 jmp	 $LN11@BlMmCompac
$LN10@BlMmCompac:

; 69   :     }
; 70   : 
; 71   :     Current = CONTAINING_RECORD(Head->Flink,
; 72   :                                 BL_MM_PHYSICAL_REGION,
; 73   :                                 Entry);

  00021	8b 4d f8	 mov	 ecx, DWORD PTR _Head$[ebp]
  00024	8b 11		 mov	 edx, DWORD PTR [ecx]
  00026	89 55 fc	 mov	 DWORD PTR _Current$[ebp], edx
$LN9@BlMmCompac:

; 74   : 
; 75   :     for (;;) {
; 76   : 
; 77   :         BLASSERT(Current->Size > 0);

  00029	8b 45 fc	 mov	 eax, DWORD PTR _Current$[ebp]
  0002c	89 45 f0	 mov	 DWORD PTR tv142[ebp], eax
  0002f	8b 4d f0	 mov	 ecx, DWORD PTR tv142[ebp]
  00032	83 79 14 00	 cmp	 DWORD PTR [ecx+20], 0
  00036	77 1a		 ja	 SHORT $LN7@BlMmCompac
  00038	72 09		 jb	 SHORT $LN14@BlMmCompac
  0003a	8b 55 f0	 mov	 edx, DWORD PTR tv142[ebp]
  0003d	83 7a 10 00	 cmp	 DWORD PTR [edx+16], 0
  00041	77 0f		 ja	 SHORT $LN7@BlMmCompac
$LN14@BlMmCompac:
  00043	ba 4d 00 00 00	 mov	 edx, 77			; 0000004dH
  00048	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  0004d	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN7@BlMmCompac:

; 78   : 
; 79   :         BLASSERT(Current->Start + Current->Size == Current->Limit);

  00052	8b 45 fc	 mov	 eax, DWORD PTR _Current$[ebp]
  00055	8b 4d fc	 mov	 ecx, DWORD PTR _Current$[ebp]
  00058	8b 50 08	 mov	 edx, DWORD PTR [eax+8]
  0005b	03 51 10	 add	 edx, DWORD PTR [ecx+16]
  0005e	8b 40 0c	 mov	 eax, DWORD PTR [eax+12]
  00061	13 41 14	 adc	 eax, DWORD PTR [ecx+20]
  00064	8b 4d fc	 mov	 ecx, DWORD PTR _Current$[ebp]
  00067	89 55 e8	 mov	 DWORD PTR tv157[ebp], edx
  0006a	89 45 ec	 mov	 DWORD PTR tv157[ebp+4], eax
  0006d	89 4d e4	 mov	 DWORD PTR tv160[ebp], ecx
  00070	8b 55 e4	 mov	 edx, DWORD PTR tv160[ebp]
  00073	8b 45 e8	 mov	 eax, DWORD PTR tv157[ebp]
  00076	3b 42 18	 cmp	 eax, DWORD PTR [edx+24]
  00079	75 0b		 jne	 SHORT $LN15@BlMmCompac
  0007b	8b 4d e4	 mov	 ecx, DWORD PTR tv160[ebp]
  0007e	8b 55 ec	 mov	 edx, DWORD PTR tv157[ebp+4]
  00081	3b 51 1c	 cmp	 edx, DWORD PTR [ecx+28]
  00084	74 0f		 je	 SHORT $LN6@BlMmCompac
$LN15@BlMmCompac:
  00086	ba 4f 00 00 00	 mov	 edx, 79			; 0000004fH
  0008b	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  00090	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN6@BlMmCompac:

; 80   : 
; 81   :         BLASSERT((Current->Type >= BL_MM_PHYSICAL_REGION_MIN_TYPE) && (Current->Type <= BL_MM_PHYSICAL_REGION_MAX_TYPE));

  00095	8b 45 fc	 mov	 eax, DWORD PTR _Current$[ebp]
  00098	83 78 20 01	 cmp	 DWORD PTR [eax+32], 1
  0009c	72 09		 jb	 SHORT $LN4@BlMmCompac
  0009e	8b 4d fc	 mov	 ecx, DWORD PTR _Current$[ebp]
  000a1	83 79 20 10	 cmp	 DWORD PTR [ecx+32], 16	; 00000010H
  000a5	76 0f		 jbe	 SHORT $LN5@BlMmCompac
$LN4@BlMmCompac:
  000a7	ba 51 00 00 00	 mov	 edx, 81			; 00000051H
  000ac	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  000b1	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN5@BlMmCompac:

; 82   : 
; 83   :         if (Current->Entry.Flink == Head) {

  000b6	8b 55 fc	 mov	 edx, DWORD PTR _Current$[ebp]
  000b9	8b 02		 mov	 eax, DWORD PTR [edx]
  000bb	3b 45 f8	 cmp	 eax, DWORD PTR _Head$[ebp]
  000be	75 05		 jne	 SHORT $LN3@BlMmCompac

; 84   : 
; 85   :             break;

  000c0	e9 c9 00 00 00	 jmp	 $LN11@BlMmCompac
$LN3@BlMmCompac:

; 86   :         }
; 87   : 
; 88   :         Next = CONTAINING_RECORD(Current->Entry.Flink,
; 89   :                                  BL_MM_PHYSICAL_REGION,
; 90   :                                  Entry);

  000c5	8b 4d fc	 mov	 ecx, DWORD PTR _Current$[ebp]
  000c8	8b 11		 mov	 edx, DWORD PTR [ecx]
  000ca	89 55 f4	 mov	 DWORD PTR _Next$[ebp], edx

; 91   : 
; 92   :         BLASSERT(Next->Start >= Current->Limit);

  000cd	8b 45 f4	 mov	 eax, DWORD PTR _Next$[ebp]
  000d0	8b 4d fc	 mov	 ecx, DWORD PTR _Current$[ebp]
  000d3	89 45 e0	 mov	 DWORD PTR tv174[ebp], eax
  000d6	89 4d dc	 mov	 DWORD PTR tv175[ebp], ecx
  000d9	8b 55 e0	 mov	 edx, DWORD PTR tv174[ebp]
  000dc	8b 45 dc	 mov	 eax, DWORD PTR tv175[ebp]
  000df	8b 4a 0c	 mov	 ecx, DWORD PTR [edx+12]
  000e2	3b 48 1c	 cmp	 ecx, DWORD PTR [eax+28]
  000e5	77 1f		 ja	 SHORT $LN2@BlMmCompac
  000e7	72 0e		 jb	 SHORT $LN16@BlMmCompac
  000e9	8b 55 e0	 mov	 edx, DWORD PTR tv174[ebp]
  000ec	8b 45 dc	 mov	 eax, DWORD PTR tv175[ebp]
  000ef	8b 4a 08	 mov	 ecx, DWORD PTR [edx+8]
  000f2	3b 48 18	 cmp	 ecx, DWORD PTR [eax+24]
  000f5	73 0f		 jae	 SHORT $LN2@BlMmCompac
$LN16@BlMmCompac:
  000f7	ba 5c 00 00 00	 mov	 edx, 92			; 0000005cH
  000fc	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  00101	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN2@BlMmCompac:

; 93   : 
; 94   :         if ((Next->Start == Current->Limit) &&
; 95   :             (Next->Type == Current->Type)) {

  00106	8b 55 f4	 mov	 edx, DWORD PTR _Next$[ebp]
  00109	8b 45 fc	 mov	 eax, DWORD PTR _Current$[ebp]
  0010c	89 55 d8	 mov	 DWORD PTR tv186[ebp], edx
  0010f	89 45 d4	 mov	 DWORD PTR tv187[ebp], eax
  00112	8b 4d d8	 mov	 ecx, DWORD PTR tv186[ebp]
  00115	8b 55 d4	 mov	 edx, DWORD PTR tv187[ebp]
  00118	8b 41 08	 mov	 eax, DWORD PTR [ecx+8]
  0011b	3b 42 18	 cmp	 eax, DWORD PTR [edx+24]
  0011e	75 63		 jne	 SHORT $LN1@BlMmCompac
  00120	8b 4d d8	 mov	 ecx, DWORD PTR tv186[ebp]
  00123	8b 55 d4	 mov	 edx, DWORD PTR tv187[ebp]
  00126	8b 41 0c	 mov	 eax, DWORD PTR [ecx+12]
  00129	3b 42 1c	 cmp	 eax, DWORD PTR [edx+28]
  0012c	75 55		 jne	 SHORT $LN1@BlMmCompac
  0012e	8b 4d f4	 mov	 ecx, DWORD PTR _Next$[ebp]
  00131	8b 55 fc	 mov	 edx, DWORD PTR _Current$[ebp]
  00134	8b 41 20	 mov	 eax, DWORD PTR [ecx+32]
  00137	3b 42 20	 cmp	 eax, DWORD PTR [edx+32]
  0013a	75 47		 jne	 SHORT $LN1@BlMmCompac

; 96   : 
; 97   :             Current->Limit = Next->Limit;

  0013c	8b 4d fc	 mov	 ecx, DWORD PTR _Current$[ebp]
  0013f	8b 55 f4	 mov	 edx, DWORD PTR _Next$[ebp]
  00142	8b 42 18	 mov	 eax, DWORD PTR [edx+24]
  00145	89 41 18	 mov	 DWORD PTR [ecx+24], eax
  00148	8b 52 1c	 mov	 edx, DWORD PTR [edx+28]
  0014b	89 51 1c	 mov	 DWORD PTR [ecx+28], edx

; 98   :             Current->Size = Current->Limit - Current->Start;

  0014e	8b 45 fc	 mov	 eax, DWORD PTR _Current$[ebp]
  00151	8b 4d fc	 mov	 ecx, DWORD PTR _Current$[ebp]
  00154	8b 50 18	 mov	 edx, DWORD PTR [eax+24]
  00157	2b 51 08	 sub	 edx, DWORD PTR [ecx+8]
  0015a	8b 40 1c	 mov	 eax, DWORD PTR [eax+28]
  0015d	1b 41 0c	 sbb	 eax, DWORD PTR [ecx+12]
  00160	8b 4d fc	 mov	 ecx, DWORD PTR _Current$[ebp]
  00163	89 51 10	 mov	 DWORD PTR [ecx+16], edx
  00166	89 41 14	 mov	 DWORD PTR [ecx+20], eax

; 99   : 
; 100  :             BlRtlRemoveEntryList(&Next->Entry);

  00169	8b 4d f4	 mov	 ecx, DWORD PTR _Next$[ebp]
  0016c	e8 00 00 00 00	 call	 ?BlRtlRemoveEntryList@@YIEPAU_LIST_ENTRY@@@Z ; BlRtlRemoveEntryList

; 101  : 
; 102  :             BlRtlInsertTailList(&BlMmPhysicalRegionLookaside.FreeList, &Next->Entry);

  00171	8b 55 f4	 mov	 edx, DWORD PTR _Next$[ebp]
  00174	b9 80 02 00 00	 mov	 ecx, OFFSET ?BlMmPhysicalRegionLookaside@@3U<unnamed-tag>@@A+640
  00179	e8 00 00 00 00	 call	 ?BlRtlInsertTailList@@YIXPAU_LIST_ENTRY@@0@Z ; BlRtlInsertTailList

; 103  : 
; 104  :             continue;

  0017e	e9 a6 fe ff ff	 jmp	 $LN9@BlMmCompac
$LN1@BlMmCompac:

; 105  :         }
; 106  : 
; 107  :         Current = Next;

  00183	8b 55 f4	 mov	 edx, DWORD PTR _Next$[ebp]
  00186	89 55 fc	 mov	 DWORD PTR _Current$[ebp], edx
  00189	e9 9b fe ff ff	 jmp	 $LN9@BlMmCompac
$LN11@BlMmCompac:

; 108  :     }
; 109  : }

  0018e	8b e5		 mov	 esp, ebp
  00190	5d		 pop	 ebp
  00191	c3		 ret	 0
?BlMmCompactPhysicalRegionList@@YIXXZ ENDP		; BlMmCompactPhysicalRegionList
_TEXT	ENDS
PUBLIC	?BlMmInsertPhysicalRegion@@YIXPAU_BL_MM_PHYSICAL_REGION@@@Z ; BlMmInsertPhysicalRegion
; Function compile flags: /Odtp
;	COMDAT ?BlMmInsertPhysicalRegion@@YIXPAU_BL_MM_PHYSICAL_REGION@@@Z
_TEXT	SEGMENT
tv77 = -24						; size = 4
tv76 = -20						; size = 4
_Region$ = -16						; size = 4
_Next$ = -12						; size = 4
_Entry$ = -8						; size = 4
_Head$ = -4						; size = 4
?BlMmInsertPhysicalRegion@@YIXPAU_BL_MM_PHYSICAL_REGION@@@Z PROC ; BlMmInsertPhysicalRegion, COMDAT
; _Region$ = ecx

; 128  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 18	 sub	 esp, 24			; 00000018H
  00006	89 4d f0	 mov	 DWORD PTR _Region$[ebp], ecx

; 129  :     PLIST_ENTRY Entry;
; 130  :     PLIST_ENTRY Head;
; 131  :     PBL_MM_PHYSICAL_REGION Next;
; 132  : 
; 133  :     Head = &BlMmPhysicalRegionList;

  00009	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _Head$[ebp], OFFSET ?BlMmPhysicalRegionList@@3U_LIST_ENTRY@@A ; BlMmPhysicalRegionList

; 134  :     Entry = Head->Flink;

  00010	8b 45 fc	 mov	 eax, DWORD PTR _Head$[ebp]
  00013	8b 08		 mov	 ecx, DWORD PTR [eax]
  00015	89 4d f8	 mov	 DWORD PTR _Entry$[ebp], ecx
$LN3@BlMmInsert:

; 135  : 
; 136  :     while (Entry != Head) {

  00018	8b 55 f8	 mov	 edx, DWORD PTR _Entry$[ebp]
  0001b	3b 55 fc	 cmp	 edx, DWORD PTR _Head$[ebp]
  0001e	74 3c		 je	 SHORT $LN2@BlMmInsert

; 137  : 
; 138  :         Next = CONTAINING_RECORD(Entry,
; 139  :                                  BL_MM_PHYSICAL_REGION,
; 140  :                                  Entry);

  00020	8b 45 f8	 mov	 eax, DWORD PTR _Entry$[ebp]
  00023	89 45 f4	 mov	 DWORD PTR _Next$[ebp], eax

; 141  : 
; 142  :         if (Next->Start > Region->Start) {

  00026	8b 4d f4	 mov	 ecx, DWORD PTR _Next$[ebp]
  00029	8b 55 f0	 mov	 edx, DWORD PTR _Region$[ebp]
  0002c	89 4d ec	 mov	 DWORD PTR tv76[ebp], ecx
  0002f	89 55 e8	 mov	 DWORD PTR tv77[ebp], edx
  00032	8b 45 ec	 mov	 eax, DWORD PTR tv76[ebp]
  00035	8b 4d e8	 mov	 ecx, DWORD PTR tv77[ebp]
  00038	8b 50 0c	 mov	 edx, DWORD PTR [eax+12]
  0003b	3b 51 0c	 cmp	 edx, DWORD PTR [ecx+12]
  0003e	72 12		 jb	 SHORT $LN1@BlMmInsert
  00040	77 0e		 ja	 SHORT $LN6@BlMmInsert
  00042	8b 45 ec	 mov	 eax, DWORD PTR tv76[ebp]
  00045	8b 4d e8	 mov	 ecx, DWORD PTR tv77[ebp]
  00048	8b 50 08	 mov	 edx, DWORD PTR [eax+8]
  0004b	3b 51 08	 cmp	 edx, DWORD PTR [ecx+8]
  0004e	76 02		 jbe	 SHORT $LN1@BlMmInsert
$LN6@BlMmInsert:

; 143  : 
; 144  :             break;

  00050	eb 0a		 jmp	 SHORT $LN2@BlMmInsert
$LN1@BlMmInsert:

; 145  :         }
; 146  : 
; 147  :         Entry = Entry->Flink;

  00052	8b 45 f8	 mov	 eax, DWORD PTR _Entry$[ebp]
  00055	8b 08		 mov	 ecx, DWORD PTR [eax]
  00057	89 4d f8	 mov	 DWORD PTR _Entry$[ebp], ecx

; 148  :     }

  0005a	eb bc		 jmp	 SHORT $LN3@BlMmInsert
$LN2@BlMmInsert:

; 149  : 
; 150  :     BlRtlInsertTailList(Entry, &Region->Entry);

  0005c	8b 55 f0	 mov	 edx, DWORD PTR _Region$[ebp]
  0005f	8b 4d f8	 mov	 ecx, DWORD PTR _Entry$[ebp]
  00062	e8 00 00 00 00	 call	 ?BlRtlInsertTailList@@YIXPAU_LIST_ENTRY@@0@Z ; BlRtlInsertTailList

; 151  : 
; 152  :     BlMmCompactPhysicalRegionList();

  00067	e8 00 00 00 00	 call	 ?BlMmCompactPhysicalRegionList@@YIXXZ ; BlMmCompactPhysicalRegionList

; 153  : 
; 154  :     return;
; 155  : }

  0006c	8b e5		 mov	 esp, ebp
  0006e	5d		 pop	 ebp
  0006f	c3		 ret	 0
?BlMmInsertPhysicalRegion@@YIXPAU_BL_MM_PHYSICAL_REGION@@@Z ENDP ; BlMmInsertPhysicalRegion
_TEXT	ENDS
PUBLIC	??_C@_0CA@ENJPJAHG@MM?3?5Physical?5region?5collision?$CB?6?$AA@ ; `string'
PUBLIC	?BlMmCreatePhysicalRegion@@YIX_K0K@Z		; BlMmCreatePhysicalRegion
EXTRN	?BlRtlRemoveHeadList@@YIPAU_LIST_ENTRY@@PAU1@@Z:PROC ; BlRtlRemoveHeadList
EXTRN	?BlRtlHaltInternal@@YIXPBDK@Z:PROC		; BlRtlHaltInternal
EXTRN	?BlRtlPrintf@@YAEPBDZZ:PROC			; BlRtlPrintf
EXTRN	__aullrem:PROC
;	COMDAT ??_C@_0CA@ENJPJAHG@MM?3?5Physical?5region?5collision?$CB?6?$AA@
CONST	SEGMENT
??_C@_0CA@ENJPJAHG@MM?3?5Physical?5region?5collision?$CB?6?$AA@ DB 'MM: P'
	DB	'hysical region collision!', 0aH, 00H	; `string'
; Function compile flags: /Odtp
CONST	ENDS
;	COMDAT ?BlMmCreatePhysicalRegion@@YIX_K0K@Z
_TEXT	SEGMENT
tv217 = -56						; size = 4
tv203 = -52						; size = 4
tv195 = -48						; size = 4
tv175 = -44						; size = 8
tv154 = -36						; size = 8
_Type$ = -28						; size = 4
_Entry$ = -24						; size = 4
_Head$ = -20						; size = 4
_Limit$ = -16						; size = 8
_Region$ = -4						; size = 4
_Start$ = 8						; size = 8
_Size$ = 16						; size = 8
?BlMmCreatePhysicalRegion@@YIX_K0K@Z PROC		; BlMmCreatePhysicalRegion, COMDAT
; _Type$ = ecx

; 180  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 38	 sub	 esp, 56			; 00000038H
  00006	89 4d e4	 mov	 DWORD PTR _Type$[ebp], ecx

; 181  :     PLIST_ENTRY Entry;
; 182  :     PLIST_ENTRY Head;
; 183  :     UINT64 Limit;
; 184  :     PBL_MM_PHYSICAL_REGION Region;
; 185  : 
; 186  :     BLASSERT((Start % PAGE_SIZE) == 0);

  00009	6a 00		 push	 0
  0000b	68 00 10 00 00	 push	 4096			; 00001000H
  00010	8b 45 0c	 mov	 eax, DWORD PTR _Start$[ebp+4]
  00013	50		 push	 eax
  00014	8b 4d 08	 mov	 ecx, DWORD PTR _Start$[ebp]
  00017	51		 push	 ecx
  00018	e8 00 00 00 00	 call	 __aullrem
  0001d	89 45 dc	 mov	 DWORD PTR tv154[ebp], eax
  00020	89 55 e0	 mov	 DWORD PTR tv154[ebp+4], edx
  00023	8b 55 dc	 mov	 edx, DWORD PTR tv154[ebp]
  00026	0b 55 e0	 or	 edx, DWORD PTR tv154[ebp+4]
  00029	74 0f		 je	 SHORT $LN13@BlMmCreate
  0002b	ba ba 00 00 00	 mov	 edx, 186		; 000000baH
  00030	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  00035	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN13@BlMmCreate:

; 187  :     BLASSERT(Size > 0);

  0003a	83 7d 14 00	 cmp	 DWORD PTR _Size$[ebp+4], 0
  0003e	77 17		 ja	 SHORT $LN12@BlMmCreate
  00040	72 06		 jb	 SHORT $LN16@BlMmCreate
  00042	83 7d 10 00	 cmp	 DWORD PTR _Size$[ebp], 0
  00046	77 0f		 ja	 SHORT $LN12@BlMmCreate
$LN16@BlMmCreate:
  00048	ba bb 00 00 00	 mov	 edx, 187		; 000000bbH
  0004d	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  00052	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN12@BlMmCreate:

; 188  :     BLASSERT((Size % PAGE_SIZE) == 0);

  00057	6a 00		 push	 0
  00059	68 00 10 00 00	 push	 4096			; 00001000H
  0005e	8b 45 14	 mov	 eax, DWORD PTR _Size$[ebp+4]
  00061	50		 push	 eax
  00062	8b 4d 10	 mov	 ecx, DWORD PTR _Size$[ebp]
  00065	51		 push	 ecx
  00066	e8 00 00 00 00	 call	 __aullrem
  0006b	89 45 d4	 mov	 DWORD PTR tv175[ebp], eax
  0006e	89 55 d8	 mov	 DWORD PTR tv175[ebp+4], edx
  00071	8b 55 d4	 mov	 edx, DWORD PTR tv175[ebp]
  00074	0b 55 d8	 or	 edx, DWORD PTR tv175[ebp+4]
  00077	74 0f		 je	 SHORT $LN11@BlMmCreate
  00079	ba bc 00 00 00	 mov	 edx, 188		; 000000bcH
  0007e	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  00083	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN11@BlMmCreate:

; 189  :     BLASSERT(Type >= BL_MM_PHYSICAL_REGION_MIN_TYPE);

  00088	83 7d e4 01	 cmp	 DWORD PTR _Type$[ebp], 1
  0008c	73 0f		 jae	 SHORT $LN10@BlMmCreate
  0008e	ba bd 00 00 00	 mov	 edx, 189		; 000000bdH
  00093	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  00098	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN10@BlMmCreate:

; 190  :     BLASSERT(Type <= BL_MM_PHYSICAL_REGION_MAX_TYPE);

  0009d	83 7d e4 10	 cmp	 DWORD PTR _Type$[ebp], 16 ; 00000010H
  000a1	76 0f		 jbe	 SHORT $LN9@BlMmCreate
  000a3	ba be 00 00 00	 mov	 edx, 190		; 000000beH
  000a8	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  000ad	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN9@BlMmCreate:

; 191  : 
; 192  :     Limit = Start + Size;

  000b2	8b 45 08	 mov	 eax, DWORD PTR _Start$[ebp]
  000b5	03 45 10	 add	 eax, DWORD PTR _Size$[ebp]
  000b8	8b 4d 0c	 mov	 ecx, DWORD PTR _Start$[ebp+4]
  000bb	13 4d 14	 adc	 ecx, DWORD PTR _Size$[ebp+4]
  000be	89 45 f0	 mov	 DWORD PTR _Limit$[ebp], eax
  000c1	89 4d f4	 mov	 DWORD PTR _Limit$[ebp+4], ecx

; 193  : 
; 194  :     BLASSERT(Limit > Start);

  000c4	8b 55 f4	 mov	 edx, DWORD PTR _Limit$[ebp+4]
  000c7	3b 55 0c	 cmp	 edx, DWORD PTR _Start$[ebp+4]
  000ca	77 19		 ja	 SHORT $LN8@BlMmCreate
  000cc	72 08		 jb	 SHORT $LN17@BlMmCreate
  000ce	8b 45 f0	 mov	 eax, DWORD PTR _Limit$[ebp]
  000d1	3b 45 08	 cmp	 eax, DWORD PTR _Start$[ebp]
  000d4	77 0f		 ja	 SHORT $LN8@BlMmCreate
$LN17@BlMmCreate:
  000d6	ba c2 00 00 00	 mov	 edx, 194		; 000000c2H
  000db	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  000e0	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN8@BlMmCreate:

; 195  : 
; 196  :     Head = &BlMmPhysicalRegionList;

  000e5	c7 45 ec 00 00
	00 00		 mov	 DWORD PTR _Head$[ebp], OFFSET ?BlMmPhysicalRegionList@@3U_LIST_ENTRY@@A ; BlMmPhysicalRegionList

; 197  :     Entry = Head->Flink;

  000ec	8b 4d ec	 mov	 ecx, DWORD PTR _Head$[ebp]
  000ef	8b 11		 mov	 edx, DWORD PTR [ecx]
  000f1	89 55 e8	 mov	 DWORD PTR _Entry$[ebp], edx
$LN7@BlMmCreate:

; 198  : 
; 199  :     while (Entry != Head) {

  000f4	8b 45 e8	 mov	 eax, DWORD PTR _Entry$[ebp]
  000f7	3b 45 ec	 cmp	 eax, DWORD PTR _Head$[ebp]
  000fa	74 68		 je	 SHORT $LN6@BlMmCreate

; 200  : 
; 201  :         Region = CONTAINING_RECORD(Entry,
; 202  :                                    BL_MM_PHYSICAL_REGION,
; 203  :                                    Entry);

  000fc	8b 4d e8	 mov	 ecx, DWORD PTR _Entry$[ebp]
  000ff	89 4d fc	 mov	 DWORD PTR _Region$[ebp], ecx

; 204  : 
; 205  :         if ((Start < Region->Limit) && (Limit > Region->Start)) {

  00102	8b 55 fc	 mov	 edx, DWORD PTR _Region$[ebp]
  00105	89 55 d0	 mov	 DWORD PTR tv195[ebp], edx
  00108	8b 45 d0	 mov	 eax, DWORD PTR tv195[ebp]
  0010b	8b 4d 0c	 mov	 ecx, DWORD PTR _Start$[ebp+4]
  0010e	3b 48 1c	 cmp	 ecx, DWORD PTR [eax+28]
  00111	77 47		 ja	 SHORT $LN5@BlMmCreate
  00113	72 0b		 jb	 SHORT $LN18@BlMmCreate
  00115	8b 55 d0	 mov	 edx, DWORD PTR tv195[ebp]
  00118	8b 45 08	 mov	 eax, DWORD PTR _Start$[ebp]
  0011b	3b 42 18	 cmp	 eax, DWORD PTR [edx+24]
  0011e	73 3a		 jae	 SHORT $LN5@BlMmCreate
$LN18@BlMmCreate:
  00120	8b 4d fc	 mov	 ecx, DWORD PTR _Region$[ebp]
  00123	89 4d cc	 mov	 DWORD PTR tv203[ebp], ecx
  00126	8b 55 cc	 mov	 edx, DWORD PTR tv203[ebp]
  00129	8b 45 f4	 mov	 eax, DWORD PTR _Limit$[ebp+4]
  0012c	3b 42 0c	 cmp	 eax, DWORD PTR [edx+12]
  0012f	72 29		 jb	 SHORT $LN5@BlMmCreate
  00131	77 0b		 ja	 SHORT $LN19@BlMmCreate
  00133	8b 4d cc	 mov	 ecx, DWORD PTR tv203[ebp]
  00136	8b 55 f0	 mov	 edx, DWORD PTR _Limit$[ebp]
  00139	3b 51 08	 cmp	 edx, DWORD PTR [ecx+8]
  0013c	76 1c		 jbe	 SHORT $LN5@BlMmCreate
$LN19@BlMmCreate:

; 206  : 
; 207  :             BlRtlPrintf("MM: Physical region collision!\n");

  0013e	68 00 00 00 00	 push	 OFFSET ??_C@_0CA@ENJPJAHG@MM?3?5Physical?5region?5collision?$CB?6?$AA@
  00143	e8 00 00 00 00	 call	 ?BlRtlPrintf@@YAEPBDZZ	; BlRtlPrintf
  00148	83 c4 04	 add	 esp, 4

; 208  :             BlRtlHalt();

  0014b	ba d0 00 00 00	 mov	 edx, 208		; 000000d0H
  00150	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  00155	e8 00 00 00 00	 call	 ?BlRtlHaltInternal@@YIXPBDK@Z ; BlRtlHaltInternal
$LN5@BlMmCreate:

; 209  :         }
; 210  : 
; 211  :         Entry = Entry->Flink;

  0015a	8b 45 e8	 mov	 eax, DWORD PTR _Entry$[ebp]
  0015d	8b 08		 mov	 ecx, DWORD PTR [eax]
  0015f	89 4d e8	 mov	 DWORD PTR _Entry$[ebp], ecx

; 212  :     }

  00162	eb 90		 jmp	 SHORT $LN7@BlMmCreate
$LN6@BlMmCreate:

; 213  : 
; 214  :     Entry = Head->Flink;

  00164	8b 55 ec	 mov	 edx, DWORD PTR _Head$[ebp]
  00167	8b 02		 mov	 eax, DWORD PTR [edx]
  00169	89 45 e8	 mov	 DWORD PTR _Entry$[ebp], eax
$LN4@BlMmCreate:

; 215  : 
; 216  :     while (Entry != Head) {

  0016c	8b 4d e8	 mov	 ecx, DWORD PTR _Entry$[ebp]
  0016f	3b 4d ec	 cmp	 ecx, DWORD PTR _Head$[ebp]
  00172	74 30		 je	 SHORT $LN3@BlMmCreate

; 217  : 
; 218  :         Region = CONTAINING_RECORD(Entry,
; 219  :                                    BL_MM_PHYSICAL_REGION,
; 220  :                                    Entry);

  00174	8b 55 e8	 mov	 edx, DWORD PTR _Entry$[ebp]
  00177	89 55 fc	 mov	 DWORD PTR _Region$[ebp], edx

; 221  : 
; 222  :         if (Start < Region->Start) {

  0017a	8b 45 fc	 mov	 eax, DWORD PTR _Region$[ebp]
  0017d	89 45 c8	 mov	 DWORD PTR tv217[ebp], eax
  00180	8b 4d c8	 mov	 ecx, DWORD PTR tv217[ebp]
  00183	8b 55 0c	 mov	 edx, DWORD PTR _Start$[ebp+4]
  00186	3b 51 0c	 cmp	 edx, DWORD PTR [ecx+12]
  00189	77 0f		 ja	 SHORT $LN2@BlMmCreate
  0018b	72 0b		 jb	 SHORT $LN20@BlMmCreate
  0018d	8b 45 c8	 mov	 eax, DWORD PTR tv217[ebp]
  00190	8b 4d 08	 mov	 ecx, DWORD PTR _Start$[ebp]
  00193	3b 48 08	 cmp	 ecx, DWORD PTR [eax+8]
  00196	73 02		 jae	 SHORT $LN2@BlMmCreate
$LN20@BlMmCreate:

; 223  : 
; 224  :             break;

  00198	eb 0a		 jmp	 SHORT $LN3@BlMmCreate
$LN2@BlMmCreate:

; 225  :         }
; 226  : 
; 227  :         Entry = Entry->Flink;

  0019a	8b 55 e8	 mov	 edx, DWORD PTR _Entry$[ebp]
  0019d	8b 02		 mov	 eax, DWORD PTR [edx]
  0019f	89 45 e8	 mov	 DWORD PTR _Entry$[ebp], eax

; 228  :     }

  001a2	eb c8		 jmp	 SHORT $LN4@BlMmCreate
$LN3@BlMmCreate:

; 229  : 
; 230  :     BLASSERT(BlRtlIsListEmpty(&BlMmPhysicalRegionLookaside.FreeList) == FALSE);

  001a4	b9 80 02 00 00	 mov	 ecx, OFFSET ?BlMmPhysicalRegionLookaside@@3U<unnamed-tag>@@A+640
  001a9	e8 00 00 00 00	 call	 ?BlRtlIsListEmpty@@YIEPAU_LIST_ENTRY@@@Z ; BlRtlIsListEmpty
  001ae	0f b6 c8	 movzx	 ecx, al
  001b1	85 c9		 test	 ecx, ecx
  001b3	74 0f		 je	 SHORT $LN1@BlMmCreate
  001b5	ba e6 00 00 00	 mov	 edx, 230		; 000000e6H
  001ba	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  001bf	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN1@BlMmCreate:

; 231  : 
; 232  :     Region = CONTAINING_RECORD(BlRtlRemoveHeadList(&BlMmPhysicalRegionLookaside.FreeList),
; 233  :                                BL_MM_PHYSICAL_REGION,
; 234  :                                Entry);

  001c4	b9 80 02 00 00	 mov	 ecx, OFFSET ?BlMmPhysicalRegionLookaside@@3U<unnamed-tag>@@A+640
  001c9	e8 00 00 00 00	 call	 ?BlRtlRemoveHeadList@@YIPAU_LIST_ENTRY@@PAU1@@Z ; BlRtlRemoveHeadList
  001ce	89 45 fc	 mov	 DWORD PTR _Region$[ebp], eax

; 235  : 
; 236  :     Region->Start = Start;

  001d1	8b 55 fc	 mov	 edx, DWORD PTR _Region$[ebp]
  001d4	8b 45 08	 mov	 eax, DWORD PTR _Start$[ebp]
  001d7	89 42 08	 mov	 DWORD PTR [edx+8], eax
  001da	8b 4d 0c	 mov	 ecx, DWORD PTR _Start$[ebp+4]
  001dd	89 4a 0c	 mov	 DWORD PTR [edx+12], ecx

; 237  :     Region->Size = Size;

  001e0	8b 55 fc	 mov	 edx, DWORD PTR _Region$[ebp]
  001e3	8b 45 10	 mov	 eax, DWORD PTR _Size$[ebp]
  001e6	89 42 10	 mov	 DWORD PTR [edx+16], eax
  001e9	8b 4d 14	 mov	 ecx, DWORD PTR _Size$[ebp+4]
  001ec	89 4a 14	 mov	 DWORD PTR [edx+20], ecx

; 238  :     Region->Limit = Limit;

  001ef	8b 55 fc	 mov	 edx, DWORD PTR _Region$[ebp]
  001f2	8b 45 f0	 mov	 eax, DWORD PTR _Limit$[ebp]
  001f5	89 42 18	 mov	 DWORD PTR [edx+24], eax
  001f8	8b 4d f4	 mov	 ecx, DWORD PTR _Limit$[ebp+4]
  001fb	89 4a 1c	 mov	 DWORD PTR [edx+28], ecx

; 239  :     Region->Type = Type;

  001fe	8b 55 fc	 mov	 edx, DWORD PTR _Region$[ebp]
  00201	8b 45 e4	 mov	 eax, DWORD PTR _Type$[ebp]
  00204	89 42 20	 mov	 DWORD PTR [edx+32], eax

; 240  : 
; 241  :     BlMmInsertPhysicalRegion(Region);

  00207	8b 4d fc	 mov	 ecx, DWORD PTR _Region$[ebp]
  0020a	e8 00 00 00 00	 call	 ?BlMmInsertPhysicalRegion@@YIXPAU_BL_MM_PHYSICAL_REGION@@@Z ; BlMmInsertPhysicalRegion

; 242  : 
; 243  :     return;
; 244  : }

  0020f	8b e5		 mov	 esp, ebp
  00211	5d		 pop	 ebp
  00212	c2 10 00	 ret	 16			; 00000010H
?BlMmCreatePhysicalRegion@@YIX_K0K@Z ENDP		; BlMmCreatePhysicalRegion
_TEXT	ENDS
PUBLIC	??_C@_0CC@GFMNFNPB@MM?3?5Unable?5to?5allocate?5?$CFx?5bytes?$CB@ ; `string'
PUBLIC	?BlMmAllocatePhysicalRegion@@YI_KKK@Z		; BlMmAllocatePhysicalRegion
EXTRN	?BlRtlZeroMemory@@YIXPAXK@Z:PROC		; BlRtlZeroMemory
;	COMDAT ??_C@_0CC@GFMNFNPB@MM?3?5Unable?5to?5allocate?5?$CFx?5bytes?$CB@
CONST	SEGMENT
??_C@_0CC@GFMNFNPB@MM?3?5Unable?5to?5allocate?5?$CFx?5bytes?$CB@ DB 'MM: '
	DB	'Unable to allocate %x bytes!', 0aH, 00H	; `string'
; Function compile flags: /Odtp
CONST	ENDS
;	COMDAT ?BlMmAllocatePhysicalRegion@@YI_KKK@Z
_TEXT	SEGMENT
tv192 = -52						; size = 8
tv191 = -44						; size = 4
tv179 = -40						; size = 4
tv169 = -36						; size = 8
tv168 = -28						; size = 4
_Type$ = -24						; size = 4
_Size$ = -20						; size = 4
_FreeRegion$ = -16					; size = 4
_Entry$ = -12						; size = 4
_Head$ = -8						; size = 4
_Region$ = -4						; size = 4
?BlMmAllocatePhysicalRegion@@YI_KKK@Z PROC		; BlMmAllocatePhysicalRegion, COMDAT
; _Size$ = ecx
; _Type$ = edx

; 271  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 34	 sub	 esp, 52			; 00000034H
  00006	56		 push	 esi
  00007	89 55 e8	 mov	 DWORD PTR _Type$[ebp], edx
  0000a	89 4d ec	 mov	 DWORD PTR _Size$[ebp], ecx

; 272  :     PLIST_ENTRY Entry;
; 273  :     PBL_MM_PHYSICAL_REGION FreeRegion;
; 274  :     PLIST_ENTRY Head;
; 275  :     PBL_MM_PHYSICAL_REGION Region;
; 276  : 
; 277  :     BLASSERT(Size > 0);

  0000d	83 7d ec 00	 cmp	 DWORD PTR _Size$[ebp], 0
  00011	77 0f		 ja	 SHORT $LN8@BlMmAlloca
  00013	ba 15 01 00 00	 mov	 edx, 277		; 00000115H
  00018	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  0001d	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN8@BlMmAlloca:

; 278  :     BLASSERT(Type != BL_MM_PHYSICAL_REGION_FREE);

  00022	83 7d e8 01	 cmp	 DWORD PTR _Type$[ebp], 1
  00026	75 0f		 jne	 SHORT $LN7@BlMmAlloca
  00028	ba 16 01 00 00	 mov	 edx, 278		; 00000116H
  0002d	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  00032	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN7@BlMmAlloca:

; 279  : 
; 280  :     SATISFY_OVERZEALOUS_COMPILER(Region = NULL);

  00037	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _Region$[ebp], 0

; 281  : 
; 282  :     Size = ROUND_UP_TO_PAGES(Size);

  0003e	8b 45 ec	 mov	 eax, DWORD PTR _Size$[ebp]
  00041	05 ff 0f 00 00	 add	 eax, 4095		; 00000fffH
  00046	25 00 f0 ff ff	 and	 eax, -4096		; fffff000H
  0004b	89 45 ec	 mov	 DWORD PTR _Size$[ebp], eax

; 283  : 
; 284  :     Head = &BlMmPhysicalRegionList;

  0004e	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _Head$[ebp], OFFSET ?BlMmPhysicalRegionList@@3U_LIST_ENTRY@@A ; BlMmPhysicalRegionList

; 285  :     Entry = Head->Blink;

  00055	8b 4d f8	 mov	 ecx, DWORD PTR _Head$[ebp]
  00058	8b 51 04	 mov	 edx, DWORD PTR [ecx+4]
  0005b	89 55 f4	 mov	 DWORD PTR _Entry$[ebp], edx
$LN6@BlMmAlloca:

; 286  : 
; 287  :     while (Entry != Head) {

  0005e	8b 45 f4	 mov	 eax, DWORD PTR _Entry$[ebp]
  00061	3b 45 f8	 cmp	 eax, DWORD PTR _Head$[ebp]
  00064	74 5f		 je	 SHORT $LN5@BlMmAlloca

; 288  : 
; 289  :         Region = CONTAINING_RECORD(Entry,
; 290  :                                    BL_MM_PHYSICAL_REGION,
; 291  :                                    Entry);

  00066	8b 4d f4	 mov	 ecx, DWORD PTR _Entry$[ebp]
  00069	89 4d fc	 mov	 DWORD PTR _Region$[ebp], ecx

; 292  : 
; 293  :         if ((Region->Type == BL_MM_PHYSICAL_REGION_FREE) &&
; 294  :             (Region->Size >= Size) &&
; 295  :             (Region->Limit < 0x100000000UI64)) {

  0006c	8b 55 fc	 mov	 edx, DWORD PTR _Region$[ebp]
  0006f	83 7a 20 01	 cmp	 DWORD PTR [edx+32], 1
  00073	75 45		 jne	 SHORT $LN4@BlMmAlloca
  00075	8b 45 ec	 mov	 eax, DWORD PTR _Size$[ebp]
  00078	33 c9		 xor	 ecx, ecx
  0007a	8b 55 fc	 mov	 edx, DWORD PTR _Region$[ebp]
  0007d	89 55 e4	 mov	 DWORD PTR tv168[ebp], edx
  00080	89 45 dc	 mov	 DWORD PTR tv169[ebp], eax
  00083	89 4d e0	 mov	 DWORD PTR tv169[ebp+4], ecx
  00086	8b 45 e4	 mov	 eax, DWORD PTR tv168[ebp]
  00089	8b 48 14	 mov	 ecx, DWORD PTR [eax+20]
  0008c	3b 4d e0	 cmp	 ecx, DWORD PTR tv169[ebp+4]
  0008f	72 29		 jb	 SHORT $LN4@BlMmAlloca
  00091	77 0b		 ja	 SHORT $LN11@BlMmAlloca
  00093	8b 55 e4	 mov	 edx, DWORD PTR tv168[ebp]
  00096	8b 42 10	 mov	 eax, DWORD PTR [edx+16]
  00099	3b 45 dc	 cmp	 eax, DWORD PTR tv169[ebp]
  0009c	72 1c		 jb	 SHORT $LN4@BlMmAlloca
$LN11@BlMmAlloca:
  0009e	8b 4d fc	 mov	 ecx, DWORD PTR _Region$[ebp]
  000a1	89 4d d8	 mov	 DWORD PTR tv179[ebp], ecx
  000a4	8b 55 d8	 mov	 edx, DWORD PTR tv179[ebp]
  000a7	83 7a 1c 01	 cmp	 DWORD PTR [edx+28], 1
  000ab	77 0d		 ja	 SHORT $LN4@BlMmAlloca
  000ad	72 09		 jb	 SHORT $LN12@BlMmAlloca
  000af	8b 45 d8	 mov	 eax, DWORD PTR tv179[ebp]
  000b2	83 78 18 00	 cmp	 DWORD PTR [eax+24], 0
  000b6	73 02		 jae	 SHORT $LN4@BlMmAlloca
$LN12@BlMmAlloca:

; 296  : 
; 297  :             break;

  000b8	eb 0b		 jmp	 SHORT $LN5@BlMmAlloca
$LN4@BlMmAlloca:

; 298  :         }
; 299  : 
; 300  :         Entry = Entry->Blink;

  000ba	8b 4d f4	 mov	 ecx, DWORD PTR _Entry$[ebp]
  000bd	8b 51 04	 mov	 edx, DWORD PTR [ecx+4]
  000c0	89 55 f4	 mov	 DWORD PTR _Entry$[ebp], edx

; 301  :     }

  000c3	eb 99		 jmp	 SHORT $LN6@BlMmAlloca
$LN5@BlMmAlloca:

; 302  : 
; 303  :     if (Entry == Head) {

  000c5	8b 45 f4	 mov	 eax, DWORD PTR _Entry$[ebp]
  000c8	3b 45 f8	 cmp	 eax, DWORD PTR _Head$[ebp]
  000cb	75 20		 jne	 SHORT $LN3@BlMmAlloca

; 304  : 
; 305  :         BlRtlPrintf("MM: Unable to allocate %x bytes!\n", Size);

  000cd	8b 4d ec	 mov	 ecx, DWORD PTR _Size$[ebp]
  000d0	51		 push	 ecx
  000d1	68 00 00 00 00	 push	 OFFSET ??_C@_0CC@GFMNFNPB@MM?3?5Unable?5to?5allocate?5?$CFx?5bytes?$CB@
  000d6	e8 00 00 00 00	 call	 ?BlRtlPrintf@@YAEPBDZZ	; BlRtlPrintf
  000db	83 c4 08	 add	 esp, 8

; 306  :         BlRtlHalt();

  000de	ba 32 01 00 00	 mov	 edx, 306		; 00000132H
  000e3	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  000e8	e8 00 00 00 00	 call	 ?BlRtlHaltInternal@@YIXPBDK@Z ; BlRtlHaltInternal
$LN3@BlMmAlloca:

; 307  :     }
; 308  : 
; 309  :     if (Region->Size == Size) {

  000ed	8b 55 ec	 mov	 edx, DWORD PTR _Size$[ebp]
  000f0	33 c0		 xor	 eax, eax
  000f2	8b 4d fc	 mov	 ecx, DWORD PTR _Region$[ebp]
  000f5	89 4d d4	 mov	 DWORD PTR tv191[ebp], ecx
  000f8	89 55 cc	 mov	 DWORD PTR tv192[ebp], edx
  000fb	89 45 d0	 mov	 DWORD PTR tv192[ebp+4], eax
  000fe	8b 55 d4	 mov	 edx, DWORD PTR tv191[ebp]
  00101	8b 42 10	 mov	 eax, DWORD PTR [edx+16]
  00104	3b 45 cc	 cmp	 eax, DWORD PTR tv192[ebp]
  00107	75 22		 jne	 SHORT $LN2@BlMmAlloca
  00109	8b 4d d4	 mov	 ecx, DWORD PTR tv191[ebp]
  0010c	8b 51 14	 mov	 edx, DWORD PTR [ecx+20]
  0010f	3b 55 d0	 cmp	 edx, DWORD PTR tv192[ebp+4]
  00112	75 17		 jne	 SHORT $LN2@BlMmAlloca

; 310  : 
; 311  :         Region->Type = Type;

  00114	8b 45 fc	 mov	 eax, DWORD PTR _Region$[ebp]
  00117	8b 4d e8	 mov	 ecx, DWORD PTR _Type$[ebp]
  0011a	89 48 20	 mov	 DWORD PTR [eax+32], ecx

; 312  :         return Region->Start;

  0011d	8b 55 fc	 mov	 edx, DWORD PTR _Region$[ebp]
  00120	8b 42 08	 mov	 eax, DWORD PTR [edx+8]
  00123	8b 52 0c	 mov	 edx, DWORD PTR [edx+12]
  00126	e9 d8 00 00 00	 jmp	 $LN9@BlMmAlloca
$LN2@BlMmAlloca:

; 313  :     }
; 314  : 
; 315  :     FreeRegion = Region;

  0012b	8b 45 fc	 mov	 eax, DWORD PTR _Region$[ebp]
  0012e	89 45 f0	 mov	 DWORD PTR _FreeRegion$[ebp], eax

; 316  : 
; 317  :     BLASSERT(BlRtlIsListEmpty(&BlMmPhysicalRegionLookaside.FreeList) == FALSE);

  00131	b9 80 02 00 00	 mov	 ecx, OFFSET ?BlMmPhysicalRegionLookaside@@3U<unnamed-tag>@@A+640
  00136	e8 00 00 00 00	 call	 ?BlRtlIsListEmpty@@YIEPAU_LIST_ENTRY@@@Z ; BlRtlIsListEmpty
  0013b	0f b6 c8	 movzx	 ecx, al
  0013e	85 c9		 test	 ecx, ecx
  00140	74 0f		 je	 SHORT $LN1@BlMmAlloca
  00142	ba 3d 01 00 00	 mov	 edx, 317		; 0000013dH
  00147	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  0014c	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN1@BlMmAlloca:

; 318  : 
; 319  :     Region = CONTAINING_RECORD(BlRtlRemoveHeadList(&BlMmPhysicalRegionLookaside.FreeList),
; 320  :                                BL_MM_PHYSICAL_REGION,
; 321  :                                Entry);

  00151	b9 80 02 00 00	 mov	 ecx, OFFSET ?BlMmPhysicalRegionLookaside@@3U<unnamed-tag>@@A+640
  00156	e8 00 00 00 00	 call	 ?BlRtlRemoveHeadList@@YIPAU_LIST_ENTRY@@PAU1@@Z ; BlRtlRemoveHeadList
  0015b	89 45 fc	 mov	 DWORD PTR _Region$[ebp], eax

; 322  : 
; 323  :     Region->Start = FreeRegion->Limit - Size;

  0015e	8b 55 ec	 mov	 edx, DWORD PTR _Size$[ebp]
  00161	33 c0		 xor	 eax, eax
  00163	8b 4d f0	 mov	 ecx, DWORD PTR _FreeRegion$[ebp]
  00166	8b 71 18	 mov	 esi, DWORD PTR [ecx+24]
  00169	2b f2		 sub	 esi, edx
  0016b	8b 51 1c	 mov	 edx, DWORD PTR [ecx+28]
  0016e	1b d0		 sbb	 edx, eax
  00170	8b 45 fc	 mov	 eax, DWORD PTR _Region$[ebp]
  00173	89 70 08	 mov	 DWORD PTR [eax+8], esi
  00176	89 50 0c	 mov	 DWORD PTR [eax+12], edx

; 324  :     FreeRegion->Limit -= Size;

  00179	8b 4d ec	 mov	 ecx, DWORD PTR _Size$[ebp]
  0017c	33 d2		 xor	 edx, edx
  0017e	8b 45 f0	 mov	 eax, DWORD PTR _FreeRegion$[ebp]
  00181	8b 70 18	 mov	 esi, DWORD PTR [eax+24]
  00184	2b f1		 sub	 esi, ecx
  00186	8b 48 1c	 mov	 ecx, DWORD PTR [eax+28]
  00189	1b ca		 sbb	 ecx, edx
  0018b	8b 55 f0	 mov	 edx, DWORD PTR _FreeRegion$[ebp]
  0018e	89 72 18	 mov	 DWORD PTR [edx+24], esi
  00191	89 4a 1c	 mov	 DWORD PTR [edx+28], ecx

; 325  :     FreeRegion->Size -= Size;

  00194	8b 45 ec	 mov	 eax, DWORD PTR _Size$[ebp]
  00197	33 c9		 xor	 ecx, ecx
  00199	8b 55 f0	 mov	 edx, DWORD PTR _FreeRegion$[ebp]
  0019c	8b 72 10	 mov	 esi, DWORD PTR [edx+16]
  0019f	2b f0		 sub	 esi, eax
  001a1	8b 42 14	 mov	 eax, DWORD PTR [edx+20]
  001a4	1b c1		 sbb	 eax, ecx
  001a6	8b 4d f0	 mov	 ecx, DWORD PTR _FreeRegion$[ebp]
  001a9	89 71 10	 mov	 DWORD PTR [ecx+16], esi
  001ac	89 41 14	 mov	 DWORD PTR [ecx+20], eax

; 326  : 
; 327  :     Region->Size = Size;

  001af	8b 55 ec	 mov	 edx, DWORD PTR _Size$[ebp]
  001b2	33 c0		 xor	 eax, eax
  001b4	8b 4d fc	 mov	 ecx, DWORD PTR _Region$[ebp]
  001b7	89 51 10	 mov	 DWORD PTR [ecx+16], edx
  001ba	89 41 14	 mov	 DWORD PTR [ecx+20], eax

; 328  :     Region->Limit = Region->Start + Region->Size;

  001bd	8b 55 fc	 mov	 edx, DWORD PTR _Region$[ebp]
  001c0	8b 45 fc	 mov	 eax, DWORD PTR _Region$[ebp]
  001c3	8b 4a 08	 mov	 ecx, DWORD PTR [edx+8]
  001c6	03 48 10	 add	 ecx, DWORD PTR [eax+16]
  001c9	8b 52 0c	 mov	 edx, DWORD PTR [edx+12]
  001cc	13 50 14	 adc	 edx, DWORD PTR [eax+20]
  001cf	8b 45 fc	 mov	 eax, DWORD PTR _Region$[ebp]
  001d2	89 48 18	 mov	 DWORD PTR [eax+24], ecx
  001d5	89 50 1c	 mov	 DWORD PTR [eax+28], edx

; 329  :     Region->Type = Type;

  001d8	8b 4d fc	 mov	 ecx, DWORD PTR _Region$[ebp]
  001db	8b 55 e8	 mov	 edx, DWORD PTR _Type$[ebp]
  001de	89 51 20	 mov	 DWORD PTR [ecx+32], edx

; 330  : 
; 331  :     BlRtlZeroMemory((PVOID) (ULONG_PTR) Region->Start, (ULONG_PTR) (UINT32) Region->Size);

  001e1	8b 45 fc	 mov	 eax, DWORD PTR _Region$[ebp]
  001e4	8b 50 10	 mov	 edx, DWORD PTR [eax+16]
  001e7	8b 4d fc	 mov	 ecx, DWORD PTR _Region$[ebp]
  001ea	8b 49 08	 mov	 ecx, DWORD PTR [ecx+8]
  001ed	e8 00 00 00 00	 call	 ?BlRtlZeroMemory@@YIXPAXK@Z ; BlRtlZeroMemory

; 332  : 
; 333  :     BlMmInsertPhysicalRegion(Region);

  001f2	8b 4d fc	 mov	 ecx, DWORD PTR _Region$[ebp]
  001f5	e8 00 00 00 00	 call	 ?BlMmInsertPhysicalRegion@@YIXPAU_BL_MM_PHYSICAL_REGION@@@Z ; BlMmInsertPhysicalRegion

; 334  : 
; 335  :     return Region->Start;

  001fa	8b 55 fc	 mov	 edx, DWORD PTR _Region$[ebp]
  001fd	8b 42 08	 mov	 eax, DWORD PTR [edx+8]
  00200	8b 52 0c	 mov	 edx, DWORD PTR [edx+12]
$LN9@BlMmAlloca:

; 336  : }

  00203	5e		 pop	 esi
  00204	8b e5		 mov	 esp, ebp
  00206	5d		 pop	 ebp
  00207	c3		 ret	 0
?BlMmAllocatePhysicalRegion@@YI_KKK@Z ENDP		; BlMmAllocatePhysicalRegion
_TEXT	ENDS
PUBLIC	?BlMmAllocateSpecificPhysicalRegion@@YIE_K0K@Z	; BlMmAllocateSpecificPhysicalRegion
; Function compile flags: /Odtp
;	COMDAT ?BlMmAllocateSpecificPhysicalRegion@@YIE_K0K@Z
_TEXT	SEGMENT
tv265 = -76						; size = 4
tv235 = -72						; size = 4
tv223 = -68						; size = 4
tv215 = -64						; size = 4
tv195 = -60						; size = 8
tv174 = -52						; size = 8
_Type$ = -44						; size = 4
_End$ = -40						; size = 8
_NextRegion$ = -28					; size = 4
_Entry$ = -24						; size = 4
_Head$ = -20						; size = 4
_PreviousRegion$ = -16					; size = 4
_Region$ = -12						; size = 4
_Start$ = -8						; size = 8
_Base$ = 8						; size = 8
_Size$ = 16						; size = 8
?BlMmAllocateSpecificPhysicalRegion@@YIE_K0K@Z PROC	; BlMmAllocateSpecificPhysicalRegion, COMDAT
; _Type$ = ecx

; 366  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 4c	 sub	 esp, 76			; 0000004cH
  00006	89 4d d4	 mov	 DWORD PTR _Type$[ebp], ecx

; 367  :     UINT64 End;
; 368  :     PLIST_ENTRY Entry;
; 369  :     PLIST_ENTRY Head;
; 370  :     PBL_MM_PHYSICAL_REGION NextRegion;
; 371  :     PBL_MM_PHYSICAL_REGION PreviousRegion;
; 372  :     PBL_MM_PHYSICAL_REGION Region;
; 373  :     UINT64 Start;
; 374  : 
; 375  :     BLASSERT((Base % PAGE_SIZE) == 0);

  00009	6a 00		 push	 0
  0000b	68 00 10 00 00	 push	 4096			; 00001000H
  00010	8b 45 0c	 mov	 eax, DWORD PTR _Base$[ebp+4]
  00013	50		 push	 eax
  00014	8b 4d 08	 mov	 ecx, DWORD PTR _Base$[ebp]
  00017	51		 push	 ecx
  00018	e8 00 00 00 00	 call	 __aullrem
  0001d	89 45 cc	 mov	 DWORD PTR tv174[ebp], eax
  00020	89 55 d0	 mov	 DWORD PTR tv174[ebp+4], edx
  00023	8b 55 cc	 mov	 edx, DWORD PTR tv174[ebp]
  00026	0b 55 d0	 or	 edx, DWORD PTR tv174[ebp+4]
  00029	74 0f		 je	 SHORT $LN16@BlMmAlloca@2
  0002b	ba 77 01 00 00	 mov	 edx, 375		; 00000177H
  00030	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  00035	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN16@BlMmAlloca@2:

; 376  : 
; 377  :     BLASSERT(Size > 0);

  0003a	83 7d 14 00	 cmp	 DWORD PTR _Size$[ebp+4], 0
  0003e	77 17		 ja	 SHORT $LN15@BlMmAlloca@2
  00040	72 06		 jb	 SHORT $LN19@BlMmAlloca@2
  00042	83 7d 10 00	 cmp	 DWORD PTR _Size$[ebp], 0
  00046	77 0f		 ja	 SHORT $LN15@BlMmAlloca@2
$LN19@BlMmAlloca@2:
  00048	ba 79 01 00 00	 mov	 edx, 377		; 00000179H
  0004d	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  00052	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN15@BlMmAlloca@2:

; 378  : 
; 379  :     BLASSERT((Size % PAGE_SIZE) == 0);

  00057	6a 00		 push	 0
  00059	68 00 10 00 00	 push	 4096			; 00001000H
  0005e	8b 45 14	 mov	 eax, DWORD PTR _Size$[ebp+4]
  00061	50		 push	 eax
  00062	8b 4d 10	 mov	 ecx, DWORD PTR _Size$[ebp]
  00065	51		 push	 ecx
  00066	e8 00 00 00 00	 call	 __aullrem
  0006b	89 45 c4	 mov	 DWORD PTR tv195[ebp], eax
  0006e	89 55 c8	 mov	 DWORD PTR tv195[ebp+4], edx
  00071	8b 55 c4	 mov	 edx, DWORD PTR tv195[ebp]
  00074	0b 55 c8	 or	 edx, DWORD PTR tv195[ebp+4]
  00077	74 0f		 je	 SHORT $LN14@BlMmAlloca@2
  00079	ba 7b 01 00 00	 mov	 edx, 379		; 0000017bH
  0007e	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  00083	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN14@BlMmAlloca@2:

; 380  : 
; 381  :     BLASSERT(Type != BL_MM_PHYSICAL_REGION_FREE);

  00088	83 7d d4 01	 cmp	 DWORD PTR _Type$[ebp], 1
  0008c	75 0f		 jne	 SHORT $LN13@BlMmAlloca@2
  0008e	ba 7d 01 00 00	 mov	 edx, 381		; 0000017dH
  00093	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  00098	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN13@BlMmAlloca@2:

; 382  : 
; 383  :     SATISFY_OVERZEALOUS_COMPILER(Region = NULL);

  0009d	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _Region$[ebp], 0

; 384  : 
; 385  :     Start = Base;

  000a4	8b 45 08	 mov	 eax, DWORD PTR _Base$[ebp]
  000a7	89 45 f8	 mov	 DWORD PTR _Start$[ebp], eax
  000aa	8b 4d 0c	 mov	 ecx, DWORD PTR _Base$[ebp+4]
  000ad	89 4d fc	 mov	 DWORD PTR _Start$[ebp+4], ecx

; 386  :     End = Start + Size;

  000b0	8b 55 f8	 mov	 edx, DWORD PTR _Start$[ebp]
  000b3	03 55 10	 add	 edx, DWORD PTR _Size$[ebp]
  000b6	8b 45 fc	 mov	 eax, DWORD PTR _Start$[ebp+4]
  000b9	13 45 14	 adc	 eax, DWORD PTR _Size$[ebp+4]
  000bc	89 55 d8	 mov	 DWORD PTR _End$[ebp], edx
  000bf	89 45 dc	 mov	 DWORD PTR _End$[ebp+4], eax

; 387  : 
; 388  :     Head = &BlMmPhysicalRegionList;

  000c2	c7 45 ec 00 00
	00 00		 mov	 DWORD PTR _Head$[ebp], OFFSET ?BlMmPhysicalRegionList@@3U_LIST_ENTRY@@A ; BlMmPhysicalRegionList

; 389  : 
; 390  :     for (Entry = Head->Flink; Entry != Head; Entry = Entry->Flink) {

  000c9	8b 4d ec	 mov	 ecx, DWORD PTR _Head$[ebp]
  000cc	8b 11		 mov	 edx, DWORD PTR [ecx]
  000ce	89 55 e8	 mov	 DWORD PTR _Entry$[ebp], edx
  000d1	eb 08		 jmp	 SHORT $LN12@BlMmAlloca@2
$LN11@BlMmAlloca@2:
  000d3	8b 45 e8	 mov	 eax, DWORD PTR _Entry$[ebp]
  000d6	8b 08		 mov	 ecx, DWORD PTR [eax]
  000d8	89 4d e8	 mov	 DWORD PTR _Entry$[ebp], ecx
$LN12@BlMmAlloca@2:
  000db	8b 55 e8	 mov	 edx, DWORD PTR _Entry$[ebp]
  000de	3b 55 ec	 cmp	 edx, DWORD PTR _Head$[ebp]
  000e1	74 46		 je	 SHORT $LN10@BlMmAlloca@2

; 391  : 
; 392  :         Region = CONTAINING_RECORD(Entry,
; 393  :                                    BL_MM_PHYSICAL_REGION,
; 394  :                                    Entry);

  000e3	8b 45 e8	 mov	 eax, DWORD PTR _Entry$[ebp]
  000e6	89 45 f4	 mov	 DWORD PTR _Region$[ebp], eax

; 395  : 
; 396  :         if ((Start >= Region->Start) && (End <= Region->Limit)) {

  000e9	8b 4d f4	 mov	 ecx, DWORD PTR _Region$[ebp]
  000ec	89 4d c0	 mov	 DWORD PTR tv215[ebp], ecx
  000ef	8b 55 c0	 mov	 edx, DWORD PTR tv215[ebp]
  000f2	8b 45 fc	 mov	 eax, DWORD PTR _Start$[ebp+4]
  000f5	3b 42 0c	 cmp	 eax, DWORD PTR [edx+12]
  000f8	72 2d		 jb	 SHORT $LN9@BlMmAlloca@2
  000fa	77 0b		 ja	 SHORT $LN20@BlMmAlloca@2
  000fc	8b 4d c0	 mov	 ecx, DWORD PTR tv215[ebp]
  000ff	8b 55 f8	 mov	 edx, DWORD PTR _Start$[ebp]
  00102	3b 51 08	 cmp	 edx, DWORD PTR [ecx+8]
  00105	72 20		 jb	 SHORT $LN9@BlMmAlloca@2
$LN20@BlMmAlloca@2:
  00107	8b 45 f4	 mov	 eax, DWORD PTR _Region$[ebp]
  0010a	89 45 bc	 mov	 DWORD PTR tv223[ebp], eax
  0010d	8b 4d bc	 mov	 ecx, DWORD PTR tv223[ebp]
  00110	8b 55 dc	 mov	 edx, DWORD PTR _End$[ebp+4]
  00113	3b 51 1c	 cmp	 edx, DWORD PTR [ecx+28]
  00116	77 0f		 ja	 SHORT $LN9@BlMmAlloca@2
  00118	72 0b		 jb	 SHORT $LN21@BlMmAlloca@2
  0011a	8b 45 bc	 mov	 eax, DWORD PTR tv223[ebp]
  0011d	8b 4d d8	 mov	 ecx, DWORD PTR _End$[ebp]
  00120	3b 48 18	 cmp	 ecx, DWORD PTR [eax+24]
  00123	77 02		 ja	 SHORT $LN9@BlMmAlloca@2
$LN21@BlMmAlloca@2:

; 397  : 
; 398  :             break;

  00125	eb 02		 jmp	 SHORT $LN10@BlMmAlloca@2
$LN9@BlMmAlloca@2:

; 399  :         }
; 400  :     }

  00127	eb aa		 jmp	 SHORT $LN11@BlMmAlloca@2
$LN10@BlMmAlloca@2:

; 401  : 
; 402  :     if (Entry == Head) {

  00129	8b 55 e8	 mov	 edx, DWORD PTR _Entry$[ebp]
  0012c	3b 55 ec	 cmp	 edx, DWORD PTR _Head$[ebp]
  0012f	75 07		 jne	 SHORT $LN8@BlMmAlloca@2

; 403  : 
; 404  :         return FALSE;

  00131	32 c0		 xor	 al, al
  00133	e9 8e 01 00 00	 jmp	 $LN17@BlMmAlloca@2
$LN8@BlMmAlloca@2:

; 405  :     }
; 406  : 
; 407  :     if (Region->Type != BL_MM_PHYSICAL_REGION_FREE) {

  00138	8b 45 f4	 mov	 eax, DWORD PTR _Region$[ebp]
  0013b	83 78 20 01	 cmp	 DWORD PTR [eax+32], 1
  0013f	74 07		 je	 SHORT $LN7@BlMmAlloca@2

; 408  : 
; 409  :         return FALSE;

  00141	32 c0		 xor	 al, al
  00143	e9 7e 01 00 00	 jmp	 $LN17@BlMmAlloca@2
$LN7@BlMmAlloca@2:

; 410  :     }
; 411  : 
; 412  :     PreviousRegion = NULL;

  00148	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _PreviousRegion$[ebp], 0

; 413  :     NextRegion = NULL;

  0014f	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _NextRegion$[ebp], 0

; 414  : 
; 415  :     if (Region->Start < Start) {

  00156	8b 4d f4	 mov	 ecx, DWORD PTR _Region$[ebp]
  00159	89 4d b8	 mov	 DWORD PTR tv235[ebp], ecx
  0015c	8b 55 b8	 mov	 edx, DWORD PTR tv235[ebp]
  0015f	8b 42 0c	 mov	 eax, DWORD PTR [edx+12]
  00162	3b 45 fc	 cmp	 eax, DWORD PTR _Start$[ebp+4]
  00165	77 7d		 ja	 SHORT $LN6@BlMmAlloca@2
  00167	72 0b		 jb	 SHORT $LN22@BlMmAlloca@2
  00169	8b 4d b8	 mov	 ecx, DWORD PTR tv235[ebp]
  0016c	8b 51 08	 mov	 edx, DWORD PTR [ecx+8]
  0016f	3b 55 f8	 cmp	 edx, DWORD PTR _Start$[ebp]
  00172	73 70		 jae	 SHORT $LN6@BlMmAlloca@2
$LN22@BlMmAlloca@2:

; 416  : 
; 417  :         BLASSERT(BlRtlIsListEmpty(&BlMmPhysicalRegionLookaside.FreeList) == FALSE);

  00174	b9 80 02 00 00	 mov	 ecx, OFFSET ?BlMmPhysicalRegionLookaside@@3U<unnamed-tag>@@A+640
  00179	e8 00 00 00 00	 call	 ?BlRtlIsListEmpty@@YIEPAU_LIST_ENTRY@@@Z ; BlRtlIsListEmpty
  0017e	0f b6 c0	 movzx	 eax, al
  00181	85 c0		 test	 eax, eax
  00183	74 0f		 je	 SHORT $LN5@BlMmAlloca@2
  00185	ba a1 01 00 00	 mov	 edx, 417		; 000001a1H
  0018a	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  0018f	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN5@BlMmAlloca@2:

; 418  : 
; 419  :         PreviousRegion = CONTAINING_RECORD(BlRtlRemoveHeadList(&BlMmPhysicalRegionLookaside.FreeList),
; 420  :                                            BL_MM_PHYSICAL_REGION,
; 421  :                                            Entry);

  00194	b9 80 02 00 00	 mov	 ecx, OFFSET ?BlMmPhysicalRegionLookaside@@3U<unnamed-tag>@@A+640
  00199	e8 00 00 00 00	 call	 ?BlRtlRemoveHeadList@@YIPAU_LIST_ENTRY@@PAU1@@Z ; BlRtlRemoveHeadList
  0019e	89 45 f0	 mov	 DWORD PTR _PreviousRegion$[ebp], eax

; 422  : 
; 423  :         PreviousRegion->Start = Region->Start;

  001a1	8b 4d f0	 mov	 ecx, DWORD PTR _PreviousRegion$[ebp]
  001a4	8b 55 f4	 mov	 edx, DWORD PTR _Region$[ebp]
  001a7	8b 42 08	 mov	 eax, DWORD PTR [edx+8]
  001aa	89 41 08	 mov	 DWORD PTR [ecx+8], eax
  001ad	8b 52 0c	 mov	 edx, DWORD PTR [edx+12]
  001b0	89 51 0c	 mov	 DWORD PTR [ecx+12], edx

; 424  :         PreviousRegion->Size = Start - Region->Start;

  001b3	8b 45 f4	 mov	 eax, DWORD PTR _Region$[ebp]
  001b6	8b 4d f8	 mov	 ecx, DWORD PTR _Start$[ebp]
  001b9	2b 48 08	 sub	 ecx, DWORD PTR [eax+8]
  001bc	8b 55 fc	 mov	 edx, DWORD PTR _Start$[ebp+4]
  001bf	1b 50 0c	 sbb	 edx, DWORD PTR [eax+12]
  001c2	8b 45 f0	 mov	 eax, DWORD PTR _PreviousRegion$[ebp]
  001c5	89 48 10	 mov	 DWORD PTR [eax+16], ecx
  001c8	89 50 14	 mov	 DWORD PTR [eax+20], edx

; 425  :         PreviousRegion->Limit = Start;

  001cb	8b 4d f0	 mov	 ecx, DWORD PTR _PreviousRegion$[ebp]
  001ce	8b 55 f8	 mov	 edx, DWORD PTR _Start$[ebp]
  001d1	89 51 18	 mov	 DWORD PTR [ecx+24], edx
  001d4	8b 45 fc	 mov	 eax, DWORD PTR _Start$[ebp+4]
  001d7	89 41 1c	 mov	 DWORD PTR [ecx+28], eax

; 426  :         PreviousRegion->Type = BL_MM_PHYSICAL_REGION_FREE;

  001da	8b 4d f0	 mov	 ecx, DWORD PTR _PreviousRegion$[ebp]
  001dd	c7 41 20 01 00
	00 00		 mov	 DWORD PTR [ecx+32], 1
$LN6@BlMmAlloca@2:

; 427  :     }
; 428  : 
; 429  :     if (Region->Limit > End) {

  001e4	8b 55 f4	 mov	 edx, DWORD PTR _Region$[ebp]
  001e7	89 55 b4	 mov	 DWORD PTR tv265[ebp], edx
  001ea	8b 45 b4	 mov	 eax, DWORD PTR tv265[ebp]
  001ed	8b 48 1c	 mov	 ecx, DWORD PTR [eax+28]
  001f0	3b 4d dc	 cmp	 ecx, DWORD PTR _End$[ebp+4]
  001f3	72 7d		 jb	 SHORT $LN4@BlMmAlloca@2
  001f5	77 0b		 ja	 SHORT $LN23@BlMmAlloca@2
  001f7	8b 55 b4	 mov	 edx, DWORD PTR tv265[ebp]
  001fa	8b 42 18	 mov	 eax, DWORD PTR [edx+24]
  001fd	3b 45 d8	 cmp	 eax, DWORD PTR _End$[ebp]
  00200	76 70		 jbe	 SHORT $LN4@BlMmAlloca@2
$LN23@BlMmAlloca@2:

; 430  : 
; 431  :         BLASSERT(BlRtlIsListEmpty(&BlMmPhysicalRegionLookaside.FreeList) == FALSE);

  00202	b9 80 02 00 00	 mov	 ecx, OFFSET ?BlMmPhysicalRegionLookaside@@3U<unnamed-tag>@@A+640
  00207	e8 00 00 00 00	 call	 ?BlRtlIsListEmpty@@YIEPAU_LIST_ENTRY@@@Z ; BlRtlIsListEmpty
  0020c	0f b6 c8	 movzx	 ecx, al
  0020f	85 c9		 test	 ecx, ecx
  00211	74 0f		 je	 SHORT $LN3@BlMmAlloca@2
  00213	ba af 01 00 00	 mov	 edx, 431		; 000001afH
  00218	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  0021d	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN3@BlMmAlloca@2:

; 432  : 
; 433  :         NextRegion = CONTAINING_RECORD(BlRtlRemoveHeadList(&BlMmPhysicalRegionLookaside.FreeList),
; 434  :                                        BL_MM_PHYSICAL_REGION,
; 435  :                                        Entry);

  00222	b9 80 02 00 00	 mov	 ecx, OFFSET ?BlMmPhysicalRegionLookaside@@3U<unnamed-tag>@@A+640
  00227	e8 00 00 00 00	 call	 ?BlRtlRemoveHeadList@@YIPAU_LIST_ENTRY@@PAU1@@Z ; BlRtlRemoveHeadList
  0022c	89 45 e4	 mov	 DWORD PTR _NextRegion$[ebp], eax

; 436  : 
; 437  :         NextRegion->Start = End;

  0022f	8b 55 e4	 mov	 edx, DWORD PTR _NextRegion$[ebp]
  00232	8b 45 d8	 mov	 eax, DWORD PTR _End$[ebp]
  00235	89 42 08	 mov	 DWORD PTR [edx+8], eax
  00238	8b 4d dc	 mov	 ecx, DWORD PTR _End$[ebp+4]
  0023b	89 4a 0c	 mov	 DWORD PTR [edx+12], ecx

; 438  :         NextRegion->Size = Region->Limit - End;

  0023e	8b 55 f4	 mov	 edx, DWORD PTR _Region$[ebp]
  00241	8b 42 18	 mov	 eax, DWORD PTR [edx+24]
  00244	2b 45 d8	 sub	 eax, DWORD PTR _End$[ebp]
  00247	8b 4a 1c	 mov	 ecx, DWORD PTR [edx+28]
  0024a	1b 4d dc	 sbb	 ecx, DWORD PTR _End$[ebp+4]
  0024d	8b 55 e4	 mov	 edx, DWORD PTR _NextRegion$[ebp]
  00250	89 42 10	 mov	 DWORD PTR [edx+16], eax
  00253	89 4a 14	 mov	 DWORD PTR [edx+20], ecx

; 439  :         NextRegion->Limit = Region->Limit;

  00256	8b 45 e4	 mov	 eax, DWORD PTR _NextRegion$[ebp]
  00259	8b 4d f4	 mov	 ecx, DWORD PTR _Region$[ebp]
  0025c	8b 51 18	 mov	 edx, DWORD PTR [ecx+24]
  0025f	89 50 18	 mov	 DWORD PTR [eax+24], edx
  00262	8b 49 1c	 mov	 ecx, DWORD PTR [ecx+28]
  00265	89 48 1c	 mov	 DWORD PTR [eax+28], ecx

; 440  :         NextRegion->Type = BL_MM_PHYSICAL_REGION_FREE;

  00268	8b 55 e4	 mov	 edx, DWORD PTR _NextRegion$[ebp]
  0026b	c7 42 20 01 00
	00 00		 mov	 DWORD PTR [edx+32], 1
$LN4@BlMmAlloca@2:

; 441  :     }
; 442  : 
; 443  :     Region->Start = Start;

  00272	8b 45 f4	 mov	 eax, DWORD PTR _Region$[ebp]
  00275	8b 4d f8	 mov	 ecx, DWORD PTR _Start$[ebp]
  00278	89 48 08	 mov	 DWORD PTR [eax+8], ecx
  0027b	8b 55 fc	 mov	 edx, DWORD PTR _Start$[ebp+4]
  0027e	89 50 0c	 mov	 DWORD PTR [eax+12], edx

; 444  :     Region->Size = Size;

  00281	8b 45 f4	 mov	 eax, DWORD PTR _Region$[ebp]
  00284	8b 4d 10	 mov	 ecx, DWORD PTR _Size$[ebp]
  00287	89 48 10	 mov	 DWORD PTR [eax+16], ecx
  0028a	8b 55 14	 mov	 edx, DWORD PTR _Size$[ebp+4]
  0028d	89 50 14	 mov	 DWORD PTR [eax+20], edx

; 445  :     Region->Limit = End;

  00290	8b 45 f4	 mov	 eax, DWORD PTR _Region$[ebp]
  00293	8b 4d d8	 mov	 ecx, DWORD PTR _End$[ebp]
  00296	89 48 18	 mov	 DWORD PTR [eax+24], ecx
  00299	8b 55 dc	 mov	 edx, DWORD PTR _End$[ebp+4]
  0029c	89 50 1c	 mov	 DWORD PTR [eax+28], edx

; 446  :     Region->Type = Type;

  0029f	8b 45 f4	 mov	 eax, DWORD PTR _Region$[ebp]
  002a2	8b 4d d4	 mov	 ecx, DWORD PTR _Type$[ebp]
  002a5	89 48 20	 mov	 DWORD PTR [eax+32], ecx

; 447  : 
; 448  :     if (PreviousRegion != NULL) {

  002a8	83 7d f0 00	 cmp	 DWORD PTR _PreviousRegion$[ebp], 0
  002ac	74 08		 je	 SHORT $LN2@BlMmAlloca@2

; 449  : 
; 450  :         BlMmInsertPhysicalRegion(PreviousRegion);

  002ae	8b 4d f0	 mov	 ecx, DWORD PTR _PreviousRegion$[ebp]
  002b1	e8 00 00 00 00	 call	 ?BlMmInsertPhysicalRegion@@YIXPAU_BL_MM_PHYSICAL_REGION@@@Z ; BlMmInsertPhysicalRegion
$LN2@BlMmAlloca@2:

; 451  :     }
; 452  : 
; 453  :     if (NextRegion != NULL) {

  002b6	83 7d e4 00	 cmp	 DWORD PTR _NextRegion$[ebp], 0
  002ba	74 08		 je	 SHORT $LN1@BlMmAlloca@2

; 454  : 
; 455  :         BlMmInsertPhysicalRegion(NextRegion);

  002bc	8b 4d e4	 mov	 ecx, DWORD PTR _NextRegion$[ebp]
  002bf	e8 00 00 00 00	 call	 ?BlMmInsertPhysicalRegion@@YIXPAU_BL_MM_PHYSICAL_REGION@@@Z ; BlMmInsertPhysicalRegion
$LN1@BlMmAlloca@2:

; 456  :     }
; 457  : 
; 458  :     return TRUE;

  002c4	b0 01		 mov	 al, 1
$LN17@BlMmAlloca@2:

; 459  : }

  002c6	8b e5		 mov	 esp, ebp
  002c8	5d		 pop	 ebp
  002c9	c2 10 00	 ret	 16			; 00000010H
?BlMmAllocateSpecificPhysicalRegion@@YIE_K0K@Z ENDP	; BlMmAllocateSpecificPhysicalRegion
_TEXT	ENDS
PUBLIC	?BlMmFindFreePhysicalRegion@@YIEPA_K0@Z		; BlMmFindFreePhysicalRegion
; Function compile flags: /Odtp
;	COMDAT ?BlMmFindFreePhysicalRegion@@YIEPA_K0@Z
_TEXT	SEGMENT
_Size$ = -20						; size = 4
_Base$ = -16						; size = 4
_Entry$ = -12						; size = 4
_Head$ = -8						; size = 4
_Region$ = -4						; size = 4
?BlMmFindFreePhysicalRegion@@YIEPA_K0@Z PROC		; BlMmFindFreePhysicalRegion, COMDAT
; _Base$ = ecx
; _Size$ = edx

; 486  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 14	 sub	 esp, 20			; 00000014H
  00006	89 55 ec	 mov	 DWORD PTR _Size$[ebp], edx
  00009	89 4d f0	 mov	 DWORD PTR _Base$[ebp], ecx

; 487  :     PLIST_ENTRY Entry;
; 488  :     PLIST_ENTRY Head;
; 489  :     PBL_MM_PHYSICAL_REGION Region;
; 490  : 
; 491  :     Head = &BlMmPhysicalRegionList;

  0000c	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _Head$[ebp], OFFSET ?BlMmPhysicalRegionList@@3U_LIST_ENTRY@@A ; BlMmPhysicalRegionList

; 492  : 
; 493  :     for (Entry = Head->Flink; Entry != Head; Entry = Entry->Flink) {

  00013	8b 45 f8	 mov	 eax, DWORD PTR _Head$[ebp]
  00016	8b 08		 mov	 ecx, DWORD PTR [eax]
  00018	89 4d f4	 mov	 DWORD PTR _Entry$[ebp], ecx
  0001b	eb 08		 jmp	 SHORT $LN4@BlMmFindFr
$LN3@BlMmFindFr:
  0001d	8b 55 f4	 mov	 edx, DWORD PTR _Entry$[ebp]
  00020	8b 02		 mov	 eax, DWORD PTR [edx]
  00022	89 45 f4	 mov	 DWORD PTR _Entry$[ebp], eax
$LN4@BlMmFindFr:
  00025	8b 4d f4	 mov	 ecx, DWORD PTR _Entry$[ebp]
  00028	3b 4d f8	 cmp	 ecx, DWORD PTR _Head$[ebp]
  0002b	74 37		 je	 SHORT $LN2@BlMmFindFr

; 494  : 
; 495  :         Region = CONTAINING_RECORD(Entry,
; 496  :                                    BL_MM_PHYSICAL_REGION,
; 497  :                                    Entry);

  0002d	8b 55 f4	 mov	 edx, DWORD PTR _Entry$[ebp]
  00030	89 55 fc	 mov	 DWORD PTR _Region$[ebp], edx

; 498  : 
; 499  :         if (Region->Type == BL_MM_PHYSICAL_REGION_FREE) {

  00033	8b 45 fc	 mov	 eax, DWORD PTR _Region$[ebp]
  00036	83 78 20 01	 cmp	 DWORD PTR [eax+32], 1
  0003a	75 26		 jne	 SHORT $LN1@BlMmFindFr

; 500  : 
; 501  :             *Base = Region->Start;

  0003c	8b 4d f0	 mov	 ecx, DWORD PTR _Base$[ebp]
  0003f	8b 55 fc	 mov	 edx, DWORD PTR _Region$[ebp]
  00042	8b 42 08	 mov	 eax, DWORD PTR [edx+8]
  00045	89 01		 mov	 DWORD PTR [ecx], eax
  00047	8b 52 0c	 mov	 edx, DWORD PTR [edx+12]
  0004a	89 51 04	 mov	 DWORD PTR [ecx+4], edx

; 502  :             *Size = Region->Size;

  0004d	8b 45 ec	 mov	 eax, DWORD PTR _Size$[ebp]
  00050	8b 4d fc	 mov	 ecx, DWORD PTR _Region$[ebp]
  00053	8b 51 10	 mov	 edx, DWORD PTR [ecx+16]
  00056	89 10		 mov	 DWORD PTR [eax], edx
  00058	8b 49 14	 mov	 ecx, DWORD PTR [ecx+20]
  0005b	89 48 04	 mov	 DWORD PTR [eax+4], ecx

; 503  :             return TRUE;

  0005e	b0 01		 mov	 al, 1
  00060	eb 04		 jmp	 SHORT $LN5@BlMmFindFr
$LN1@BlMmFindFr:

; 504  :         }
; 505  :     }

  00062	eb b9		 jmp	 SHORT $LN3@BlMmFindFr
$LN2@BlMmFindFr:

; 506  : 
; 507  :     return FALSE;

  00064	32 c0		 xor	 al, al
$LN5@BlMmFindFr:

; 508  : }

  00066	8b e5		 mov	 esp, ebp
  00068	5d		 pop	 ebp
  00069	c3		 ret	 0
?BlMmFindFreePhysicalRegion@@YIEPA_K0@Z ENDP		; BlMmFindFreePhysicalRegion
_TEXT	ENDS
PUBLIC	?BlMmGetNextPhysicalRegion@@YIEPAPAXPA_K1PAK@Z	; BlMmGetNextPhysicalRegion
; Function compile flags: /Odtp
;	COMDAT ?BlMmGetNextPhysicalRegion@@YIEPAPAXPA_K1PAK@Z
_TEXT	SEGMENT
_Base$ = -20						; size = 4
_Handle$ = -16						; size = 4
_Entry$ = -12						; size = 4
_Head$ = -8						; size = 4
_Region$ = -4						; size = 4
_Size$ = 8						; size = 4
_Type$ = 12						; size = 4
?BlMmGetNextPhysicalRegion@@YIEPAPAXPA_K1PAK@Z PROC	; BlMmGetNextPhysicalRegion, COMDAT
; _Handle$ = ecx
; _Base$ = edx

; 543  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 14	 sub	 esp, 20			; 00000014H
  00006	89 55 ec	 mov	 DWORD PTR _Base$[ebp], edx
  00009	89 4d f0	 mov	 DWORD PTR _Handle$[ebp], ecx

; 544  :     PLIST_ENTRY Entry;
; 545  :     PLIST_ENTRY Head;
; 546  :     PBL_MM_PHYSICAL_REGION Region;
; 547  : 
; 548  :     Head = &BlMmPhysicalRegionList;

  0000c	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _Head$[ebp], OFFSET ?BlMmPhysicalRegionList@@3U_LIST_ENTRY@@A ; BlMmPhysicalRegionList

; 549  : 
; 550  :     if (*Handle == NULL) {

  00013	8b 45 f0	 mov	 eax, DWORD PTR _Handle$[ebp]
  00016	83 38 00	 cmp	 DWORD PTR [eax], 0
  00019	75 08		 jne	 SHORT $LN3@BlMmGetNex

; 551  : 
; 552  :         Entry = Head;

  0001b	8b 4d f8	 mov	 ecx, DWORD PTR _Head$[ebp]
  0001e	89 4d f4	 mov	 DWORD PTR _Entry$[ebp], ecx

; 553  : 
; 554  :     } else {

  00021	eb 08		 jmp	 SHORT $LN2@BlMmGetNex
$LN3@BlMmGetNex:

; 555  : 
; 556  :         Entry = (PLIST_ENTRY) *Handle;

  00023	8b 55 f0	 mov	 edx, DWORD PTR _Handle$[ebp]
  00026	8b 02		 mov	 eax, DWORD PTR [edx]
  00028	89 45 f4	 mov	 DWORD PTR _Entry$[ebp], eax
$LN2@BlMmGetNex:

; 557  :     }
; 558  : 
; 559  :     Entry = Entry->Flink;

  0002b	8b 4d f4	 mov	 ecx, DWORD PTR _Entry$[ebp]
  0002e	8b 11		 mov	 edx, DWORD PTR [ecx]
  00030	89 55 f4	 mov	 DWORD PTR _Entry$[ebp], edx

; 560  : 
; 561  :     if (Entry == Head) {

  00033	8b 45 f4	 mov	 eax, DWORD PTR _Entry$[ebp]
  00036	3b 45 f8	 cmp	 eax, DWORD PTR _Head$[ebp]
  00039	75 04		 jne	 SHORT $LN1@BlMmGetNex

; 562  : 
; 563  :         return FALSE;

  0003b	32 c0		 xor	 al, al
  0003d	eb 3d		 jmp	 SHORT $LN4@BlMmGetNex
$LN1@BlMmGetNex:

; 564  :     }
; 565  : 
; 566  :     Region = CONTAINING_RECORD(Entry,
; 567  :                                BL_MM_PHYSICAL_REGION,
; 568  :                                Entry);

  0003f	8b 4d f4	 mov	 ecx, DWORD PTR _Entry$[ebp]
  00042	89 4d fc	 mov	 DWORD PTR _Region$[ebp], ecx

; 569  : 
; 570  :     *Handle = &Region->Entry;

  00045	8b 55 f0	 mov	 edx, DWORD PTR _Handle$[ebp]
  00048	8b 45 fc	 mov	 eax, DWORD PTR _Region$[ebp]
  0004b	89 02		 mov	 DWORD PTR [edx], eax

; 571  :     *Base = Region->Start;

  0004d	8b 4d ec	 mov	 ecx, DWORD PTR _Base$[ebp]
  00050	8b 55 fc	 mov	 edx, DWORD PTR _Region$[ebp]
  00053	8b 42 08	 mov	 eax, DWORD PTR [edx+8]
  00056	89 01		 mov	 DWORD PTR [ecx], eax
  00058	8b 52 0c	 mov	 edx, DWORD PTR [edx+12]
  0005b	89 51 04	 mov	 DWORD PTR [ecx+4], edx

; 572  :     *Size = Region->Size;

  0005e	8b 45 08	 mov	 eax, DWORD PTR _Size$[ebp]
  00061	8b 4d fc	 mov	 ecx, DWORD PTR _Region$[ebp]
  00064	8b 51 10	 mov	 edx, DWORD PTR [ecx+16]
  00067	89 10		 mov	 DWORD PTR [eax], edx
  00069	8b 49 14	 mov	 ecx, DWORD PTR [ecx+20]
  0006c	89 48 04	 mov	 DWORD PTR [eax+4], ecx

; 573  :     *Type = Region->Type;

  0006f	8b 55 0c	 mov	 edx, DWORD PTR _Type$[ebp]
  00072	8b 45 fc	 mov	 eax, DWORD PTR _Region$[ebp]
  00075	8b 48 20	 mov	 ecx, DWORD PTR [eax+32]
  00078	89 0a		 mov	 DWORD PTR [edx], ecx

; 574  : 
; 575  :     return TRUE;

  0007a	b0 01		 mov	 al, 1
$LN4@BlMmGetNex:

; 576  : }

  0007c	8b e5		 mov	 esp, ebp
  0007e	5d		 pop	 ebp
  0007f	c2 08 00	 ret	 8
?BlMmGetNextPhysicalRegion@@YIEPAPAXPA_K1PAK@Z ENDP	; BlMmGetNextPhysicalRegion
_TEXT	ENDS
PUBLIC	??_C@_0BB@GBGJFAGF@SINGULARITY_SMAP?$AA@	; `string'
PUBLIC	??_C@_0L@HFEHJDPJ@BOOT_STACK?$AA@		; `string'
PUBLIC	??_C@_0M@KGCABPNA@SINGULARITY?$AA@		; `string'
PUBLIC	??_C@_04KKJBFIJG@TASK?$AA@			; `string'
PUBLIC	??_C@_07GHPPKNEI@CONTEXT?$AA@			; `string'
PUBLIC	??_C@_0N@JIHEIFIK@KERNEL_STACK?$AA@		; `string'
PUBLIC	??_C@_08HALIBMIK@LOG_TEXT?$AA@			; `string'
PUBLIC	??_C@_0L@NNLIGPNO@LOG_RECORD?$AA@		; `string'
PUBLIC	??_C@_0BB@MBLMFHLL@NATIVE_PROCESSOR?$AA@	; `string'
PUBLIC	??_C@_0BA@BBGJNAMD@NATIVE_PLATFORM?$AA@		; `string'
PUBLIC	??_C@_0N@MOEDNENG@KERNEL_IMAGE?$AA@		; `string'
PUBLIC	??_C@_06NJIFKOLF@DISTRO?$AA@			; `string'
PUBLIC	??_C@_0O@CKGIKGKG@SMAP_RESERVED?$AA@		; `string'
PUBLIC	??_C@_0M@CDFHDJDB@BOOT_LOADER?$AA@		; `string'
PUBLIC	??_C@_04BHKCNABG@BIOS?$AA@			; `string'
PUBLIC	??_C@_04HEDFJGEJ@FREE?$AA@			; `string'
PUBLIC	?BlMmPhysicalRegionTypeString@@YIPADK@Z		; BlMmPhysicalRegionTypeString
;	COMDAT ??_C@_0BB@GBGJFAGF@SINGULARITY_SMAP?$AA@
CONST	SEGMENT
??_C@_0BB@GBGJFAGF@SINGULARITY_SMAP?$AA@ DB 'SINGULARITY_SMAP', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0L@HFEHJDPJ@BOOT_STACK?$AA@
CONST	SEGMENT
??_C@_0L@HFEHJDPJ@BOOT_STACK?$AA@ DB 'BOOT_STACK', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0M@KGCABPNA@SINGULARITY?$AA@
CONST	SEGMENT
??_C@_0M@KGCABPNA@SINGULARITY?$AA@ DB 'SINGULARITY', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_04KKJBFIJG@TASK?$AA@
CONST	SEGMENT
??_C@_04KKJBFIJG@TASK?$AA@ DB 'TASK', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_07GHPPKNEI@CONTEXT?$AA@
CONST	SEGMENT
??_C@_07GHPPKNEI@CONTEXT?$AA@ DB 'CONTEXT', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0N@JIHEIFIK@KERNEL_STACK?$AA@
CONST	SEGMENT
??_C@_0N@JIHEIFIK@KERNEL_STACK?$AA@ DB 'KERNEL_STACK', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_08HALIBMIK@LOG_TEXT?$AA@
CONST	SEGMENT
??_C@_08HALIBMIK@LOG_TEXT?$AA@ DB 'LOG_TEXT', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0L@NNLIGPNO@LOG_RECORD?$AA@
CONST	SEGMENT
??_C@_0L@NNLIGPNO@LOG_RECORD?$AA@ DB 'LOG_RECORD', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0BB@MBLMFHLL@NATIVE_PROCESSOR?$AA@
CONST	SEGMENT
??_C@_0BB@MBLMFHLL@NATIVE_PROCESSOR?$AA@ DB 'NATIVE_PROCESSOR', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BA@BBGJNAMD@NATIVE_PLATFORM?$AA@
CONST	SEGMENT
??_C@_0BA@BBGJNAMD@NATIVE_PLATFORM?$AA@ DB 'NATIVE_PLATFORM', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0N@MOEDNENG@KERNEL_IMAGE?$AA@
CONST	SEGMENT
??_C@_0N@MOEDNENG@KERNEL_IMAGE?$AA@ DB 'KERNEL_IMAGE', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_06NJIFKOLF@DISTRO?$AA@
CONST	SEGMENT
??_C@_06NJIFKOLF@DISTRO?$AA@ DB 'DISTRO', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0O@CKGIKGKG@SMAP_RESERVED?$AA@
CONST	SEGMENT
??_C@_0O@CKGIKGKG@SMAP_RESERVED?$AA@ DB 'SMAP_RESERVED', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0M@CDFHDJDB@BOOT_LOADER?$AA@
CONST	SEGMENT
??_C@_0M@CDFHDJDB@BOOT_LOADER?$AA@ DB 'BOOT_LOADER', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_04BHKCNABG@BIOS?$AA@
CONST	SEGMENT
??_C@_04BHKCNABG@BIOS?$AA@ DB 'BIOS', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_04HEDFJGEJ@FREE?$AA@
CONST	SEGMENT
??_C@_04HEDFJGEJ@FREE?$AA@ DB 'FREE', 00H		; `string'
; Function compile flags: /Odtp
CONST	ENDS
;	COMDAT ?BlMmPhysicalRegionTypeString@@YIPADK@Z
_TEXT	SEGMENT
tv64 = -8						; size = 4
_Type$ = -4						; size = 4
?BlMmPhysicalRegionTypeString@@YIPADK@Z PROC		; BlMmPhysicalRegionTypeString, COMDAT
; _Type$ = ecx

; 599  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8
  00006	89 4d fc	 mov	 DWORD PTR _Type$[ebp], ecx

; 600  : 
; 601  : #define CASE(X) case BL_MM_PHYSICAL_REGION_##X: return #X;
; 602  : 
; 603  :     switch (Type) {

  00009	8b 45 fc	 mov	 eax, DWORD PTR _Type$[ebp]
  0000c	89 45 f8	 mov	 DWORD PTR tv64[ebp], eax
  0000f	8b 4d f8	 mov	 ecx, DWORD PTR tv64[ebp]
  00012	83 e9 01	 sub	 ecx, 1
  00015	89 4d f8	 mov	 DWORD PTR tv64[ebp], ecx
  00018	83 7d f8 0f	 cmp	 DWORD PTR tv64[ebp], 15	; 0000000fH
  0001c	77 7d		 ja	 SHORT $LN18@BlMmPhysic
  0001e	8b 55 f8	 mov	 edx, DWORD PTR tv64[ebp]
  00021	ff 24 95 00 00
	00 00		 jmp	 DWORD PTR $LN22@BlMmPhysic[edx*4]
$LN17@BlMmPhysic:

; 604  : 
; 605  :         CASE(FREE)

  00028	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_04HEDFJGEJ@FREE?$AA@
  0002d	e9 83 00 00 00	 jmp	 $LN20@BlMmPhysic
$LN16@BlMmPhysic:

; 606  :         CASE(BIOS)

  00032	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_04BHKCNABG@BIOS?$AA@
  00037	eb 7c		 jmp	 SHORT $LN20@BlMmPhysic
$LN15@BlMmPhysic:

; 607  :         CASE(BOOT_LOADER)

  00039	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_0M@CDFHDJDB@BOOT_LOADER?$AA@
  0003e	eb 75		 jmp	 SHORT $LN20@BlMmPhysic
$LN14@BlMmPhysic:

; 608  :         CASE(SMAP_RESERVED)

  00040	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_0O@CKGIKGKG@SMAP_RESERVED?$AA@
  00045	eb 6e		 jmp	 SHORT $LN20@BlMmPhysic
$LN13@BlMmPhysic:

; 609  :         CASE(DISTRO)

  00047	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_06NJIFKOLF@DISTRO?$AA@
  0004c	eb 67		 jmp	 SHORT $LN20@BlMmPhysic
$LN12@BlMmPhysic:

; 610  :         CASE(KERNEL_IMAGE)

  0004e	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_0N@MOEDNENG@KERNEL_IMAGE?$AA@
  00053	eb 60		 jmp	 SHORT $LN20@BlMmPhysic
$LN11@BlMmPhysic:

; 611  :         CASE(NATIVE_PLATFORM)

  00055	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_0BA@BBGJNAMD@NATIVE_PLATFORM?$AA@
  0005a	eb 59		 jmp	 SHORT $LN20@BlMmPhysic
$LN10@BlMmPhysic:

; 612  :         CASE(NATIVE_PROCESSOR)

  0005c	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_0BB@MBLMFHLL@NATIVE_PROCESSOR?$AA@
  00061	eb 52		 jmp	 SHORT $LN20@BlMmPhysic
$LN9@BlMmPhysic:

; 613  :         CASE(LOG_RECORD)

  00063	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_0L@NNLIGPNO@LOG_RECORD?$AA@
  00068	eb 4b		 jmp	 SHORT $LN20@BlMmPhysic
$LN8@BlMmPhysic:

; 614  :         CASE(LOG_TEXT)

  0006a	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_08HALIBMIK@LOG_TEXT?$AA@
  0006f	eb 44		 jmp	 SHORT $LN20@BlMmPhysic
$LN7@BlMmPhysic:

; 615  :         CASE(KERNEL_STACK)

  00071	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_0N@JIHEIFIK@KERNEL_STACK?$AA@
  00076	eb 3d		 jmp	 SHORT $LN20@BlMmPhysic
$LN6@BlMmPhysic:

; 616  :         CASE(CONTEXT)

  00078	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_07GHPPKNEI@CONTEXT?$AA@
  0007d	eb 36		 jmp	 SHORT $LN20@BlMmPhysic
$LN5@BlMmPhysic:

; 617  :         CASE(TASK)

  0007f	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_04KKJBFIJG@TASK?$AA@
  00084	eb 2f		 jmp	 SHORT $LN20@BlMmPhysic
$LN4@BlMmPhysic:

; 618  :         CASE(SINGULARITY)

  00086	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_0M@KGCABPNA@SINGULARITY?$AA@
  0008b	eb 28		 jmp	 SHORT $LN20@BlMmPhysic
$LN3@BlMmPhysic:

; 619  :         CASE(BOOT_STACK)

  0008d	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_0L@HFEHJDPJ@BOOT_STACK?$AA@
  00092	eb 21		 jmp	 SHORT $LN20@BlMmPhysic
$LN2@BlMmPhysic:

; 620  :         CASE(SINGULARITY_SMAP)

  00094	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_0BB@GBGJFAGF@SINGULARITY_SMAP?$AA@
  00099	eb 1a		 jmp	 SHORT $LN20@BlMmPhysic
$LN18@BlMmPhysic:

; 621  :     }
; 622  : 
; 623  : #undef CASE
; 624  : 
; 625  :     BLASSERT(FALSE);

  0009b	b8 01 00 00 00	 mov	 eax, 1
  000a0	85 c0		 test	 eax, eax
  000a2	74 0f		 je	 SHORT $LN1@BlMmPhysic
  000a4	ba 71 02 00 00	 mov	 edx, 625		; 00000271H
  000a9	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  000ae	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN1@BlMmPhysic:

; 626  :     return NULL;

  000b3	33 c0		 xor	 eax, eax
$LN20@BlMmPhysic:

; 627  : }

  000b5	8b e5		 mov	 esp, ebp
  000b7	5d		 pop	 ebp
  000b8	c3		 ret	 0
  000b9	8d 49 00	 npad	 3
$LN22@BlMmPhysic:
  000bc	00 00 00 00	 DD	 $LN17@BlMmPhysic
  000c0	00 00 00 00	 DD	 $LN16@BlMmPhysic
  000c4	00 00 00 00	 DD	 $LN15@BlMmPhysic
  000c8	00 00 00 00	 DD	 $LN14@BlMmPhysic
  000cc	00 00 00 00	 DD	 $LN13@BlMmPhysic
  000d0	00 00 00 00	 DD	 $LN12@BlMmPhysic
  000d4	00 00 00 00	 DD	 $LN11@BlMmPhysic
  000d8	00 00 00 00	 DD	 $LN10@BlMmPhysic
  000dc	00 00 00 00	 DD	 $LN9@BlMmPhysic
  000e0	00 00 00 00	 DD	 $LN8@BlMmPhysic
  000e4	00 00 00 00	 DD	 $LN7@BlMmPhysic
  000e8	00 00 00 00	 DD	 $LN6@BlMmPhysic
  000ec	00 00 00 00	 DD	 $LN5@BlMmPhysic
  000f0	00 00 00 00	 DD	 $LN4@BlMmPhysic
  000f4	00 00 00 00	 DD	 $LN3@BlMmPhysic
  000f8	00 00 00 00	 DD	 $LN2@BlMmPhysic
?BlMmPhysicalRegionTypeString@@YIPADK@Z ENDP		; BlMmPhysicalRegionTypeString
_TEXT	ENDS
PUBLIC	??_C@_01EEMJAFIK@?6?$AA@			; `string'
PUBLIC	??_C@_0BO@NKCHPHGB@MM?3?5?5?5?$CF016I64x?4?4?4?$CF016I64x?5?$CFs?6?$AA@ ; `string'
PUBLIC	??_C@_0BG@CNDFIJED@MM?3?5Physical?5Region?3?6?$AA@ ; `string'
PUBLIC	?BlMmDumpPhysicalRegionList@@YIXXZ		; BlMmDumpPhysicalRegionList
;	COMDAT ??_C@_01EEMJAFIK@?6?$AA@
CONST	SEGMENT
??_C@_01EEMJAFIK@?6?$AA@ DB 0aH, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0BO@NKCHPHGB@MM?3?5?5?5?$CF016I64x?4?4?4?$CF016I64x?5?$CFs?6?$AA@
CONST	SEGMENT
??_C@_0BO@NKCHPHGB@MM?3?5?5?5?$CF016I64x?4?4?4?$CF016I64x?5?$CFs?6?$AA@ DB 'M'
	DB	'M:   %016I64x...%016I64x %s', 0aH, 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0BG@CNDFIJED@MM?3?5Physical?5Region?3?6?$AA@
CONST	SEGMENT
??_C@_0BG@CNDFIJED@MM?3?5Physical?5Region?3?6?$AA@ DB 'MM: Physical Regio'
	DB	'n:', 0aH, 00H				; `string'
; Function compile flags: /Odtp
CONST	ENDS
;	COMDAT ?BlMmDumpPhysicalRegionList@@YIXXZ
_TEXT	SEGMENT
_Entry$ = -12						; size = 4
_Head$ = -8						; size = 4
_Region$ = -4						; size = 4
?BlMmDumpPhysicalRegionList@@YIXXZ PROC			; BlMmDumpPhysicalRegionList, COMDAT

; 642  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 0c	 sub	 esp, 12			; 0000000cH

; 643  :     PLIST_ENTRY Entry;
; 644  :     PLIST_ENTRY Head;
; 645  :     PBL_MM_PHYSICAL_REGION Region;
; 646  : 
; 647  :     BlRtlPrintf("MM: Physical Region:\n");

  00006	68 00 00 00 00	 push	 OFFSET ??_C@_0BG@CNDFIJED@MM?3?5Physical?5Region?3?6?$AA@
  0000b	e8 00 00 00 00	 call	 ?BlRtlPrintf@@YAEPBDZZ	; BlRtlPrintf
  00010	83 c4 04	 add	 esp, 4

; 648  : 
; 649  :     Head = &BlMmPhysicalRegionList;

  00013	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _Head$[ebp], OFFSET ?BlMmPhysicalRegionList@@3U_LIST_ENTRY@@A ; BlMmPhysicalRegionList

; 650  : 
; 651  :     for (Entry = Head->Flink; Entry != Head; Entry = Entry->Flink) {

  0001a	8b 45 f8	 mov	 eax, DWORD PTR _Head$[ebp]
  0001d	8b 08		 mov	 ecx, DWORD PTR [eax]
  0001f	89 4d f4	 mov	 DWORD PTR _Entry$[ebp], ecx
  00022	eb 08		 jmp	 SHORT $LN3@BlMmDumpPh
$LN2@BlMmDumpPh:
  00024	8b 55 f4	 mov	 edx, DWORD PTR _Entry$[ebp]
  00027	8b 02		 mov	 eax, DWORD PTR [edx]
  00029	89 45 f4	 mov	 DWORD PTR _Entry$[ebp], eax
$LN3@BlMmDumpPh:
  0002c	8b 4d f4	 mov	 ecx, DWORD PTR _Entry$[ebp]
  0002f	3b 4d f8	 cmp	 ecx, DWORD PTR _Head$[ebp]
  00032	74 37		 je	 SHORT $LN1@BlMmDumpPh

; 652  : 
; 653  :         Region = CONTAINING_RECORD(Entry, BL_MM_PHYSICAL_REGION, Entry);

  00034	8b 55 f4	 mov	 edx, DWORD PTR _Entry$[ebp]
  00037	89 55 fc	 mov	 DWORD PTR _Region$[ebp], edx

; 654  : 
; 655  :         BlRtlPrintf("MM:   %016I64x...%016I64x %s\n",
; 656  :                     Region->Start,
; 657  :                     Region->Limit,
; 658  :                     BlMmPhysicalRegionTypeString(Region->Type));

  0003a	8b 45 fc	 mov	 eax, DWORD PTR _Region$[ebp]
  0003d	8b 48 20	 mov	 ecx, DWORD PTR [eax+32]
  00040	e8 00 00 00 00	 call	 ?BlMmPhysicalRegionTypeString@@YIPADK@Z ; BlMmPhysicalRegionTypeString
  00045	50		 push	 eax
  00046	8b 4d fc	 mov	 ecx, DWORD PTR _Region$[ebp]
  00049	8b 51 1c	 mov	 edx, DWORD PTR [ecx+28]
  0004c	52		 push	 edx
  0004d	8b 41 18	 mov	 eax, DWORD PTR [ecx+24]
  00050	50		 push	 eax
  00051	8b 4d fc	 mov	 ecx, DWORD PTR _Region$[ebp]
  00054	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  00057	52		 push	 edx
  00058	8b 41 08	 mov	 eax, DWORD PTR [ecx+8]
  0005b	50		 push	 eax
  0005c	68 00 00 00 00	 push	 OFFSET ??_C@_0BO@NKCHPHGB@MM?3?5?5?5?$CF016I64x?4?4?4?$CF016I64x?5?$CFs?6?$AA@
  00061	e8 00 00 00 00	 call	 ?BlRtlPrintf@@YAEPBDZZ	; BlRtlPrintf
  00066	83 c4 18	 add	 esp, 24			; 00000018H

; 659  :     }

  00069	eb b9		 jmp	 SHORT $LN2@BlMmDumpPh
$LN1@BlMmDumpPh:

; 660  : 
; 661  :     BlRtlPrintf("\n");

  0006b	68 00 00 00 00	 push	 OFFSET ??_C@_01EEMJAFIK@?6?$AA@
  00070	e8 00 00 00 00	 call	 ?BlRtlPrintf@@YAEPBDZZ	; BlRtlPrintf
  00075	83 c4 04	 add	 esp, 4

; 662  : 
; 663  :     return;
; 664  : }

  00078	8b e5		 mov	 esp, ebp
  0007a	5d		 pop	 ebp
  0007b	c3		 ret	 0
?BlMmDumpPhysicalRegionList@@YIXXZ ENDP			; BlMmDumpPhysicalRegionList
_TEXT	ENDS
PUBLIC	?BlGetBeb@@YIPAU_BEB@@XZ			; BlGetBeb
PUBLIC	?BlMmInitializePageTables@@YIXXZ		; BlMmInitializePageTables
EXTRN	?BlMmSetCr3@@YIXK@Z:PROC			; BlMmSetCr3
EXTRN	__allshl:PROC
EXTRN	__allmul:PROC
; Function compile flags: /Odtp
;	COMDAT ?BlMmInitializePageTables@@YIXXZ
_TEXT	SEGMENT
_Pte$ = -44						; size = 4
_PtBase$ = -40						; size = 8
_Pdpe$ = -32						; size = 4
_Pde$ = -28						; size = 4
_PdptBase$ = -24					; size = 8
_Index$ = -16						; size = 8
_PdtBase$ = -8						; size = 8
?BlMmInitializePageTables@@YIXXZ PROC			; BlMmInitializePageTables, COMDAT

; 683  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 2c	 sub	 esp, 44			; 0000002cH
  00006	56		 push	 esi
  00007	57		 push	 edi

; 684  :     UINT64 Index;
; 685  :     UINT64 *Pde;
; 686  :     UINT64 PdtBase;
; 687  :     UINT64 *Pdpe;
; 688  :     UINT64 PdptBase;
; 689  : 
; 690  : #if defined(BOOT_X64)
; 691  : 
; 692  :     UINT64 *Pml4e;
; 693  :     UINT64 Pml4tBase;
; 694  : 
; 695  : #endif
; 696  : 
; 697  :     UINT64 *Pte;
; 698  :     UINT64 PtBase;
; 699  : 
; 700  : #if defined(BOOT_X64)
; 701  : 
; 702  :     Pml4tBase = (UINT64) (ULONG_PTR) BlMmPml4Table;
; 703  : 
; 704  : #endif
; 705  : 
; 706  :     PdptBase = (UINT64) (ULONG_PTR) BlMmPdpTable;

  00008	b8 00 00 00 00	 mov	 eax, OFFSET ?BlMmPdpTable@@3PAU_BL_MM_PAGE_TABLE@@A ; BlMmPdpTable
  0000d	33 c9		 xor	 ecx, ecx
  0000f	89 45 e8	 mov	 DWORD PTR _PdptBase$[ebp], eax
  00012	89 4d ec	 mov	 DWORD PTR _PdptBase$[ebp+4], ecx

; 707  :     PdtBase = (UINT64) (ULONG_PTR) BlMmPdTable;

  00015	ba 00 00 00 00	 mov	 edx, OFFSET ?BlMmPdTable@@3PAU_BL_MM_PAGE_TABLE@@A ; BlMmPdTable
  0001a	33 c0		 xor	 eax, eax
  0001c	89 55 f8	 mov	 DWORD PTR _PdtBase$[ebp], edx
  0001f	89 45 fc	 mov	 DWORD PTR _PdtBase$[ebp+4], eax

; 708  :     PtBase = (UINT64) (ULONG_PTR) BlMmPgTable;

  00022	b9 00 00 00 00	 mov	 ecx, OFFSET ?BlMmPgTable@@3PAU_BL_MM_PAGE_TABLE@@A ; BlMmPgTable
  00027	33 d2		 xor	 edx, edx
  00029	89 4d d8	 mov	 DWORD PTR _PtBase$[ebp], ecx
  0002c	89 55 dc	 mov	 DWORD PTR _PtBase$[ebp+4], edx

; 709  : 
; 710  : #if defined(BOOT_X64)
; 711  : 
; 712  :     Pml4e = (UINT64 *) (PVOID) Pml4tBase;
; 713  : 
; 714  : #endif
; 715  : 
; 716  :     Pdpe = (UINT64 *) (PVOID) (ULONG_PTR) PdptBase;

  0002f	8b 45 e8	 mov	 eax, DWORD PTR _PdptBase$[ebp]
  00032	89 45 e0	 mov	 DWORD PTR _Pdpe$[ebp], eax

; 717  :     Pde = (UINT64 *) (PVOID) (ULONG_PTR) PdtBase;

  00035	8b 4d f8	 mov	 ecx, DWORD PTR _PdtBase$[ebp]
  00038	89 4d e4	 mov	 DWORD PTR _Pde$[ebp], ecx

; 718  :     Pte = (UINT64 *) (PVOID) (ULONG_PTR) PtBase;

  0003b	8b 55 d8	 mov	 edx, DWORD PTR _PtBase$[ebp]
  0003e	89 55 d4	 mov	 DWORD PTR _Pte$[ebp], edx

; 719  : 
; 720  : #if defined(BOOT_X64)
; 721  : 
; 722  :     Pml4e[0] = PdptBase | PAGE_PRESENT | PAGE_WRITEABLE | PAGE_ACCESSED;
; 723  : 
; 724  : #endif
; 725  : 
; 726  :     for (Index = 0; Index < 4; Index += 1) {

  00041	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _Index$[ebp], 0
  00048	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _Index$[ebp+4], 0
  0004f	eb 12		 jmp	 SHORT $LN9@BlMmInitia
$LN8@BlMmInitia:
  00051	8b 45 f0	 mov	 eax, DWORD PTR _Index$[ebp]
  00054	83 c0 01	 add	 eax, 1
  00057	8b 4d f4	 mov	 ecx, DWORD PTR _Index$[ebp+4]
  0005a	83 d1 00	 adc	 ecx, 0
  0005d	89 45 f0	 mov	 DWORD PTR _Index$[ebp], eax
  00060	89 4d f4	 mov	 DWORD PTR _Index$[ebp+4], ecx
$LN9@BlMmInitia:
  00063	83 7d f4 00	 cmp	 DWORD PTR _Index$[ebp+4], 0
  00067	77 46		 ja	 SHORT $LN7@BlMmInitia
  00069	72 06		 jb	 SHORT $LN12@BlMmInitia
  0006b	83 7d f0 04	 cmp	 DWORD PTR _Index$[ebp], 4
  0006f	73 3e		 jae	 SHORT $LN7@BlMmInitia
$LN12@BlMmInitia:

; 727  : 
; 728  :         Pdpe[Index] = (PdtBase + (Index * PAGE_SIZE)) | PAGE_PRESENT;

  00071	6a 00		 push	 0
  00073	68 00 10 00 00	 push	 4096			; 00001000H
  00078	8b 55 f4	 mov	 edx, DWORD PTR _Index$[ebp+4]
  0007b	52		 push	 edx
  0007c	8b 45 f0	 mov	 eax, DWORD PTR _Index$[ebp]
  0007f	50		 push	 eax
  00080	e8 00 00 00 00	 call	 __allmul
  00085	8b f0		 mov	 esi, eax
  00087	03 75 f8	 add	 esi, DWORD PTR _PdtBase$[ebp]
  0008a	8b 7d fc	 mov	 edi, DWORD PTR _PdtBase$[ebp+4]
  0008d	13 fa		 adc	 edi, edx
  0008f	83 ce 01	 or	 esi, 1
  00092	6a 00		 push	 0
  00094	6a 08		 push	 8
  00096	8b 4d f4	 mov	 ecx, DWORD PTR _Index$[ebp+4]
  00099	51		 push	 ecx
  0009a	8b 55 f0	 mov	 edx, DWORD PTR _Index$[ebp]
  0009d	52		 push	 edx
  0009e	e8 00 00 00 00	 call	 __allmul
  000a3	8b 4d e0	 mov	 ecx, DWORD PTR _Pdpe$[ebp]
  000a6	89 34 01	 mov	 DWORD PTR [ecx+eax], esi
  000a9	89 7c 01 04	 mov	 DWORD PTR [ecx+eax+4], edi

; 729  : 
; 730  : #if defined(BOOT_X64)
; 731  : 
; 732  :         Pdpe[Index] |= PAGE_WRITEABLE | PAGE_ACCESSED;
; 733  : 
; 734  : #endif
; 735  : 
; 736  :     }

  000ad	eb a2		 jmp	 SHORT $LN8@BlMmInitia
$LN7@BlMmInitia:

; 737  : 
; 738  :     Pde[0] = PtBase | PAGE_PRESENT | PAGE_WRITEABLE | PAGE_ACCESSED;

  000af	8b 55 d8	 mov	 edx, DWORD PTR _PtBase$[ebp]
  000b2	83 ca 01	 or	 edx, 1
  000b5	8b 45 dc	 mov	 eax, DWORD PTR _PtBase$[ebp+4]
  000b8	83 ca 02	 or	 edx, 2
  000bb	83 ca 20	 or	 edx, 32			; 00000020H
  000be	8b 4d e4	 mov	 ecx, DWORD PTR _Pde$[ebp]
  000c1	89 11		 mov	 DWORD PTR [ecx], edx
  000c3	89 41 04	 mov	 DWORD PTR [ecx+4], eax

; 739  : 
; 740  :     for (Index = 1; Index < 512; Index += 1) {

  000c6	c7 45 f0 01 00
	00 00		 mov	 DWORD PTR _Index$[ebp], 1
  000cd	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _Index$[ebp+4], 0
  000d4	eb 12		 jmp	 SHORT $LN6@BlMmInitia
$LN5@BlMmInitia:
  000d6	8b 55 f0	 mov	 edx, DWORD PTR _Index$[ebp]
  000d9	83 c2 01	 add	 edx, 1
  000dc	8b 45 f4	 mov	 eax, DWORD PTR _Index$[ebp+4]
  000df	83 d0 00	 adc	 eax, 0
  000e2	89 55 f0	 mov	 DWORD PTR _Index$[ebp], edx
  000e5	89 45 f4	 mov	 DWORD PTR _Index$[ebp+4], eax
$LN6@BlMmInitia:
  000e8	83 7d f4 00	 cmp	 DWORD PTR _Index$[ebp+4], 0
  000ec	77 42		 ja	 SHORT $LN4@BlMmInitia
  000ee	72 09		 jb	 SHORT $LN13@BlMmInitia
  000f0	81 7d f0 00 02
	00 00		 cmp	 DWORD PTR _Index$[ebp], 512 ; 00000200H
  000f7	73 37		 jae	 SHORT $LN4@BlMmInitia
$LN13@BlMmInitia:

; 741  : 
; 742  :         Pte[Index] = (Index << 12) | PAGE_PRESENT | PAGE_WRITEABLE | PAGE_ACCESSED;

  000f9	8b 45 f0	 mov	 eax, DWORD PTR _Index$[ebp]
  000fc	8b 55 f4	 mov	 edx, DWORD PTR _Index$[ebp+4]
  000ff	b1 0c		 mov	 cl, 12			; 0000000cH
  00101	e8 00 00 00 00	 call	 __allshl
  00106	8b f0		 mov	 esi, eax
  00108	8b fa		 mov	 edi, edx
  0010a	83 ce 01	 or	 esi, 1
  0010d	83 ce 02	 or	 esi, 2
  00110	83 ce 20	 or	 esi, 32			; 00000020H
  00113	6a 00		 push	 0
  00115	6a 08		 push	 8
  00117	8b 4d f4	 mov	 ecx, DWORD PTR _Index$[ebp+4]
  0011a	51		 push	 ecx
  0011b	8b 55 f0	 mov	 edx, DWORD PTR _Index$[ebp]
  0011e	52		 push	 edx
  0011f	e8 00 00 00 00	 call	 __allmul
  00124	8b 4d d4	 mov	 ecx, DWORD PTR _Pte$[ebp]
  00127	89 34 01	 mov	 DWORD PTR [ecx+eax], esi
  0012a	89 7c 01 04	 mov	 DWORD PTR [ecx+eax+4], edi

; 743  :     }

  0012e	eb a6		 jmp	 SHORT $LN5@BlMmInitia
$LN4@BlMmInitia:

; 744  : 
; 745  :     for (Index = 1; Index < 2048; Index += 1) {

  00130	c7 45 f0 01 00
	00 00		 mov	 DWORD PTR _Index$[ebp], 1
  00137	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _Index$[ebp+4], 0
  0013e	eb 12		 jmp	 SHORT $LN3@BlMmInitia
$LN2@BlMmInitia:
  00140	8b 55 f0	 mov	 edx, DWORD PTR _Index$[ebp]
  00143	83 c2 01	 add	 edx, 1
  00146	8b 45 f4	 mov	 eax, DWORD PTR _Index$[ebp+4]
  00149	83 d0 00	 adc	 eax, 0
  0014c	89 55 f0	 mov	 DWORD PTR _Index$[ebp], edx
  0014f	89 45 f4	 mov	 DWORD PTR _Index$[ebp+4], eax
$LN3@BlMmInitia:
  00152	83 7d f4 00	 cmp	 DWORD PTR _Index$[ebp+4], 0
  00156	77 48		 ja	 SHORT $LN1@BlMmInitia
  00158	72 09		 jb	 SHORT $LN14@BlMmInitia
  0015a	81 7d f0 00 08
	00 00		 cmp	 DWORD PTR _Index$[ebp], 2048 ; 00000800H
  00161	73 3d		 jae	 SHORT $LN1@BlMmInitia
$LN14@BlMmInitia:

; 746  : 
; 747  :         Pde[Index] = (Index << 21) | PAGE_PRESENT | PAGE_WRITEABLE | PAGE_ACCESSED | PAGE_2MB;

  00163	8b 45 f0	 mov	 eax, DWORD PTR _Index$[ebp]
  00166	8b 55 f4	 mov	 edx, DWORD PTR _Index$[ebp+4]
  00169	b1 15		 mov	 cl, 21			; 00000015H
  0016b	e8 00 00 00 00	 call	 __allshl
  00170	8b f0		 mov	 esi, eax
  00172	8b fa		 mov	 edi, edx
  00174	83 ce 01	 or	 esi, 1
  00177	83 ce 02	 or	 esi, 2
  0017a	83 ce 20	 or	 esi, 32			; 00000020H
  0017d	81 ce 80 00 00
	00		 or	 esi, 128		; 00000080H
  00183	6a 00		 push	 0
  00185	6a 08		 push	 8
  00187	8b 4d f4	 mov	 ecx, DWORD PTR _Index$[ebp+4]
  0018a	51		 push	 ecx
  0018b	8b 55 f0	 mov	 edx, DWORD PTR _Index$[ebp]
  0018e	52		 push	 edx
  0018f	e8 00 00 00 00	 call	 __allmul
  00194	8b 4d e4	 mov	 ecx, DWORD PTR _Pde$[ebp]
  00197	89 34 01	 mov	 DWORD PTR [ecx+eax], esi
  0019a	89 7c 01 04	 mov	 DWORD PTR [ecx+eax+4], edi

; 748  :     }

  0019e	eb a0		 jmp	 SHORT $LN2@BlMmInitia
$LN1@BlMmInitia:

; 749  : 
; 750  : #if defined(BOOT_X86)
; 751  : 
; 752  :     BlMmBootCr3 = (ULONG_PTR) PdptBase;

  001a0	8b 55 e8	 mov	 edx, DWORD PTR _PdptBase$[ebp]
  001a3	89 15 00 00 00
	00		 mov	 DWORD PTR ?BlMmBootCr3@@3KA, edx ; BlMmBootCr3

; 753  : 
; 754  : #elif defined(BOOT_X64)
; 755  : 
; 756  :     BlMmBootCr3 = Pml4tBase;
; 757  : 
; 758  : #endif
; 759  : 
; 760  :     BlMmSetCr3(BlMmBootCr3);

  001a9	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?BlMmBootCr3@@3KA ; BlMmBootCr3
  001af	e8 00 00 00 00	 call	 ?BlMmSetCr3@@YIXK@Z	; BlMmSetCr3

; 761  : 
; 762  :     BlGetBeb()->LegacyReturnCr3 = (UINT32) BlMmBootCr3;

  001b4	e8 00 00 00 00	 call	 ?BlGetBeb@@YIPAU_BEB@@XZ ; BlGetBeb
  001b9	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?BlMmBootCr3@@3KA ; BlMmBootCr3
  001bf	89 48 1c	 mov	 DWORD PTR [eax+28], ecx

; 763  : 
; 764  : #if MM_VERBOSE
; 765  : 
; 766  :     BlRtlPrintf("MM: 4GB identity map [CR3=%p]\n", BlMmBootCr3);
; 767  : 
; 768  : #endif
; 769  : 
; 770  :     return;
; 771  : }

  001c2	5f		 pop	 edi
  001c3	5e		 pop	 esi
  001c4	8b e5		 mov	 esp, ebp
  001c6	5d		 pop	 ebp
  001c7	c3		 ret	 0
?BlMmInitializePageTables@@YIXXZ ENDP			; BlMmInitializePageTables
; Function compile flags: /Odtp
; File d:\oses\verve\verify\src\trusted\bootloader\singldrpc\bl.h
_TEXT	ENDS
;	COMDAT ?BlGetBeb@@YIPAU_BEB@@XZ
_TEXT	SEGMENT
?BlGetBeb@@YIPAU_BEB@@XZ PROC				; BlGetBeb, COMDAT

; 355  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 356  :     return ((PBEB) BEB_BASE);

  00003	b8 00 f0 02 00	 mov	 eax, 192512		; 0002f000H

; 357  : }

  00008	5d		 pop	 ebp
  00009	c3		 ret	 0
?BlGetBeb@@YIPAU_BEB@@XZ ENDP				; BlGetBeb
_TEXT	ENDS
PUBLIC	?BlMmMapVirtualPage@@YIXPAX0EEE@Z		; BlMmMapVirtualPage
EXTRN	__aullshr:PROC
; Function compile flags: /Odtp
; File d:\oses\verve\verify\src\trusted\bootloader\singldrpc\blmm.cpp
;	COMDAT ?BlMmMapVirtualPage@@YIXPAX0EEE@Z
_TEXT	SEGMENT
tv219 = -88						; size = 8
tv189 = -80						; size = 8
_PhysicalAddress$ = -72					; size = 4
_VirtualAddress$ = -68					; size = 4
_PtIndex$ = -64						; size = 4
_PtBase$ = -60						; size = 4
_VirtualPageNumber$ = -56				; size = 4
_PdBase$ = -52						; size = 4
_PdpBase$ = -48						; size = 4
_PdpIndex$ = -44					; size = 4
_Entry$ = -40						; size = 8
_PdIndex$ = -28						; size = 4
_LargePageAddress$ = -24				; size = 8
_PhysicalPageNumber$ = -16				; size = 8
_Index$ = -4						; size = 4
_Writeable$ = 8						; size = 1
_Cacheable$ = 12					; size = 1
_WriteThrough$ = 16					; size = 1
?BlMmMapVirtualPage@@YIXPAX0EEE@Z PROC			; BlMmMapVirtualPage, COMDAT
; _VirtualAddress$ = ecx
; _PhysicalAddress$ = edx

; 802  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	56		 push	 esi
  00007	89 55 b8	 mov	 DWORD PTR _PhysicalAddress$[ebp], edx
  0000a	89 4d bc	 mov	 DWORD PTR _VirtualAddress$[ebp], ecx

; 803  :     UINT64 Entry;
; 804  :     UINT32 Index;
; 805  :     UINT64 LargePageAddress;
; 806  :     PUINT64 PdBase;
; 807  :     UINT32 PdIndex;
; 808  :     PUINT64 PdpBase;
; 809  :     UINT32 PdpIndex;
; 810  :     UINT64 PhysicalPageNumber;
; 811  :     PUINT64 PtBase;
; 812  :     UINT32 PtIndex;
; 813  :     ULONG_PTR VirtualPageNumber;
; 814  : 
; 815  :     BLASSERT((((ULONG_PTR) VirtualAddress) & 0xFFF) == 0);

  0000d	8b 45 bc	 mov	 eax, DWORD PTR _VirtualAddress$[ebp]
  00010	25 ff 0f 00 00	 and	 eax, 4095		; 00000fffH
  00015	74 0f		 je	 SHORT $LN11@BlMmMapVir
  00017	ba 2f 03 00 00	 mov	 edx, 815		; 0000032fH
  0001c	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  00021	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN11@BlMmMapVir:

; 816  : 
; 817  :     BLASSERT((((ULONG_PTR) PhysicalAddress) & 0xFFF) == 0);

  00026	8b 4d b8	 mov	 ecx, DWORD PTR _PhysicalAddress$[ebp]
  00029	81 e1 ff 0f 00
	00		 and	 ecx, 4095		; 00000fffH
  0002f	74 0f		 je	 SHORT $LN10@BlMmMapVir
  00031	ba 31 03 00 00	 mov	 edx, 817		; 00000331H
  00036	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  0003b	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN10@BlMmMapVir:

; 818  : 
; 819  : #if defined(BOOT_X64)
; 820  : 
; 821  :     BLASSERT((ULONG_PTR) VirtualAddress < 0x100000000UI64);
; 822  : 
; 823  : #endif
; 824  : 
; 825  :     //
; 826  :     // Compute virtual page number, page directory pointer, page directory, and page table indices.
; 827  :     //
; 828  : 
; 829  :     VirtualPageNumber = ((ULONG_PTR) VirtualAddress) / PAGE_SIZE;

  00040	8b 55 bc	 mov	 edx, DWORD PTR _VirtualAddress$[ebp]
  00043	c1 ea 0c	 shr	 edx, 12			; 0000000cH
  00046	89 55 c8	 mov	 DWORD PTR _VirtualPageNumber$[ebp], edx

; 830  : 
; 831  :     PdpIndex = (UINT32) ((VirtualPageNumber >> 18) & 0x1FF);

  00049	8b 45 c8	 mov	 eax, DWORD PTR _VirtualPageNumber$[ebp]
  0004c	c1 e8 12	 shr	 eax, 18			; 00000012H
  0004f	25 ff 01 00 00	 and	 eax, 511		; 000001ffH
  00054	89 45 d4	 mov	 DWORD PTR _PdpIndex$[ebp], eax

; 832  :     PdIndex = (UINT32) ((VirtualPageNumber >> 9) & 0x1FF);

  00057	8b 4d c8	 mov	 ecx, DWORD PTR _VirtualPageNumber$[ebp]
  0005a	c1 e9 09	 shr	 ecx, 9
  0005d	81 e1 ff 01 00
	00		 and	 ecx, 511		; 000001ffH
  00063	89 4d e4	 mov	 DWORD PTR _PdIndex$[ebp], ecx

; 833  :     PtIndex = (UINT32) (VirtualPageNumber & 0x1FF);

  00066	8b 55 c8	 mov	 edx, DWORD PTR _VirtualPageNumber$[ebp]
  00069	81 e2 ff 01 00
	00		 and	 edx, 511		; 000001ffH
  0006f	89 55 c0	 mov	 DWORD PTR _PtIndex$[ebp], edx

; 834  : 
; 835  :     //
; 836  :     // Look up page directory base address.
; 837  :     //
; 838  : 
; 839  :     PdpBase = &BlMmPdpTable[0].Entry[0];

  00072	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _PdpBase$[ebp], OFFSET ?BlMmPdpTable@@3PAU_BL_MM_PAGE_TABLE@@A ; BlMmPdpTable

; 840  : 
; 841  :     PdBase = (PUINT64) (ULONG_PTR) (PdpBase[PdpIndex] & (~(0xFFFUI64)));

  00079	8b 45 d4	 mov	 eax, DWORD PTR _PdpIndex$[ebp]
  0007c	8b 4d d0	 mov	 ecx, DWORD PTR _PdpBase$[ebp]
  0007f	8b 14 c1	 mov	 edx, DWORD PTR [ecx+eax*8]
  00082	81 e2 00 f0 ff
	ff		 and	 edx, -4096		; fffff000H
  00088	8b 44 c1 04	 mov	 eax, DWORD PTR [ecx+eax*8+4]
  0008c	89 55 cc	 mov	 DWORD PTR _PdBase$[ebp], edx

; 842  : 
; 843  :     //
; 844  :     // If the specified page is currently being mapped with large pages, then split it into 4K mappings.
; 845  :     //
; 846  : 
; 847  :     if ((PdBase[PdIndex] & PAGE_2MB) != 0) {

  0008f	8b 4d e4	 mov	 ecx, DWORD PTR _PdIndex$[ebp]
  00092	8b 55 cc	 mov	 edx, DWORD PTR _PdBase$[ebp]
  00095	8b 04 ca	 mov	 eax, DWORD PTR [edx+ecx*8]
  00098	25 80 00 00 00	 and	 eax, 128		; 00000080H
  0009d	8b 4c ca 04	 mov	 ecx, DWORD PTR [edx+ecx*8+4]
  000a1	83 e1 00	 and	 ecx, 0
  000a4	89 45 b0	 mov	 DWORD PTR tv189[ebp], eax
  000a7	89 4d b4	 mov	 DWORD PTR tv189[ebp+4], ecx
  000aa	8b 55 b0	 mov	 edx, DWORD PTR tv189[ebp]
  000ad	0b 55 b4	 or	 edx, DWORD PTR tv189[ebp+4]
  000b0	0f 84 c6 00 00
	00		 je	 $LN9@BlMmMapVir

; 848  : 
; 849  :         PtBase = (PUINT64) (ULONG_PTR) BlMmAllocatePhysicalRegion(PAGE_SIZE, BL_MM_PHYSICAL_REGION_BOOT_LOADER);

  000b6	ba 03 00 00 00	 mov	 edx, 3
  000bb	b9 00 10 00 00	 mov	 ecx, 4096		; 00001000H
  000c0	e8 00 00 00 00	 call	 ?BlMmAllocatePhysicalRegion@@YI_KKK@Z ; BlMmAllocatePhysicalRegion
  000c5	89 45 c4	 mov	 DWORD PTR _PtBase$[ebp], eax

; 850  : 
; 851  :         LargePageAddress = (PdBase[PdIndex] & (~(0xFFFUI64)));

  000c8	8b 45 e4	 mov	 eax, DWORD PTR _PdIndex$[ebp]
  000cb	8b 4d cc	 mov	 ecx, DWORD PTR _PdBase$[ebp]
  000ce	8b 14 c1	 mov	 edx, DWORD PTR [ecx+eax*8]
  000d1	81 e2 00 f0 ff
	ff		 and	 edx, -4096		; fffff000H
  000d7	8b 44 c1 04	 mov	 eax, DWORD PTR [ecx+eax*8+4]
  000db	89 55 e8	 mov	 DWORD PTR _LargePageAddress$[ebp], edx
  000de	89 45 ec	 mov	 DWORD PTR _LargePageAddress$[ebp+4], eax

; 852  : 
; 853  :         BLASSERT(((LargePageAddress >> 12) & 0x1FF) == 0);

  000e1	8b 45 e8	 mov	 eax, DWORD PTR _LargePageAddress$[ebp]
  000e4	8b 55 ec	 mov	 edx, DWORD PTR _LargePageAddress$[ebp+4]
  000e7	b1 0c		 mov	 cl, 12			; 0000000cH
  000e9	e8 00 00 00 00	 call	 __aullshr
  000ee	25 ff 01 00 00	 and	 eax, 511		; 000001ffH
  000f3	83 e2 00	 and	 edx, 0
  000f6	89 45 a8	 mov	 DWORD PTR tv219[ebp], eax
  000f9	89 55 ac	 mov	 DWORD PTR tv219[ebp+4], edx
  000fc	8b 4d a8	 mov	 ecx, DWORD PTR tv219[ebp]
  000ff	0b 4d ac	 or	 ecx, DWORD PTR tv219[ebp+4]
  00102	74 0f		 je	 SHORT $LN8@BlMmMapVir
  00104	ba 55 03 00 00	 mov	 edx, 853		; 00000355H
  00109	b9 00 00 00 00	 mov	 ecx, OFFSET ??_C@_08JOIABOAI@blmm?4cpp?$AA@
  0010e	e8 00 00 00 00	 call	 ?BlRtlAssertFailed@@YIXPBDK@Z ; BlRtlAssertFailed
$LN8@BlMmMapVir:

; 854  : 
; 855  :         //
; 856  :         // Create page table entries to map the region in 4K pages.
; 857  :         //
; 858  : 
; 859  :         for (Index = 0; Index < 512; Index += 1) {

  00113	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _Index$[ebp], 0
  0011a	eb 09		 jmp	 SHORT $LN7@BlMmMapVir
$LN6@BlMmMapVir:
  0011c	8b 55 fc	 mov	 edx, DWORD PTR _Index$[ebp]
  0011f	83 c2 01	 add	 edx, 1
  00122	89 55 fc	 mov	 DWORD PTR _Index$[ebp], edx
$LN7@BlMmMapVir:
  00125	81 7d fc 00 02
	00 00		 cmp	 DWORD PTR _Index$[ebp], 512 ; 00000200H
  0012c	73 28		 jae	 SHORT $LN5@BlMmMapVir

; 860  : 
; 861  :             PtBase[Index] = (LargePageAddress + (Index * PAGE_SIZE)) | PAGE_PRESENT | PAGE_WRITEABLE | PAGE_ACCESSED;

  0012e	8b 45 fc	 mov	 eax, DWORD PTR _Index$[ebp]
  00131	c1 e0 0c	 shl	 eax, 12			; 0000000cH
  00134	33 c9		 xor	 ecx, ecx
  00136	03 45 e8	 add	 eax, DWORD PTR _LargePageAddress$[ebp]
  00139	8b 55 ec	 mov	 edx, DWORD PTR _LargePageAddress$[ebp+4]
  0013c	13 d1		 adc	 edx, ecx
  0013e	83 c8 01	 or	 eax, 1
  00141	83 c8 02	 or	 eax, 2
  00144	83 c8 20	 or	 eax, 32			; 00000020H
  00147	8b 4d fc	 mov	 ecx, DWORD PTR _Index$[ebp]
  0014a	8b 75 c4	 mov	 esi, DWORD PTR _PtBase$[ebp]
  0014d	89 04 ce	 mov	 DWORD PTR [esi+ecx*8], eax
  00150	89 54 ce 04	 mov	 DWORD PTR [esi+ecx*8+4], edx

; 862  :         }

  00154	eb c6		 jmp	 SHORT $LN6@BlMmMapVir
$LN5@BlMmMapVir:

; 863  : 
; 864  :         //
; 865  :         // Update page directory entry.
; 866  :         //
; 867  : 
; 868  :         PdBase[PdIndex] = ((UINT64) (ULONG_PTR) PtBase) | PAGE_PRESENT | PAGE_WRITEABLE | PAGE_ACCESSED;

  00156	8b 55 c4	 mov	 edx, DWORD PTR _PtBase$[ebp]
  00159	33 c0		 xor	 eax, eax
  0015b	83 ca 01	 or	 edx, 1
  0015e	83 ca 02	 or	 edx, 2
  00161	83 ca 20	 or	 edx, 32			; 00000020H
  00164	8b 4d e4	 mov	 ecx, DWORD PTR _PdIndex$[ebp]
  00167	8b 75 cc	 mov	 esi, DWORD PTR _PdBase$[ebp]
  0016a	89 14 ce	 mov	 DWORD PTR [esi+ecx*8], edx
  0016d	89 44 ce 04	 mov	 DWORD PTR [esi+ecx*8+4], eax

; 869  : 
; 870  :         //
; 871  :         // Flush TLB.
; 872  :         //
; 873  : 
; 874  :         BlMmSetCr3(BlMmBootCr3);

  00171	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?BlMmBootCr3@@3KA ; BlMmBootCr3
  00177	e8 00 00 00 00	 call	 ?BlMmSetCr3@@YIXK@Z	; BlMmSetCr3
$LN9@BlMmMapVir:

; 875  :     }
; 876  : 
; 877  :     //
; 878  :     // Update page mapping.
; 879  :     //
; 880  : 
; 881  :     PtBase = (PUINT64) (ULONG_PTR) (PdBase[PdIndex] & (~(0xFFFUI64)));

  0017c	8b 55 e4	 mov	 edx, DWORD PTR _PdIndex$[ebp]
  0017f	8b 45 cc	 mov	 eax, DWORD PTR _PdBase$[ebp]
  00182	8b 0c d0	 mov	 ecx, DWORD PTR [eax+edx*8]
  00185	81 e1 00 f0 ff
	ff		 and	 ecx, -4096		; fffff000H
  0018b	8b 54 d0 04	 mov	 edx, DWORD PTR [eax+edx*8+4]
  0018f	89 4d c4	 mov	 DWORD PTR _PtBase$[ebp], ecx

; 882  : 
; 883  :     PhysicalPageNumber = ((ULONG_PTR) PhysicalAddress) >> 12;

  00192	8b 45 b8	 mov	 eax, DWORD PTR _PhysicalAddress$[ebp]
  00195	c1 e8 0c	 shr	 eax, 12			; 0000000cH
  00198	33 c9		 xor	 ecx, ecx
  0019a	89 45 f0	 mov	 DWORD PTR _PhysicalPageNumber$[ebp], eax
  0019d	89 4d f4	 mov	 DWORD PTR _PhysicalPageNumber$[ebp+4], ecx

; 884  : 
; 885  :     Entry = (PhysicalPageNumber << 12) | PAGE_PRESENT;

  001a0	8b 45 f0	 mov	 eax, DWORD PTR _PhysicalPageNumber$[ebp]
  001a3	8b 55 f4	 mov	 edx, DWORD PTR _PhysicalPageNumber$[ebp+4]
  001a6	b1 0c		 mov	 cl, 12			; 0000000cH
  001a8	e8 00 00 00 00	 call	 __allshl
  001ad	83 c8 01	 or	 eax, 1
  001b0	89 45 d8	 mov	 DWORD PTR _Entry$[ebp], eax
  001b3	89 55 dc	 mov	 DWORD PTR _Entry$[ebp+4], edx

; 886  : 
; 887  :     if (Writeable != FALSE) {

  001b6	0f b6 55 08	 movzx	 edx, BYTE PTR _Writeable$[ebp]
  001ba	85 d2		 test	 edx, edx
  001bc	74 0f		 je	 SHORT $LN4@BlMmMapVir

; 888  : 
; 889  :         Entry |= PAGE_WRITEABLE;

  001be	8b 45 d8	 mov	 eax, DWORD PTR _Entry$[ebp]
  001c1	83 c8 02	 or	 eax, 2
  001c4	8b 4d dc	 mov	 ecx, DWORD PTR _Entry$[ebp+4]
  001c7	89 45 d8	 mov	 DWORD PTR _Entry$[ebp], eax
  001ca	89 4d dc	 mov	 DWORD PTR _Entry$[ebp+4], ecx
$LN4@BlMmMapVir:

; 890  :     }
; 891  : 
; 892  :     if (Cacheable == FALSE) {

  001cd	0f b6 55 0c	 movzx	 edx, BYTE PTR _Cacheable$[ebp]
  001d1	85 d2		 test	 edx, edx
  001d3	75 11		 jne	 SHORT $LN3@BlMmMapVir

; 893  : 
; 894  :         Entry |= PAGE_CACHEDISABLE;

  001d5	8b 45 d8	 mov	 eax, DWORD PTR _Entry$[ebp]
  001d8	83 c8 10	 or	 eax, 16			; 00000010H
  001db	8b 4d dc	 mov	 ecx, DWORD PTR _Entry$[ebp+4]
  001de	89 45 d8	 mov	 DWORD PTR _Entry$[ebp], eax
  001e1	89 4d dc	 mov	 DWORD PTR _Entry$[ebp+4], ecx
  001e4	eb 17		 jmp	 SHORT $LN2@BlMmMapVir
$LN3@BlMmMapVir:

; 895  : 
; 896  :     } else if (WriteThrough != FALSE) {

  001e6	0f b6 55 10	 movzx	 edx, BYTE PTR _WriteThrough$[ebp]
  001ea	85 d2		 test	 edx, edx
  001ec	74 0f		 je	 SHORT $LN2@BlMmMapVir

; 897  : 
; 898  :         Entry |= PAGE_WRITETHROUGH;

  001ee	8b 45 d8	 mov	 eax, DWORD PTR _Entry$[ebp]
  001f1	83 c8 08	 or	 eax, 8
  001f4	8b 4d dc	 mov	 ecx, DWORD PTR _Entry$[ebp+4]
  001f7	89 45 d8	 mov	 DWORD PTR _Entry$[ebp], eax
  001fa	89 4d dc	 mov	 DWORD PTR _Entry$[ebp+4], ecx
$LN2@BlMmMapVir:

; 899  :     }
; 900  : 
; 901  :     PtBase[PtIndex] = Entry;

  001fd	8b 55 c0	 mov	 edx, DWORD PTR _PtIndex$[ebp]
  00200	8b 45 c4	 mov	 eax, DWORD PTR _PtBase$[ebp]
  00203	8b 4d d8	 mov	 ecx, DWORD PTR _Entry$[ebp]
  00206	89 0c d0	 mov	 DWORD PTR [eax+edx*8], ecx
  00209	8b 4d dc	 mov	 ecx, DWORD PTR _Entry$[ebp+4]
  0020c	89 4c d0 04	 mov	 DWORD PTR [eax+edx*8+4], ecx

; 902  : 
; 903  :     //
; 904  :     // Flush TLB.
; 905  :     //
; 906  : 
; 907  :     BlMmSetCr3(BlMmBootCr3);

  00210	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?BlMmBootCr3@@3KA ; BlMmBootCr3
  00216	e8 00 00 00 00	 call	 ?BlMmSetCr3@@YIXK@Z	; BlMmSetCr3

; 908  : 
; 909  :     return;
; 910  : }

  0021b	5e		 pop	 esi
  0021c	8b e5		 mov	 esp, ebp
  0021e	5d		 pop	 ebp
  0021f	c2 0c 00	 ret	 12			; 0000000cH
?BlMmMapVirtualPage@@YIXPAX0EEE@Z ENDP			; BlMmMapVirtualPage
_TEXT	ENDS
PUBLIC	?BlMmMapVirtualRange@@YIXPAX0KEEE@Z		; BlMmMapVirtualRange
; Function compile flags: /Odtp
;	COMDAT ?BlMmMapVirtualRange@@YIXPAX0KEEE@Z
_TEXT	SEGMENT
_PhysicalAddress$ = -20					; size = 4
_VirtualAddress$ = -16					; size = 4
_PhysicalNext$ = -12					; size = 4
_VirtualLimit$ = -8					; size = 4
_VirtualNext$ = -4					; size = 4
_Size$ = 8						; size = 4
_Writeable$ = 12					; size = 1
_Cacheable$ = 16					; size = 1
_WriteThrough$ = 20					; size = 1
?BlMmMapVirtualRange@@YIXPAX0KEEE@Z PROC		; BlMmMapVirtualRange, COMDAT
; _VirtualAddress$ = ecx
; _PhysicalAddress$ = edx

; 944  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 14	 sub	 esp, 20			; 00000014H
  00006	89 55 ec	 mov	 DWORD PTR _PhysicalAddress$[ebp], edx
  00009	89 4d f0	 mov	 DWORD PTR _VirtualAddress$[ebp], ecx

; 945  :     ULONG_PTR PhysicalNext;
; 946  :     ULONG_PTR VirtualLimit;
; 947  :     ULONG_PTR VirtualNext;
; 948  : 
; 949  :     VirtualNext = (ULONG_PTR) VirtualAddress;

  0000c	8b 45 f0	 mov	 eax, DWORD PTR _VirtualAddress$[ebp]
  0000f	89 45 fc	 mov	 DWORD PTR _VirtualNext$[ebp], eax

; 950  :     VirtualLimit = VirtualNext + Size;

  00012	8b 4d fc	 mov	 ecx, DWORD PTR _VirtualNext$[ebp]
  00015	03 4d 08	 add	 ecx, DWORD PTR _Size$[ebp]
  00018	89 4d f8	 mov	 DWORD PTR _VirtualLimit$[ebp], ecx

; 951  : 
; 952  :     VirtualNext &= (~((ULONG_PTR) 0xFFF));

  0001b	8b 55 fc	 mov	 edx, DWORD PTR _VirtualNext$[ebp]
  0001e	81 e2 00 f0 ff
	ff		 and	 edx, -4096		; fffff000H
  00024	89 55 fc	 mov	 DWORD PTR _VirtualNext$[ebp], edx

; 953  :     VirtualLimit = ROUND_UP_TO_PAGES(VirtualLimit);

  00027	8b 45 f8	 mov	 eax, DWORD PTR _VirtualLimit$[ebp]
  0002a	05 ff 0f 00 00	 add	 eax, 4095		; 00000fffH
  0002f	25 00 f0 ff ff	 and	 eax, -4096		; fffff000H
  00034	89 45 f8	 mov	 DWORD PTR _VirtualLimit$[ebp], eax

; 954  : 
; 955  :     PhysicalNext = (ULONG_PTR) PhysicalAddress;

  00037	8b 4d ec	 mov	 ecx, DWORD PTR _PhysicalAddress$[ebp]
  0003a	89 4d f4	 mov	 DWORD PTR _PhysicalNext$[ebp], ecx

; 956  :     PhysicalNext &= (~((ULONG_PTR) 0xFFF));

  0003d	8b 55 f4	 mov	 edx, DWORD PTR _PhysicalNext$[ebp]
  00040	81 e2 00 f0 ff
	ff		 and	 edx, -4096		; fffff000H
  00046	89 55 f4	 mov	 DWORD PTR _PhysicalNext$[ebp], edx
$LN2@BlMmMapVir@2:

; 957  : 
; 958  :     while (VirtualNext < VirtualLimit) {

  00049	8b 45 fc	 mov	 eax, DWORD PTR _VirtualNext$[ebp]
  0004c	3b 45 f8	 cmp	 eax, DWORD PTR _VirtualLimit$[ebp]
  0004f	73 31		 jae	 SHORT $LN3@BlMmMapVir@2

; 959  : 
; 960  :         BlMmMapVirtualPage((PVOID) VirtualNext,
; 961  :                            (PVOID) PhysicalNext,
; 962  :                            Writeable,
; 963  :                            Cacheable,
; 964  :                            WriteThrough);

  00051	8a 4d 14	 mov	 cl, BYTE PTR _WriteThrough$[ebp]
  00054	51		 push	 ecx
  00055	8a 55 10	 mov	 dl, BYTE PTR _Cacheable$[ebp]
  00058	52		 push	 edx
  00059	8a 45 0c	 mov	 al, BYTE PTR _Writeable$[ebp]
  0005c	50		 push	 eax
  0005d	8b 55 f4	 mov	 edx, DWORD PTR _PhysicalNext$[ebp]
  00060	8b 4d fc	 mov	 ecx, DWORD PTR _VirtualNext$[ebp]
  00063	e8 00 00 00 00	 call	 ?BlMmMapVirtualPage@@YIXPAX0EEE@Z ; BlMmMapVirtualPage

; 965  : 
; 966  :         VirtualNext += PAGE_SIZE;

  00068	8b 4d fc	 mov	 ecx, DWORD PTR _VirtualNext$[ebp]
  0006b	81 c1 00 10 00
	00		 add	 ecx, 4096		; 00001000H
  00071	89 4d fc	 mov	 DWORD PTR _VirtualNext$[ebp], ecx

; 967  :         PhysicalNext += PAGE_SIZE;

  00074	8b 55 f4	 mov	 edx, DWORD PTR _PhysicalNext$[ebp]
  00077	81 c2 00 10 00
	00		 add	 edx, 4096		; 00001000H
  0007d	89 55 f4	 mov	 DWORD PTR _PhysicalNext$[ebp], edx

; 968  :     }

  00080	eb c7		 jmp	 SHORT $LN2@BlMmMapVir@2
$LN3@BlMmMapVir@2:

; 969  : 
; 970  :     return;
; 971  : }

  00082	8b e5		 mov	 esp, ebp
  00084	5d		 pop	 ebp
  00085	c2 10 00	 ret	 16			; 00000010H
?BlMmMapVirtualRange@@YIXPAX0KEEE@Z ENDP		; BlMmMapVirtualRange
_TEXT	ENDS
PUBLIC	?BlMmInitializeCodeSegment@@YIXPAU_CODE_SEGMENT@@@Z ; BlMmInitializeCodeSegment
; Function compile flags: /Odtp
;	COMDAT ?BlMmInitializeCodeSegment@@YIXPAU_CODE_SEGMENT@@@Z
_TEXT	SEGMENT
_CodeSegment$ = -4					; size = 4
?BlMmInitializeCodeSegment@@YIXPAU_CODE_SEGMENT@@@Z PROC ; BlMmInitializeCodeSegment, COMDAT
; _CodeSegment$ = ecx

; 990  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	89 4d fc	 mov	 DWORD PTR _CodeSegment$[ebp], ecx

; 991  :     BlRtlZeroMemory(CodeSegment, sizeof(CODE_SEGMENT));

  00007	ba 08 00 00 00	 mov	 edx, 8
  0000c	8b 4d fc	 mov	 ecx, DWORD PTR _CodeSegment$[ebp]
  0000f	e8 00 00 00 00	 call	 ?BlRtlZeroMemory@@YIXPAXK@Z ; BlRtlZeroMemory

; 992  : 
; 993  :     CodeSegment->Accessed = 1;

  00014	8b 45 fc	 mov	 eax, DWORD PTR _CodeSegment$[ebp]
  00017	8b 08		 mov	 ecx, DWORD PTR [eax]
  00019	8b 50 04	 mov	 edx, DWORD PTR [eax+4]
  0001c	81 ca 00 01 00
	00		 or	 edx, 256		; 00000100H
  00022	8b 45 fc	 mov	 eax, DWORD PTR _CodeSegment$[ebp]
  00025	89 08		 mov	 DWORD PTR [eax], ecx
  00027	89 50 04	 mov	 DWORD PTR [eax+4], edx

; 994  :     CodeSegment->Readable = 1;

  0002a	8b 4d fc	 mov	 ecx, DWORD PTR _CodeSegment$[ebp]
  0002d	8b 11		 mov	 edx, DWORD PTR [ecx]
  0002f	8b 41 04	 mov	 eax, DWORD PTR [ecx+4]
  00032	0d 00 02 00 00	 or	 eax, 512		; 00000200H
  00037	8b 4d fc	 mov	 ecx, DWORD PTR _CodeSegment$[ebp]
  0003a	89 11		 mov	 DWORD PTR [ecx], edx
  0003c	89 41 04	 mov	 DWORD PTR [ecx+4], eax

; 995  :     CodeSegment->Code = 1;

  0003f	8b 55 fc	 mov	 edx, DWORD PTR _CodeSegment$[ebp]
  00042	8b 02		 mov	 eax, DWORD PTR [edx]
  00044	8b 4a 04	 mov	 ecx, DWORD PTR [edx+4]
  00047	81 c9 00 08 00
	00		 or	 ecx, 2048		; 00000800H
  0004d	8b 55 fc	 mov	 edx, DWORD PTR _CodeSegment$[ebp]
  00050	89 02		 mov	 DWORD PTR [edx], eax
  00052	89 4a 04	 mov	 DWORD PTR [edx+4], ecx

; 996  :     CodeSegment->S = 1;

  00055	8b 45 fc	 mov	 eax, DWORD PTR _CodeSegment$[ebp]
  00058	8b 08		 mov	 ecx, DWORD PTR [eax]
  0005a	8b 50 04	 mov	 edx, DWORD PTR [eax+4]
  0005d	81 ca 00 10 00
	00		 or	 edx, 4096		; 00001000H
  00063	8b 45 fc	 mov	 eax, DWORD PTR _CodeSegment$[ebp]
  00066	89 08		 mov	 DWORD PTR [eax], ecx
  00068	89 50 04	 mov	 DWORD PTR [eax+4], edx

; 997  :     CodeSegment->Present = 1;

  0006b	8b 4d fc	 mov	 ecx, DWORD PTR _CodeSegment$[ebp]
  0006e	8b 11		 mov	 edx, DWORD PTR [ecx]
  00070	8b 41 04	 mov	 eax, DWORD PTR [ecx+4]
  00073	0d 00 80 00 00	 or	 eax, 32768		; 00008000H
  00078	8b 4d fc	 mov	 ecx, DWORD PTR _CodeSegment$[ebp]
  0007b	89 11		 mov	 DWORD PTR [ecx], edx
  0007d	89 41 04	 mov	 DWORD PTR [ecx+4], eax

; 998  :     CodeSegment->Long = 1;

  00080	8b 55 fc	 mov	 edx, DWORD PTR _CodeSegment$[ebp]
  00083	8b 02		 mov	 eax, DWORD PTR [edx]
  00085	8b 4a 04	 mov	 ecx, DWORD PTR [edx+4]
  00088	81 c9 00 00 20
	00		 or	 ecx, 2097152		; 00200000H
  0008e	8b 55 fc	 mov	 edx, DWORD PTR _CodeSegment$[ebp]
  00091	89 02		 mov	 DWORD PTR [edx], eax
  00093	89 4a 04	 mov	 DWORD PTR [edx+4], ecx

; 999  : 
; 1000 :     return;
; 1001 : }

  00096	8b e5		 mov	 esp, ebp
  00098	5d		 pop	 ebp
  00099	c3		 ret	 0
?BlMmInitializeCodeSegment@@YIXPAU_CODE_SEGMENT@@@Z ENDP ; BlMmInitializeCodeSegment
_TEXT	ENDS
PUBLIC	?BlMmInitializeDataSegment@@YIXPAU_DATA_SEGMENT@@KK@Z ; BlMmInitializeDataSegment
; Function compile flags: /Odtp
;	COMDAT ?BlMmInitializeDataSegment@@YIXPAU_DATA_SEGMENT@@KK@Z
_TEXT	SEGMENT
_Base$ = -8						; size = 4
_DataSegment$ = -4					; size = 4
_Limit$ = 8						; size = 4
?BlMmInitializeDataSegment@@YIXPAU_DATA_SEGMENT@@KK@Z PROC ; BlMmInitializeDataSegment, COMDAT
; _DataSegment$ = ecx
; _Base$ = edx

; 1026 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8
  00006	56		 push	 esi
  00007	89 55 f8	 mov	 DWORD PTR _Base$[ebp], edx
  0000a	89 4d fc	 mov	 DWORD PTR _DataSegment$[ebp], ecx

; 1027 :     BlRtlZeroMemory(DataSegment, sizeof(DATA_SEGMENT));

  0000d	ba 08 00 00 00	 mov	 edx, 8
  00012	8b 4d fc	 mov	 ecx, DWORD PTR _DataSegment$[ebp]
  00015	e8 00 00 00 00	 call	 ?BlRtlZeroMemory@@YIXPAXK@Z ; BlRtlZeroMemory

; 1028 : 
; 1029 :     DataSegment->Accessed = 1;

  0001a	8b 45 fc	 mov	 eax, DWORD PTR _DataSegment$[ebp]
  0001d	8b 08		 mov	 ecx, DWORD PTR [eax]
  0001f	8b 50 04	 mov	 edx, DWORD PTR [eax+4]
  00022	81 ca 00 01 00
	00		 or	 edx, 256		; 00000100H
  00028	8b 45 fc	 mov	 eax, DWORD PTR _DataSegment$[ebp]
  0002b	89 08		 mov	 DWORD PTR [eax], ecx
  0002d	89 50 04	 mov	 DWORD PTR [eax+4], edx

; 1030 :     DataSegment->Writable = 1;

  00030	8b 4d fc	 mov	 ecx, DWORD PTR _DataSegment$[ebp]
  00033	8b 11		 mov	 edx, DWORD PTR [ecx]
  00035	8b 41 04	 mov	 eax, DWORD PTR [ecx+4]
  00038	0d 00 02 00 00	 or	 eax, 512		; 00000200H
  0003d	8b 4d fc	 mov	 ecx, DWORD PTR _DataSegment$[ebp]
  00040	89 11		 mov	 DWORD PTR [ecx], edx
  00042	89 41 04	 mov	 DWORD PTR [ecx+4], eax

; 1031 :     DataSegment->S = 1;

  00045	8b 55 fc	 mov	 edx, DWORD PTR _DataSegment$[ebp]
  00048	8b 02		 mov	 eax, DWORD PTR [edx]
  0004a	8b 4a 04	 mov	 ecx, DWORD PTR [edx+4]
  0004d	81 c9 00 10 00
	00		 or	 ecx, 4096		; 00001000H
  00053	8b 55 fc	 mov	 edx, DWORD PTR _DataSegment$[ebp]
  00056	89 02		 mov	 DWORD PTR [edx], eax
  00058	89 4a 04	 mov	 DWORD PTR [edx+4], ecx

; 1032 :     DataSegment->Present = 1;

  0005b	8b 45 fc	 mov	 eax, DWORD PTR _DataSegment$[ebp]
  0005e	8b 08		 mov	 ecx, DWORD PTR [eax]
  00060	8b 50 04	 mov	 edx, DWORD PTR [eax+4]
  00063	81 ca 00 80 00
	00		 or	 edx, 32768		; 00008000H
  00069	8b 45 fc	 mov	 eax, DWORD PTR _DataSegment$[ebp]
  0006c	89 08		 mov	 DWORD PTR [eax], ecx
  0006e	89 50 04	 mov	 DWORD PTR [eax+4], edx

; 1033 :     DataSegment->Big = 1;

  00071	8b 4d fc	 mov	 ecx, DWORD PTR _DataSegment$[ebp]
  00074	8b 11		 mov	 edx, DWORD PTR [ecx]
  00076	8b 41 04	 mov	 eax, DWORD PTR [ecx+4]
  00079	0d 00 00 40 00	 or	 eax, 4194304		; 00400000H
  0007e	8b 4d fc	 mov	 ecx, DWORD PTR _DataSegment$[ebp]
  00081	89 11		 mov	 DWORD PTR [ecx], edx
  00083	89 41 04	 mov	 DWORD PTR [ecx+4], eax

; 1034 : 
; 1035 :     DataSegment->Base_23_0 = Base & 0xFFFFFF;

  00086	8b 55 f8	 mov	 edx, DWORD PTR _Base$[ebp]
  00089	81 e2 ff ff ff
	00		 and	 edx, 16777215		; 00ffffffH
  0008f	8b c2		 mov	 eax, edx
  00091	33 d2		 xor	 edx, edx
  00093	25 ff ff ff 00	 and	 eax, 16777215		; 00ffffffH
  00098	83 e2 00	 and	 edx, 0
  0009b	b1 10		 mov	 cl, 16			; 00000010H
  0009d	e8 00 00 00 00	 call	 __allshl
  000a2	8b 4d fc	 mov	 ecx, DWORD PTR _DataSegment$[ebp]
  000a5	8b 31		 mov	 esi, DWORD PTR [ecx]
  000a7	81 e6 ff ff 00
	00		 and	 esi, 65535		; 0000ffffH
  000ad	8b 49 04	 mov	 ecx, DWORD PTR [ecx+4]
  000b0	81 e1 00 ff ff
	ff		 and	 ecx, -256		; ffffff00H
  000b6	0b f0		 or	 esi, eax
  000b8	0b ca		 or	 ecx, edx
  000ba	8b 55 fc	 mov	 edx, DWORD PTR _DataSegment$[ebp]
  000bd	89 32		 mov	 DWORD PTR [edx], esi
  000bf	89 4a 04	 mov	 DWORD PTR [edx+4], ecx

; 1036 :     DataSegment->Base_31_24 = Base >> 24;

  000c2	8b 45 f8	 mov	 eax, DWORD PTR _Base$[ebp]
  000c5	c1 e8 18	 shr	 eax, 24			; 00000018H
  000c8	33 d2		 xor	 edx, edx
  000ca	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  000cf	83 e2 00	 and	 edx, 0
  000d2	b1 38		 mov	 cl, 56			; 00000038H
  000d4	e8 00 00 00 00	 call	 __allshl
  000d9	8b 4d fc	 mov	 ecx, DWORD PTR _DataSegment$[ebp]
  000dc	8b 31		 mov	 esi, DWORD PTR [ecx]
  000de	8b 49 04	 mov	 ecx, DWORD PTR [ecx+4]
  000e1	81 e1 ff ff ff
	00		 and	 ecx, 16777215		; 00ffffffH
  000e7	0b f0		 or	 esi, eax
  000e9	0b ca		 or	 ecx, edx
  000eb	8b 55 fc	 mov	 edx, DWORD PTR _DataSegment$[ebp]
  000ee	89 32		 mov	 DWORD PTR [edx], esi
  000f0	89 4a 04	 mov	 DWORD PTR [edx+4], ecx

; 1037 : 
; 1038 :     if (Limit <= 0xFFFFF) {

  000f3	81 7d 08 ff ff
	0f 00		 cmp	 DWORD PTR _Limit$[ebp], 1048575 ; 000fffffH
  000fa	77 62		 ja	 SHORT $LN2@BlMmInitia@2

; 1039 : 
; 1040 :         DataSegment->Limit_15_0 = Limit & 0xFFFF;

  000fc	8b 45 08	 mov	 eax, DWORD PTR _Limit$[ebp]
  000ff	25 ff ff 00 00	 and	 eax, 65535		; 0000ffffH
  00104	33 c9		 xor	 ecx, ecx
  00106	25 ff ff 00 00	 and	 eax, 65535		; 0000ffffH
  0010b	83 e1 00	 and	 ecx, 0
  0010e	8b 55 fc	 mov	 edx, DWORD PTR _DataSegment$[ebp]
  00111	8b 32		 mov	 esi, DWORD PTR [edx]
  00113	81 e6 00 00 ff
	ff		 and	 esi, -65536		; ffff0000H
  00119	8b 52 04	 mov	 edx, DWORD PTR [edx+4]
  0011c	0b f0		 or	 esi, eax
  0011e	0b d1		 or	 edx, ecx
  00120	8b 45 fc	 mov	 eax, DWORD PTR _DataSegment$[ebp]
  00123	89 30		 mov	 DWORD PTR [eax], esi
  00125	89 50 04	 mov	 DWORD PTR [eax+4], edx

; 1041 :         DataSegment->Limit_19_16 = (Limit >> 16) & 0xF;

  00128	8b 4d 08	 mov	 ecx, DWORD PTR _Limit$[ebp]
  0012b	c1 e9 10	 shr	 ecx, 16			; 00000010H
  0012e	83 e1 0f	 and	 ecx, 15			; 0000000fH
  00131	8b c1		 mov	 eax, ecx
  00133	33 d2		 xor	 edx, edx
  00135	83 e0 0f	 and	 eax, 15			; 0000000fH
  00138	83 e2 00	 and	 edx, 0
  0013b	b1 30		 mov	 cl, 48			; 00000030H
  0013d	e8 00 00 00 00	 call	 __allshl
  00142	8b 4d fc	 mov	 ecx, DWORD PTR _DataSegment$[ebp]
  00145	8b 31		 mov	 esi, DWORD PTR [ecx]
  00147	8b 49 04	 mov	 ecx, DWORD PTR [ecx+4]
  0014a	81 e1 ff ff f0
	ff		 and	 ecx, -983041		; fff0ffffH
  00150	0b f0		 or	 esi, eax
  00152	0b ca		 or	 ecx, edx
  00154	8b 55 fc	 mov	 edx, DWORD PTR _DataSegment$[ebp]
  00157	89 32		 mov	 DWORD PTR [edx], esi
  00159	89 4a 04	 mov	 DWORD PTR [edx+4], ecx

; 1042 : 
; 1043 :     } else {

  0015c	eb 7b		 jmp	 SHORT $LN3@BlMmInitia@2
$LN2@BlMmInitia@2:

; 1044 : 
; 1045 :         DataSegment->Granularity = 1;

  0015e	8b 45 fc	 mov	 eax, DWORD PTR _DataSegment$[ebp]
  00161	8b 08		 mov	 ecx, DWORD PTR [eax]
  00163	8b 50 04	 mov	 edx, DWORD PTR [eax+4]
  00166	81 ca 00 00 80
	00		 or	 edx, 8388608		; 00800000H
  0016c	8b 45 fc	 mov	 eax, DWORD PTR _DataSegment$[ebp]
  0016f	89 08		 mov	 DWORD PTR [eax], ecx
  00171	89 50 04	 mov	 DWORD PTR [eax+4], edx

; 1046 :         DataSegment->Limit_15_0 = (Limit >> 12) & 0xFFFF;

  00174	8b 4d 08	 mov	 ecx, DWORD PTR _Limit$[ebp]
  00177	c1 e9 0c	 shr	 ecx, 12			; 0000000cH
  0017a	81 e1 ff ff 00
	00		 and	 ecx, 65535		; 0000ffffH
  00180	33 d2		 xor	 edx, edx
  00182	81 e1 ff ff 00
	00		 and	 ecx, 65535		; 0000ffffH
  00188	83 e2 00	 and	 edx, 0
  0018b	8b 45 fc	 mov	 eax, DWORD PTR _DataSegment$[ebp]
  0018e	8b 30		 mov	 esi, DWORD PTR [eax]
  00190	81 e6 00 00 ff
	ff		 and	 esi, -65536		; ffff0000H
  00196	8b 40 04	 mov	 eax, DWORD PTR [eax+4]
  00199	0b f1		 or	 esi, ecx
  0019b	0b c2		 or	 eax, edx
  0019d	8b 4d fc	 mov	 ecx, DWORD PTR _DataSegment$[ebp]
  001a0	89 31		 mov	 DWORD PTR [ecx], esi
  001a2	89 41 04	 mov	 DWORD PTR [ecx+4], eax

; 1047 :         DataSegment->Limit_19_16 = (Limit >> 28) & 0xF;

  001a5	8b 55 08	 mov	 edx, DWORD PTR _Limit$[ebp]
  001a8	c1 ea 1c	 shr	 edx, 28			; 0000001cH
  001ab	83 e2 0f	 and	 edx, 15			; 0000000fH
  001ae	8b c2		 mov	 eax, edx
  001b0	33 d2		 xor	 edx, edx
  001b2	83 e0 0f	 and	 eax, 15			; 0000000fH
  001b5	83 e2 00	 and	 edx, 0
  001b8	b1 30		 mov	 cl, 48			; 00000030H
  001ba	e8 00 00 00 00	 call	 __allshl
  001bf	8b 4d fc	 mov	 ecx, DWORD PTR _DataSegment$[ebp]
  001c2	8b 31		 mov	 esi, DWORD PTR [ecx]
  001c4	8b 49 04	 mov	 ecx, DWORD PTR [ecx+4]
  001c7	81 e1 ff ff f0
	ff		 and	 ecx, -983041		; fff0ffffH
  001cd	0b f0		 or	 esi, eax
  001cf	0b ca		 or	 ecx, edx
  001d1	8b 55 fc	 mov	 edx, DWORD PTR _DataSegment$[ebp]
  001d4	89 32		 mov	 DWORD PTR [edx], esi
  001d6	89 4a 04	 mov	 DWORD PTR [edx+4], ecx
$LN3@BlMmInitia@2:

; 1048 :     }
; 1049 : 
; 1050 :     return;
; 1051 : }

  001d9	5e		 pop	 esi
  001da	8b e5		 mov	 esp, ebp
  001dc	5d		 pop	 ebp
  001dd	c2 04 00	 ret	 4
?BlMmInitializeDataSegment@@YIXPAU_DATA_SEGMENT@@KK@Z ENDP ; BlMmInitializeDataSegment
_TEXT	ENDS
PUBLIC	?BlMmInitializeSystemSegment@@YIXPAU_SYSTEM_SEGMENT@@KKK@Z ; BlMmInitializeSystemSegment
; Function compile flags: /Odtp
;	COMDAT ?BlMmInitializeSystemSegment@@YIXPAU_SYSTEM_SEGMENT@@KKK@Z
_TEXT	SEGMENT
_Type$ = -8						; size = 4
_SystemSegment$ = -4					; size = 4
_Base$ = 8						; size = 4
_Limit$ = 12						; size = 4
?BlMmInitializeSystemSegment@@YIXPAU_SYSTEM_SEGMENT@@KKK@Z PROC ; BlMmInitializeSystemSegment, COMDAT
; _SystemSegment$ = ecx
; _Type$ = edx

; 1079 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8
  00006	56		 push	 esi
  00007	89 55 f8	 mov	 DWORD PTR _Type$[ebp], edx
  0000a	89 4d fc	 mov	 DWORD PTR _SystemSegment$[ebp], ecx

; 1080 :     BlRtlZeroMemory(SystemSegment, sizeof(SYSTEM_SEGMENT));

  0000d	ba 08 00 00 00	 mov	 edx, 8
  00012	8b 4d fc	 mov	 ecx, DWORD PTR _SystemSegment$[ebp]
  00015	e8 00 00 00 00	 call	 ?BlRtlZeroMemory@@YIXPAXK@Z ; BlRtlZeroMemory

; 1081 : 
; 1082 :     SystemSegment->Type = (Type & 0xF);

  0001a	8b 45 f8	 mov	 eax, DWORD PTR _Type$[ebp]
  0001d	83 e0 0f	 and	 eax, 15			; 0000000fH
  00020	33 d2		 xor	 edx, edx
  00022	83 e0 0f	 and	 eax, 15			; 0000000fH
  00025	83 e2 00	 and	 edx, 0
  00028	b1 28		 mov	 cl, 40			; 00000028H
  0002a	e8 00 00 00 00	 call	 __allshl
  0002f	8b 4d fc	 mov	 ecx, DWORD PTR _SystemSegment$[ebp]
  00032	8b 31		 mov	 esi, DWORD PTR [ecx]
  00034	8b 49 04	 mov	 ecx, DWORD PTR [ecx+4]
  00037	81 e1 ff f0 ff
	ff		 and	 ecx, -3841		; fffff0ffH
  0003d	0b f0		 or	 esi, eax
  0003f	0b ca		 or	 ecx, edx
  00041	8b 55 fc	 mov	 edx, DWORD PTR _SystemSegment$[ebp]
  00044	89 32		 mov	 DWORD PTR [edx], esi
  00046	89 4a 04	 mov	 DWORD PTR [edx+4], ecx

; 1083 :     SystemSegment->Present = 1;

  00049	8b 45 fc	 mov	 eax, DWORD PTR _SystemSegment$[ebp]
  0004c	8b 08		 mov	 ecx, DWORD PTR [eax]
  0004e	8b 50 04	 mov	 edx, DWORD PTR [eax+4]
  00051	81 ca 00 80 00
	00		 or	 edx, 32768		; 00008000H
  00057	8b 45 fc	 mov	 eax, DWORD PTR _SystemSegment$[ebp]
  0005a	89 08		 mov	 DWORD PTR [eax], ecx
  0005c	89 50 04	 mov	 DWORD PTR [eax+4], edx

; 1084 : 
; 1085 :     SystemSegment->Base_23_0 = Base & 0xFFFFFF;

  0005f	8b 4d 08	 mov	 ecx, DWORD PTR _Base$[ebp]
  00062	81 e1 ff ff ff
	00		 and	 ecx, 16777215		; 00ffffffH
  00068	8b c1		 mov	 eax, ecx
  0006a	33 d2		 xor	 edx, edx
  0006c	25 ff ff ff 00	 and	 eax, 16777215		; 00ffffffH
  00071	83 e2 00	 and	 edx, 0
  00074	b1 10		 mov	 cl, 16			; 00000010H
  00076	e8 00 00 00 00	 call	 __allshl
  0007b	8b 4d fc	 mov	 ecx, DWORD PTR _SystemSegment$[ebp]
  0007e	8b 31		 mov	 esi, DWORD PTR [ecx]
  00080	81 e6 ff ff 00
	00		 and	 esi, 65535		; 0000ffffH
  00086	8b 49 04	 mov	 ecx, DWORD PTR [ecx+4]
  00089	81 e1 00 ff ff
	ff		 and	 ecx, -256		; ffffff00H
  0008f	0b f0		 or	 esi, eax
  00091	0b ca		 or	 ecx, edx
  00093	8b 55 fc	 mov	 edx, DWORD PTR _SystemSegment$[ebp]
  00096	89 32		 mov	 DWORD PTR [edx], esi
  00098	89 4a 04	 mov	 DWORD PTR [edx+4], ecx

; 1086 :     SystemSegment->Base_31_24 = (Base >> 24) & 0xFF;

  0009b	8b 45 08	 mov	 eax, DWORD PTR _Base$[ebp]
  0009e	c1 e8 18	 shr	 eax, 24			; 00000018H
  000a1	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  000a6	33 d2		 xor	 edx, edx
  000a8	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  000ad	83 e2 00	 and	 edx, 0
  000b0	b1 38		 mov	 cl, 56			; 00000038H
  000b2	e8 00 00 00 00	 call	 __allshl
  000b7	8b 4d fc	 mov	 ecx, DWORD PTR _SystemSegment$[ebp]
  000ba	8b 31		 mov	 esi, DWORD PTR [ecx]
  000bc	8b 49 04	 mov	 ecx, DWORD PTR [ecx+4]
  000bf	81 e1 ff ff ff
	00		 and	 ecx, 16777215		; 00ffffffH
  000c5	0b f0		 or	 esi, eax
  000c7	0b ca		 or	 ecx, edx
  000c9	8b 55 fc	 mov	 edx, DWORD PTR _SystemSegment$[ebp]
  000cc	89 32		 mov	 DWORD PTR [edx], esi
  000ce	89 4a 04	 mov	 DWORD PTR [edx+4], ecx

; 1087 : 
; 1088 : #if defined(BOOT_X64)
; 1089 : 
; 1090 :     SystemSegment->Base_63_32 = Base >> 32;
; 1091 : 
; 1092 : #endif
; 1093 : 
; 1094 :     if (Limit <= 0xFFFFF) {

  000d1	81 7d 0c ff ff
	0f 00		 cmp	 DWORD PTR _Limit$[ebp], 1048575 ; 000fffffH
  000d8	77 62		 ja	 SHORT $LN2@BlMmInitia@3

; 1095 : 
; 1096 :         SystemSegment->Limit_15_0 = Limit & 0xFFFF;

  000da	8b 45 0c	 mov	 eax, DWORD PTR _Limit$[ebp]
  000dd	25 ff ff 00 00	 and	 eax, 65535		; 0000ffffH
  000e2	33 c9		 xor	 ecx, ecx
  000e4	25 ff ff 00 00	 and	 eax, 65535		; 0000ffffH
  000e9	83 e1 00	 and	 ecx, 0
  000ec	8b 55 fc	 mov	 edx, DWORD PTR _SystemSegment$[ebp]
  000ef	8b 32		 mov	 esi, DWORD PTR [edx]
  000f1	81 e6 00 00 ff
	ff		 and	 esi, -65536		; ffff0000H
  000f7	8b 52 04	 mov	 edx, DWORD PTR [edx+4]
  000fa	0b f0		 or	 esi, eax
  000fc	0b d1		 or	 edx, ecx
  000fe	8b 45 fc	 mov	 eax, DWORD PTR _SystemSegment$[ebp]
  00101	89 30		 mov	 DWORD PTR [eax], esi
  00103	89 50 04	 mov	 DWORD PTR [eax+4], edx

; 1097 :         SystemSegment->Limit_19_16 = (Limit >> 16) & 0xF;

  00106	8b 4d 0c	 mov	 ecx, DWORD PTR _Limit$[ebp]
  00109	c1 e9 10	 shr	 ecx, 16			; 00000010H
  0010c	83 e1 0f	 and	 ecx, 15			; 0000000fH
  0010f	8b c1		 mov	 eax, ecx
  00111	33 d2		 xor	 edx, edx
  00113	83 e0 0f	 and	 eax, 15			; 0000000fH
  00116	83 e2 00	 and	 edx, 0
  00119	b1 30		 mov	 cl, 48			; 00000030H
  0011b	e8 00 00 00 00	 call	 __allshl
  00120	8b 4d fc	 mov	 ecx, DWORD PTR _SystemSegment$[ebp]
  00123	8b 31		 mov	 esi, DWORD PTR [ecx]
  00125	8b 49 04	 mov	 ecx, DWORD PTR [ecx+4]
  00128	81 e1 ff ff f0
	ff		 and	 ecx, -983041		; fff0ffffH
  0012e	0b f0		 or	 esi, eax
  00130	0b ca		 or	 ecx, edx
  00132	8b 55 fc	 mov	 edx, DWORD PTR _SystemSegment$[ebp]
  00135	89 32		 mov	 DWORD PTR [edx], esi
  00137	89 4a 04	 mov	 DWORD PTR [edx+4], ecx

; 1098 : 
; 1099 :     } else {

  0013a	eb 7b		 jmp	 SHORT $LN3@BlMmInitia@3
$LN2@BlMmInitia@3:

; 1100 : 
; 1101 :         SystemSegment->Granularity = 1;

  0013c	8b 45 fc	 mov	 eax, DWORD PTR _SystemSegment$[ebp]
  0013f	8b 08		 mov	 ecx, DWORD PTR [eax]
  00141	8b 50 04	 mov	 edx, DWORD PTR [eax+4]
  00144	81 ca 00 00 80
	00		 or	 edx, 8388608		; 00800000H
  0014a	8b 45 fc	 mov	 eax, DWORD PTR _SystemSegment$[ebp]
  0014d	89 08		 mov	 DWORD PTR [eax], ecx
  0014f	89 50 04	 mov	 DWORD PTR [eax+4], edx

; 1102 :         SystemSegment->Limit_15_0 = (Limit >> 12) & 0xFFFF;

  00152	8b 4d 0c	 mov	 ecx, DWORD PTR _Limit$[ebp]
  00155	c1 e9 0c	 shr	 ecx, 12			; 0000000cH
  00158	81 e1 ff ff 00
	00		 and	 ecx, 65535		; 0000ffffH
  0015e	33 d2		 xor	 edx, edx
  00160	81 e1 ff ff 00
	00		 and	 ecx, 65535		; 0000ffffH
  00166	83 e2 00	 and	 edx, 0
  00169	8b 45 fc	 mov	 eax, DWORD PTR _SystemSegment$[ebp]
  0016c	8b 30		 mov	 esi, DWORD PTR [eax]
  0016e	81 e6 00 00 ff
	ff		 and	 esi, -65536		; ffff0000H
  00174	8b 40 04	 mov	 eax, DWORD PTR [eax+4]
  00177	0b f1		 or	 esi, ecx
  00179	0b c2		 or	 eax, edx
  0017b	8b 4d fc	 mov	 ecx, DWORD PTR _SystemSegment$[ebp]
  0017e	89 31		 mov	 DWORD PTR [ecx], esi
  00180	89 41 04	 mov	 DWORD PTR [ecx+4], eax

; 1103 :         SystemSegment->Limit_19_16 = (Limit >> 28) & 0xF;

  00183	8b 55 0c	 mov	 edx, DWORD PTR _Limit$[ebp]
  00186	c1 ea 1c	 shr	 edx, 28			; 0000001cH
  00189	83 e2 0f	 and	 edx, 15			; 0000000fH
  0018c	8b c2		 mov	 eax, edx
  0018e	33 d2		 xor	 edx, edx
  00190	83 e0 0f	 and	 eax, 15			; 0000000fH
  00193	83 e2 00	 and	 edx, 0
  00196	b1 30		 mov	 cl, 48			; 00000030H
  00198	e8 00 00 00 00	 call	 __allshl
  0019d	8b 4d fc	 mov	 ecx, DWORD PTR _SystemSegment$[ebp]
  001a0	8b 31		 mov	 esi, DWORD PTR [ecx]
  001a2	8b 49 04	 mov	 ecx, DWORD PTR [ecx+4]
  001a5	81 e1 ff ff f0
	ff		 and	 ecx, -983041		; fff0ffffH
  001ab	0b f0		 or	 esi, eax
  001ad	0b ca		 or	 ecx, edx
  001af	8b 55 fc	 mov	 edx, DWORD PTR _SystemSegment$[ebp]
  001b2	89 32		 mov	 DWORD PTR [edx], esi
  001b4	89 4a 04	 mov	 DWORD PTR [edx+4], ecx
$LN3@BlMmInitia@3:

; 1104 :     }
; 1105 : 
; 1106 :     return;
; 1107 : }

  001b7	5e		 pop	 esi
  001b8	8b e5		 mov	 esp, ebp
  001ba	5d		 pop	 ebp
  001bb	c2 08 00	 ret	 8
?BlMmInitializeSystemSegment@@YIXPAU_SYSTEM_SEGMENT@@KKK@Z ENDP ; BlMmInitializeSystemSegment
_TEXT	ENDS
PUBLIC	?BlMmEnableA20Gate@@YIXXZ			; BlMmEnableA20Gate
EXTRN	?BlRtlWritePort8@@YIXGE@Z:PROC			; BlRtlWritePort8
EXTRN	?BlRtlReadPort8@@YIEG@Z:PROC			; BlRtlReadPort8
; Function compile flags: /Odtp
;	COMDAT ?BlMmEnableA20Gate@@YIXXZ
_TEXT	SEGMENT
?BlMmEnableA20Gate@@YIXXZ PROC				; BlMmEnableA20Gate, COMDAT

; 1123 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
$LN10@BlMmEnable:

; 1124 :     BL_KEYBOARD_WRITE_OUTPUT_PORT(BL_KEYBOARD_A20_ENABLE);

  00003	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  00008	e8 00 00 00 00	 call	 ?BlRtlReadPort8@@YIEG@Z	; BlRtlReadPort8
  0000d	0f b6 c0	 movzx	 eax, al
  00010	83 e0 02	 and	 eax, 2
  00013	74 02		 je	 SHORT $LN9@BlMmEnable
  00015	eb ec		 jmp	 SHORT $LN10@BlMmEnable
$LN9@BlMmEnable:
  00017	b2 d1		 mov	 dl, 209			; 000000d1H
  00019	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  0001e	e8 00 00 00 00	 call	 ?BlRtlWritePort8@@YIXGE@Z ; BlRtlWritePort8
$LN8@BlMmEnable:
  00023	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  00028	e8 00 00 00 00	 call	 ?BlRtlReadPort8@@YIEG@Z	; BlRtlReadPort8
  0002d	0f b6 c8	 movzx	 ecx, al
  00030	83 e1 02	 and	 ecx, 2
  00033	74 02		 je	 SHORT $LN7@BlMmEnable
  00035	eb ec		 jmp	 SHORT $LN8@BlMmEnable
$LN7@BlMmEnable:
  00037	b2 df		 mov	 dl, 223			; 000000dfH
  00039	b9 60 00 00 00	 mov	 ecx, 96			; 00000060H
  0003e	e8 00 00 00 00	 call	 ?BlRtlWritePort8@@YIXGE@Z ; BlRtlWritePort8
$LN6@BlMmEnable:
  00043	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  00048	e8 00 00 00 00	 call	 ?BlRtlReadPort8@@YIEG@Z	; BlRtlReadPort8
  0004d	0f b6 d0	 movzx	 edx, al
  00050	83 e2 02	 and	 edx, 2
  00053	74 02		 je	 SHORT $LN4@BlMmEnable
  00055	eb ec		 jmp	 SHORT $LN6@BlMmEnable
$LN4@BlMmEnable:

; 1125 : 
; 1126 :     BL_KEYBOARD_WRITE_COMMAND(BL_KEYBOARD_COMMAND_PULSE_OUTPUT_PORT);

  00057	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  0005c	e8 00 00 00 00	 call	 ?BlRtlReadPort8@@YIEG@Z	; BlRtlReadPort8
  00061	0f b6 c0	 movzx	 eax, al
  00064	83 e0 02	 and	 eax, 2
  00067	74 02		 je	 SHORT $LN3@BlMmEnable
  00069	eb ec		 jmp	 SHORT $LN4@BlMmEnable
$LN3@BlMmEnable:
  0006b	80 ca ff	 or	 dl, 255			; 000000ffH
  0006e	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  00073	e8 00 00 00 00	 call	 ?BlRtlWritePort8@@YIXGE@Z ; BlRtlWritePort8
$LN2@BlMmEnable:
  00078	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  0007d	e8 00 00 00 00	 call	 ?BlRtlReadPort8@@YIEG@Z	; BlRtlReadPort8
  00082	0f b6 c8	 movzx	 ecx, al
  00085	83 e1 02	 and	 ecx, 2
  00088	74 02		 je	 SHORT $LN11@BlMmEnable
  0008a	eb ec		 jmp	 SHORT $LN2@BlMmEnable
$LN11@BlMmEnable:

; 1127 : 
; 1128 :     return;
; 1129 : }

  0008c	5d		 pop	 ebp
  0008d	c3		 ret	 0
?BlMmEnableA20Gate@@YIXXZ ENDP				; BlMmEnableA20Gate
_TEXT	ENDS
PUBLIC	?BlMmGetExtendedBiosDataArea@@YIPAXXZ		; BlMmGetExtendedBiosDataArea
; Function compile flags: /Odtp
;	COMDAT ?BlMmGetExtendedBiosDataArea@@YIPAXXZ
_TEXT	SEGMENT
_Segment$ = -4						; size = 2
?BlMmGetExtendedBiosDataArea@@YIPAXXZ PROC		; BlMmGetExtendedBiosDataArea, COMDAT

; 1149 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx

; 1150 :     UINT16 Segment;
; 1151 : 
; 1152 :     Segment = *((PUINT16) (ULONG_PTR) 0x40E);

  00004	66 a1 0e 04 00
	00		 mov	 ax, WORD PTR ds:1038
  0000a	66 89 45 fc	 mov	 WORD PTR _Segment$[ebp], ax

; 1153 : 
; 1154 :     return (PVOID) (((ULONG_PTR) Segment) << 4);

  0000e	0f b7 45 fc	 movzx	 eax, WORD PTR _Segment$[ebp]
  00012	c1 e0 04	 shl	 eax, 4

; 1155 : }

  00015	8b e5		 mov	 esp, ebp
  00017	5d		 pop	 ebp
  00018	c3		 ret	 0
?BlMmGetExtendedBiosDataArea@@YIPAXXZ ENDP		; BlMmGetExtendedBiosDataArea
_TEXT	ENDS
PUBLIC	?BlMmInitializeSystem@@YIXXZ			; BlMmInitializeSystem
EXTRN	?BlPoolAllocateBlock@@YIPAXK@Z:PROC		; BlPoolAllocateBlock
EXTRN	?BlPoolInitialize@@YIXXZ:PROC			; BlPoolInitialize
EXTRN	?BlSystemMemoryMap@@3U_BL_SMAP@@A:BYTE		; BlSystemMemoryMap
EXTRN	?BlRtlInitializeListHead@@YIXPAU_LIST_ENTRY@@@Z:PROC ; BlRtlInitializeListHead
EXTRN	?BlSmapInitialize@@YIXXZ:PROC			; BlSmapInitialize
EXTRN	?BlMmGetGdtr@@YIXPAU_GDTR@@@Z:PROC		; BlMmGetGdtr
EXTRN	?BlMmGetCr3@@YIKXZ:PROC				; BlMmGetCr3
; Function compile flags: /Odtp
;	COMDAT ?BlMmInitializeSystem@@YIXXZ
_TEXT	SEGMENT
tv259 = -52						; size = 4
tv245 = -48						; size = 8
tv184 = -40						; size = 8
tv164 = -32						; size = 4
tv159 = -28						; size = 4
_Delta$ = -24						; size = 8
_SmapEntry$ = -12					; size = 4
_PhysicalRegion$ = -8					; size = 4
_Index$ = -4						; size = 4
?BlMmInitializeSystem@@YIXXZ PROC			; BlMmInitializeSystem, COMDAT

; 1170 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 34	 sub	 esp, 52			; 00000034H

; 1171 :     UINT64 Delta;
; 1172 :     UINT32 Index;
; 1173 :     PBL_MM_PHYSICAL_REGION PhysicalRegion;
; 1174 :     PBL_SMAP_ENTRY SmapEntry;
; 1175 : 
; 1176 : #if !defined(BOOT_PXE)
; 1177 :     //
; 1178 :     // Enable A20 gate.
; 1179 :     //
; 1180 : 
; 1181 :     BlMmEnableA20Gate();

  00006	e8 00 00 00 00	 call	 ?BlMmEnableA20Gate@@YIXXZ ; BlMmEnableA20Gate

; 1182 : #endif
; 1183 : 
; 1184 :     //
; 1185 :     // Get extended BIOS data area.
; 1186 :     //
; 1187 : 
; 1188 :     BlMmExtendedBiosDataArea = BlMmGetExtendedBiosDataArea();

  0000b	e8 00 00 00 00	 call	 ?BlMmGetExtendedBiosDataArea@@YIPAXXZ ; BlMmGetExtendedBiosDataArea
  00010	a3 00 00 00 00	 mov	 DWORD PTR ?BlMmExtendedBiosDataArea@@3PAXA, eax ; BlMmExtendedBiosDataArea

; 1189 : 
; 1190 :     //
; 1191 :     // Get legacy CR3 value;
; 1192 :     //
; 1193 : 
; 1194 :     BlMmLegacyCr3 = BlMmGetCr3();

  00015	e8 00 00 00 00	 call	 ?BlMmGetCr3@@YIKXZ	; BlMmGetCr3
  0001a	a3 00 00 00 00	 mov	 DWORD PTR ?BlMmLegacyCr3@@3KA, eax ; BlMmLegacyCr3

; 1195 : 
; 1196 :     //
; 1197 :     // Get initial GDTR.
; 1198 :     //
; 1199 : 
; 1200 :     BlMmGetGdtr(&BlMmInitialGdtr);

  0001f	b9 00 00 00 00	 mov	 ecx, OFFSET ?BlMmInitialGdtr@@3U_GDTR@@A ; BlMmInitialGdtr
  00024	e8 00 00 00 00	 call	 ?BlMmGetGdtr@@YIXPAU_GDTR@@@Z ; BlMmGetGdtr

; 1201 : 
; 1202 :     //
; 1203 :     // Initialize memory map.
; 1204 :     //
; 1205 : 
; 1206 :     BlSmapInitialize();

  00029	e8 00 00 00 00	 call	 ?BlSmapInitialize@@YIXXZ ; BlSmapInitialize

; 1207 : 
; 1208 :     //
; 1209 :     // Create physical region lookaside.
; 1210 :     //
; 1211 : 
; 1212 :     BlRtlInitializeListHead(&BlMmPhysicalRegionList);

  0002e	b9 00 00 00 00	 mov	 ecx, OFFSET ?BlMmPhysicalRegionList@@3U_LIST_ENTRY@@A ; BlMmPhysicalRegionList
  00033	e8 00 00 00 00	 call	 ?BlRtlInitializeListHead@@YIXPAU_LIST_ENTRY@@@Z ; BlRtlInitializeListHead

; 1213 : 
; 1214 :     BlRtlInitializeListHead(&BlMmPhysicalRegionLookaside.FreeList);

  00038	b9 80 02 00 00	 mov	 ecx, OFFSET ?BlMmPhysicalRegionLookaside@@3U<unnamed-tag>@@A+640
  0003d	e8 00 00 00 00	 call	 ?BlRtlInitializeListHead@@YIXPAU_LIST_ENTRY@@@Z ; BlRtlInitializeListHead

; 1215 : 
; 1216 :     for (Index = 0; Index < (sizeof(BlMmPhysicalRegionLookaside.StaticArray) / sizeof(BlMmPhysicalRegionLookaside.StaticArray[0])); Index += 1) {

  00042	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _Index$[ebp], 0
  00049	eb 09		 jmp	 SHORT $LN13@BlMmInitia@4
$LN12@BlMmInitia@4:
  0004b	8b 45 fc	 mov	 eax, DWORD PTR _Index$[ebp]
  0004e	83 c0 01	 add	 eax, 1
  00051	89 45 fc	 mov	 DWORD PTR _Index$[ebp], eax
$LN13@BlMmInitia@4:
  00054	83 7d fc 10	 cmp	 DWORD PTR _Index$[ebp], 16 ; 00000010H
  00058	73 18		 jae	 SHORT $LN11@BlMmInitia@4

; 1217 : 
; 1218 :         BlRtlInsertTailList(&BlMmPhysicalRegionLookaside.FreeList, &BlMmPhysicalRegionLookaside.StaticArray[Index].Entry);

  0005a	8b 55 fc	 mov	 edx, DWORD PTR _Index$[ebp]
  0005d	6b d2 28	 imul	 edx, 40			; 00000028H
  00060	81 c2 00 00 00
	00		 add	 edx, OFFSET ?BlMmPhysicalRegionLookaside@@3U<unnamed-tag>@@A ; BlMmPhysicalRegionLookaside
  00066	b9 80 02 00 00	 mov	 ecx, OFFSET ?BlMmPhysicalRegionLookaside@@3U<unnamed-tag>@@A+640
  0006b	e8 00 00 00 00	 call	 ?BlRtlInsertTailList@@YIXPAU_LIST_ENTRY@@0@Z ; BlRtlInsertTailList

; 1219 :     }

  00070	eb d9		 jmp	 SHORT $LN12@BlMmInitia@4
$LN11@BlMmInitia@4:

; 1220 : 
; 1221 :     //
; 1222 :     // Initialize page tables.
; 1223 :     //
; 1224 : 
; 1225 :     BlMmInitializePageTables();

  00072	e8 00 00 00 00	 call	 ?BlMmInitializePageTables@@YIXXZ ; BlMmInitializePageTables

; 1226 : 
; 1227 :     //
; 1228 :     // Create reserved BIOS region.
; 1229 :     //
; 1230 : 
; 1231 :     BlMmCreatePhysicalRegion(0,
; 1232 :                              BL_MM_BIOS_SIZE,
; 1233 :                              BL_MM_PHYSICAL_REGION_BIOS);

  00077	6a 00		 push	 0
  00079	68 00 00 10 00	 push	 1048576			; 00100000H
  0007e	6a 00		 push	 0
  00080	6a 00		 push	 0
  00082	b9 02 00 00 00	 mov	 ecx, 2
  00087	e8 00 00 00 00	 call	 ?BlMmCreatePhysicalRegion@@YIX_K0K@Z ; BlMmCreatePhysicalRegion

; 1234 : 
; 1235 :     //
; 1236 :     // Create free regions based on SMAP.
; 1237 :     //
; 1238 : 
; 1239 :     for (Index = 0; Index < BlSystemMemoryMap.EntryCount; Index += 1) {

  0008c	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _Index$[ebp], 0
  00093	eb 09		 jmp	 SHORT $LN10@BlMmInitia@4
$LN9@BlMmInitia@4:
  00095	8b 4d fc	 mov	 ecx, DWORD PTR _Index$[ebp]
  00098	83 c1 01	 add	 ecx, 1
  0009b	89 4d fc	 mov	 DWORD PTR _Index$[ebp], ecx
$LN10@BlMmInitia@4:
  0009e	8b 55 fc	 mov	 edx, DWORD PTR _Index$[ebp]
  000a1	3b 15 00 0c 00
	00		 cmp	 edx, DWORD PTR ?BlSystemMemoryMap@@3U_BL_SMAP@@A+3072
  000a7	0f 83 6a 01 00
	00		 jae	 $LN8@BlMmInitia@4

; 1240 : 
; 1241 :         SmapEntry = &BlSystemMemoryMap.Entry[Index];

  000ad	8b 45 fc	 mov	 eax, DWORD PTR _Index$[ebp]
  000b0	6b c0 18	 imul	 eax, 24			; 00000018H
  000b3	05 00 00 00 00	 add	 eax, OFFSET ?BlSystemMemoryMap@@3U_BL_SMAP@@A ; BlSystemMemoryMap
  000b8	89 45 f4	 mov	 DWORD PTR _SmapEntry$[ebp], eax

; 1242 : 
; 1243 :         //
; 1244 :         // Don't use any memory below 1MB (BIOS area) and above 2GB (Singularity uses MSB for marking and such).
; 1245 :         //
; 1246 : 
; 1247 :         if ((SmapEntry->Type == BL_SMAP_AVAILABLE) &&
; 1248 :             (SmapEntry->Base >= BL_MM_BIOS_SIZE) &&
; 1249 :             (SmapEntry->Base < 0x80000000UI64)
; 1250 :             ) {

  000bb	8b 4d f4	 mov	 ecx, DWORD PTR _SmapEntry$[ebp]
  000be	83 79 10 01	 cmp	 DWORD PTR [ecx+16], 1
  000c2	0f 85 4a 01 00
	00		 jne	 $LN7@BlMmInitia@4
  000c8	8b 55 f4	 mov	 edx, DWORD PTR _SmapEntry$[ebp]
  000cb	89 55 e4	 mov	 DWORD PTR tv159[ebp], edx
  000ce	8b 45 e4	 mov	 eax, DWORD PTR tv159[ebp]
  000d1	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  000d5	77 0f		 ja	 SHORT $LN16@BlMmInitia@4
  000d7	8b 4d e4	 mov	 ecx, DWORD PTR tv159[ebp]
  000da	81 39 00 00 10
	00		 cmp	 DWORD PTR [ecx], 1048576 ; 00100000H
  000e0	0f 82 2c 01 00
	00		 jb	 $LN7@BlMmInitia@4
$LN16@BlMmInitia@4:
  000e6	8b 55 f4	 mov	 edx, DWORD PTR _SmapEntry$[ebp]
  000e9	89 55 e0	 mov	 DWORD PTR tv164[ebp], edx
  000ec	8b 45 e0	 mov	 eax, DWORD PTR tv164[ebp]
  000ef	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  000f3	0f 87 19 01 00
	00		 ja	 $LN7@BlMmInitia@4
  000f9	72 0f		 jb	 SHORT $LN17@BlMmInitia@4
  000fb	8b 4d e0	 mov	 ecx, DWORD PTR tv164[ebp]
  000fe	81 39 00 00 00
	80		 cmp	 DWORD PTR [ecx], -2147483648 ; 80000000H
  00104	0f 83 08 01 00
	00		 jae	 $LN7@BlMmInitia@4
$LN17@BlMmInitia@4:

; 1251 : 
; 1252 :             if ((SmapEntry->Base % PAGE_SIZE) != 0) {

  0010a	8b 55 f4	 mov	 edx, DWORD PTR _SmapEntry$[ebp]
  0010d	6a 00		 push	 0
  0010f	68 00 10 00 00	 push	 4096			; 00001000H
  00114	8b 42 04	 mov	 eax, DWORD PTR [edx+4]
  00117	50		 push	 eax
  00118	8b 0a		 mov	 ecx, DWORD PTR [edx]
  0011a	51		 push	 ecx
  0011b	e8 00 00 00 00	 call	 __aullrem
  00120	89 45 d8	 mov	 DWORD PTR tv184[ebp], eax
  00123	89 55 dc	 mov	 DWORD PTR tv184[ebp+4], edx
  00126	8b 55 d8	 mov	 edx, DWORD PTR tv184[ebp]
  00129	0b 55 dc	 or	 edx, DWORD PTR tv184[ebp+4]
  0012c	74 58		 je	 SHORT $LN6@BlMmInitia@4

; 1253 : 
; 1254 :                 Delta = PAGE_SIZE - (SmapEntry->Base % PAGE_SIZE);

  0012e	8b 45 f4	 mov	 eax, DWORD PTR _SmapEntry$[ebp]
  00131	6a 00		 push	 0
  00133	68 00 10 00 00	 push	 4096			; 00001000H
  00138	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  0013b	51		 push	 ecx
  0013c	8b 10		 mov	 edx, DWORD PTR [eax]
  0013e	52		 push	 edx
  0013f	e8 00 00 00 00	 call	 __aullrem
  00144	b9 00 10 00 00	 mov	 ecx, 4096		; 00001000H
  00149	2b c8		 sub	 ecx, eax
  0014b	b8 00 00 00 00	 mov	 eax, 0
  00150	1b c2		 sbb	 eax, edx
  00152	89 4d e8	 mov	 DWORD PTR _Delta$[ebp], ecx
  00155	89 45 ec	 mov	 DWORD PTR _Delta$[ebp+4], eax

; 1255 :                 SmapEntry->Base += Delta;

  00158	8b 4d f4	 mov	 ecx, DWORD PTR _SmapEntry$[ebp]
  0015b	8b 11		 mov	 edx, DWORD PTR [ecx]
  0015d	03 55 e8	 add	 edx, DWORD PTR _Delta$[ebp]
  00160	8b 41 04	 mov	 eax, DWORD PTR [ecx+4]
  00163	13 45 ec	 adc	 eax, DWORD PTR _Delta$[ebp+4]
  00166	8b 4d f4	 mov	 ecx, DWORD PTR _SmapEntry$[ebp]
  00169	89 11		 mov	 DWORD PTR [ecx], edx
  0016b	89 41 04	 mov	 DWORD PTR [ecx+4], eax

; 1256 :                 SmapEntry->Size -= Delta;

  0016e	8b 55 f4	 mov	 edx, DWORD PTR _SmapEntry$[ebp]
  00171	8b 42 08	 mov	 eax, DWORD PTR [edx+8]
  00174	2b 45 e8	 sub	 eax, DWORD PTR _Delta$[ebp]
  00177	8b 4a 0c	 mov	 ecx, DWORD PTR [edx+12]
  0017a	1b 4d ec	 sbb	 ecx, DWORD PTR _Delta$[ebp+4]
  0017d	8b 55 f4	 mov	 edx, DWORD PTR _SmapEntry$[ebp]
  00180	89 42 08	 mov	 DWORD PTR [edx+8], eax
  00183	89 4a 0c	 mov	 DWORD PTR [edx+12], ecx
$LN6@BlMmInitia@4:

; 1257 :             }
; 1258 : 
; 1259 :             SmapEntry->Size &= (~(0xFFFUI64));

  00186	8b 45 f4	 mov	 eax, DWORD PTR _SmapEntry$[ebp]
  00189	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  0018c	81 e1 00 f0 ff
	ff		 and	 ecx, -4096		; fffff000H
  00192	8b 50 0c	 mov	 edx, DWORD PTR [eax+12]
  00195	8b 45 f4	 mov	 eax, DWORD PTR _SmapEntry$[ebp]
  00198	89 48 08	 mov	 DWORD PTR [eax+8], ecx
  0019b	89 50 0c	 mov	 DWORD PTR [eax+12], edx

; 1260 : 
; 1261 :             if ((SmapEntry->Base + SmapEntry->Size) > 0x80000000UI64) {

  0019e	8b 4d f4	 mov	 ecx, DWORD PTR _SmapEntry$[ebp]
  001a1	8b 55 f4	 mov	 edx, DWORD PTR _SmapEntry$[ebp]
  001a4	8b 01		 mov	 eax, DWORD PTR [ecx]
  001a6	03 42 08	 add	 eax, DWORD PTR [edx+8]
  001a9	8b 49 04	 mov	 ecx, DWORD PTR [ecx+4]
  001ac	13 4a 0c	 adc	 ecx, DWORD PTR [edx+12]
  001af	89 45 d0	 mov	 DWORD PTR tv245[ebp], eax
  001b2	89 4d d4	 mov	 DWORD PTR tv245[ebp+4], ecx
  001b5	75 09		 jne	 SHORT $LN18@BlMmInitia@4
  001b7	81 7d d0 00 00
	00 80		 cmp	 DWORD PTR tv245[ebp], -2147483648 ; 80000000H
  001be	76 1b		 jbe	 SHORT $LN5@BlMmInitia@4
$LN18@BlMmInitia@4:

; 1262 : 
; 1263 :                 SmapEntry->Size = 0x80000000UI64 - SmapEntry->Base;

  001c0	8b 55 f4	 mov	 edx, DWORD PTR _SmapEntry$[ebp]
  001c3	b8 00 00 00 80	 mov	 eax, -2147483648	; 80000000H
  001c8	2b 02		 sub	 eax, DWORD PTR [edx]
  001ca	b9 00 00 00 00	 mov	 ecx, 0
  001cf	1b 4a 04	 sbb	 ecx, DWORD PTR [edx+4]
  001d2	8b 55 f4	 mov	 edx, DWORD PTR _SmapEntry$[ebp]
  001d5	89 42 08	 mov	 DWORD PTR [edx+8], eax
  001d8	89 4a 0c	 mov	 DWORD PTR [edx+12], ecx
$LN5@BlMmInitia@4:

; 1264 :             }
; 1265 : 
; 1266 :             if (SmapEntry->Size > 0) {

  001db	8b 45 f4	 mov	 eax, DWORD PTR _SmapEntry$[ebp]
  001de	89 45 cc	 mov	 DWORD PTR tv259[ebp], eax
  001e1	8b 4d cc	 mov	 ecx, DWORD PTR tv259[ebp]
  001e4	83 79 0c 00	 cmp	 DWORD PTR [ecx+12], 0
  001e8	77 09		 ja	 SHORT $LN19@BlMmInitia@4
  001ea	8b 55 cc	 mov	 edx, DWORD PTR tv259[ebp]
  001ed	83 7a 08 00	 cmp	 DWORD PTR [edx+8], 0
  001f1	76 1f		 jbe	 SHORT $LN7@BlMmInitia@4
$LN19@BlMmInitia@4:

; 1267 : 
; 1268 :                 BlMmCreatePhysicalRegion(SmapEntry->Base,
; 1269 :                                          SmapEntry->Size,
; 1270 :                                          BL_MM_PHYSICAL_REGION_FREE);

  001f3	8b 45 f4	 mov	 eax, DWORD PTR _SmapEntry$[ebp]
  001f6	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  001f9	51		 push	 ecx
  001fa	8b 50 08	 mov	 edx, DWORD PTR [eax+8]
  001fd	52		 push	 edx
  001fe	8b 45 f4	 mov	 eax, DWORD PTR _SmapEntry$[ebp]
  00201	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  00204	51		 push	 ecx
  00205	8b 10		 mov	 edx, DWORD PTR [eax]
  00207	52		 push	 edx
  00208	b9 01 00 00 00	 mov	 ecx, 1
  0020d	e8 00 00 00 00	 call	 ?BlMmCreatePhysicalRegion@@YIX_K0K@Z ; BlMmCreatePhysicalRegion
$LN7@BlMmInitia@4:

; 1271 :             }
; 1272 :         }
; 1273 :     }

  00212	e9 7e fe ff ff	 jmp	 $LN9@BlMmInitia@4
$LN8@BlMmInitia@4:

; 1274 : 
; 1275 :     //
; 1276 :     // Initialize pool.
; 1277 :     //
; 1278 : 
; 1279 :     BlPoolInitialize();

  00217	e8 00 00 00 00	 call	 ?BlPoolInitialize@@YIXXZ ; BlPoolInitialize

; 1280 : 
; 1281 :     //
; 1282 :     // Add more entries to the physical region lookaside.
; 1283 :     //
; 1284 : 
; 1285 :     for (Index = 0; Index < 256; Index += 1) {

  0021c	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _Index$[ebp], 0
  00223	eb 09		 jmp	 SHORT $LN3@BlMmInitia@4
$LN2@BlMmInitia@4:
  00225	8b 45 fc	 mov	 eax, DWORD PTR _Index$[ebp]
  00228	83 c0 01	 add	 eax, 1
  0022b	89 45 fc	 mov	 DWORD PTR _Index$[ebp], eax
$LN3@BlMmInitia@4:
  0022e	81 7d fc 00 01
	00 00		 cmp	 DWORD PTR _Index$[ebp], 256 ; 00000100H
  00235	73 1c		 jae	 SHORT $LN14@BlMmInitia@4

; 1286 : 
; 1287 :         PhysicalRegion = (PBL_MM_PHYSICAL_REGION)
; 1288 :             BlPoolAllocateBlock(sizeof(BL_MM_PHYSICAL_REGION));

  00237	b9 28 00 00 00	 mov	 ecx, 40			; 00000028H
  0023c	e8 00 00 00 00	 call	 ?BlPoolAllocateBlock@@YIPAXK@Z ; BlPoolAllocateBlock
  00241	89 45 f8	 mov	 DWORD PTR _PhysicalRegion$[ebp], eax

; 1289 : 
; 1290 :         BlRtlInsertTailList(&BlMmPhysicalRegionLookaside.FreeList, &PhysicalRegion->Entry);

  00244	8b 55 f8	 mov	 edx, DWORD PTR _PhysicalRegion$[ebp]
  00247	b9 80 02 00 00	 mov	 ecx, OFFSET ?BlMmPhysicalRegionLookaside@@3U<unnamed-tag>@@A+640
  0024c	e8 00 00 00 00	 call	 ?BlRtlInsertTailList@@YIXPAU_LIST_ENTRY@@0@Z ; BlRtlInsertTailList

; 1291 :     }

  00251	eb d2		 jmp	 SHORT $LN2@BlMmInitia@4
$LN14@BlMmInitia@4:

; 1292 : 
; 1293 :     return;
; 1294 : }

  00253	8b e5		 mov	 esp, ebp
  00255	5d		 pop	 ebp
  00256	c3		 ret	 0
?BlMmInitializeSystem@@YIXXZ ENDP			; BlMmInitializeSystem
_TEXT	ENDS
END
