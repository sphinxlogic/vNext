<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>COM in plain C, Part 4 - CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/Main.css">

    <script type="text/javascript" async="" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/analytics.js"></script><script type="text/javascript" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/jquery.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/article.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/MemberProfilePopup.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/a.js" defer="defer"></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="Make a COM object with multiple interfaces, in C.">
<meta name="Keywords" content="C++, C, Windows, Visual-Studio, Dev, COM, Beginner,COM / COM+,Platforms, Frameworks &amp; Libraries,Free source code, tutorials">
<meta name="Author" content="Jeff Glatt">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4">
<meta name="twitter: card" content="summary">
<meta name="twitter: site" content="@CodeProject">
<meta property="og:url" content="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4">
<meta property="og:title" content="COM in plain C, Part 4">
<meta property="og:description" content="Make a COM object with multiple interfaces, in C.">

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Artificial Intelligence" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=31">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4"
   },
  "headline": "COM in plain C, Part 4",
  "url": "https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4",
  "discussionUrl": "https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4#_comments",
  "isFamilyFriendly": "true",
  "image": "https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "C++,C,Windows,Visual-Studio,Dev,COM,Beginner",
  "commentCount": "12",
  "editor" : {
    "@type" : "Person",
    "name" : "Smitha Nishant",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=28970"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "Make a COM object with multiple interfaces, in C.",
  "articleSection": "COM / COM+",
  "author" : [{
      "@type" : "Person",
      "name" : "Jeff Glatt",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=88625"
    }],
  "datePublished": "2006-05-16",
  "dateCreated": "2006-05-16",
  "dateModified": "2006-05-16"
,
  "aggregateRating" : {
    "@type" : "aggregateRating",
    "ratingValue" : 4.95,
    "ratingCount" : 31,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/8/Platforms-Frameworks-Libraries.aspx",
      "name" : "Platforms, Frameworks & Libraries"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/COM/",
      "name" : "COM / COM+"
    }
  }]
}</script>


	<!-- base href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4" -->
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





<!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" type="text/javascript" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': '55e1d411-e955-4cb4-9978-1528f21616a2'});
    </script>


<style type="text/css"></style></head>	

<body class="firefox firefox72">

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">14,417,643 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		<span id="ctl00_MemberBar_ReadLaterList_ReadLaterListDiv" class="tooltip member-message">
	<span id="ReadLaterListIcon" class="readlaterlist-count openable hidden"></span>
	<div class="tooltip-flyout readlaterlist-dropdown">
		<div id="ItemsToRead" class="readlaterlist-list"></div>
	</div>
</span><span id="ctl00_MemberBar_Messages_NotificationDiv" class="tooltip member-message">
	<a id="ctl00_MemberBar_Messages_NotificationCount" title="1 message" class="notification-count openable" href="https://www.codeproject.com/script/Membership/MyNotifications.aspx">1</a>

	<div class="tooltip-flyout notification-dropdown">
		

		<div id="ctl00_MemberBar_Messages_Confirm" class="bold spaced">
            <img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/caution.png" style="width:20px;height:20px;vertical-align:bottom">
            <a id="ctl00_MemberBar_Messages_EmailConfirm" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f14117%2fCOM-in-plain-C-Part-4">Click here to confirm your email address. </a>
		</div>

		
		
		<div id="Notifications" class="notification-list">
			<img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/loading24.gif" alt="loading" style="margin:auto;">
		</div>
		<div class="spaced">
			
		</div>
	</div>
</span><span id="ctl00_MemberBar_TotalPoints" title="Total reputation points"><a class="bold member-rep-box silver" title="Reputation points earned: 828" href="https://www.codeproject.com/script/Reputation/List.aspx?mid=527156">828</a></span><span id="ctl00_MemberBar_CurRat" class="member-links tooltip openable">
				<a id="ctl00_MemberBar_MyProfile" class="me desktop-only tablet-only" dir="ltr" href="https://www.codeproject.com/Members/jon57">jon57</a>
                <a id="ctl00_MemberBar_MyProfileMob" class="me mobile-only" href="https://www.codeproject.com/Members/jon57">☰</a>
                <div class="tooltip-flyout">
					
					<div class="list-item"><a id="ctl00_MemberBar_MySettingsDefault" href="https://www.codeproject.com/script/Membership/Modify.aspx">My Settings</a></div>
					
					<div class="list-item"><a id="ctl00_MemberBar_MyBookmarks" href="https://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2">My Bookmarks</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyArticles" href="https://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=527156">My Articles</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyMessages" href="https://www.codeproject.com/script/Forums/Messages.aspx?fmid=527156">My Messages</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyQuestions" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=questions&amp;mid=527156&amp;showall=True">My Questions</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyAnswers" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=answers&amp;mid=527156&amp;showall=True">My Answers</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyComments" href="https://www.codeproject.com/script/comments/MemberComments.aspx?mid=527156">My Comments</a></div>
					
					
					<div id="ctl00_MemberBar_MyFollowingHolder">
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowing" href="https://www.codeproject.com/script/follow/Edit.aspx">Things I Follow</a></div>
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowers" href="https://www.codeproject.com/script/follow/Followers.aspx">My Followers</a></div>
					</div>
					
        
					<form name="unsubForm" id="unsubForm" action="/script/Membership/LogOff.aspx?rp=%2fArticles%2f14117%2fCOM-in-plain-C-Part-4" method="post" class="tight">
                    <input type="hidden" name="AntiForgeryToken" value="e82756ee-ccd1-43de-910d-7f5dd2636494">
                    <input type="submit" value="Sign out" class="list-item border-none extended align-left" onclick="return doSignout();" style="background-color: transparent; color: #999; cursor:pointer">
                    
                    </form>

                    <script type="text/javascript">//<!--
			        function doSignout()
			        {
    			        document.unsubForm.action = "/script/Membership/LogOff.aspx?rp=%2fArticles%2f14117%2fCOM-in-plain-C-Part-4"
				        document.unsubForm.submit();
				        return true;
			        }//-->
			        </script>
                    
				</div>
			</span>

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/COM" data-country="US" data-tags="C++, C, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=728x90&c=284926"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=728x90&c=284926"  width="728px" height="90px" target="_blank"/></a></noscript></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table class="search" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><input tabindex="2" class="search subdue" id="sb_tb" autocomplete="off" value="Search for articles, questions, tips" name="q"></td><td><input type="image" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		
		
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/write13.png" width="13" height="13"> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="https://www.codeproject.com/script/Articles/ImportArticle.aspx">
			<img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/write13.png" width="13" height="13"> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/write13.png" width="13" height="13"> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">View VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">View ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=93" style="padding-left:30px">View SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues.aspx">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript.aspx">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools.aspx">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift.aspx">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database.aspx">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1942421/Linux-Programming.aspx">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android.aspx">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS.aspx">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1540733/SharePoint.aspx">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development.aspx">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch.aspx">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">stuff</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="https://www.codeproject.com/KB/showcase/">Product Showcase</a></li>
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Contests/Winners.aspx?obtid=1&amp;cmpTpId=2&amp;cid=0">Most Valuable Professionals</a></li>
		

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="https://www.codeproject.com/Forums/1939564/Where-I-am-Member-Photos.aspx">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>
		<li></li>
		

		
		<li class="openable"><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">Non-English Language
			<span class="has-submenu">&gt;</span></a>
		<ul>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		
		</ul>
		</li><li class="last"></li>
		
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> » <a href="https://www.codeproject.com/Chapters/8/Platforms-Frameworks-Libraries.aspx">Platforms, Frameworks &amp; Libraries</a> » <a href="https://www.codeproject.com/KB/COM/">COM / COM+</a> » <a href="https://www.codeproject.com/KB/COM/#COM">COM</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
                
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    <a id="ctl00_ActionLinks_ArticleFollow_FollowBtn" title="" class="button unfollowed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Have any updates for this Article appear in your Timeline so you can stay up to date" style="display: inline-block;">Follow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have any updates for this Article appear in your Timeline so you can stay up to date</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_ActionLinks_ArticleFollow_UnfollowBtn" title="" class="button followed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Stop following this Article" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Article</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

</div>



<span id="ctl00_ActionLinks_BookmarkMd_bookmark" data-type="bookmark" data-ref="2_14117_1" data-size="medium" data-mode="bookmark"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/bookmark48.png" style="width:24px;height:24px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span> 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?display=Print" class="tooltip" title="">
   <img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/print48.png" style="border:0" width="24px" height="24px">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="/Articles/14117/COM-in-plain-C-Part-4" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="GAAEl37YDS6UIxR1o0IQzVckhMBkB9i17B6MjrdVzt175bpAJZJc2CBH8vok1BOFMHb5+qHK3zC2qxoZTWj3nV9mIFOzA9WHYGEWLcD/ECyOKXaC2+zVqeUI01IrlrZVp9wsQVW3TR4FeVZIWVQ/j5Qzc/S1qelBjFW1QGw2xlaqhWD9bXPrHM5egUk7lok81NymOz0abFWh9qq/tK/64AQ8qTcJ23fXUBqAXIBz06YRIIeUce7gmaMLckJD60tVshElD36tC1eOS1Ngi/VFfvfdPfudBfy+Mks9oxInFZE+OqOxIi3eekGXpvBMHllGLnhJ2aTo+CwxinkzrxOmp8Bp2aAlS5J5VyHS1w3ZnrU0ANJbi0cnd4qewRBX8ROjF4ZkyoPUFQ43Edqt++WHMvGl3ksciCkrU0yfjvR5G/5HIIAKnW/OlDbQrx1ZVogETnMFxOq3TadKYrQr0+lRE5ZEoWNTnntLAFNnDMm5Zkqyfx6DyvXz0AzVdx1fE7RhPgP2AlrXRUuNpDWjKu144/59kcH2YNBvsPhswodKmhzMXzqF8yTAeLGojLcmzY8tB6jy5XlqeRfZbHqdD2IlGI8xv3J3COPFPr2Q13sSh/ZC6UNfSzRNVRK+xXLHy1WZxHtto4Qwygj3nDPmCEs+q1yfIiJx3zFUVyCkgZhdgFzsd73xjZXHUZjBnX/3gRk29rSJbkjFNmfmwymHT9uuRuXdkvq22t9EXTeE657SoztPf2dnupuH8AWpRz96gqwC4+yLsJD5B4YQUvb3lR9i+BclQoLeQ8qf8pWQT+SuNpSCzMdZG9vm7jIsNrYT2muaVsPsEKGjBsAMOIXmVAvrzl3bTPX7WVQSF8zL0mP5wdk9fKZ58YI581JdHonlSfFytO+6ZWd0Qik8geIfFXbOeS1cja0kMQd9GrP5PCdzaNNPXkXWdOGg7X7cYCrzrN5O/X1Wwnxn1o1g/9W4yjALY5C4iOjSe7ZSHe1Xh7NSyiyetZc7FW5SB4x0Jle+gTOzgoo1IQOMlwGMSeaRK+NwKEHpuX9xqzpJOT+7Gmyx/d72iyAnWFt6PRkkfLH9LNj7Zv7CkvSrF+8ODWTLEuUq5zhq+wiqP95PUU6GtaGWR6nRCB2qBiLaEjKcYVIlYyAF0zAkB1CHTxjvHz09qKnk81u0s/5C+hnYnn4GJsunP25jQhb/Sh8nWeMmt7f6rYrOR1OVSfED4Seuiu8A2SvjbsNsIO5W8PfGrxdA0q5rgEkURi0BqfsqiJs/wrgRHU4we/bQ16bjilLb/BR72/6R4axGXlAJakmaYfKdh5Uf3SPe29dA7jeZNwmp/Pfq0U+MJF4YKWpJ1kV9H1nalEtjS/iiEB74ddkiv3lqzIv158a/JDXi7NnLOhGBztlplF+UNBdooZ4or9jkYGoqdWMQlRmiH4oYsUpEnkvRtPh6JuWtXXlyJGTyURyDfYWrVK/HqVgbu3Ez+YG6UN+BhGw1bXNjw2MF7ikMKooH4iJ3IiAEuIK1oxJarwfhX0HMcuirrNwovq6NbNgG7FtvHwaGmsVUbikjVky0J87UlzETb+K8iLR/6IlV0G9VvhvNslaMVBkZB5KcNPgH4PwrLvtonmIEpGD9qNYbYR8CBPOBCMBgo8dzQ08ITzTVP/1lcelEd5gVg6PlqmnDiNj6J3Sr6h0AZfN+wxINkttTFV8j3T8b9rWdol+Bax7Rr9lZazfw5tihJu3DiBaZ0+RopZWq5QtGUa5jSaaAdFlz4cTKSNdZ15U2TUCN80OYjkDnfS8kdZ7phgo9xKamD0pad6+1Z7kARkiZxXool4kw/+16lOYywaQPSJJIl5ivzQPXVm1bV3AaeQYoEQsp51gMedAaGhNoilnncSOk08cjNMDR6Jbt5OMZQXU6GhPmLRSR6Faa2NmanzR8SbwWC0g9ala6QVFXb1LQeu2dlFnnufjcICrXq7KhzR7e9uMEC7bv9/o1zr03voSI9OzvR7Z2nYiyMcc8SA/vAJ0hXwWveYuhQIFPEV/D927PC35zhw7hwOW3Yc8Dqn4xig8unQwmH3P7swjL9JWvO1Ghg0RR/3nOXxStkg9lJyPu7NtJCsjV5/CNpkPWbXonXF+DW9Vla2pA7b7Nh7uz01zlLekbOa6/RDBDCi+Dt4i2mI4ZwWVuKqQCNacwPPhDvZ9eN9Q1hYopYE0ZljY4j7EkDateRNoCSNvb2/zb/VVY68k5K5OtSKMKpsN6//CQyHIxXWQLXMgTw1WAY/srXBO0a2lvC+SWLOaVNrRpaCrllMtlKaCbwbQOPlyThQul3i0bgPyjhs2xUT7/FtB5W7RrwCs01W2SoCbodnau8aylXUHARBPE4+HbRw6RlaTQtVDm16nu6MiIG6X6d/fdnPtzYKiG+wTnYNzvPlINoxh3nYWbryxD+WwOpHDGZg==">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">COM in plain C, Part 4</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

                                

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625" rel="author">Jeff Glatt</a></span> 

                                        <div class="flex-item" style="margin-top:-7px;height:35px">
                                            <div id="ctl00_RateArticle_RateItemWrapper" class="container-rating small-text" name="RateItem_14117">

	<table class="small-text" width="100%" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right">
			<span class="align-right"></span>
			<img class="loading invisible" alt="loading..." src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/loading16.gif" width="16px" height="16px"> 
		</td>

	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tbody><tr>
				
				<td id="ctl00_RateArticle_StartForm" nowrap="nowrap" align="right"><b>Rate me!</b> </td>

				<td id="ctl00_RateArticle_VoteFormDiv" class="nowrap tooltip rating-stars-voter-large" style="padding-top:1px">

                    
					

<meta itemprop="upvoteCount" content="30">


<table id="ctl00_RateArticle_ItemRating_RatingTable" style="margin:0 1px;" class="hide-on-hover float-left" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td class="nowrap">

        <div style="width:120px;height:28px;position:relative" class="nowrap rating-stars-large"><div style="width:118px;height:24px;" class="clipped align-left float-left"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/stars-fill-lg.png"></div><div style="width:2px;height:24px;position:relative" class="clipped"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/stars-empty-lg.png" style="position:absolute;top:0;right:0"></div>

		
	</div></td>
		<td id="ctl00_RateArticle_ItemRating_VR" class="nowrap">
		<span id="ctl00_RateArticle_ItemRating_VotesR">4.95  (31 votes)</span>
		
	</td>
	</tr>
</tbody></table>

<span id="ctl00_RateArticle_ItemRating_RatingText"></span>


                    
					<span id="ctl00_RateArticle_RB" class="ajaxHist radio voting show-on-hover" style="display: none;">
						<span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5" style="display: none;"></span> 
					<div class="rating-star-block"><a href="#" rating="1" class="star outline" title="vote 1">vote 1</a><a href="#" rating="2" class="star outline" title="vote 2">vote 2</a><a href="#" rating="3" class="star outline" title="vote 3">vote 3</a><a href="#" rating="4" class="star outline" title="vote 4">vote 4</a><a href="#" rating="5" class="star outline" title="vote 5">vote 5</a></div></span>

                    
					

                    
	                <div id="ctl00_RateArticle_RCD" class="hover-container tooltip-flyout rating-comment" style="top:12px">
		                Add a reason or comment to your vote:
                        <a href="#" id="clear-rate_ctl00_RateArticle_RCD" title="close" class="rating-close">x</a>
                        <br>
                        <textarea class="RateComment" rows="5" cols="60" style="width:96%;"></textarea>
		                <span id="ctl00_RateArticle_CommentReq" class="subdue">Adding a comment to your rating is optional</span>
		            </div>

                    
                        

				</td>

				
                <td id="ctl00_RateArticle_VR" class="nowrap show-on-hover tooltip" style="display: none;">

		            <span id="ctl00_RateArticle_VotesR">4.95  (31 votes)</span>

                    
					<div id="ctl00_RateArticle_histPHR" class="speech-bubble-container-up-right" style="width:175px;margin-top:24px;right:-15px;top:6px">
						<div class="speech-bubble-up-right">
							<div id="ctl00_RateArticle_HistogramR">

</div>
							<img id="ctl00_RateArticle_LoadingR" class="align-middle" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/loading24.gif" style="border-width:0px;">
						</div>
						<div class="speech-bubble-pointer-up-right">
							<div class="speech-bubble-pointer-up-right-inner"></div>
						</div>
					</div>
                </td>


				<td style="padding-left:5px">	
					<input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button" style="display: none;">
				</td>
			</tr>
			</tbody></table>

			
		</td>
	</tr>
	</tbody></table>

</div>
                                        </div>
                                    </div>

                                    <div class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">16 May 2006</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_description" class="summary">Make a COM object with multiple interfaces, in C.</div><span id="ctl00_thumbnailUrl" class="date" content="https://codeproject.global.ssl.fastly.net/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					
					

						
					

					<div id="ctl00_confirmError" class="advise"><img style="float:left;margin-right:10px" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/warning48.png" width="48px" height="48px"><b>Is your email address OK?</b> You are signed up for our 
						newsletters but your email address is either unconfirmed, or has not been 
						reconfirmed in a long time. Please <b>click <a id="ctl00_RequestConfirmLink2" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f14117%2fCOM-in-plain-C-Part-4">here</a> to have a confirmation email
                        sent</b> so we can confirm your email address and start sending you 
                        newsletters again. Alternatively, you can 
						<a id="ctl00_SubscribeLink2" href="https://www.codeproject.com/script/Membership/Subscribe.aspx">update your subscriptions</a>.</div>

						
						<div id="contentdiv" class="text">
						



<ul class="download">
<li><a href="https://www.codeproject.com/KB/COM/com_in__c4/com_in__c4_src.zip">Download source files - 194 Kb</a> </li></ul>
<h2>Contents</h2>
<ul>
<li><a href="#INTRO">Introduction</a> 
</li><li><a href="#EMBED">Embedding sub-objects in our object</a> 
</li><li><a href="#BASE">How an app obtains the base object</a> 
</li><li><a href="#SUB">How an app obtains a sub object from the base object</a> 
</li><li><a href="#SUB2">How an app obtains an object from another sub-object</a> 
</li><li><a href="#DELE">Delegation</a> 
</li><li><a href="#UNK1">QueryInterface, AddRef, and Release of our base object</a> 
</li><li><a href="#UNK2">QueryInterface, AddRef, and Release of our sub-objects</a> 
</li><li><a href="#ADD">Another way to add a sub-object to our object</a> 
</li><li><a href="#DLL">An example object with multiple interfaces</a> 
</li><li><a href="#EXAM">An example C app that uses our object</a> 
</li><li><a href="#NEXT">What's next?</a> </li></ul>
<h2><a name="INTRO">Introduction</a></h2>
<p>Sometimes, a COM object may have what is called <i>multiple interfaces</i>.
 Saying that a COM object has multiple interfaces is just another way of
 saying that the object is composed of several "sub-objects". Each 
sub-object is itself a full COM object, with its own <code>lpVtbl</code> member (pointer to its own VTable), and its own VTable set of functions (including its own <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code> functions).</p>
<p>An object may have numerous kinds of sub-objects. For example, let's 
say that our object manages one audio card. An audio card can have 
several input and output jacks upon it. Let's say that we want to have a
 sub-object for each input/output jack. For example, let's assume we 
have a Line In jack, a Mic In jack, and a Speaker Out jack. We, 
therefore, may have three sub-objects called <code>ILineIn</code>, <code>IMicIn</code>, and <code>ISpeakerOut</code>.
 Each individual object may have functions that specifically control its
 individual jack. For example, maybe the Mic In jack has a setting 
whereby the jack can be switched between accepting a low impedance, or a
 high impedance, microphone. So, our <code>IMicIn</code> object may have a <code>SetImpedance</code> function. But the <code>ILineIn</code> and <code>ISpeakerOut</code> objects do not need such a function because that setting isn't pertinent to those jacks. Maybe the <code>ILineIn</code> and/or <code>ISpeakerOut</code> objects may need other functions that are specific to those jacks. Let's say that the <code>ILineIn</code> has a function called <code>Mute</code> to mute the signal. Our <code>ISpeakerOut</code> has a function called <code>SetVolume</code>
 to set its volume. Here is how we may define these three objects, using
 the macro that Microsoft has provided to define a COM object:</p><div class="pre-action-link" id="premain522695" style="width:100%;display:block;"><span id="prehide522695" onclick="processCodeBlocks.togglePre(522695);">Hide</span>  &nbsp; <span id="preShrink522695" onclick="processCodeBlocks.shrinkExpand(522695);">Shrink</span> <img id="preimg522695" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(522695);">  &nbsp; <span id="copycode522695" onclick="return processCodeBlocks.copyCode(522695);">Copy Code</span></div><pre id="pre522695" style="margin-top: 0px;" processed="true" class="notranslate">#undef  INTERFACE
#define INTERFACE  IMicIn
DECLARE_INTERFACE_ (INTERFACE, IUnknown)
{
   STDMETHOD  (QueryInterface) (THIS_ REFIID, void **) PURE;
   STDMETHOD_ (ULONG, AddRef)  (THIS) PURE;
   STDMETHOD_ (ULONG, Release) (THIS) PURE;
   STDMETHOD  (SetImpedance)   (THIS_ long) PURE;
};

#undef  INTERFACE
#define INTERFACE  ILineIn
DECLARE_INTERFACE_ (INTERFACE, IUnknown)
{
   STDMETHOD  (QueryInterface) (THIS_ REFIID, void **) PURE;
   STDMETHOD_ (ULONG, AddRef)  (THIS) PURE;
   STDMETHOD_ (ULONG, Release) (THIS) PURE;
   STDMETHOD  (Mute)           (THIS_ long) PURE;
};

#undef  INTERFACE
#define INTERFACE  ISpeakerOut
DECLARE_INTERFACE_ (INTERFACE, IUnknown)
{
   STDMETHOD  (QueryInterface) (THIS_ REFIID, void **) PURE;
   STDMETHOD_ (ULONG, AddRef)  (THIS) PURE;
   STDMETHOD_ (ULONG, Release) (THIS) PURE;
   STDMETHOD  (SetVolume)      (THIS_ long) PURE;
};</pre>
<p>Notice that each sub-object's VTable begins with its own <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code> functions, as all COM objects must. After this, we list any extra functions that are in the object's VTable. So, <code>IMicIn</code> has its <code>SetImpedance</code> function, <code>ILineIn</code> has its <code>Mute</code> function, and <code>ISpeakerOut</code> has its <code>SetVolume</code> function. (For demonstration, I've defined each of these to be passed one argument -- a <code>long</code> value. In the case of <code>SetImpedance</code>, this may be the impedance value. For <code>Mute</code>, this may be a 1 for mute or 0 for un-mute. For <code>SetVolume</code>, this may be the volume level.)</p>
<blockquote><b>Note:</b> I haven't added any <code>IDispatch</code> functions to these sub-objects (and have not specified that their VTable is based upon <code>IDispatch</code>). Instead, I've omitted the <code>IDispatch</code> functions, and specified that the VTable is based upon <code>IUnknown</code>.
 Therefore, none of these sub-objects' functions are directly callable 
by script languages such as VBScript or JScript. That's OK, because 
those script languages are not designed to be able to use multiple 
interface objects anyway.</blockquote>
<p>Also, remember that the above macro also automatically defines the object itself as having one member, <code>lpVtbl</code> -- a pointer to its VTable:</p><div class="pre-action-link" id="premain979469" style="width:100%;display:block;"><span id="prehide979469" onclick="processCodeBlocks.togglePre(979469);">Hide</span>  &nbsp; <span id="copycode979469" onclick="return processCodeBlocks.copyCode(979469);">Copy Code</span></div><pre id="pre979469" style="margin-top: 0px;" class="notranslate">typedef struct {
   IMicInVtbl  *lpVtbl;
} IMicIn;

typedef struct {
   ILineInVtbl  *lpVtbl;
} ILineIn;

typedef struct {
   ISpeakerOutVtbl  *lpVtbl;
} ISpeakerOut;</pre>
<h2><a name="EMBED">Embedding</a> sub-objects in our object</h2>
<p>There are a few rules concerning the sub-objects. One of the 
sub-objects is considered to be the "base object", and its VTable 
pointer must be the very first member of our object itself. For example,
 let's say that we want our <code>IMicIn</code> sub-object to be the base object. We could define our object (which we'll call an <code>IAudioCard</code>) as so, embedding the <code>IMicIn</code> sub-object first, and embedding the other sub-objects after:</p><div class="pre-action-link" id="premain39393" style="width:100%;display:block;"><span id="prehide39393" onclick="processCodeBlocks.togglePre(39393);">Hide</span>  &nbsp; <span id="copycode39393" onclick="return processCodeBlocks.copyCode(39393);">Copy Code</span></div><pre id="pre39393" style="margin-top: 0px;" class="notranslate">typedef struct {
   IMicIn       mic;     // Our IMicIn (base) sub-object.
   ILineIn      line;    // Our ILineIn sub-object.
   ISpeakerOut  speaker; // Our ISpeakerOut sub-object.
} IAudioCard;</pre>
<p>Remember that the very first member of an <code>IMicIn</code> is its <code>lpVtbl</code> (i.e., pointer to its VTable). And since our <code>IMicIn</code> is embedded directly inside of our <code>IAudioCard</code> object at the very start of the struct, this means the very first member inside of our <code>IAudioCard</code> object is effectively a pointer to <code>IMicIn</code>'s VTable. This is how <code>IMicIn</code> becomes the base object. So, <code>IAudioCard</code> does indeed begin with a pointer to a VTable (because that's what <code>IMicIn</code> begins with), and its VTable does in fact begin with the three functions <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code>.</p>
<p>Another rule is that every sub-object's VTable must have its own GUID. So, we would need to run <i>GUIDGEN.EXE</i> to create GUIDs for the <code>IMicIn</code>, <code>ILineIn</code>, and <code>ISpeakerOut</code> VTables. And, we would need a GUID for our <code>IAudioCard</code> object itself.</p>
<h2><a name="BASE">How</a> an app obtains the base object</h2>
<p>Typically, an app would get hold of the base object (in this case, our <code>IMicIn</code>) by calling our <code>IClassFactory</code>'s <code>CreateInstance</code>, passing the GUID for our <code>IAudioCard</code>.
 (Or to get our base object, maybe the app would call some extra 
function we've added to another one of our objects, like how we returned
 our collection object or <code>IEnumVARIANT</code> objects in the previous part of this series.) Our <code>IClassFactory</code>'s <code>CreateInstance</code> would then return a pointer to our base object.</p><div class="pre-action-link" id="premain945457" style="width:100%;display:block;"><span id="prehide945457" onclick="processCodeBlocks.togglePre(945457);">Hide</span>  &nbsp; <span id="preShrink945457" onclick="processCodeBlocks.shrinkExpand(945457);">Shrink</span> <img id="preimg945457" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(945457);">  &nbsp; <span id="copycode945457" onclick="return processCodeBlocks.copyCode(945457);">Copy Code</span></div><pre id="pre945457" style="margin-top: 0px;" processed="true" class="notranslate">// How an app gets IAudioCard's base object. Error-checking omitted!

// Include the .H file that defines the VTables of
// our IAudioCard sub-objects, and has all of the
// needed GUIDs.
#include "IAudioCard.h"

// First, we need to get IAudioCard's base object. Let's assume we
// do this by calling CoCreateInstance. We must pass the GUID for the
// DLL containing the IAudioCard object. Let's assume that this GUID
// has been given the name CLSID_IAudioCard in IAudioCard.h. We must
// also pass the IAudioCard object's GUID which we'll assume is
// given the name IID_IAudioCard. CoCreateInstance returns a pointer
// to IAudioCard's base object, which we store in our audioCard variable.
// Note that we've declared our audioCard variable as an IUknown *. This
// is because we don't really know what kind of object that base object
// is. (Well, it's going to be an IMicIn object. But if this DLL was
// written by someone else, we may not have been told what kind of
// object the base object really is). All we know is that it definitely
// has a QueryInterface function, since all COM objects start with that one.
IUnknown    *audioCard;

CoCreateInstance(&amp;CLSID_IAudioCard, 0, CLSCTX_ALL, &amp;IID_IAudioCard,
     (void **)&amp;audioCard);

// "audioCard" now contains a pointer to the base object (whatever it
// is -- in this case, it will be an IMicIn, but we'd typically
// follow up with a call to QueryInterface, passing IID_IMicIn
// if we specifically want the IMicIn).</pre>
<h2><a name="SUB">How</a> an app obtains a sub-object from the base object</h2>
<p>The way that an app gets hold of one of our <code>IAudioCard</code>'s sub-objects is by calling the base object's (<code>IMicIn</code>'s) <code>QueryInterface</code> function, passing the VTable GUID of the sub-object it wants. (And now, you see the other purpose of the <code>QueryInterface</code> function, besides allowing an app to verify what kind of object it has. <code>QueryInterface</code> is also used to obtain sub-objects of a multiple interface object.) What this means is that the base object's <code>QueryInterface</code>
 function should be able to recognize when an app passes the GUID of any
 of the other sub-objects' VTables, locate that sub-object, and return 
(to the app) a pointer to that sub-object.</p>
<p>So, if an app wants to get our <code>ISpeakerOut</code> object, it must first get our <code>IAudioCard</code>'s base object. Then, the app must call that base object's <code>QueryInterface</code>, passing the GUID of our <code>ISpeakerOut</code>'s VTable. <code>QueryInterface</code> will return a pointer to our <code>ISpeakerOut</code> object.</p><div class="pre-action-link" id="premain709794" style="width:100%;display:block;"><span id="prehide709794" onclick="processCodeBlocks.togglePre(709794);">Hide</span>  &nbsp; <span id="copycode709794" onclick="return processCodeBlocks.copyCode(709794);">Copy Code</span></div><pre id="pre709794" style="margin-top: 0px;" class="notranslate">// How an app gets IAudioCard's ISpeakerOut sub-object.
// Error-checking omitted!

IUnknown    *audioCard;
ISpeakerOut *speakerOut;

// Get IAudioCard's base object.
CoCreateInstance(&amp;CLSID_IAudioCard, 0, CLSCTX_ALL, &amp;IID_IAudioCard,
     (void **)&amp;audioCard);

// Now that we've got the base object (whatever it is) in "audioCard", let's
// call its QueryInterface, asking for its ISpeakerOut sub-object. We call the
// base object's QueryInterface, passing the GUID of ISpeakerOut's VTable,
// which we'll assume has the name IID_ISpeakerOut. QueryInterface will
// store this pointer in "speakerOut".
audioCard-&gt;lpVtbl-&gt;QueryInterface(audioCard, &amp;IID_ISpeakerOut,
     &amp;speakerOut);

// Now that we've got the ISpeakerOut, we can Release the base object.
// NOTE: If the base object happened to be the ISpeakerOut, then both
// "speakerOut" and "audioCard" are the same pointer (object). But
// CoCreateInstance has done an AddRef on it for us. And QueryInterface
// has also done an AddRef on it for us. So the Release below undoes
// only one of the AddRef's. Our ISpeakerOut isn't going away, because
// we still need to do one more Release on it.
audioCard-&gt;lpVtbl-&gt;Release(audioCard);</pre>
<h2><a name="SUB2">How</a> an app obtains an object from another sub-object</h2>
<p>Another rule is that a base object can't be deleted until all of the other sub-objects have been <code>Release</code>d by the app. If the app is holding onto any pointers to sub-objects, the base object must stick around (even if the app has <code>Release</code>'d its hold on the base object). Why? Well, this has to do with the next rule.</p>
<p>As usual, every sub-object's <code>QueryInterface</code> function must be able to recognize being passed its own GUID. (I.e., <code>IMicIn</code>'s <code>QueryInterface</code> must recognize its own VTable GUID, and <code>ISpeakerOut</code> must recognize its own VTable GUID, and <code>ILineIn</code> must recognize its own VTable GUID.) But, each sub-object's <code>QueryInterface</code> must also recognize its base object's GUID, and be able to return a pointer to that base object.</p>
<p>For example, an app can pass our <code>IAudioCard</code> VTable's GUID to <code>ISpeakerOut</code>'s <code>QueryInterface</code> function. <code>ISpeakerOut</code>'s <code>QueryInterface</code>
 must recognize this and return a pointer to the base object. What this 
should tell you is that each sub-object needs to be able to locate the 
base object. And of course, this means that the base object must exist 
while any other sub-object exists.</p><div class="pre-action-link" id="premain208299" style="width:100%;display:block;"><span id="prehide208299" onclick="processCodeBlocks.togglePre(208299);">Hide</span>  &nbsp; <span id="copycode208299" onclick="return processCodeBlocks.copyCode(208299);">Copy Code</span></div><pre id="pre208299" style="margin-top: 0px;" class="notranslate">// How an app gets IAudioCard's base object from
// its ISpeakerOut sub-object. Error-checking omitted!

// Assume that we've got a pointer to the ISpeakerOut sub-object
// in our variable "speakerOut". To get the base object, we call
// ISpeakerOut's QueryInterface, passing the GUID of IAudioCard's
// VTable. Here, QueryInterface stores that pointer in our
// variable "audioCard".

IUnknown    *audioCard;

speakerOut-&gt;lpVtbl-&gt;QueryInterface(speakerOut, 
                &amp;IID_IAudioCard, &amp;audioCard);

// Note: We must audioCard-&gt;lpVtbl-&gt;Release(audioCard) when
// we're done with the base object.</pre>
<p>In fact, every sub-object must be able to recognize the VTable GUIDs 
of every other sub-object, and locate/return a pointer to that other 
sub-object.</p>
<p>For example, an app can pass our <code>ILineIn</code> VTable's GUID to <code>ISpeakerOut</code>'s <code>QueryInterface</code> function. <code>ISpeakerOut</code>'s <code>QueryInterface</code> must recognize this, and return a pointer to the <code>ILineIn</code> sub-object.</p><div class="pre-action-link" id="premain919039" style="width:100%;display:block;"><span id="prehide919039" onclick="processCodeBlocks.togglePre(919039);">Hide</span>  &nbsp; <span id="copycode919039" onclick="return processCodeBlocks.copyCode(919039);">Copy Code</span></div><pre id="pre919039" style="margin-top: 0px;" class="notranslate">// How an app gets the ILineIn sub-object from the ISpeakerOut sub-object.
// Error-checking omitted!

// Assume that we've got a pointer to the ISpeakerOut sub-object
// in our variable "speakerOut". To get the ILineIn sub-object, we call
// ISpeakerOut's QueryInterface, passing the GUID of ILineIn's
// VTable. Here, QueryInterface stores that pointer in our
// variable "lineIn".

ILineIn    *lineIn;

speakerOut-&gt;lpVtbl-&gt;QueryInterface(speakerOut, &amp;IID_ILineIn,
    &amp;lineIn);

// Note: We must lineIn-&gt;lpVtbl-&gt;Release(lineIn) when
// we're done with the ILineIn.</pre>
<h2><a name="DELE">Delegation</a></h2>
<p>So, we must ensure that the <code>QueryInterface</code> of every sub-object can recognize the GUIDs of every other sub-object's VTable, and our <code>IAudioCard</code>'s VTable, and return a pointer to the appropriate sub-object.</p>
<p>How are we going to accomplish this?</p>
<p>Since we've already determined that a base object must recognize all 
of the different VTable GUIDs (including its own), and return a pointer 
to the appropriate sub-object, our base object's <code>QueryInterface</code> already does all the work of locating/returning any sub-object. So, all that the <code>QueryInterface</code> of any other sub-object needs to do is call its base object's <code>QueryInterface</code>. In other words, the sub-object's <code>QueryInterface</code>
 "passes the buck" to the base object. After all, if the sub-object can 
get a pointer to its base object, it can call its base's <code>QueryInterface</code>, just like an app would.</p>
<p>And to keep the base object from disappearing before all of the other
 sub-objects are released, whenever the base returns a sub-object, we 
will have to increment its reference count. This reference count will be
 complementarily decremented each time the app <code>Release</code>s a 
sub-object. In this way, the base's reference count will not hit zero 
until all outstanding pointers to both the base, as well as all other 
sub-objects, have been <code>Release</code>d. But note that if an app calls some sub-object's <code>AddRef</code>
 function, we must increment the base's reference count too. It must be 
so to keep the base's reference count synchronized with how many times 
we expect the app to <code>Release</code> the sub-objects. So, a sub-object's <code>AddRef</code> and <code>Release</code> functions will also call the base's <code>AddRef</code> and <code>Release</code> functions, respectively. Thus, the base's reference count is incremented each time one of the other sub-objects is <code>AddRef</code>ed, and decremented each time one of the sub-objects is <code>Release</code>d.</p>
<p>When a sub-object calls its base's <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code>, we refer to this as <i>delegation</i>. The sub-object is delegating (to its base) some of the work the sub-object itself is supposed to be doing.</p>
<h2><a name="UNK1">QueryInterface</a>, AddRef, and Release of our base object</h2>
<p>As shown earlier, we can define our <code>IAudioCard</code> to actually embed the three sub-objects right inside of it. Because we've chosen the <code>IMicIn</code> as the base object, it must be first. We must also add a reference count member to our object.</p><div class="pre-action-link" id="premain720146" style="width:100%;display:block;"><span id="prehide720146" onclick="processCodeBlocks.togglePre(720146);">Hide</span>  &nbsp; <span id="copycode720146" onclick="return processCodeBlocks.copyCode(720146);">Copy Code</span></div><pre id="pre720146" style="margin-top: 0px;" class="notranslate">typedef struct {
   IMicIn      mic;     // Our IMicIn (base) sub-object.
   ILineIn     line;    // Our ILineIn sub-object.
   ISpeakerOut speaker; // Our ISpeakerOut sub-object.
   long        count;   // The reference count.
} IAudioCard;</pre>
<p>As soon as our <code>IAudioCard</code> object is allocated (presumably by our <code>IClassFactory</code>'s <code>CreateInstance</code>), all three sub-objects are simultaneously allocated (because they exist directly inside of the <code>IAudioCard</code>). So, we can initialize the sub-objects right then and there, stuffing their VTables into their respective <code>lpVtbl</code> members.</p>
<p>For example, our <code>IClassFactory</code>'s <code>CreateInstance</code> may do something like this:</p><div class="pre-action-link" id="premain32022" style="width:100%;display:block;"><span id="prehide32022" onclick="processCodeBlocks.togglePre(32022);">Hide</span>  &nbsp; <span id="copycode32022" onclick="return processCodeBlocks.copyCode(32022);">Copy Code</span></div><pre id="pre32022" style="margin-top: 0px;" class="notranslate">IAudioCard  *thisObj

// Allocate the IAudioCard (and its 3 embedded sub-objects).
thisobj = (IAudioCard *)GlobalAlloc(GMEM_FIXED, sizeof(IAudioCard));

// Store IMicIn's VTable in its lpVtbl member.
thisobj-&gt;mic.lpVtbl = &amp;IMicIn_Vtbl;

// Store ILineIn's VTable in its lpVtbl member.
thisobj-&gt;line.lpVtbl = &amp;ILineIn_Vtbl;

// Store ISpeakOut's VTable in its lpVtbl member.
thisobj-&gt;speaker.lpVtbl = &amp;ISpeakerOut_Vtbl;</pre>
<p>After this, <code>CreateInstance</code> would call the base object's (<code>IMicIn</code>'s) <code>QueryInterface</code> to check that the app passed our <code>IID_IAudioCard</code> GUID, and to fill in the app's pointer with the base (<code>IMicIn</code>) object.</p>
<p>When an app asks our base object's <code>QueryInterface</code> for a sub-object, we can simply use pointer arithmetic to locate it within our <code>IAudioCard</code> object. For example, here's how <code>IMicIn</code>'s <code>QueryInterface</code> locates the <code>ISpeakerOut</code> child object (assuming "<code>this</code>" is a pointer to <code>IMicIn</code>):</p><div class="pre-action-link" id="premain803800" style="width:100%;display:block;"><span id="prehide803800" onclick="processCodeBlocks.togglePre(803800);">Hide</span>  &nbsp; <span id="copycode803800" onclick="return processCodeBlocks.copyCode(803800);">Copy Code</span></div><pre id="pre803800" style="margin-top: 0px;" class="notranslate">// Is the app asking for our ISpeakerOut sub-object? If it
// passed ISpeakerOut's VTable GUID, that's the case.
if (IsEqualIID(vTableGuid, &amp;IID_ISpeakerOut))

   // Just locate the ISpeakerOut object embedded directly
   // inside of IAudioCard
   *ppv = ((unsigned char *)this + offsetof(IAudioCard, speaker));</pre>
<h2><a name="UNK2">QueryInterface</a>, AddRef, and Release of our sub-objects</h2>
<p>Because each sub-object also exists directly inside of our <code>IAudioCard</code>, the sub-object can also use pointer arithmetic to locate the base (<code>IMicIn</code>) object. For example, <code>ISpeakerOut</code>'s <code>QueryInterface</code> can call <code>IMicIn</code>'s <code>QueryInterface</code> like so (assuming that "<code>this</code>" is the <code>ISpeakerOut</code>):</p><div class="pre-action-link" id="premain607889" style="width:100%;display:block;"><span id="prehide607889" onclick="processCodeBlocks.togglePre(607889);">Hide</span>  &nbsp; <span id="copycode607889" onclick="return processCodeBlocks.copyCode(607889);">Copy Code</span></div><pre id="pre607889" style="margin-top: 0px;" class="notranslate">IMicIn  *base;

base = (IMicIn *)((unsigned char *)this - 
                   offsetof(IAudioCard, speaker));
base-&gt;lpVtbl-&gt;QueryInterface(base, tableGuid, ppv);</pre>
<h2><a name="ADD">Another</a> way to add a sub-object to our object</h2>
<p>Another way we can choose to add sub-objects to our object is to have our base object's <code>QueryInterface</code>
 allocate and initialize the other sub-object when the app first asks 
for that sub-object. The sub-object will not actually exist until the 
app asks for it.</p>
<p><b>Note:</b> The base object cannot be implemented this way. It must be embedded.</p>
<p>To facilitate this, we'll add an extra member to our <code>IAudioCard</code> for each sub-object. This member will be a pointer to the sub-object. For example, our <code>IAudioCard</code> object may look like this:</p><div class="pre-action-link" id="premain127289" style="width:100%;display:block;"><span id="prehide127289" onclick="processCodeBlocks.togglePre(127289);">Hide</span>  &nbsp; <span id="copycode127289" onclick="return processCodeBlocks.copyCode(127289);">Copy Code</span></div><pre id="pre127289" style="margin-top: 0px;" class="notranslate">typedef struct {
   IMicIn      mic;      // Our base (IMicIn) object.
                         // It must be directly embedded.
   ILineIn     *line;    // A pointer to the ILineIn object.
   ISpeakerOut *speaker; // A pointer to the ISpeakerOut object.
   long        count;    // The reference count.
} IAudioCard;</pre>
<p>When the <code>IAudioCard</code> itself is allocated, we would zero out those pointers because the sub-objects are not yet created. In <code>IMicIn</code>'s <code>QueryInterface</code>, when an app asks for one of the sub-objects, we would <code>GlobalAlloc</code> and initialize it then, and then stuff the pointer to it into its respective <code>IAudioCard</code> member. Then, we'd return that pointer to the app. The next time the app calls our <code>QueryInterface</code> asking for that same object, we'd simply return the same pointer we stored.</p>
<p>But since a sub-object needs to be able to find the base object, 
we'll need to add an extra pointer member to each sub-object. That extra
 member will store a pointer to its base. So, our <code>ISpeakerOut</code> object may look like this:</p><div class="pre-action-link" id="premain501376" style="width:100%;display:block;"><span id="prehide501376" onclick="processCodeBlocks.togglePre(501376);">Hide</span>  &nbsp; <span id="copycode501376" onclick="return processCodeBlocks.copyCode(501376);">Copy Code</span></div><pre id="pre501376" style="margin-top: 0px;" class="notranslate">typedef struct {
   ISpeakerOutVtbl  *lpVtbl;   // Our ISpeakerOut's VTable. Must be first.
   // NOTE: The sub-objects do not need their own reference count.
   // Instead, they increment/decrement the base's count.
   IMicIn           *base;     // A pointer to the base object.
} ISpeakerOut;</pre>
<p>Immediately after <code>IMicIn</code>'s <code>QueryInterface</code> allocates the <code>ISpeakerOut</code> object, <code>IMicIn</code> will stuff a pointer to itself into the <code>base</code> member of the <code>ISpeakerOut</code> sub-object.</p>
<p>For example, <code>IMicIn</code>'s <code>QueryInterface</code> may return an <code>ISpeakerOut</code> sub-object as so:</p><div class="pre-action-link" id="premain55254" style="width:100%;display:block;"><span id="prehide55254" onclick="processCodeBlocks.togglePre(55254);">Hide</span>  &nbsp; <span id="preShrink55254" onclick="processCodeBlocks.shrinkExpand(55254);">Shrink</span> <img id="preimg55254" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(55254);">  &nbsp; <span id="copycode55254" onclick="return processCodeBlocks.copyCode(55254);">Copy Code</span></div><pre id="pre55254" style="margin-top: 0px;" processed="true" class="notranslate">// Is the app asking for our ISpeakerOut sub-object? If it
// passed ISpeakerOut's VTable GUID, that's the case.
if (IsEqualIID(vTableGuid, &amp;IID_ISpeakerOut))
{
   IAudioCard   *myObj;

   // Because our IMicIn is the base object, "this" is effectively
   // pointing to our IAudioCard too.
   myObj = (IAudioCard *)this;

   // If we've already allocated the ISpeakerOut, then our
   // IAudioCard-&gt;speaker member points to it. We just need
   // to return that pointer.
   if (!myObj-&gt;speaker)
   {
      // We didn't allocate the ISpeakerOut yet. Let's do so now,
      // and save the pointer in our IAudioCard-&gt;speaker member.
      if (!(myObj-&gt;speaker = (ISpeakerOut *)GlobaAlloc(GMEM_FIXED,
           sizeof(ISpeakerOut))))
         return(E_OUTOFMEMORY);

      // Set the base member.
      myObj-&gt;speaker-&gt;base = this;

      // Set ISpeakerOut's VTable into its lpVtbl member.
      myObj-&gt;speaker-&gt;lpVtbl = &amp;ISpeakerOut_Vtbl;
   }

   // Return the ISpeakerOut sub-object.
   *ppv = myObj-&gt;speaker;
}</pre>
<p>When the app finally <code>Release</code>s our <code>IAudioCard</code> object and all its sub-objects, we'll need to check those pointer members (in <code>IAudioCard</code>'s <code>Release</code>) and <code>GlobalFree</code> any existing sub-objects (right before we <code>GlobalFree</code> our <code>IAudioCard</code> itself).</p>
<p>Now, when our <code>ISpeakerOut</code>'s <code>QueryInterface</code> needs to call its base's <code>QueryInterface</code>, all the <code>ISpeakerOut</code> needs to do is (assuming "<code>this</code>" is a pointer to <code>ISpeakerOut</code>):</p><div class="pre-action-link" id="premain994505" style="width:100%;display:block;"><span id="prehide994505" onclick="processCodeBlocks.togglePre(994505);">Hide</span>  &nbsp; <span id="copycode994505" onclick="return processCodeBlocks.copyCode(994505);">Copy Code</span></div><pre id="pre994505" style="margin-top: 0px;" class="notranslate">this-&gt;base-&gt;lpVtbl-&gt;QueryInterface(this-&gt;base, tableGuid, ppv);</pre>
<p>The choice is up to you whether you want to embed a sub-object 
directly inside of your object, or just put a pointer to the sub-object 
inside the object and then allocate the sub-object separately. 
Allocating the sub-objects separately means that large sub-objects don't
 need to exist until/unless the app actually needs them. So, if a 
particular sub-object has lots of private data members, this won't 
consume memory needlessly. On the other hand, embedding the sub-objects 
saves having to add an extra pointer member to every sub-object, and if 
it's likely that the app is going to ask for those sub-objects anyway, 
they may as well exist as soon as their parent object is created.</p>
<p>In fact, you could even mix the techniques, having some sub-objects embedded and others allocated separately.</p>
<h2><a name="DLL">An</a> example object with multiple interfaces</h2>
<p>Let's create an object that has multiple interfaces. We'll call this object an <code>IMultInterface</code>, and we'll create a DLL named <i>IMultInterface.DLL</i> containing our object. Our object will contain a base object that we'll call an <code>IBase</code>, and two additional sub-objects called <code>ISub1</code> and <code>ISub2</code>, respectively. For the sake of illustration, we'll embed <code>ISub1</code> directly inside of our <code>IMultInterface</code> (and of course, our <code>IBase</code> must be embedded too at the start), but we'll allocate <code>ISub2</code> separately.</p>
<p>In the directory <i>IMultInterface</i>, you'll find the source files.</p>
<p>Rather than put the functions of all three sub-objects into one source file, we'll put them in three separate files, named <i>IBase.c</i>, <i>Sub1.c</i>, and <i>Sub2.c</i>.</p>
<p><i>IMultInterface.h</i> contains the definitions of the three sub-objects, plus all the GUIDs.</p>
<p>Just for illustration, I've added an extra function to <code>IBase</code> called <code>Sum</code>. An app passes two <code>long</code>s to this function, and it returns a sum of those two values (in a pointer to a <code>long</code> supplied by the app).</p>
<p>I've added an extra function to <code>ISub1</code> called <code>ShowMessage</code>. An app passes a string to this function, and it displays a message box.</p>
<p>I've added three extra functions to <code>ISub2</code> called <code>Increment</code>, <code>Decrement</code>, and <code>GetValue</code>. The first function increments a <code>long</code> member of <code>ISub2</code>. The second function decrements that <code>long</code> member. And, the last function retrieves its current value.</p>
<p>I've defined our <code>IMultInterface</code> object in a separate include file named <i>IMultInterface2.h</i>. Why? Because an app is going to <code>#include</code> our <i>IMultInterface.h</i> file, and we don't want the app to know anything about the actual, internal structure of our <code>IMultInterface</code>. So, we've put that latter information in a separate <i>.H</i> file that will be <code>#include</code>d only by our <i>IBase.c</i>, <i>ISub1.c</i>, and <i>ISub2.c</i> files.</p>
<p>I've put our <code>IClassFactory</code> into <i>IBase.c</i>. If you peruse <i>IBase.c</i>, you'll notice that this base object is almost exactly like the <code>IExample</code> object from our very first chapter. In fact, a lot of the code is copied verbatim from <i>IExample.c</i>, with comments removed from the duplicate code. What comments remain in <i>IBase.c</i> concern what needed to be done to add <code>ISub1</code> and <code>ISub2</code> as sub-objects to <code>IMultInterface</code>. There really isn't much new here. The biggest change is to the base object's <code>QueryInterface</code> and <code>Release</code> functions. <code>IBase</code>'s <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code> functions are renamed to prepend <b>IBase_</b> to them, and also removed <code>static</code> from them. Since <code>ISub1</code> and <code>ISub2</code>'s code will be in separate files, and they need to call the base object's <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code>, we need to make those latter functions global, and avoid name conflicts.</p>
<p>Also, there is some minor retooling to our <code>IClassFactory</code>'s <code>CreateInstance</code>.</p>
<p>After you compile this code into the DLL <i>IMultInterface.dll</i>, you can register it by modifying the installer we created in our very first chapter (whose source is in the <i>RegIExample</i> directory). Simply replace all instances of <code>IExample</code> with <code>IMultInterface</code>. You can create an uninstaller by doing the same to <i>UnregIExample</i>.</p>
<h2><a name="EXAM">An</a> example C app that uses our object</h2>
<p>In the directory <i>IMultInterfaceApp</i>, is an example C app that uses our <code>IMultIterface</code>
 object (i.e., its three sub-objects). Peruse the comments in the code 
to see how the app gets the base object, and can get any sub-object from
 another sub-object.</p>
<h2><a name="NEXT">What's</a> next?</h2>
<p>As mentioned earlier, an object with multiple interfaces can't be 
directly used by script languages such as VBScript or JScript. Why? 
Because in order to get a sub-object, the script would have to be able 
to call the <code>QueryInterface</code> function. And to call <code>QueryInterface</code>, the script must reference the pointer to the VTable (our object's <code>lpVtbl</code> member). But VBScript and JScript have no concept of how to access a pointer.</p>
<p>So, does this mean that multiple interface objects are totally 
useless to VBScript or JScript? Not necessarily. The VBScript and 
JScript engines themselves could call our object's <code>QueryInterface</code>
 on behalf of the script. Is there any particular instance when the 
engine may do that? Yes -- when hooking up "event sinks", which will be 
the topic of the next chapter.</p>


						</div>
						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/COM" data-country="US" data-loadonview="true" data-tags="C++, C, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=300x250&c=284926"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=300x250&c=284926"  width="300px" height="250px" target="_blank"/></a></noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

    <ul class="rrssb-buttons clearfix rrssb-1">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=COM%20in%20plain%20C%2c%20Part%204%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f14117%2fCOM-in-plain-C-Part-4%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=COM+in+plain+C%2c+Part+4+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f14117%2fCOM-in-plain-C-Part-4" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                        C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14117%2fCOM-in-plain-C-Part-4" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14117%2fCOM-in-plain-C-Part-4&amp;title=COM+in+plain+C%2c+Part+4+-+CodeProject&amp;summary=&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14117%2fCOM-in-plain-C-Part-4&amp;title=COM+in+plain+C%2c+Part+4+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14117%2fCOM-in-plain-C-Part-4&amp;description=COM+in+plain+C%2c+Part+4+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    

<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/member_unknown.gif" style="border-width:0px;transform:rotate(1deg);">
    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="https://www.codeproject.com/Members/Jeff-Glatt">Jeff Glatt</a></b>

        <table>
        <tbody><tr>
            <td rowspan="2" valign="middle" nowrap="nowrap">
            
            </td>
            <td nowrap="nowrap">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle"></span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
                </div>
            </td>
            <td rowspan="2" style="padding-left:15px">
                <a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn" title="" class="button unfollowed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Have the articles and posts from this member appear in your Timeline so you can stay up to date." style="display: inline-block;">Follow<div class="tiny-text" style="margin-top:-3px;">this Member</div><div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have the articles and posts from this member appear in your Timeline so you can stay up to date.</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn" title="" class="button followed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Stop following this Member" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Member</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">United States <img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/US.gif" alt="United States" width="16px" height="11px"></span>
            </td>
        </tr>
        </tbody></table>
    </div>

    <div class="description">
        No Biography provided

        
    </div>

</div><br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/COM" data-country="US" data-loadonview="true" data-tags="C++, C, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5,pos_bottom" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=728x90&c=284926"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=728x90&c=284926"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellspacing="0" cellpadding="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="3px" border="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="button new-message compose float-left">
<a rel="nofollow" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;floc=/Articles/14117/COM-in-plain-C-Part-4" name="Frm_HoverNL" target="_top">Add a Comment or Question&nbsp;</a>
</div><div class="admin-links float-left align-middle" style="width:90px;line-height:24px;margin-top:4px;">
&nbsp;<a href="https://www.codeproject.com/KB/FAQs/MessageBoardsFAQ.aspx"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/help_sm.png" title="FAQ" alt="FAQ" style="border-width:0;width:16px;height:16px;vertical-align:middle;"></a>
</div><div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="306318"><input type="hidden" name="sbo" value="fm"><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search subdue" autocomplete="off" name="qf" value="Search Comments"><input type="image" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/search.gif">
</form>
</div><div class="tooltip email-alert" id="ctl00_MessageBoard_SubscribeDiv">
	<span class="nowrap medium-text">Email Alerts</span><div class="tooltip-flyout" style="width: 335px;margin-top: 24px;left: -270px;padding: 7px;">
		<b>Email me</b><input type="checkbox" id="ctl00_MessageBoard_SubscribeNew"><label for="ctl00_MessageBoard_SubscribeNew">New Posts</label><input type="checkbox" id="ctl00_MessageBoard_SubscribeReplies"><label for="ctl00_MessageBoard_SubscribeReplies">Replies to Posts</label><br><br><b>Send them</b><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeInstant"><label for="ctl00_MessageBoard_SubscribeInstant">Instantly</label><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeDaily"><label for="ctl00_MessageBoard_SubscribeDaily">Daily</label>&nbsp; <b>For</b> <select id="ctl00_MessageBoard_MessageType" class="tiny-text" style="width:80px;">
			<option value="0" selected="selected">
				All Types
			</option><option value="128">
				Announcements
			</option>
		</select><button class="button safe float-right update">Update</button>
	</div>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?floc=%2fArticles%2f14117%2fCOM-in-plain-C-Part-4&amp;fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="306318"><input type="hidden" name="currentQS" value="floc=%2fArticles%2f14117%2fCOM-in-plain-C-Part-4&amp;fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True"><input type="hidden" name="floc" value="/Articles/14117/COM-in-plain-C-Part-4">Spacing<select size="1" class="dropdown" name="spc">
<option selected="selected" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view">
<option selected="selected" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="selected" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table width="100%" cellspacing="0" cellpadding="2px" border="0">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span> <span class="nav-link disabled">Next</span></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table class="fixed-layout blank-background" width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr id="F2009007_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx2009007xx"></a><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2009007" parent="0" thread="2009007" href="https://www.codeproject.com/Messages/2009007/an-error-confuse.aspx">an error [confuse]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">eantaru</span><span class="date">27-Apr-07  1:11</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3461993">eantaru</a></span></td><td class="date"><span>27-Apr-07  1:11&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2009007_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="3461993" msgid="2009007" votingtype="GoodOrBad" done="true"><a href="#xx2009007xx" onclick="return rateItem(5, 2009007,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3461993);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2009007xx" onclick="return rateItem(1, 2009007,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3461993);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">sorry for my english<br>
<br>
1&gt;GetSMSMsgStoreDlg.obj : error LNK2001: unresolved external symbol 
"public: virtual long __cdecl CMailRuleClient::QueryInterface(struct 
_GUID const &amp;,void * *)" 
(?QueryInterface@CMailRuleClient@@UAAJABU_GUID@@PAPAX@Z)<br>
1&gt;GetSMSMsgStoreDlg.obj : error LNK2001: unresolved external symbol 
"public: virtual unsigned long __cdecl CMailRuleClient::AddRef(void)" 
(?AddRef@CMailRuleClient@@UAAKXZ)<br>
1&gt;GetSMSMsgStoreDlg.obj : error LNK2001: unresolved external symbol 
"public: virtual unsigned long __cdecl CMailRuleClient::Release(void)" 
(?Release@CMailRuleClient@@UAAKXZ)<br>
1&gt;GetSMSMsgStoreDlg.obj : error LNK2001: unresolved external symbol 
"public: virtual long __cdecl CMailRuleClient::Initialize(struct 
IMsgStore *,enum _MRCACCESS *)" 
(?Initialize@CMailRuleClient@@UAAJPAUIMsgStore@@PAW4_MRCACCESS@@@Z)<br>
<br>
<br>
they are errors, what suppose i to do ?? i really dont get it<br>
<br>
<br>
<br>
<br>
<br>
 <br>
<br>
<div class="ForumSig">death by chocolate ^ ^</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=2009007&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=2009007&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2009007" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2009007" data-ref="3_2009007" class="rating-label" name="RateItem_2009007"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2009007/an-error-confuse.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2009007"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="3461993" msgid="2009007"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2009119_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx2009119xx"></a><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2009119" parent="2009007" thread="2009007" href="https://www.codeproject.com/Messages/2009119/Re-an-error-confuse.aspx">Re: an error [confuse]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">27-Apr-07  3:13</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>27-Apr-07  3:13&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2009119_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="2009119" votingtype="GoodOrBad" done="true"><a href="#xx2009119xx" onclick="return rateItem(5, 2009119,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2009119xx" onclick="return rateItem(1, 2009119,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2009007);" href="https://www.codeproject.com/Messages/2009007/an-error-confuse.aspx"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Um, you aren't trying to mix C and C++ code, are you?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=2009119&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=2009119&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2009007" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2009119" data-ref="3_2009119" class="rating-label" name="RateItem_2009119"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2009119/Re-an-error-confuse.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2009119"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="2009119"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2009127_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx2009127xx"></a><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2009127" parent="2009119" thread="2009007" href="https://www.codeproject.com/Messages/2009127/Re-an-error-confuse.aspx">Re: an error [confuse]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">eantaru</span><span class="date">27-Apr-07  3:22</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3461993">eantaru</a></span></td><td class="date"><span>27-Apr-07  3:22&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2009127_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="3461993" msgid="2009127" votingtype="GoodOrBad" done="true"><a href="#xx2009127xx" onclick="return rateItem(5, 2009127,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3461993);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2009127xx" onclick="return rateItem(1, 2009127,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3461993);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2009119);" href="https://www.codeproject.com/Messages/2009119/Re-an-error-confuse.aspx"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>no i dont.<br>
<br>
acctualy i want to read sms inbox in smartphone that using windows mobile 2005, do u has any suggestion ?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=2009127&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=2009127&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2009007" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2009127" data-ref="3_2009127" class="rating-label" name="RateItem_2009127"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2009127/Re-an-error-confuse.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2009127"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="3461993" msgid="2009127"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2009216_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="74px"><a name="xx2009216xx"></a><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2009216" parent="2009127" thread="2009007" href="https://www.codeproject.com/Messages/2009216/Re-an-error-confuse.aspx">Re: an error [confuse]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">27-Apr-07  4:13</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>27-Apr-07  4:13&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2009216_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:74px;"><span class="voteform vertical" ownerid="88625" msgid="2009216" votingtype="GoodOrBad" done="true"><a href="#xx2009216xx" onclick="return rateItem(5, 2009216,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2009216xx" onclick="return rateItem(1, 2009216,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2009127);" href="https://www.codeproject.com/Messages/2009127/Re-an-error-confuse.aspx"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I'm
 not familiar with this particular object CMailRuleClient. Perhaps it's 
some object that you're supposed to implement, and you aren't. You'll 
have to consult the documentation for whatever it is you're using.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=2009216&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=2009216&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2009007" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2009216" data-ref="3_2009216" class="rating-label" name="RateItem_2009216"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2009216/Re-an-error-confuse.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2009216"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="2009216"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2009250_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="92px"><a name="xx2009250xx"></a><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2009250" parent="2009216" thread="2009007" href="https://www.codeproject.com/Messages/2009250/Re-an-error-confuse.aspx">Re: an error [confuse]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">eantaru</span><span class="date">27-Apr-07  4:34</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3461993">eantaru</a></span></td><td class="date"><span>27-Apr-07  4:34&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2009250_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:92px;"><span class="voteform vertical" ownerid="3461993" msgid="2009250" votingtype="GoodOrBad" done="true"><a href="#xx2009250xx" onclick="return rateItem(5, 2009250,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3461993);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2009250xx" onclick="return rateItem(1, 2009250,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3461993);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2009216);" href="https://www.codeproject.com/Messages/2009216/Re-an-error-confuse.aspx"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>ok, thanks for your attention ^ ^<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=2009250&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=2009250&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2009007" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2009250" data-ref="3_2009250" class="rating-label" name="RateItem_2009250"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2009250/Re-an-error-confuse.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2009250"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="3461993" msgid="2009250"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1504213_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx1504213xx"></a><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1504213" parent="0" thread="1504213" href="https://www.codeproject.com/Messages/1504213/Jeff-DUMB.aspx">Jeff DUMB ?'</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">TheUberOverLord</span><span class="date">25-May-06  20:41</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2502231">TheUberOverLord</a></span></td><td class="date"><span>25-May-06  20:41&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1504213_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="2502231" msgid="1504213" votingtype="GoodOrBad" done="true"><a href="#xx1504213xx" onclick="return rateItem(5, 1504213,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',2502231);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1504213xx" onclick="return rateItem(1, 1504213,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',2502231);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Here is my situation, I only have visual studio Express 
C++ and want to create an ActiveX interface to Skype, currently there is
 a new Skype4com.dll but it does not support ActiveX via scripting such 
as JavaScript. I am trying to do this to get fancy with web embedded 
controls for Skype.<br>
<br>
I can't use MFC to do this and it seems like your series of plain C may 
have just saved the day for me. But, could these examples be loaded via a
 web page as they are, it seems like your examples where local where the
 dll was registered already on the system.<br>
<br>
Maybe I missed something? It sure would be great to see how to 
dynamically invoke this from a script located in a web page on a web 
site.<br>
<br>
Thanks <br>
<br>
Where Black, Gray and White Hats Unite - http://testing.OnlyTheRightAnswers.com<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=1504213&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=1504213&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1504213" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1504213" data-ref="3_1504213" class="rating-label" name="RateItem_1504213"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1504213/Jeff-DUMB.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1504213"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="2502231" msgid="1504213"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1504275_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx1504275xx"></a><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1504275" parent="1504213" thread="1504213" href="https://www.codeproject.com/Messages/1504275/Re-Jeff-DUMB-modified.aspx">Re: Jeff DUMB ?' [modified]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">25-May-06  23:01</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>25-May-06  23:01&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1504275_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="1504275" votingtype="GoodOrBad" done="true"><a href="#xx1504275xx" onclick="return rateItem(5, 1504275,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1504275xx" onclick="return rateItem(1, 1504275,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1504213);" href="https://www.codeproject.com/Messages/1504213/Jeff-DUMB.aspx"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>You
 definitely can use an ActiveX component from a web page. After all, you
 can embed a VBscript or JScript within an HTML SCRIPT tag. And if 
you've read Part 2 of this series, which discusses how to write an 
ActiveX component that can be used from scripting languages like 
VBscript or JScript, you know how to use that ActiveX component from a 
VBscript. (I didn't include a JScript example, but it works much like 
the VBscript example).<br>
<br>
I don't know much about Skype, but I would assume that's something 
running on the server hosting the web page? Or is it something that must
 be installed on the client computer (that is viewing the web page)? For
 the former, you'd probably want to use Active Server Pages (ASP). Take a
 look at http://www.takempis.com/information.asp for some 
easy-to-understand tutorials about that.<br>
<br>
If you're using client-side VBscripting (which I think is supported only
 in IE), here's how you would take the IExample2.vbs test script and 
employ it on a web page:<br>
<br>
&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;A script test&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;<br>
<br>
A message box should pop up with &lt;FONT COLOR=RED&gt;Hello world&lt;/FONT&gt;,<br>
due to having a SCRIPT tag on this web page. The script tag has<br>
VB instructions to display a message box.<br>
<br>
&lt;SCRIPT LANGUAGE="VBscript" TYPE="text/VBscript"&gt;<br>
&lt;!--<br>
Dim myObj<br>
set myObj = CreateObject("IExample2.object")<br>
myObj.Buffer = "Hello world"<br>
MsgBox myObj.Buffer, 0, "GetString return"<br>
--&gt;<br>
&lt;/SCRIPT&gt;<br>
<br>
&lt;/BODY&gt;&lt;/HTML&gt;<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=1504275&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=1504275&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1504213" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1504275" data-ref="3_1504275" class="rating-label" name="RateItem_1504275"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1504275/Re-Jeff-DUMB-modified.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1504275"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1504275"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1497656_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx1497656xx"></a><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1497656" parent="0" thread="1497656" href="https://www.codeproject.com/Messages/1497656/Link-error.aspx">Link error</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">transoft</span><span class="date">21-May-06  21:38</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2694">transoft</a></span></td><td class="date"><span>21-May-06  21:38&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1497656_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="2694" msgid="1497656" votingtype="GoodOrBad" done="true"><a href="#xx1497656xx" onclick="return rateItem(5, 1497656,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',2694);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1497656xx" onclick="return rateItem(1, 1497656,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',2694);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Link error:<br>
<br>
ISub1.obj : error LNK2005: _IID_ISub2 already defined in IBase.obj<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=1497656&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=1497656&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1497656" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1497656" data-ref="3_1497656" class="rating-label" name="RateItem_1497656"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1497656/Link-error.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1497656"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="2694" msgid="1497656"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1502090_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx1502090xx"></a><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1502090" parent="1497656" thread="1497656" href="https://www.codeproject.com/Messages/1502090/Re-Link-error.aspx">Re: Link error</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">24-May-06  13:35</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>24-May-06  13:35&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1502090_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="1502090" votingtype="GoodOrBad" done="true"><a href="#xx1502090xx" onclick="return rateItem(5, 1502090,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1502090xx" onclick="return rateItem(1, 1502090,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1497656);" href="https://www.codeproject.com/Messages/1497656/Link-error.aspx"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Hmmmm. I'm not getting this error in Visual C. Maybe try putting an:<br>
<br>
extern GUID IID_ISub2;<br>
<br>
in any file that references this GUID (except for IBase.c).<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=1502090&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=1502090&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1497656" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1502090" data-ref="3_1502090" class="rating-label" name="RateItem_1502090"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1502090/Re-Link-error.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1502090"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1502090"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2694364_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx2694364xx"></a><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2694364" parent="1497656" thread="1497656" href="https://www.codeproject.com/Messages/2694364/Re-Link-error-modified.aspx">Re: Link error [modified]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Member 4298929</span><span class="date">26-Aug-08  9:19</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=4298929">Member 4298929</a></span></td><td class="date"><span>26-Aug-08  9:19&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2694364_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="4298929" msgid="2694364" votingtype="GoodOrBad" done="true"><a href="#xx2694364xx" onclick="return rateItem(5, 2694364,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',4298929);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2694364xx" onclick="return rateItem(1, 2694364,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',4298929);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1497656);" href="https://www.codeproject.com/Messages/1497656/Link-error.aspx"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I also have the same question, do you resolve this question?<br>
<br>
Thank you! <br>
<br>
<div class="ForumMod">modified on Wednesday, August 27, 2008 2:29 AM</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=2694364&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=2694364&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1497656" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2694364" data-ref="3_2694364" class="rating-label" name="RateItem_2694364"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2694364/Re-Link-error-modified.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2694364"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="4298929" msgid="2694364"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2695625_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx2695625xx"></a><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2695625" parent="1497656" thread="1497656" href="https://www.codeproject.com/Messages/2695625/Re-I-resolve-this-problem.aspx">Re: I resolve this problem</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Member 4298929</span><span class="date">27-Aug-08  3:35</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=4298929">Member 4298929</a></span></td><td class="date"><span>27-Aug-08  3:35&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2695625_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="4298929" msgid="2695625" votingtype="GoodOrBad" done="true"><a href="#xx2695625xx" onclick="return rateItem(5, 2695625,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',4298929);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2695625xx" onclick="return rateItem(1, 2695625,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',4298929);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1497656);" href="https://www.codeproject.com/Messages/1497656/Link-error.aspx"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Just include file "initguid.h" in file "PortNames.c", before include &lt;objbase.h&gt;<br>
<br>
just like this:<br>
#include &lt;windows.h&gt;<br>
#include &lt;initguid.h&gt;<br>
#include &lt;objbase.h&gt;<br>
#include "IExample3.h"<br>
#include "PortNames.h"<br>
<br>
<br>
delete the "include &lt;initguid.h&gt;" in file "IExample*.h"<br>
<br>
Good luck!!!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=2695625&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=2695625&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1497656" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2695625" data-ref="3_2695625" class="rating-label" name="RateItem_2695625"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2695625/Re-I-resolve-this-problem.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2695625"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="4298929" msgid="2695625"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3953033_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx3953033xx"></a><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="3953033" parent="1497656" thread="1497656" href="https://www.codeproject.com/Messages/3953033/Re-Link-error.aspx">Re: Link error</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">yaxiya</span><span class="date">10-Jul-11  1:47</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=6194398">yaxiya</a></span></td><td class="date"><span>10-Jul-11  1:47&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3953033_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="6194398" msgid="3953033" votingtype="GoodOrBad" done="true"><a href="#xx3953033xx" onclick="return rateItem(5, 3953033,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',6194398);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx3953033xx" onclick="return rateItem(1, 3953033,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',6194398);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1497656);" href="https://www.codeproject.com/Messages/1497656/Link-error.aspx"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I also have the same question, do you resolve this question?<br>
Thank you! <br>
---------------------------------------<br>
Compiling...<br>
IBase.c<br>
ISub1.c<br>
ISub2.c<br>
Linking...<br>
ISub1.obj : error LNK2005: _IID_ISub2 already defined in IBase.obj<br>
ISub1.obj : error LNK2005: _IID_ISub1 already defined in IBase.obj<br>
ISub1.obj : error LNK2005: _IID_IBase already defined in IBase.obj<br>
ISub1.obj : error LNK2005: _IID_IMultInterface already defined in IBase.obj<br>
ISub1.obj : error LNK2005: _CLSID_IMultInterface already defined in IBase.obj<br>
ISub2.obj : error LNK2005: _IID_ISub2 already defined in IBase.obj<br>
ISub2.obj : error LNK2005: _IID_ISub1 already defined in IBase.obj<br>
ISub2.obj : error LNK2005: _IID_IBase already defined in IBase.obj<br>
ISub2.obj : error LNK2005: _IID_IMultInterface already defined in IBase.obj<br>
ISub2.obj : error LNK2005: _CLSID_IMultInterface already defined in IBase.obj<br>
ISub1.obj : warning LNK4006: _IID_ISub2 already defined in IBase.obj; second definition ignored<br>
ISub1.obj : warning LNK4006: _IID_ISub1 already defined in IBase.obj; second definition ignored<br>
ISub1.obj : warning LNK4006: _IID_IBase already defined in IBase.obj; second definition ignored<br>
ISub1.obj : warning LNK4006: _IID_IMultInterface already defined in IBase.obj; second definition ignored<br>
ISub1.obj : warning LNK4006: _CLSID_IMultInterface already defined in IBase.obj; second definition ignored<br>
ISub2.obj : warning LNK4006: _IID_ISub2 already defined in IBase.obj; second definition ignored<br>
ISub2.obj : warning LNK4006: _IID_ISub1 already defined in IBase.obj; second definition ignored<br>
ISub2.obj : warning LNK4006: _IID_IBase already defined in IBase.obj; second definition ignored<br>
ISub2.obj : warning LNK4006: _IID_IMultInterface already defined in IBase.obj; second definition ignored<br>
ISub2.obj : warning LNK4006: _CLSID_IMultInterface already defined in IBase.obj; second definition ignored<br>
   Creating library Debug/IMultInterface.lib and object Debug/IMultInterface.exp<br>
Debug/IMultInterface.dll : fatal error LNK1169: one or more multiply defined symbols found<br>
Error executing link.exe.<br>
<br>
IMultInterface.dll - 11 error(s), 10 warning(s)<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=3953033&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=306318&amp;select=3953033&amp;floc=/Articles/14117/COM-in-plain-C-Part-4&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1497656" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF3953033" data-ref="3_3953033" class="rating-label" name="RateItem_3953033"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/3953033/Re-Link-error.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_3953033"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="6194398" msgid="3953033"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellspacing="0" cellpadding="2px">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 14-Jan-20  11:58 &nbsp; &nbsp; Last Update: 14-Jan-20  12:14</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/14117/COM-in-plain-C-Part-4?fid=306318&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=13"><span class="nav-link selected">1</span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_general.gif" alt="General" width="16px" height="16px" align="top"> General &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_news.gif" alt="News" width="16px" height="16px" align="top"> News &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_idea.gif" alt="Suggestion" width="16px" height="16px" align="top"> Suggestion &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_question.gif" alt="Question" width="16px" height="16px" align="top"> Question &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_bug.gif" alt="Bug" width="16px" height="16px" align="top"> Bug &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_answer.gif" alt="Answer" width="16px" height="16px" align="top"> Answer &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_joke.gif" alt="Joke" width="16px" height="16px" align="top"> Joke &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_kudos.gif" alt="Praise" width="16px" height="16px" align="top"> Praise &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_rant.gif" alt="Rant" width="16px" height="16px" align="top"> Rant &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/msg_admin.gif" alt="Admin" width="16px" height="16px" align="top"> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner">
                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div class="browse-code"><a href="https://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=14117">Browse Code</a></div>
<div><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=14117">View Stats</a></div>
<div><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=14117">Revisions</a></div>
<div><a href="#_comments">Comments (12)</a></div>
<div>Posted 16 May 2006</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Cplusplus" data-id="78">C++</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/C" data-id="80">C</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Visual-Studio" data-id="103">Visual-Studio</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/COM" data-id="130">COM</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>74.9K views</div><div>1.9K downloads</div><div>92 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

                <div id="RHSticky" class="container-article-info-sticky">
        		    

<div class="article-summary">

    
    

</div>

				    <div id="ctl00_SectionSponsor" class="padded-top" style="width:160px;margin:10px auto">
					    <div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/COM" data-country="US" data-showindicator="true" data-tags="C++, C, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=160x200&c=754139"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=160x200&c=754139"  width="160px" height="200px" target="_blank"/></a></noscript></div>
				    </div>

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/COM" data-country="US" data-tags="C++, C, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=160x600&c=754139"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=160x600&c=754139"  width="160px" height="600px" target="_blank"/></a></noscript></div>
				    </div>

                    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="theme1-background" style="height:2px;margin:5px 0" id="stickyStop"></div>

		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/14117/COM-in-plain-C-Part-4?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2006 by Jeff Glatt<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2020 <br>
                <br>
				Web03 
				2.8.200113.1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="COM%20in%20plain%20C,%20Part%204%20-%20CodeProject_files/DFPAudiencePixel.gif" style="border-width:0px;height:1px;width:1px;">



<script type="text/javascript"> // IMMEDIATE script

var readLaterList

var notificationAlert

var followService_ctl00_ActionLinks_ArticleFollow;

var bookmark_medium_true_false_ = null;

function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(null, 14117,2,1,true,true,0,'LargeStars', null, 88625);
}

function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                        if (!$('#' + containerId).attr('alreadyRequested')){
                            $.ajax({
                                url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId+'&wd=130',
                            })
                            .done(function (data) {
                                $('#' + containerId).html(data);
                                $('#' + loadingId).hide();
                            });

                            $('#' + containerId).attr('alreadyRequested', 'true');
                        }
                    }

document.addEventListener('DOMContentLoaded', function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});
function ChkRtctl00_RateArticle(val) {
}

var followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 306318,
};
var subscriptions_ctl00_MessageBoard;
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	processCodeBlocks.Initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	$('#RHSticky').sticky($('#stickyStop'));
	$('#ctl00_StickyBlock').sticky($('#stickyStop'));
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	readLaterList = new ReadLaterList('ReadLaterListIcon', 'ItemsToRead','/script/Bookmarks/WebServices/BookmarkService.aspx','https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=small',true);
	readLaterList.initialise();
	
	notificationAlert = new NotificationAlert('ctl00_MemberBar_Messages_NotificationCount','Notifications','/script/Membership/Ajax/NotificationList.aspx');
	notificationAlert.initialise();
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar && sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc && !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	followService_ctl00_ActionLinks_ArticleFollow = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_ActionLinks_ArticleFollow.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 2,
	        objectId       : 14117
	    },
	    followButtonId   : 'ctl00_ActionLinks_ArticleFollow_FollowBtn',
	    unfollowButtonId : 'ctl00_ActionLinks_ArticleFollow_UnfollowBtn'
	}, false);
	
	bookmark_medium_true_false_ = new Bookmark('[data-type="bookmark"]','https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=medium',false,true);
	bookmark_medium_true_false_.Initialise();
	
	$('#clear-rate_ctl00_RateArticle_RCD').click(function () {    $('#ctl00_RateArticle_RCD').hide(); return false;});
	
	new starRating('#ctl00_RateArticle_RateItemWrapper', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
	  $('#ctl00_RateArticle_VR').mouseenter(function() {     getVotesHistogram(14117,2   ,'ctl00_RateArticle_HistogramR','ctl00_RateArticle_LoadingR');
	  });
	
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 1,
	        objectId       : 88625
	    },
	    followButtonId   : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn',
	    unfollowButtonId : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn'
	}, false);
	
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : true,
	    allowReporting      : false,
	    allowRating         : true,
	    allowRatingDisplay  : true,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://codeproject.freetls.fastly.net',
	    switchMsgCallback   : null,
	    getVoteFormMethod   : getVoteFormHtml,
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    getRatingUrl        : '/script/Ratings/Ajax/GetRatings.aspx',
	    getRatingRefKey     : 'obrs',
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl(forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	var followService = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	var followAttributeIds = [];
	followService.initAttributeUI(undefined, followAttributeIds);

})
</script>










<style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div></body></html>