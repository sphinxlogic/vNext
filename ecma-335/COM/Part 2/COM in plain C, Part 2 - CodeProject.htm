<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>COM in plain C, Part 2 - CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/Main.css">

    <script type="text/javascript" async="" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/analytics.js"></script><script type="text/javascript" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/jquery.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/article.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/MemberProfilePopup.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/a.js" defer="defer"></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="How to write a COM component in C that can be used by script languages such as VBscript, Visual BASIC, jscript, etc.">
<meta name="Keywords" content="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Beginner,COM / COM+,Platforms, Frameworks &amp; Libraries,Free source code, tutorials">
<meta name="Author" content="Jeff Glatt">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2">
<meta name="twitter: card" content="summary">
<meta name="twitter: site" content="@CodeProject">
<meta property="og:url" content="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2">
<meta property="og:title" content="COM in plain C, Part 2">
<meta property="og:description" content="How to write a COM component in C that can be used by script languages such as VBscript, Visual BASIC, jscript, etc.">

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Artificial Intelligence" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=31">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2"
   },
  "headline": "COM in plain C, Part 2",
  "url": "https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2",
  "discussionUrl": "https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2#_comments",
  "isFamilyFriendly": "true",
  "image": "https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "VC6,C++,C,Windows,Visual-Studio,Dev,COM,Beginner",
  "commentCount": "67",
  "editor" : {
    "@type" : "Person",
    "name" : "Smitha Nishant",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=28970"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "How to write a COM component in C that can be used by script languages such as VBscript, Visual BASIC, jscript, etc.",
  "articleSection": "COM / COM+",
  "author" : [{
      "@type" : "Person",
      "name" : "Jeff Glatt",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=88625"
    }],
  "datePublished": "2006-04-20",
  "dateCreated": "2006-04-20",
  "dateModified": "2006-04-20"
,
  "aggregateRating" : {
    "@type" : "aggregateRating",
    "ratingValue" : 4.96,
    "ratingCount" : 97,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/8/Platforms-Frameworks-Libraries.aspx",
      "name" : "Platforms, Frameworks & Libraries"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/COM/",
      "name" : "COM / COM+"
    }
  }]
}</script>


	<!-- base href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2" -->
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





<!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" type="text/javascript" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': '55e1d411-e955-4cb4-9978-1528f21616a2'});
    </script>


<style type="text/css"></style></head>	

<body class="firefox firefox72">

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">14,417,643 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		<span id="ctl00_MemberBar_ReadLaterList_ReadLaterListDiv" class="tooltip member-message">
	<span id="ReadLaterListIcon" class="readlaterlist-count openable hidden"></span>
	<div class="tooltip-flyout readlaterlist-dropdown">
		<div id="ItemsToRead" class="readlaterlist-list"></div>
	</div>
</span><span id="ctl00_MemberBar_Messages_NotificationDiv" class="tooltip member-message">
	<a id="ctl00_MemberBar_Messages_NotificationCount" title="1 message" class="notification-count openable" href="https://www.codeproject.com/script/Membership/MyNotifications.aspx">1</a>

	<div class="tooltip-flyout notification-dropdown">
		

		<div id="ctl00_MemberBar_Messages_Confirm" class="bold spaced">
            <img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/caution.png" style="width:20px;height:20px;vertical-align:bottom">
            <a id="ctl00_MemberBar_Messages_EmailConfirm" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f13862%2fCOM-in-plain-C-Part-2">Click here to confirm your email address. </a>
		</div>

		
		
		<div id="Notifications" class="notification-list">
			<img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/loading24.gif" alt="loading" style="margin:auto;">
		</div>
		<div class="spaced">
			
		</div>
	</div>
</span><span id="ctl00_MemberBar_TotalPoints" title="Total reputation points"><a class="bold member-rep-box silver" title="Reputation points earned: 824" href="https://www.codeproject.com/script/Reputation/List.aspx?mid=527156">824</a></span><span id="ctl00_MemberBar_CurRat" class="member-links tooltip openable">
				<a id="ctl00_MemberBar_MyProfile" class="me desktop-only tablet-only" dir="ltr" href="https://www.codeproject.com/Members/jon57">jon57</a>
                <a id="ctl00_MemberBar_MyProfileMob" class="me mobile-only" href="https://www.codeproject.com/Members/jon57">☰</a>
                <div class="tooltip-flyout">
					
					<div class="list-item"><a id="ctl00_MemberBar_MySettingsDefault" href="https://www.codeproject.com/script/Membership/Modify.aspx">My Settings</a></div>
					
					<div class="list-item"><a id="ctl00_MemberBar_MyBookmarks" href="https://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2">My Bookmarks</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyArticles" href="https://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=527156">My Articles</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyMessages" href="https://www.codeproject.com/script/Forums/Messages.aspx?fmid=527156">My Messages</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyQuestions" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=questions&amp;mid=527156&amp;showall=True">My Questions</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyAnswers" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=answers&amp;mid=527156&amp;showall=True">My Answers</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyComments" href="https://www.codeproject.com/script/comments/MemberComments.aspx?mid=527156">My Comments</a></div>
					
					
					<div id="ctl00_MemberBar_MyFollowingHolder">
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowing" href="https://www.codeproject.com/script/follow/Edit.aspx">Things I Follow</a></div>
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowers" href="https://www.codeproject.com/script/follow/Followers.aspx">My Followers</a></div>
					</div>
					
        
					<form name="unsubForm" id="unsubForm" action="/script/Membership/LogOff.aspx?rp=%2fArticles%2f13862%2fCOM-in-plain-C-Part-2" method="post" class="tight">
                    <input type="hidden" name="AntiForgeryToken" value="e82756ee-ccd1-43de-910d-7f5dd2636494">
                    <input type="submit" value="Sign out" class="list-item border-none extended align-left" onclick="return doSignout();" style="background-color: transparent; color: #999; cursor:pointer">
                    
                    </form>

                    <script type="text/javascript">//<!--
			        function doSignout()
			        {
    			        document.unsubForm.action = "/script/Membership/LogOff.aspx?rp=%2fArticles%2f13862%2fCOM-in-plain-C-Part-2"
				        document.unsubForm.submit();
				        return true;
			        }//-->
			        </script>
                    
				</div>
			</span>

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/COM" data-country="US" data-tags="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=728x90&c=906294"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=728x90&c=906294"  width="728px" height="90px" target="_blank"/></a></noscript></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table class="search" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><input tabindex="2" class="search subdue" id="sb_tb" autocomplete="off" value="Search for articles, questions, tips" name="q"></td><td><input type="image" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		
		
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/write13.png" width="13" height="13"> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="https://www.codeproject.com/script/Articles/ImportArticle.aspx">
			<img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/write13.png" width="13" height="13"> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/write13.png" width="13" height="13"> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">View VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">View ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=93" style="padding-left:30px">View SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues.aspx">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript.aspx">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools.aspx">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift.aspx">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database.aspx">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1942421/Linux-Programming.aspx">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android.aspx">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS.aspx">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1540733/SharePoint.aspx">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development.aspx">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch.aspx">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">stuff</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="https://www.codeproject.com/KB/showcase/">Product Showcase</a></li>
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Contests/Winners.aspx?obtid=1&amp;cmpTpId=2&amp;cid=0">Most Valuable Professionals</a></li>
		

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="https://www.codeproject.com/Forums/1939564/Where-I-am-Member-Photos.aspx">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>
		<li></li>
		

		
		<li class="openable"><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">Non-English Language
			<span class="has-submenu">&gt;</span></a>
		<ul>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		
		</ul>
		</li><li class="last"></li>
		
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> » <a href="https://www.codeproject.com/Chapters/8/Platforms-Frameworks-Libraries.aspx">Platforms, Frameworks &amp; Libraries</a> » <a href="https://www.codeproject.com/KB/COM/">COM / COM+</a> » <a href="https://www.codeproject.com/KB/COM/#COM">COM</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
                
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    <a id="ctl00_ActionLinks_ArticleFollow_FollowBtn" title="" class="button unfollowed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Have any updates for this Article appear in your Timeline so you can stay up to date" style="display: inline-block;">Follow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have any updates for this Article appear in your Timeline so you can stay up to date</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_ActionLinks_ArticleFollow_UnfollowBtn" title="" class="button followed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Stop following this Article" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Article</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

</div>



<span id="ctl00_ActionLinks_BookmarkMd_bookmark" data-type="bookmark" data-ref="2_13862_1" data-size="medium" data-mode="bookmark"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark48.png" style="width:24px;height:24px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span> 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?display=Print" class="tooltip" title="">
   <img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/print48.png" style="border:0" width="24px" height="24px">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="/Articles/13862/COM-in-plain-C-Part-2" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="FuUgXWh7ltBlQnXLD07SuaLJVP5DAAyB21YTNBEHC0T+5Psrvv88JhHyQ9a4IJllHI6B4YspqhnQXYAGCO3zEH7Xse5shE5GkAu6OLYHCqNAXt5gCXCzbQYX32my5mjUJAntGLyNXL1TVQ+neku97cElR/qKckEqBiw/KJgye2Vpn+iTWyd135MM79feCfO0mnho0yESndZm1/5qCPRIlRb+wMYbaKzrOoZF/aIAO/FLLezy6z52AJumNDg9EySH382e9ejL9uDSJ3EQmv97OcRUBr0mfL0vfmEClt1uzJDgWV3I3aCiyuYmymm4+ZY2MhZy/0rioUIl7cRr0CO/V26u2OVMAlCXmnv6k95rDM7aK5F/vF75fri2p8IDYiS9ywMRdCFDAydFtp65SfRaggYTuUpss736+1g2nByiml50fHTd96QZ6mx1GclaN6CaZtLNcMOvAljWtqPwNz1YWCLYkFU1GNqNEoBmYhHHs5IzUAMpX5MkImMcv4M9NCHHZrytGy2DsJ4iJRi/MvnK9R5x4vB9rENNSKmdmD3Uv39EeFNM6U5NN78VdswzGme+JrsKaiFYAMNnwVFv+UMVVh5ydVIOPZ9gW0NS127+mA7CbKlqU/Xg6iAUoZFE1rXG+484i0XZMW1ljqMyJK/siw9sjMRQevp0Na4fdzH02ZP+0vByNBbdKN2VGUdcXsLl6wjxpAQxf82ADeE46mRIQrjUWmWnhRXUNXaB1bjBBQD46dsdZ9N2IAYxmd8aracMg8XZfUCcGvcKGnGZlwjX+BkRuEnOA1vNZZ3H5MrMkf3jkmlUDg2mSk14Cnsj1C+Ectz+Tf1xeL2KHTfH+sAlFSCVS1oZjWuLbB7f4mka9j8VHVZ042DwLsk47lbYf3EYVftZlcSeciwSJq8hVll96Gsk/3y2cVr9tR7FfFqExrfUZbjUvNSTtHGFMFFMKheNiyya4Rn1rEF9fiZz/KtelnLwkwpVfEzeGsyf/i0Y281TbHkxrvOjnxg4xm5K4QZKnrVoYYzEl19sHMSLq53QgIRqu7mkQB3i2uStqI8a33o6x74A67j3IRHxQB0O4cmtzLXevdf+VibDPYAUcSyo4JbokrxOWanUI7BLzAP5lmdeOR+slQdsGehUmx3L2JloiONfOb94MsRldgF/pN70jAXNCBHUNDahPwWskljYBPsMM/yquBeq2wmOcBKQ7Eqo2SRLkzKjVkH5Jwdhio36BI9osHg+1t+u54J8kTcDuQ6c99UPE1+j8bo0HJ0BudtuJsCA7m1vQLt7jH91AtKIJLmKA8QAeYa+iOOl5EV4mGHkEXtmYxSlnAdJMjHgAZxO7RPf25Ww3VgVoRVaBQgc5W5sZE9k84Ox6UKRdv7DMv9SlYiKtuPIdgPVW6459JG2T9cA00zHCTSKESu4HubxTcVvmLV4Z2yL/LQcADqo0F0yEkny/3g3HjITwKsj7T2oKyDCxnrftDBLOtXKR49R7+19ExvWDHppXqki1QsTydyF9mwYvIfJAXpWq8TSUA7lwNVANuROxHxd/CgCpMi2x0i4TItKVQvr7Eq/SD7WlCi1+j9kY0ZoOcjssgYPmnKCCO7wv2PyCqyfVPzTyZYiRw8zN6gm7fnfY3WynB3s8usIMCq1Fn5PpN4x1zY2lNwM8Tc2C3IjS8ydnNQXCCUybMDPQuvq67+B72g040OTaKMShzls0f9dlmA/dX10X6tUv/PXQWcGoRz6FRguyqfmCO0a+ls+GAAFhLMQm6aHgZAgyLdp+6MW5oUcEBDcikQb21/Bc82AVLlPpbt1V/rwmFimdsj5r9+BfP4coLq/Zhm+4YZWzUE09XoxZow1cocddH6nA3MPDEPOVeY+prcQfcguOXBt5yOJsZmB0prtZt28BIUgUsIBGDFgfFujgzKsJjjYdrz0A/kMgmzFYD+t+jG4ZZLCR/SUei3/4M3hFF5iKK8GnDgnkw7WQgyPlYin3MOCb5bTBi/mMDLyzlbo/2oMUKVEdziJpSPcGxYD+6xqBR6qdOf4jDRZJVBPhw64wBDJFTy8QR6U79ZnkWLfDUsqVZzJPoQ6eHGoJLPMBOY/tt+cwnP107ytswVimnyC7JQJDIca/INvTt5O5LEGMEPyyZViOci/MndrgZY7A9/aNMj+g2kLD6uJN4re4oBjsdrY5MeNoY23GnStOQrgeYcHM0UDsI+EBL4bA7w4A9ULhD5P+flB2E7tS8sHXPdsN6VxOlxlT9G6/IAcuVTvgfjBa9l9PV/bxN7ue9cuvta+8plSVPR00aw/5sFZIKy1wvlncvi0w/mimm2CyVGBL97Rmy7PcrA3nsSTzMbhIQXzKZpUSmAFKo+Kms0QvStwjYsLmjajY/kGwXQNzFY7GpYoHPbwT1DpYuXPm1ZO+SM8nQYHheIc5DGFRK610QJEW7YPLA==">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">COM in plain C, Part 2</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

                                

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625" rel="author">Jeff Glatt</a></span> 

                                        <div class="flex-item" style="margin-top:-7px;height:35px">
                                            <div id="ctl00_RateArticle_RateItemWrapper" class="container-rating small-text" name="RateItem_13862">

	<table class="small-text" width="100%" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right">
			<span class="align-right"></span>
			<img class="loading invisible" alt="loading..." src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/loading16.gif" width="16px" height="16px"> 
		</td>

	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tbody><tr>
				
				<td id="ctl00_RateArticle_StartForm" nowrap="nowrap" align="right"><b>Rate me!</b> </td>

				<td id="ctl00_RateArticle_VoteFormDiv" class="nowrap tooltip rating-stars-voter-large" style="padding-top:1px">

                    
					

<meta itemprop="upvoteCount" content="94">


<table id="ctl00_RateArticle_ItemRating_RatingTable" style="margin:0 1px;" class="hide-on-hover float-left" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td class="nowrap">

        <div style="width:120px;height:28px;position:relative" class="nowrap rating-stars-large"><div style="width:119px;height:24px;" class="clipped align-left float-left"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/stars-fill-lg.png"></div><div style="width:1px;height:24px;position:relative" class="clipped"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/stars-empty-lg.png" style="position:absolute;top:0;right:0"></div>

		
	</div></td>
		<td id="ctl00_RateArticle_ItemRating_VR" class="nowrap">
		<span id="ctl00_RateArticle_ItemRating_VotesR">4.96  (97 votes)</span>
		
	</td>
	</tr>
</tbody></table>

<span id="ctl00_RateArticle_ItemRating_RatingText"></span>


                    
					<span id="ctl00_RateArticle_RB" class="ajaxHist radio voting show-on-hover" style="display: none;">
						<span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5" style="display: none;"></span> 
					<div class="rating-star-block"><a href="#" rating="1" class="star outline" title="vote 1">vote 1</a><a href="#" rating="2" class="star outline" title="vote 2">vote 2</a><a href="#" rating="3" class="star outline" title="vote 3">vote 3</a><a href="#" rating="4" class="star outline" title="vote 4">vote 4</a><a href="#" rating="5" class="star outline" title="vote 5">vote 5</a></div></span>

                    
					

                    
	                <div id="ctl00_RateArticle_RCD" class="hover-container tooltip-flyout rating-comment" style="top:12px">
		                Add a reason or comment to your vote:
                        <a href="#" id="clear-rate_ctl00_RateArticle_RCD" title="close" class="rating-close">x</a>
                        <br>
                        <textarea class="RateComment" rows="5" cols="60" style="width:96%;"></textarea>
		                <span id="ctl00_RateArticle_CommentReq" class="subdue">Adding a comment to your rating is optional</span>
		            </div>

                    
                        

				</td>

				
                <td id="ctl00_RateArticle_VR" class="nowrap show-on-hover tooltip" style="display: none;">

		            <span id="ctl00_RateArticle_VotesR">4.96  (97 votes)</span>

                    
					<div id="ctl00_RateArticle_histPHR" class="speech-bubble-container-up-right" style="width:175px;margin-top:24px;right:-15px;top:6px">
						<div class="speech-bubble-up-right">
							<div id="ctl00_RateArticle_HistogramR">

</div>
							<img id="ctl00_RateArticle_LoadingR" class="align-middle" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/loading24.gif" style="border-width:0px;">
						</div>
						<div class="speech-bubble-pointer-up-right">
							<div class="speech-bubble-pointer-up-right-inner"></div>
						</div>
					</div>
                </td>


				<td style="padding-left:5px">	
					<input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button" style="display: none;">
				</td>
			</tr>
			</tbody></table>

			
		</td>
	</tr>
	</tbody></table>

</div>
                                        </div>
                                    </div>

                                    <div class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">20 Apr 2006</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_description" class="summary">How to write a COM component in C that can be used by script languages such as VBscript, Visual BASIC, jscript, etc.</div><span id="ctl00_thumbnailUrl" class="date" content="https://codeproject.global.ssl.fastly.net/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					
					

						
					

					<div id="ctl00_confirmError" class="advise"><img style="float:left;margin-right:10px" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/warning48.png" width="48px" height="48px"><b>Is your email address OK?</b> You are signed up for our 
						newsletters but your email address is either unconfirmed, or has not been 
						reconfirmed in a long time. Please <b>click <a id="ctl00_RequestConfirmLink2" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f13862%2fCOM-in-plain-C-Part-2">here</a> to have a confirmation email
                        sent</b> so we can confirm your email address and start sending you 
                        newsletters again. Alternatively, you can 
						<a id="ctl00_SubscribeLink2" href="https://www.codeproject.com/script/Membership/Subscribe.aspx">update your subscriptions</a>.</div>

						
						<div id="contentdiv" class="text">
						



<ul class="download">
<li><a href="https://www.codeproject.com/KB/COM/com_in_c2/com_in_c2_src.zip">Download source files - 93.5 Kb</a> </li></ul>
<h2>Contents</h2>
<ul>
<li><a href="#intro">Introduction</a> 
</li><li><a href="#WHY">Why script languages can't use our DLL as is?</a> 
</li><li><a href="#TYPE">Automation data types (i.e., BSTR, VARIANT)</a> 
</li><li><a href="#DISPATCH">The IDispatch functions</a> 
</li><li><a href="#LIB">The type library</a> 
</li><li><a href="#REG">Registering the type library</a> 
</li><li><a href="#VB">A VBScript example</a> 
</li><li><a href="#PROP">A Property</a> 
</li><li><a href="#C">An updated example C application</a> 
</li><li><a href="#EXE">A COM component in an EXE</a> </li></ul>
<h2><a name="intro"></a>Introduction</h2>
<p>In the first part of this series, we created a COM component in plain
 C, packaged it into a DLL, and learned how to register it so that it 
could be used by any C/C++ application. We also created a C/C++ include 
file (<i>IExample.h</i>) that contained our GUIDs and the definition of our object's VTable (functions). By including this <i>.H</i>
 file, a C/C++ application knows what the names of our object VTable's 
members are (to call our functions), what arguments to pass, what the 
functions return, and what the GUIDs of our object and its VTable are. 
</p><p>Whereas this is all the support a C/C++ app needs, we must add further support (to our <code>IExample</code>
 DLL) to accommodate interpreted "scripting" languages such as Visual 
Basic, VBScript, Jscript, Python, etc. The focus of this article is how 
to add such support. After we add this support, we'll write a VBScript 
example to use our updated <code>IExample</code> component.</p>
<h2><a name="WHY">Why</a> script languages can't use our DLL as is?</h2>
<p>Unless a particular language can read our C/C++ include file and 
extract the information in it, a Visual Basic, Python, etc. application 
simply does not know what functions are in our object, what arguments 
those functions are passed, and what they return, and what our GUIDs 
are. Most languages do not support extracting information from a C/C++ 
include file. We need some way of specifying all the information 
contained within <i>IExample.h</i> in a language-neutral format, preferably a compact "binary" format, unlike <i>IExample.h</i>. As we'll see later, we do this by creating something called a <i>type library</i>.</p>
<p>To make it easier and more standardized for a script engine to peruse
 the contents of our "type library", we'll add some functions, called <code>IDispatch</code> functions, to our object. The script engine gets the type library information only via these <code>IDispatch</code>
 functions. Only our object directly accesses its own type library. By 
not having the script engine directly access our type library, this 
means that if Microsoft develops later versions of a type library, these
 messy version details will be hidden from the script engine.</p>
<p>There's another matter with data types. Consider a string in ANSI C. A
 C string is a series of 8-bit bytes ending with a 0 byte. But that 
isn't how strings are stored in Pascal. A Pascal string starts with a 
byte that tells how many more bytes follow. In other words, a Pascal 
string starts with a length byte, and then the rest of the bytes. There 
is no terminating 0 byte. And what about UNICODE versus ANSI? With 
UNICODE, every character in the string is actually 2 bytes (i.e., a <code>short</code>). Visual Basic strings are UNICODE, unlike ANSI C.</p>
<p>We need to deal with the problem of resolving these data type issues.
 We need to come up with a set of "generic data types" that work for any
 language that uses our object, and use only those data types for 
arguments to our object's functions (and any data our functions return).</p>
<h2><b><a name="TYPE">Automation</a> data types</b></h2>
<p>In order to support any language (as well as extensions in each 
language such as UNICODE), Microsoft has defined a generic set of data 
types that a COM object should use. Microsoft calls these "Automation 
data types". (Later, we'll look at where the word Automation comes 
from.) One such automation data type is a <code>BSTR</code>. If a COM object is passed a string, then the argument can take the form of a <code>BSTR</code>. What is a <code>BSTR</code>? It's a pointer to a specially formatted string. Every character is two bytes (i.e., a <code>short</code>),
 and it is prefaced with an unsigned long that tells how many more 
shorts follow, plus it ends with a 0 short. This accommodates the 
"string" data type of almost every language/extension. But it also means
 that, a C/C++ app, or our C object itself, will sometimes need to 
reformat a C string to a null-terminated UNICODE string prefaced with a 
length.</p>
<p>Just for the sake of illustration, let's take the following ANSI C string:</p><div class="pre-action-link" id="premain877991" style="width:100%;display:block;"><span id="prehide877991" onclick="processCodeBlocks.togglePre(877991);">Hide</span>  &nbsp; <span id="copycode877991" onclick="return processCodeBlocks.copyCode(877991);">Copy Code</span></div><pre id="pre877991" style="margin-top: 0px;" class="notranslate">char MyString[] = "Some text";</pre>
<p>First, let's break up the string into separate chars:</p><div class="pre-action-link" id="premain256533" style="width:100%;display:block;"><span id="prehide256533" onclick="processCodeBlocks.togglePre(256533);">Hide</span>  &nbsp; <span id="copycode256533" onclick="return processCodeBlocks.copyCode(256533);">Copy Code</span></div><pre id="pre256533" style="margin-top: 0px;" class="notranslate">char MyString[] = {'S','o','m','e',' ','t','e','x','t', 0};</pre>
<p>Since C strings are null-terminated, notice that we include that last, 0 byte in the array.</p>
<p>Now, we need to convert the string to UNICODE. This means that every char becomes a short. We'll just redefine the array as <code>short</code>:</p><div class="pre-action-link" id="premain41306" style="width:100%;display:block;"><span id="prehide41306" onclick="processCodeBlocks.togglePre(41306);">Hide</span>  &nbsp; <span id="copycode41306" onclick="return processCodeBlocks.copyCode(41306);">Copy Code</span></div><pre id="pre41306" style="margin-top: 0px;" class="notranslate">short MyString[] = {'S','o','m','e',' ','t','e','x','t', 0};</pre>
<p>Now, we need to preface the array with the number of bytes in the array. Note that we don't count the terminating zero as <code>short</code>. So, we have a length of 9 <code>short</code>s * 2 bytes per <code>short</code> (note the Intel Little Endian byte order):</p><div class="pre-action-link" id="premain143531" style="width:100%;display:block;"><span id="prehide143531" onclick="processCodeBlocks.togglePre(143531);">Hide</span>  &nbsp; <span id="copycode143531" onclick="return processCodeBlocks.copyCode(143531);">Copy Code</span></div><pre id="pre143531" style="margin-top: 0px;" class="notranslate">short MyString[] = {18, 0, 'S','o','m','e',' ','t','e','x','t', 0};</pre>
<p>A <code>BSTR</code> is defined as a pointer to this specially formatted UNICODE string. Actually, it is a pointer to the third <code>short</code> in the UNICODE string, because the length is supposed to <b>preface</b> the actual string. So, here we declare a variable of type <code>BSTR</code>, and set it to point to our string above:</p><div class="pre-action-link" id="premain118220" style="width:100%;display:block;"><span id="prehide118220" onclick="processCodeBlocks.togglePre(118220);">Hide</span>  &nbsp; <span id="copycode118220" onclick="return processCodeBlocks.copyCode(118220);">Copy Code</span></div><pre id="pre118220" style="margin-top: 0px;" class="notranslate">BSTR  strptr;

strptr = &amp;MyString[2];</pre>
<p>We can now pass <code>strptr</code> to a COM object that expects a <code>BSTR</code> as an argument. And if one of our object's functions expects a <code>BSTR</code> argument, <code>strptr</code> is what is going to be passed.</p>
<p>But before you think that you have to manually reformat all of your 
strings as above, that's not necessary. Fortunately, there is an 
operating system function called <code>MultiByteToWideChar</code> to convert an ANSI C string to UNICODE, and functions like <code>SysAllocString</code> and <code>SysAllocStringLen</code>
 which will allocate a buffer to copy the UNICODE string, prefaced with 
an unsigned long holding the size of that buffer. So to take our 
original <code>char</code> string and make a <code>BSTR</code> pointer to it (error checking omitted), we can do:</p><div class="pre-action-link" id="premain449937" style="width:100%;display:block;"><span id="prehide449937" onclick="processCodeBlocks.togglePre(449937);">Hide</span>  &nbsp; <span id="copycode449937" onclick="return processCodeBlocks.copyCode(449937);">Copy Code</span></div><pre id="pre449937" style="margin-top: 0px;" class="notranslate">DWORD len;
BSTR  strptr;
char  MyString[] = "Some text";

// Get the length (in wide chars) of the UNICODE buffer we'll need to
// convert MyString to UNICODE.
len = MultiByteToWideChar(CP_ACP, 0, MyString, -1, 0, 0);

// Allocate a UNICODE buffer of the needed length. SysAllocStringLen will
// also allocate room for a terminating 0 short, and the unsigned long count.
// SysAllocStringLen will fill in the unsigned long with the value of
// "len * sizeof(wchar_t)" and then return a pointer to the third short in
// the buffer it allocates. All that is left for us to do is simply stuff a
// UNICODE version of our C string into this buffer.
strptr = SysAllocStringLen(0, len);

// Convert MyString to UNICODE in the buffer allocated by SysAllocStringLen.
MultiByteToWideChar(CP_ACP, 0, MyString, -1, strptr, len);

// strptr is now a pointer (BSTR) to an Automation string datatype.</pre>
<p><b>Note:</b> Somebody must later free that buffer allocated by <code>SysAllocStringLen</code>, by passing <code>strptr</code> to <code>SysFreeString</code>. Typically, that somebody is whomever called <code>SysAllocStringLen</code> to allocate it.</p>
<p>Note that since the <code>BSTR</code> points past the unsigned long size, and the string is null-terminated anyway, you can treat a <code>BSTR</code> as if it is merely a wide char (<code>wchar_t</code>) data type. For example, you can pass it to <code>lstrlenW</code>
 to get the length in wide chars. But also note that, it's entirely 
possible that the string could have embedded 0s in it. If you write a 
function that expects to be passed a human-readable text string, then 
it's a good assumption that the <code>BSTR</code> won't be pointing to something with embedded zeroes in it. On the other hand, if the <code>BSTR</code> is pointing to binary data, then this may not be a good assumption. In this case, you can use <code>SysStringLen</code> to determine the true length in wide chars (or <code>SysStringByteLen</code> if you need the length in bytes).</p>
<p>There are other "Automation data types" too, such as a <code>long</code> (i.e., a 32-bit value). So our object's functions are not restricted to being passed only pointers to Automation strings.</p>
<p>In fact, some languages support the concept of a function being 
passed an argument which could be a choice of data types. Let's say, we 
have a <code>Print()</code> function. And, let's say, that this <code>Print</code> function takes one argument, which can be either a string pointer (<code>BSTR</code>), or a <code>long</code>,
 or maybe a variety of other Automation data types, and it will print 
whatever it is passed regardless. For example, if passed a <code>BSTR</code>, it will print the characters of that string. If passed a <code>long</code>, it will first do something akin to calling:</p><div class="pre-action-link" id="premain656020" style="width:100%;display:block;"><span id="prehide656020" onclick="processCodeBlocks.togglePre(656020);">Hide</span>  &nbsp; <span id="copycode656020" onclick="return processCodeBlocks.copyCode(656020);">Copy Code</span></div><pre id="pre656020" style="margin-top: 0px;" class="notranslate">sprintf(myBuffer, "%ld", thePassedLong)</pre>
<p>...and then print out the resulting string in <code>myBuffer</code>.</p>
<p>This <code>Print</code> function needs some way to know whether it is being passed a string or a <code>long</code>. If we want to put this <code>Print</code> function into our object, we can have the application pass us another Automation data type called a <code>VARIANT</code>. A <code>VARIANT</code>
 is simply a struct that wraps another Automation data type. (This is 
the one type of "struct" that all languages supporting COM must 
internally understand and be able to create, simply for the purpose of 
passing arguments to an object's function, or receiving back data.)</p>
<p>A <code>VARIANT</code> has two members. The first member, <code>vt</code>, is set to some value that tells what other kind of data type your <code>VARIANT</code> is wrapping. The other member is a union, which is where you store the other data type.</p>
<p>So, if we wrap a <code>BSTR</code> into a <code>VARIANT</code> struct, then we set the <code>VARIANT</code>'s <code>vt</code> member to <code>VT_BSTR</code>, and store our <code>BSTR</code> (i.e., pointer to that specially formatted UNICODE string) in the <code>VARIANT</code>'s <code>bstrVal</code> member. If we wrap a <code>long</code>, then we set the <code>VARIANT</code>'s <code>vt</code> member to <code>VT_I4</code>, and store our <code>long</code> in the <code>VARIANT</code>'s <code>lVal</code> member (which, due to the union, is really the same member as <code>bstrVal</code>).</p>
<blockquote>
<p><b>In conclusion</b>, in order to support script languages, our 
object's functions must be written to be passed only a certain set of 
data types, called automation data types. Likewise, any data we return 
must be in the form of an automation data type.</p></blockquote>
<p>If you look at the definition of our <code>SetString</code> function, you'll notice one problem. We defined it to be passed a <code>char</code> pointer as so:</p><div class="pre-action-link" id="premain59210" style="width:100%;display:block;"><span id="prehide59210" onclick="processCodeBlocks.togglePre(59210);">Hide</span>  &nbsp; <span id="copycode59210" onclick="return processCodeBlocks.copyCode(59210);">Copy Code</span></div><pre id="pre59210" style="margin-top: 0px;" class="notranslate">static HRESULT STDMETHODCALLTYPE SetString(IExample *this, char *str)</pre>
<p>This is an ANSI C string, which is not an automation data type. We need to replace this with a <code>BSTR</code> argument.</p>
<p>Our <code>GetString</code> function is even more troublesome for 
script languages. Not only is it defined to take an ANSI C string 
pointer, but the caller is expected to provide that non-UNICODE buffer, 
and our function modifies its contents. This is not automation 
compatible. When returning a <code>BSTR</code> to a script language, <b>we</b> must allocate the string and give it to the script engine. The script engine will call <code>SysFreeString</code> to free that string when done with it.</p>
<p>Given these requirements, the best thing to do is to change our <code>IExample</code> object so that its buffer member is a <code>BSTR</code>. When the script engine passes our <code>SetString</code> a <code>BSTR</code>, we'll make a copy of the string, and store this new <code>BSTR</code> in the buffer member. We'll then modify our <code>GetString</code> function to take a pointer to a <code>BSTR</code>
 (i.e., a handle) provided by the script engine. We'll create another 
copy of our string, and return it to the script engine (trusting that 
the script engine will free it).</p>
<p>So that we don't alter our original sources, I copied the contents of the <i>IExample</i> directory to a new directory named <i>IExample2</i>. I changed <i>IExample.c</i> to <i>IExample2.c</i>, and <i>IExample.h</i> to <i>IExample2.h</i>, etc.</p>
<p>In <i>IExample2.c</i>, let's rename our <code>MyRealIExample</code> struct to <code>MyRealIExample2</code>
 (to differentiate it from our original sources), and change the buffer 
member data type. (We'll also change the name of the member to 
"string"). Here is its new definition:</p><div class="pre-action-link" id="premain459449" style="width:100%;display:block;"><span id="prehide459449" onclick="processCodeBlocks.togglePre(459449);">Hide</span>  &nbsp; <span id="copycode459449" onclick="return processCodeBlocks.copyCode(459449);">Copy Code</span></div><pre id="pre459449" style="margin-top: 0px;" class="notranslate">typedef struct {
   IExample2Vtbl  *lpVtbl;
   DWORD          count;
   BSTR           string;
} MyRealIExample2;</pre>
<p>And here are our updated <code>SetString</code> and <code>GetString</code> functions:</p><div class="pre-action-link" id="premain482901" style="width:100%;display:block;"><span id="prehide482901" onclick="processCodeBlocks.togglePre(482901);">Hide</span>  &nbsp; <span id="preShrink482901" onclick="processCodeBlocks.shrinkExpand(482901);">Shrink</span> <img id="preimg482901" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(482901);">  &nbsp; <span id="copycode482901" onclick="return processCodeBlocks.copyCode(482901);">Copy Code</span></div><pre id="pre482901" style="margin-top: 0px;" processed="true" class="notranslate">static HRESULT STDMETHODCALLTYPE SetString(IExample2 

*this, BSTR str)
{
   // Make sure that caller passed a string
   if (!str) return(E_POINTER);

   // First, free any old BSTR we allocated
   if (((MyRealIExample2 *)this)-&gt;string)
       SysFreeString(((MyRealIExample2 *)this)-&gt;string);

   // Make a copy of the caller's string and save this new BSTR
   if (!(((MyRealIExample2 *)this)-&gt;string = 
           SysAllocStringLen(str, SysStringLen(str))))
      return(E_OUTOFMEMORY);

   return(NOERROR);
}

static HRESULT STDMETHODCALLTYPE GetString(IExample2 *this, BSTR *string)
{
   // Make sure that caller passed a handle
   if (!string) return(E_POINTER);

   // Create a copy of our string and return the BSTR in his handle. The
   // caller is responsible for freeing it
   if (!(*string = SysAllocString(((MyRealIExample2 *)this)-&gt;string)))
      return(E_OUTOFMEMORY);

   return(NOERROR);
}</pre>
<p>Also, our <code>Release</code> function must free that allocated string right before we free our <code>MyRealIExample2</code>:</p><div class="pre-action-link" id="premain208966" style="width:100%;display:block;"><span id="prehide208966" onclick="processCodeBlocks.togglePre(208966);">Hide</span>  &nbsp; <span id="copycode208966" onclick="return processCodeBlocks.copyCode(208966);">Copy Code</span></div><pre id="pre208966" style="margin-top: 0px;" class="notranslate">if (((MyRealIExample2 *)this)-&gt;string)
        SysFreeString(((MyRealIExample2 *)this)-&gt;string);
GlobalFree(this);
</pre>
<p>And finally, when our <code>IClassFactory</code> creates a <code>MyRealIExample2</code>, it should clear the string member:</p><div class="pre-action-link" id="premain30685" style="width:100%;display:block;"><span id="prehide30685" onclick="processCodeBlocks.togglePre(30685);">Hide</span>  &nbsp; <span id="copycode30685" onclick="return processCodeBlocks.copyCode(30685);">Copy Code</span></div><pre id="pre30685" style="margin-top: 0px;" class="notranslate">((MyRealIExample2 *)thisobj)-&gt;string = 0;</pre>
<p>Of course, we need to update these function definitions in <i>IExample2.h</i>:</p><div class="pre-action-link" id="premain84447" style="width:100%;display:block;"><span id="prehide84447" onclick="processCodeBlocks.togglePre(84447);">Hide</span>  &nbsp; <span id="copycode84447" onclick="return processCodeBlocks.copyCode(84447);">Copy Code</span></div><pre id="pre84447" style="margin-top: 0px;" class="notranslate">// Extra functions
STDMETHOD  (SetString)   (THIS_ BSTR) PURE;
STDMETHOD  (GetString)   (THIS_ BSTR *) PURE;</pre>
<p>We've now updated our object functions to use Automation data types.</p>
<h2><a name="DISPATCH">The</a> IDispatch functions</h2>
<p>Our next step is to add the <code>IDispatch</code> functions to our object. There are four <code>IDispatch</code>
 functions, already defined by Microsoft. We must write these four 
functions, and then add pointers to them in our object's VTable.</p>
<p><b>Important note:</b> In our VTable, these four pointers must be called <code>GetTypeInfoCount</code>, <code>GetTypeInfo</code>, <code>GetIDsOfNames</code>, and <code>Invoke</code>. They must appear in this order, after the three <code>IUnknown</code> functions (i.e., the first three pointers in our VTable), but before the pointers to any of our own extra functions (i.e., <code>SetString</code> and <code>GetString</code>). So, let's edit <i>IExample2.h</i>, and add the definitions for these four <code>IDispatch</code> functions. We'll change our object name from <code>IExample</code> to <code>IExample2</code>. Also, note that in the <code>DECLARE_INTERFACE_</code> line of our macro, we substitute the word <code>IDispatch</code> for <code>IUnknown</code>. This indicates that we're adding the standard <code>IDispatch</code> functions to our object.</p><div class="pre-action-link" id="premain6577" style="width:100%;display:block;"><span id="prehide6577" onclick="processCodeBlocks.togglePre(6577);">Hide</span>  &nbsp; <span id="copycode6577" onclick="return processCodeBlocks.copyCode(6577);">Copy Code</span></div><pre id="pre6577" style="margin-top: 0px;" class="notranslate">// IExample2's VTable
#undef  INTERFACE
#define INTERFACE IExample2
DECLARE_INTERFACE_ (INTERFACE, IDispatch)
{
   // IUnknown functions
   STDMETHOD  (QueryInterface)         (THIS_ REFIID, void **) PURE;
   STDMETHOD_ (ULONG, AddRef)          (THIS) PURE;
   STDMETHOD_ (ULONG, Release)         (THIS) PURE;
   // IDispatch functions
   STDMETHOD_ (ULONG, GetTypeInfoCount)(THIS_ UINT *) PURE;
   STDMETHOD_ (ULONG, GetTypeInfo)     (THIS_ UINT, LCID, ITypeInfo **) PURE;
   STDMETHOD_ (ULONG, GetIDsOfNames)   (THIS_ REFIID, LPOLESTR *, 
                                        UINT, LCID, DISPID *) PURE;
   STDMETHOD_ (ULONG, Invoke)          (THIS_ DISPID, REFIID, 
                                        LCID, WORD, DISPPARAMS *,
                                        VARIANT *, EXCEPINFO *, UINT *) PURE;
   // Extra functions
   STDMETHOD  (SetString)              (THIS_ BSTR) PURE;
   STDMETHOD  (GetString)              (THIS_ BSTR *) PURE;
};</pre>
<p>Because I'm creating another COM component, I ran <i>GUIDGEN.EXE</i> to create new GUIDs for my <code>IExample2</code> and <code>IExample2VTbl</code>, and pasted them into <i>IExample2.h</i>.
 This allows us to test this new DLL without needing to uninstall our 
original DLL, nor have the new DLL interfere with the original. 
Otherwise, if we used the same GUIDs, we'd have two registered COM 
components (DLLs) with the same GUIDs. Not a good thing.</p>
<p>I also ran <i>GUIDGEN.EXE</i> a third time to generate a third GUID. We're going to need this for our type library. I added it to <i>IExample2.h</i>, and gave it a C variable name of <code>CLSID_TypeLib</code>.</p>
<p>Now, we need to write those four <code>IDispatch</code> functions. 
Fortunately, Microsoft's OLE32 DLL has some generic functions we can 
call that do most of the work for these four functions. The only real 
work we need to do is to load our type library (which we'll be creating 
later in this article), and create a COM object called an <code>ITypeInfo</code> to give to a script engine. But even there, Microsoft provides some functions to do a lot of that work, namely <code>LoadRegTypeLib</code> to load the type library, and <code>GetTypeInfoOfGuid</code> to create an <code>ITypeInfo</code>.</p>
<p>Our <code>GetTypeInfoCount</code> function is easy. The caller passes us a handle to a <code>UINT</code>. We fill this in with a 1 if we have a type library, or 0 if we don't. We do:</p><div class="pre-action-link" id="premain340056" style="width:100%;display:block;"><span id="prehide340056" onclick="processCodeBlocks.togglePre(340056);">Hide</span>  &nbsp; <span id="copycode340056" onclick="return processCodeBlocks.copyCode(340056);">Copy Code</span></div><pre id="pre340056" style="margin-top: 0px;" class="notranslate">ULONG STDMETHODCALLTYPE GetTypeInfoCount(IExample2 *this, UINT *pCount)
{
   *pCount = 1;
   return(S_OK);
}</pre>
<p>Our <code>GetTypeInfo</code> function must return (to the script engine) a pointer to an <code>ITypeInfo</code> object that we create from our type library. What does an <code>ITypeInfo</code>
 object do? It manages the script engine's access to all of the 
information loaded from our type library. Remember, we said that we're 
not going to let anyone directly load and access our type library. 
Instead, we give the script engine an <code>ITypeInfo</code> object, whose functions parse our type library information and return specific information about a function in our <code>IExample2</code> object. For example, once we give our <code>ITypeInfo</code> to the script engine, that engine can call our <code>ITypeInfo</code>'s <code>GetFuncDesc</code> function to determine how many arguments are passed to our <code>GetString</code> function, what each type of argument is, and what <code>GetString</code> returns if anything.</p>
<p><i>"Oh great. More functions to write"</i>, you must be thinking. Yes, we could write all of the necessary functions for an <code>ITypeInfo</code> object, and put them in <i>IExample2.c</i>. We could then have <code>IExample2</code>'s <code>GetTypeInfo</code> function allocate one of our <code>ITypeInfo</code> objects, initialize it (i.e., store its VTable in it), and return it to the script engine.</p>
<p>But, we're not going to do this. We're going to save ourselves a bit of work. Microsoft has already written some generic <code>ITypeInfo</code> functions (contained in the OLE DLLs), and gives us a function we can call that will allocate an <code>ITypeInfo</code> for us, and fill in its VTable to these generic functions. We can then give this "generic" <code>ITypeInfo</code> to the script engine. All we need to do is load our type library into memory and "give" it to this generic <code>ITypeInfo</code>,
 and from then on, Microsoft's functions will handle doling out the 
information to the script engine. In order to take advantage of 
Microsoft's generic <code>ITypeInfo</code> functions, we must adhere to certain rules. We must make sure our <code>IExample2</code> object is defined as something called a <i>dual interface</i>. Let's not worry right now what that is. But we're going to adhere to this requirement.</p>
<p>Before we dive into our <code>GetTypeInfo</code> function, let me say
 one thing about a type library. It can contain strings that are meant 
to be displayed to humans. For example, if we want, we could tag our <code>GetString</code> function with a "text description" that reads: <i>This function returns an IExample2 object's string</i>. Then, for example, the Visual BASIC IDE could get our <code>ITypeInfo</code> object, call its <code>GetDocumentation</code> function to retrieve this description for <code>GetString</code>, and display it to a VB programmer who wants to call our <code>IExample</code>'s <code>GetString</code>.
 There are many human languages, so just like the resources for your 
EXE/DLL can be in different languages, so too does a type library have a
 "Language ID" (LCID). For this article, we're going to create only an 
English type library, and ignore any issues concerning loading a 
particular language type library. Just be aware that a script engine may
 pass our <code>GetTypeInfo</code> function a LCID other than English, if it desires another language.</p>
<p><code>GetTypeInfo</code> is defined as so:</p><div class="pre-action-link" id="premain32089" style="width:100%;display:block;"><span id="prehide32089" onclick="processCodeBlocks.togglePre(32089);">Hide</span>  &nbsp; <span id="copycode32089" onclick="return processCodeBlocks.copyCode(32089);">Copy Code</span></div><pre id="pre32089" style="margin-top: 0px;" class="notranslate">ULONG STDMETHODCALLTYPE GetTypeInfo(IExample2 *this, 
      UINT itinfo, LCID lcid, ITypeInfo **pTypeInfo)</pre>
<p>The <code>itinfo</code> argument is not used, and should be 0. The 
LCID specifies what language type library to use. Again, we ignore this 
since we're going to deal only with English. The final argument is where
 the script engine expects us to return a pointer to our <code>ITypeInfo</code> object.</p>
<p>We only ever need one <code>ITypeInfo</code> object because its contents do not change. So our <code>GetTypeInfo</code> function will simply make sure that our type library is loaded, and that we have gotten a pointer to Microsoft's generic <code>ITypeInfo</code>. We'll store this pointer in a global variable. We do need to increment the <code>ITypeInfo</code>'s reference count (i.e., call its <code>AddRef</code> function) every time the script engine calls our <code>GetTypeInfo</code>. (And of course, we expect the script engine to call <code>ITypeInfo</code>'s <code>Release</code> when done with the <code>ITypeInfo</code>). So, here is our <code>GetTypeInfo</code> function, and a helper function (<code>loadMyTypeInfo</code>) we write that does the real work of loading our type library and getting Microsoft's generic <code>ITypeInfo</code>. Note how our helper function calls the OLE API <code>LoadRegTypeLib</code>
 to do all the work of loading our type library. All we need to do is 
pass the GUID that I created for our type library (and put in <i>IExample2.h</i>, giving it the variable name <code>CLSID_TypeLib</code>).</p><div class="pre-action-link" id="premain608330" style="width:100%;display:block;"><span id="prehide608330" onclick="processCodeBlocks.togglePre(608330);">Hide</span>  &nbsp; <span id="preShrink608330" onclick="processCodeBlocks.shrinkExpand(608330);">Shrink</span> <img id="preimg608330" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(608330);">  &nbsp; <span id="copycode608330" onclick="return processCodeBlocks.copyCode(608330);">Copy Code</span></div><pre id="pre608330" style="margin-top: 0px;" processed="true" class="notranslate">ULONG STDMETHODCALLTYPE GetTypeInfo(IExample2 *this, 
      UINT itinfo, LCID lcid, ITypeInfo **pTypeInfo)
{
   HRESULT  hr;

   // Assume an error.
   *pTypeInfo = 0;

   if (itinfo) hr = ResultFromScode(DISP_E_BADINDEX);

   // If our ITypeInfo is already created,
   // just increment its ref count.
   else if (MyTypeInfo)
   {
      MyTypeInfo-&gt;lpVtbl-&gt;AddRef(MyTypeInfo);
      hr = 0;
   }
   else
   {
      // Load our type library and
      // get Microsoft's generic ITypeInfo object.
      hr = loadMyTypeInfo(this);
   }

   if (!hr) *pTypeInfo = MyTypeInfo;

   return(hr);
}

static HRESULT loadMyTypeInfo(void)
{
   HRESULT   hr;
   LPTYPELIB pTypeLib;

   // Load our type library and get a ptr to its TYPELIB. Note: This does an
   // implicit pTypeLib-&gt;lpVtbl-&gt;AddRef(pTypeLib).
   if (!(hr = LoadRegTypeLib(&amp;CLSID_TypeLib, 1, 0, 0, &amp;pTypeLib)))
   {
      // Get Microsoft's generic ITypeInfo,
      // giving it our loaded type library. We only
      // need one of these, and we'll store
      // it in a global. Tell Microsoft this is for
      // our IExample2's VTable, by passing that VTable's GUID.
      if (!(hr = pTypeLib-&gt;lpVtbl-&gt;GetTypeInfoOfGuid(
            pTypeLib, &amp;IID_IExample2, &amp;MyTypeInfo)))
      {
         // We no longer need the ptr
         // to the TYPELIB now that we've given it
         // to Microsoft's generic ITypeInfo.
         // Note: The generic ITypeInfo has done
         // a pTypeLib-&gt;lpVtbl-&gt;AddRef(pTypeLib),
         // so this TYPELIB ain't going away
         // until the generic ITypeInfo does
         // a pTypeLib-&gt;lpVtbl-&gt;Release too.
         pTypeLib-&gt;lpVtbl-&gt;Release(pTypeLib);

         // Since caller wants us to return our ITypeInfo pointer,
         // we need to increment its reference count. Caller is
         // expected to Release() it when done.
         MyTypeInfo-&gt;lpVtbl-&gt;AddRef(MyTypeInfo);
      }
   }

   return(hr);
}</pre>
<p>When we later create our type library, we'll need to assign each one of our own functions we add to <code>IExample2</code> (i.e., <code>GetString</code> and <code>SetString</code>)
 a numeric value, which Microsoft refers to as a DISPID (Dispatch ID). 
This can be any value of our choosing, but each function must have a 
unique DISPID. (Note: Do not use the value 0, or negative values). We'll
 arbitrarily assign a DISPID of 1 to <code>GetString</code>, and 2 to <code>SetString</code>.
 Script engines internally use this DISPID for faster calls to our 
functions, since it's quicker to lookup a function in some table via 
matching a numeric value versus comparison of a function name string.</p>
<p>Next, we write our <code>GetIDsOfNames</code> function. The purpose 
of this function is to allow the script engine to pass us the name of 
one of our own functions we added to <code>IExample2</code> (i.e., <code>GetString</code> or <code>SetString</code>), and we'll return the DISPID we assigned to that function. For example, if the engine passes us "<code>GetString</code>", then we'll return the DISPID 1.</p>
<p>Because we're going to define our <code>IExample2</code> as a "dual interface" when we create our type library, we can then call the OLE function <code>DispGetIDsOfNames</code>, which will do all the work that our <code>GetIDsOfNames</code>
 needs to do (i.e., parsing the info in our type library to look up the 
DISPID we assigned to a particular function). The only thing we need to 
do is make sure that we got a <code>ITypeInfo</code>, because that needs to be passed to <code>DispGetIDsOfNames</code>. So, here is our <code>GetIDsOfNames</code>:</p><div class="pre-action-link" id="premain870312" style="width:100%;display:block;"><span id="prehide870312" onclick="processCodeBlocks.togglePre(870312);">Hide</span>  &nbsp; <span id="copycode870312" onclick="return processCodeBlocks.copyCode(870312);">Copy Code</span></div><pre id="pre870312" style="margin-top: 0px;" class="notranslate">ULONG STDMETHODCALLTYPE GetIDsOfNames(IExample2 *this, 
      REFIID riid, LPOLESTR *rgszNames, UINT cNames, 
      LCID lcid, DISPID *rgdispid)
{
   if (!MyTypeInfo)
   {
      HRESULT hr;

      if ((hr = loadMyTypeInfo())) return(hr);
   }

   // Let OLE32.DLL's DispGetIDsOfNames()
   // do all the real work of using our type
   // library to look up the DISPID
   // of the requested function in our object
   return(DispGetIDsOfNames(MyTypeInfo, rgszNames, 
                            cNames, rgdispid));
}</pre>
<p>We have one last <code>IDispatch</code> function to write - <code>Invoke</code>. This is what the script engine calls to (indirectly) call another one of the functions we added to <code>IExample2</code> (i.e., <code>GetString</code> or <code>SetString</code>). The script engine passes the DISPID for the function it wants to call (i.e., 1 for <code>GetString</code>, or 2 for <code>SetString</code>). The engine also passes an array of <code>VARIANT</code> structs, filled in with the arguments to be passed to <code>GetString</code> or <code>SetString</code>. It also passes a <code>VARIANT</code> we need to fill in with any return value from the function (not the <code>HRESULT</code> return from <code>Invoke</code>, but rather, whatever our type library indicates is the return value from <code>GetString</code> or <code>SetString</code>).</p>
<p>So, what our <code>Invoke</code> function does is first look at the DISPID. If it's 1, we know that we have to call <code>GetString</code>. If it's 2, we know we have to call <code>SetString</code>. So immediately, you should be thinking <i>case statement</i>. And it could be a big <code>case</code> statement if you've added lots of functions to <code>IExample2</code>.</p>
<p>Next, we need to pull those arguments out of the <code>VARIANT</code>s and call the correct function, passing it the arguments. For example, if the script is calling <code>SetString</code>, we need to pull the <code>BSTR</code> out of the first <code>VARIANT</code> and pass it to <code>SetString</code>.</p>
<p>Here's a problem. A script engine is allowed to pass a <code>VARIANT</code> that wraps what may not be the exact data type we expect, but one that can be coerced into the correct type. Our <code>SetString</code> expects a <code>BSTR</code>
 (pointer to a string). But, let's assume the script engine wants to set
 our string member to the string "10". Now, this is how the engine could
 setup the <code>VARIANT</code> passed to us:</p><div class="pre-action-link" id="premain50504" style="width:100%;display:block;"><span id="prehide50504" onclick="processCodeBlocks.togglePre(50504);">Hide</span>  &nbsp; <span id="copycode50504" onclick="return processCodeBlocks.copyCode(50504);">Copy Code</span></div><pre id="pre50504" style="margin-top: 0px;" class="notranslate">VARIANT myArg;

myArg.vt = VT_BSTR;
myArg.bstrVal = SysAllocString(L"10");</pre>
<p>OK, we're good to go. It's passing us a <code>BSTR</code> wrapped in that <code>VARIANT</code>.</p>
<p>But the engine could instead pass us a <code>long</code>, as so:</p><div class="pre-action-link" id="premain336711" style="width:100%;display:block;"><span id="prehide336711" onclick="processCodeBlocks.togglePre(336711);">Hide</span>  &nbsp; <span id="copycode336711" onclick="return processCodeBlocks.copyCode(336711);">Copy Code</span></div><pre id="pre336711" style="margin-top: 0px;" class="notranslate">VARIANT myArg;

myArg.vt = VT_I4;
myArg.lVal = 10;</pre>
<p>Now, our <code>Invoke</code> function has to see that this is not <code>VT_BSTR</code>, and do the conversion ourselves before we call <code>SetString</code> (error checking omitted):</p><div class="pre-action-link" id="premain484394" style="width:100%;display:block;"><span id="prehide484394" onclick="processCodeBlocks.togglePre(484394);">Hide</span>  &nbsp; <span id="preShrink484394" onclick="processCodeBlocks.shrinkExpand(484394);">Shrink</span> <img id="preimg484394" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(484394);">  &nbsp; <span id="copycode484394" onclick="return processCodeBlocks.copyCode(484394);">Copy Code</span></div><pre id="pre484394" style="margin-top: 0px;" processed="true" class="notranslate">// Determine which function to call based upon the DISPID
// the caller passed us.
switch (dispid)
{
   // GetString()
   case 1:
      // Here we'd call GetString with the appropriate args.
      break;

   // SetString()
   case 2:
      // Did he pass the BSTR that SetString expects?
      if (params-&gt;rgdispidNamedArgs[0]-&gt;vt != VT_BSTR)
      {
         // Nope. We've got to try to convert whatever he passed
         // into a BSTR.

         // Did he pass a long?
         if (params-&gt;rgdispidNamedArgs[0]-&gt;vt == VT_I4)
         {
             // Create a BSTR out of that long.
             wchar_t temp[33];

             wsprintW(temp, L"%d", params-&gt;rgdispidNamedArgs[0]-&gt;lVal);
             params-&gt;rgdispidNamedArgs[0]-&gt;bstrVal = SysAllocString(temp);

             // NOTE: The engine will free this BSTR when it calls
             // VariantClear() on params-&gt;rgdispidNamedArgs[0].
         }
         else
         {
            // Here we need to check/convert even more possible datatypes!
            // If we exhaust the logical possibilites, return DISP_E_TYPEMISMATCH.
         }
     }

     // Call SetString with the BSTR arg.
     return(this-&gt;lpVtbl-&gt;SetString(this, params-&gt;rgdispidNamedArgs[0]-&gt;bStrVal));
}</pre>
<p><i>"Oh great! This could turn into major work for me, given there are lots of functions!"</i>, you're thinking. Yes, it could. But at least, Microsoft does provide a bunch of OLE APIs to convert a <code>VARIANT</code> from one type to another. So, we can simply do:</p><div class="pre-action-link" id="premain557345" style="width:100%;display:block;"><span id="prehide557345" onclick="processCodeBlocks.togglePre(557345);">Hide</span>  &nbsp; <span id="copycode557345" onclick="return processCodeBlocks.copyCode(557345);">Copy Code</span></div><pre id="pre557345" style="margin-top: 0px;" class="notranslate">// SetString()
case 2:
   if ((hr = VariantChangeType(¶ms-&gt;rgdispidNamedArgs[0],
       ¶ms-&gt;rgdispidNamedArgs[0], 0, VT_BSTR))) return(hr);
   return(this-&gt;lpVtbl-&gt;SetString(this, 
          params-&gt;rgdispidNamedArgs[0]-&gt;bStrVal));</pre>
<p>But, here's something even better. Because we're going to define <code>IExample2</code> as a dual interface, we can call the Microsoft function <code>DispInvoke</code> to do <b>all</b>
 of the work for us. It uses our type library to match that DISPID with 
the correct function to call, checks/converts the arguments, calls the 
correct function, and even messages the return value into the <code>VARIANT</code> the engine passed for that purpose. The only thing we need to do, like in our <code>GetIDsOfNames</code> function, is make sure that we have got a <code>ITypeInfo</code> because that needs to be passed to the <code>DispInvoke</code>. So, here's our <code>Invoke</code>:</p><div class="pre-action-link" id="premain939903" style="width:100%;display:block;"><span id="prehide939903" onclick="processCodeBlocks.togglePre(939903);">Hide</span>  &nbsp; <span id="copycode939903" onclick="return processCodeBlocks.copyCode(939903);">Copy Code</span></div><pre id="pre939903" style="margin-top: 0px;" class="notranslate">ULONG STDMETHODCALLTYPE Invoke(IExample2 *this, 
      DISPID dispid, REFIID riid, LCID lcid,
      WORD wFlags, DISPPARAMS *params, VARIANT *result, 
      EXCEPINFO *pexcepinfo, UINT *puArgErr)
{
   // We implement only a "default" interface
   if (!IsEqualIID(riid, &amp;IID_NULL))
      return(DISP_E_UNKNOWNINTERFACE);

   // We need our ITypeInfo (to pass to DispInvoke)
   if (!MyTypeInfo)
   {
      HRESULT hr;

      if ((hr = loadMyTypeInfo())) return(hr);
   }

   // Let OLE32.DLL's DispInvoke() do all
   // the real work of calling the appropriate
   // function in our object, and massaging
   // the passed args into the correct format
   return(DispInvoke(this, MyTypeInfo, dispid, wFlags, 
          params, result, pexcepinfo, puArgErr));
}</pre>
<p>And, that takes care of all the <code>IDispatch</code> functions.</p>
<blockquote>
<p><b>In conclusion</b>, in order to support script languages, our object's VTable must include the four standard <code>IDispatch</code> functions. They must appear immediately after the first three, <code>IUnknown</code> functions (<code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code>).
 To make it easier to implement them, we can define our VTable as "dual 
interface" (in our type library) and then call some Microsoft OLE 
functions to do most of the real work.</p></blockquote>
<h2><a name="LIB">The</a> type library</h2>
<p>Our next step is to create our type library. First, we need to create
 the "source" file that contains the definitions of our object and its 
VTable, and their GUIDs, much like we created <i>IExample.h</i> for the benefit of our C compiler. But, the format of this source file will be different than <i>IExample.h</i>, and we will compile it with a special utility called <i>MIDL.EXE</i> (which ships with your compiler, or can be found in Microsoft's Windows Platform SDK).</p>
<p>Typically, this source file's name ends with the extension <i>.IDL</i>. If so, when we add it to our Visual C++ project, Visual C++'s IDE will automatically invoke <i>MIDL.EXE</i> on it to turn it into a binary file whose name ends with the extension <i>.TLB</i>. That TLB file is our type library.</p>
<p>In the <i>IExample2</i> directory, you will find the file <i>IExample2_extra.idl</i> which is the source for our type library. The syntax has some similarities with C++. A line preceded with <code>//</code> is a comment. And, C style opening and closing braces <code>{</code> and <code>}</code> are used to contain a particular "structure" or entity.</p>
<p>The IDL begins with the following lines:</p><div class="pre-action-link" id="premain434475" style="width:100%;display:block;"><span id="prehide434475" onclick="processCodeBlocks.togglePre(434475);">Hide</span>  &nbsp; <span id="copycode434475" onclick="return processCodeBlocks.copyCode(434475);">Copy Code</span></div><pre id="pre434475" style="margin-top: 0px;" class="notranslate">[uuid(E1124082-5FCD-4a66-82A6-755E4D45A9FC), version(1.0), 

helpstring("IExample2 COM server")]
library IExample2
{</pre>
<p>The first line is enclosed in brackets. It contains three particular 
bits of info, each separated by a comma. The first bit of info is the 
GUID for our type library. Note that it is the same GUID as specified in
 <i>IExample2.h</i> for <code>CLSID_TypeLib</code> (i.e., it's that extra GUID I generated to use for our type library).</p>
<p>Next, is the version number for our type library (which I've chosen as 1.0).</p>
<p>Last, is any help description (for our type library) that we'd like 
some object browser to display to a programmer (such as Visual BASIC's 
object browser may do). Here, I identity what my COM component is/does. 
For example, if you were creating a COM component that reads UPC bar 
codes, perhaps your help string would be "Acme Brand UPC bar code 
reader".</p>
<p>The next line must start with a <code>library</code> keyword. After this, you can give some name to the type library. I just chose <code>IExample2</code>, but it could be anything of your choice. Note that this is not related to the actual filename of the TLB file.</p>
<p>Finally, we have an opening brace. Everything between this and the 
final closing brace in our IDL source will be part of our type library. 
This is where we put the definitions of our <code>IExample2</code> object and its VTable.</p>
<p>The next line:</p><div class="pre-action-link" id="premain940684" style="width:100%;display:block;"><span id="prehide940684" onclick="processCodeBlocks.togglePre(940684);">Hide</span>  &nbsp; <span id="copycode940684" onclick="return processCodeBlocks.copyCode(940684);">Copy Code</span></div><pre id="pre940684" style="margin-top: 0px;" class="notranslate">importlib("STDOLE2.TLB");</pre>
<p>is like a <code>#include</code> statement in a <i>.H</i> file. It includes the contents of Microsoft's <i>STDOLE2.TLB</i> file (shipped with your compiler, or in the SDK) which defines basic COM objects such as <code>IUnknown</code> and <code>IDispatch</code>. We need to reference this since our <code>IExample2</code> VTable has the <code>IDispatch</code> functions (and therefore the <code>IUnknown</code> functions too) appearing at the start of it.</p>
<p>What follows is the start of our <code>IExample2</code>'s VTable definition. It looks like so:</p><div class="pre-action-link" id="premain838828" style="width:100%;display:block;"><span id="prehide838828" onclick="processCodeBlocks.togglePre(838828);">Hide</span>  &nbsp; <span id="copycode838828" onclick="return processCodeBlocks.copyCode(838828);">Copy Code</span></div><pre id="pre838828" style="margin-top: 0px;" class="notranslate">[uuid(B6127C55-AC5F-4ba0-AFF6-7220C95EEF4D), dual, 
      oleautomation, hidden, nonextensible]
interface IExample2Vtbl : IDispatch
{</pre>
<p>The first line is between brackets, and it contains the GUID for our <code>IExample2</code>'s VTable (which you'll note is the same GUID identified as <code>IID_IExample2</code> in <i>IExample2.h</i>; it must be so).</p>
<p>This line also contains several keywords that describe our VTable. The most important keyword is "<code>dual</code>". This is how we indicate that <code>IExample2</code> is a "dual interface". What this means is that, in addition to allowing some C/C++ application to directly call our <code>SetString</code> and <code>GetString</code> functions via <code>IExample2</code>'s VTable (like you saw in the demo C application with the first article), that same VTable also has the four <code>IDispatch</code> functions in it which a script engine such as VBScript can use to (indirectly) call <code>SetString</code> and <code>GetString</code> via <code>Invoke</code>. That's why it is called "<code>dual</code>". This same VTable works for both C/C++ apps that want to call our <code>SetString</code> and <code>GetString</code> functions directly, as well as a script engine that needs to call them via our <code>Invoke</code> function.</p>
<p>The <code>oleautomation</code> keyword means that we are using only Automation data types for arguments passed to the <code>SetString</code> and <code>GetString</code> functions, and also for any returned values.</p>
<p><b>Note:</b> The <code>dual</code> keyword automatically implies <code>oleautomation</code>. So, we technically don't need to specify <code>oleautomation</code>. But, I do anyway. If you identify a VTable with the <code>oleautomation</code>
 keyword, and then you try to use some non-Automation data type as an 
argument (or a return value) in one of your functions, the <i>MIDL.EXE</i> will give an error. Note that older versions of <i>MIDL.EXE</i> may flag newer Automation data types as an error, so make sure you use the <i>MIDL.EXE</i> in the latest Platform SDK.</p>
<p>The <code>hidden</code> keyword simply means that we don't want our VTable itself to be listed in some object browser. We want to show only our <code>IExample2</code> object, which we'll define presently.</p>
<p>The <code>nonextensible</code> keyword means that we won't be doing 
something unexpected like adding extra functions (which aren't defined 
in our type library) to <code>IExample2</code>'s VTable when we actually allocate and give an <code>IExample2</code> object to someone.</p>
<p>The next line must start with <code>interface</code> to indicate that
 we're defining a VTable. This is followed by whatever name we decide to
 give to this VTable in our IDL source. We could call it <code>IExample2Vtbl</code>, or whatever. I went with "<code>IExample2Vtbl</code>". We also specify the <code>IDispatch</code> type since our <code>IExample2</code> VTable does, in fact, start with an <code>IDispatch</code> (and of course, an <code>IUnknown</code> before that, since <code>IDispatch</code> implies <code>IUnknown</code> too).</p>
<p><b>Note:</b> If our VTable did not have the four <code>IDispatch</code> functions, then we would define it as the <code>IUnknown</code> type instead. 
</p><p>Finally, we have an opening C brace. After this is where we list all of the functions in our VTable. It looks like this:</p><div class="pre-action-link" id="premain636646" style="width:100%;display:block;"><span id="prehide636646" onclick="processCodeBlocks.togglePre(636646);">Hide</span>  &nbsp; <span id="copycode636646" onclick="return processCodeBlocks.copyCode(636646);">Copy Code</span></div><pre id="pre636646" style="margin-top: 0px;" class="notranslate">[helpstring("Sets the test string.")]
[id(1)] HRESULT SetString([in] BSTR str);
[helpstring("Gets the test string.")]
[id(2)] HRESULT GetString([out, retval] BSTR *strptr);</pre>
<p>First of all, you'll note that we don't define the <code>IUnknown</code> (<code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code>) nor the <code>IDispatch</code> (<code>GetTypeInfoCount</code>, <code>GetTypeInfo</code>, <code>GetIDsOfNames</code>, and <code>Invoke</code>) functions. We don't have to, because we specified <code>IDispatch</code> as our VTable type, so these automatically get added by the <i>MIDL.EXE</i> (which knows about those functions because we imported <i>STDOLE.TLB</i>).</p>
<p>So, we list only those functions we added to the end of <code>IExample2</code>'s VTable (i.e., <code>SetString</code> and <code>GetString</code>). These <b>must</b> be listed in the same order as they appear in <i>IExample2.h</i>'s definition of our VTable.</p>
<p>We've specified a help string before each function. Again, this is 
just text that an object browser would display to a programmer.</p>
<p>For each function, we first specify the DISPID that we choose to give it. Remember that we arbitrarily decided to choose 1 for <code>SetString</code> and 2 for <code>GetString</code>.</p>
<p>The rest of the definition for each function looks the same as in <i>IExample2.h</i>,
 except for one thing. Before each argument, we have to specify whether 
the argument is something that is initialized to a particular value by 
the script engine before it is passed to us (i.e., an <code>[in]</code> argument), or is an un-initialized argument that the engine expects us to fill in with some value (i.e., an <code>[out]</code>
 argument). Or maybe, it's even supposed to be an argument that the 
script engine initializes to some value, and then also expects us to 
modify it with a new value (i.e., an <code>[in, out]</code> argument). Or, maybe it can be an argument that is passed to us, which the engine expects our <code>Invoke</code> function to store in that special <code>VARIANT</code> the engine passes for the purpose of returning the value (i.e., an <code>[out, retval]</code> argument).</p>
<p><code>SetString</code> expects to be passed a <code>BSTR</code> that the engine has set to a particular value. So, we identify that as <code>[in]</code>.</p>
<p>Since <code>GetString</code> expects to be passed a <code>BSTR</code> pointer that we will fill in with a copy of a string we allocated, we should specify this as an <code>[out]</code> argument. Unfortunately, for reasons I won't get into here, Microsoft doesn't allow simply <code>[out]</code>. We must either use <code>[in, out]</code> or <code>[out, retval]</code>. The difference between the two is whether we want our allocated <code>BSTR</code> to be returned to the script as the return value of its call to <code>GetString</code> (i.e., <code>[out, retval]</code>), or whether the script will pass the name of some variable to <code>GetString</code> to be filled in (i.e., <code>[in, out]</code>). In other words, it depends upon how we want the script to call our <code>GetString</code> function. We have two choices, and here are the choices illustrated using VBScript:</p><div class="pre-action-link" id="premain358033" style="width:100%;display:block;"><span id="prehide358033" onclick="processCodeBlocks.togglePre(358033);">Hide</span>  &nbsp; <span id="copycode358033" onclick="return processCodeBlocks.copyCode(358033);">Copy Code</span></div><pre id="pre358033" style="margin-top: 0px;" class="notranslate" lang="vbscript">newString = GetString()  <span class="code-comment">'</span><span class="code-comment"> [out, retval]</span>
GetString(newString)     <span class="code-comment">'</span><span class="code-comment"> [in, out]</span></pre>
<p>The former looks more natural to me, so we'll go ahead and define the argument passed to <code>GetString</code> as <code>[out, retval]</code>.</p>
<p><b>Note:</b> Only one argument passed to your function can be marked as <code>[out, retval]</code>. The remaining arguments must be either <code>[in]</code> or <code>[in, out]</code>.</p>
<p>We end the definition of our VTable with a closing brace. 
</p><p>Now, we get to the definition of our <code>IExample2</code> object. It looks like so:</p><div class="pre-action-link" id="premain490431" style="width:100%;display:block;"><span id="prehide490431" onclick="processCodeBlocks.togglePre(490431);">Hide</span>  &nbsp; <span id="copycode490431" onclick="return processCodeBlocks.copyCode(490431);">Copy Code</span></div><pre id="pre490431" style="margin-top: 0px;" class="notranslate">[uuid(520F4CFD-61C6-4eed-8004-C26D514D3D19), 
      helpstring("IExample2 object."), appobject]
coclass IExample2
{
   [default] interface IExample2Vtbl;
}</pre>
<p>The first line specifies the GUID for our <code>IExample2</code> object. Again, note that it is the same GUID defined in <i>IExample2.h</i> as <code>CLSID_IExample2</code>, and it must be so.</p>
<p>We specify a help string that lets an object browser know what this particular object is/does.</p>
<p>The <code>appobject</code> keyword indicates that our <code>IExample2</code> object can be gotten via <code>CoGetClassObject</code>.</p>
<p>The next line must start with <code>coclass</code>, followed by what we decide to call our object in this IDL source.</p>
<p>Within the braces, we put a line that indicates that our object begins with the VTable that we identified as "<code>IExample2Vtbl</code>" in our IDL file. This line contains the <code>interface</code> keyword, followed by the name of our VTable. We preface it with the <code>default</code>
 keyword (enclosed in brackets) to indicate that this is the VTable a 
script engine should assume is the one that it will get in its <code>IExample2</code>
 object. (We haven't talked about this yet, but it's possible for an 
object to have pointers to more than one VTable inside it. This is known
 as "multiple interfaces". But trying to get such an object to work with
 script engines is a major hassle, so we'll avoid it altogether. Even 
though we have only one VTable in <code>IExample2</code>, we still need to mark it as the default one.)</p>
<p>We finish up with a couple closing braces, and our IDL file is done. You can compile it with <i>MIDL.EXE</i> (or add the <i>IExample2_extra.idl</i> to your Visual C++ project and let the IDE run <i>MIDL.EXE</i> on it). If there are no problems, you should end up with a binary file named <i>IExample2.tlb</i>. That's our type library.</p>
<p>It's possible to embed that <i>.TLB</i> file in the resources of our DLL, and have it loaded from there. But I like to keep the <i>.TLB</i> separate from the DLL. Why? Because C/C++ applications don't need the <i>.TLB</i>, nor do compiled Visual BASIC apps. The <i>.TLB</i>
 is needed only for interpreted Visual BASIC, VBScript, and other such 
interpreted languages. (And you do need to distribute the type library 
for those programmers.)</p>
<blockquote>
<p><b>In conclusion</b>, an IDL file contains the "source code" for our 
type library. We put the definitions of our objects and their VTables in
 this file, much like we do in a C include file, but in a slightly 
different format. It is compiled with <i>MIDL.EXE</i> to create a <i>.TLB</i> file which is our actual, binary type library. This <i>.TLB</i>
 file can either be embedded in our DLL's resources, or shipped along 
with our DLL, to allow script engines to use our component.</p></blockquote>
<h2><b><a name="REG">Registering</a> the type library</b></h2>
<p>We're done with our updated component. Of course, before anyone can 
use it, we need to install/register it. In the first article, you'll 
recall, we wrote a utility to register our component. We need to make a 
very simple addition to that code, because our type library (<i>.TLB</i>
 file) needs to be registered too. So, we'll do that in the same 
installation utility. Microsoft provides an API to do all of the work of
 registering a type library: <code>RegisterTypeLib</code>.</p>
<p>But before we look at that, there's another matter to discuss. Visual
 BASIC programmers don't like to deal with complicated things like "big 
numbers". A GUID looks too scary to them. So, Microsoft decided that COM
 developers could associate a "Product ID" (ProdID) with their 
component. And instead of using our <code>IExample2</code> GUID to 
create our object, a Visual BASIC programmer will use our ProdID 
instead. So what's a ProdID? It's just some unique string you choose to 
identify your component. Typically, you'll take your main object name 
(here, we have <code>IExample2</code>), and append some interface name 
to it, and maybe even a version number, each separated by a dot. I'm 
just going to arbitrarily choose <b>IExample2.object</b> as my ProdID. In order to associate this ProdID with our <code>IExample2</code>,
 we need to set a couple extra registry keys. We'll do that in our 
installation utility as well. All we do is create a registry key named 
"IExample2.object" (i.e., our chosen ProdID). Then, we create a subkey 
named "CLSID" under that, and set its default value to our <code>IExample2</code> GUID. The only tricky part is that the GUID has to be formatted into a human-readable string.</p>
<p>In the directory <i>RegIExample2</i>, there is an updated 
installation utility which creates the extra ProdID registry keys, and 
calls RegisterTypeLib to register our type library. The additions are 
trivial, so you can peruse the commented code to study the details.</p>
<p>After running this installation utility, a script engine can now use our component.</p>
<p>Of course, our uninstall utility needs to be updated to delete the extra registry keys. And, Microsoft provides <b>UnRegisterTypeLib</b> to undo what RegisterTypeLib does. Peruse the updated code in the directory <i>UnregIExample2</i>.</p>
<blockquote>
<p><b>In conclusion</b>, the type library (i.e., the TLB file) must be registered, just like our <code>IExample</code>
 object itself. This is easily done with RegisterTypeLib. Furthermore, 
we should choose a ProdID, which is just a non-scary string that a VB 
programmer can use in lieu of our object's GUID, and set up some 
registry keys to associate this ProdID with our GUID.</p></blockquote>
<h2><a name="VB">A</a> VBScript example</h2>
<p>Let's take a trivial VBScript example of using <code>IExample2</code>. We'll simply call <code>SetString</code> to set <code>IExample2</code>'s string member to "Hello World". Then, we'll call <code>GetString</code> to retrieve that string (into another VBScript variable) and display it (so we can be sure it was set/retrieved properly).</p><div class="pre-action-link" id="premain668371" style="width:100%;display:block;"><span id="prehide668371" onclick="processCodeBlocks.togglePre(668371);">Hide</span>  &nbsp; <span id="copycode668371" onclick="return processCodeBlocks.copyCode(668371);">Copy Code</span></div><pre id="pre668371" style="margin-top: 0px;" class="notranslate" lang="vbscript"><span class="code-keyword">set</span> myObj = <span class="code-keyword">CreateObject</span>(<span class="code-string">"</span><span class="code-string">IExample2.object"</span>)
myObj.SetString(<span class="code-string">"</span><span class="code-string">Hello world"</span>)
copy = myObj.GetString()
MsgBox copy, <span class="code-digit">0</span>, <span class="code-string">"</span><span class="code-string">GetString return"</span></pre>
<p>First, the VBScript gets one of our <code>IExample2</code> objects. The script calls the VB engine's <code>CreateObject</code>. Note that our <code>IExample2</code> ProdID has been passed. <code>CreateObject</code> first calls <code>CLSIDFromProgID</code> to look up <code>IExample2</code>'s GUID from that ProdID. Then, <code>CreateObject</code> calls <code>CoCreateInstance</code> to get a pointer to an <code>IExample2</code> that our DLL allocates. The script stores this in the variable <code>myObj</code>.</p>
<p>Next, the script calls our <code>IExample2</code>'s <code>SetString</code>, passing the string "Hello World". The script engine does this by calling <code>IExample2</code>'s <code>GetIDsOfNames</code> to get the DISPID for <code>SetString</code>, then calls <code>IExample2</code>'s <code>Invoke</code>, passing a <code>VARIANT</code> wrapping a <code>BSTR</code> of "Hello World".</p>
<p>Next, the script calls our <code>IExample2</code>'s <code>GetString</code>. Again, the script engine calls <code>GetIDsOfNames</code> and <code>Invoke</code>. The script stores the string we (i.e., <code>Invoke</code>) return in the variable <code>copy</code>.</p>
<p>Finally, the script displays what <code>GetString</code> returned.</p>
<p>But don't run this script yet. We're going to change something about our component first.</p>
<h2><b><a name="PROP">A</a> Property</b></h2>
<p>Consider the following C code:</p><div class="pre-action-link" id="premain304029" style="width:100%;display:block;"><span id="prehide304029" onclick="processCodeBlocks.togglePre(304029);">Hide</span>  &nbsp; <span id="copycode304029" onclick="return processCodeBlocks.copyCode(304029);">Copy Code</span></div><pre id="pre304029" style="margin-top: 0px;" class="notranslate">typedef struct {
   char *  string;
} IExample;

IExample example;

example.string = "Hello World";</pre>
<p>Wouldn't it be nice if VBScript could do a similar thing to set our <code>IExample2</code>'s string member? For example, instead of calling <code>SetString</code>, the VBScript could do this:</p><div class="pre-action-link" id="premain7219" style="width:100%;display:block;"><span id="prehide7219" onclick="processCodeBlocks.togglePre(7219);">Hide</span>  &nbsp; <span id="copycode7219" onclick="return processCodeBlocks.copyCode(7219);">Copy Code</span></div><pre id="pre7219" style="margin-top: 0px;" class="notranslate" lang="vbscript">myObj.<span class="code-keyword">string</span> = <span class="code-string">"</span><span class="code-string">Hello World"</span></pre>
<p>But although it looks like the script is directly accessing our <code>IExample2</code>'s string member, this would internally translate into a call to our <code>SetString</code>, passing "Hello World".</p>
<p>And so too, the script could do this to retrieve the value of <code>IExample2</code>'s string member (and assign it to the <code>copy</code> variable):</p><div class="pre-action-link" id="premain274803" style="width:100%;display:block;"><span id="prehide274803" onclick="processCodeBlocks.togglePre(274803);">Hide</span>  &nbsp; <span id="copycode274803" onclick="return processCodeBlocks.copyCode(274803);">Copy Code</span></div><pre id="pre274803" style="margin-top: 0px;" class="notranslate" lang="vbscript">copy = myObj.<span class="code-keyword">string</span></pre>
<p>And again, this would internally translate to a call to our <code>GetString</code>, and the return value is assigned to <code>copy</code>.</p>
<p>Can we do that? Yes, we can. But we need to change the definitions of <code>SetString</code> and <code>GetString</code>, not in our C code, nor in our <i>.H</i> file, but rather, in our <i>.IDL</i> file. Since <code>SetString</code> sets the value of a member, we need to mark it as a "property set" function. And since <code>GetString</code> retrieves the value of a member, we need to mark it as a "property get" function. In the IDL file, we also rename <code>GetString</code> and <code>SetString</code>
 to both be what member name we want the VBScript to use. Here, we'll 
choose "string". So, here is how we change the definitions in our IDL 
file:</p><div class="pre-action-link" id="premain228046" style="width:100%;display:block;"><span id="prehide228046" onclick="processCodeBlocks.togglePre(228046);">Hide</span>  &nbsp; <span id="copycode228046" onclick="return processCodeBlocks.copyCode(228046);">Copy Code</span></div><pre id="pre228046" style="margin-top: 0px;" class="notranslate">[id(1), propput] HRESULT string([in] BSTR);
[id(1), propget] HRESULT string([out, retval] BSTR *);</pre>
<p>All we've done is add "<code>propput</code>" to <code>SetString</code> (and change the function name to "string"). We also added "<code>propget</code>" to <code>GetString</code>, and changed its function name to "string" as well.</p>
<p><i>"Wait a minute. How can you have two functions with the same name?"</i>, you may ask. We don't. The real function names are still <code>SetString</code> and <code>GetString</code>. After all, these appear in <i>IExample2.h</i>'s
 VTable definition in the same place that they appear in our IDL VTable 
definition. It's only that our type library considers the names to both 
be "string", and it knows that they are two different functions because 
one sets the value (<code>propput</code>) and the other retrieves the value (<code>propget</code>).</p>
<p>But in order to declare a function as <code>propget</code>, it must take exactly two arguments. First, of course, is a pointer to our object. The second argument must be declared as <code>[in]</code>, and it should be the value to set the member. For example, since <code>IExample2</code>'s string member needs to be set to a <code>BSTR</code> (pointer), we define the argument as a <code>BSTR</code>. If the string member had been defined as a <code>long</code>, we would have defined the argument as "<code>long</code>". As long as we stick to automation data types, we're OK.</p>
<p>And in order to declare a function as <code>propput</code>, it must take exactly two arguments. First, of course, is a pointer to our object. The second argument must be declared as <code>[out, retval]</code>, and it should be a pointer to where we return the member's value. For example, since <code>IExample2</code>'s string member is a <code>BSTR</code> (pointer), we define the argument as a <code>BSTR *</code> (which is actually a handle since <code>BSTR</code> itself is a pointer). If the string member had been defined as a <code>long</code>, we would have defined the argument as "<code>long *</code>".</p>
<p>I've changed the above two lines in <i>IExample2_extra.idl</i>, and renamed it to <i>IExample2.idl</i>. Run <i>MIDL.EXE</i> on it to produce a new <i>.TLB</i> file.</p>
<p>Now, we can rewrite our VBScript example as so:</p><div class="pre-action-link" id="premain483476" style="width:100%;display:block;"><span id="prehide483476" onclick="processCodeBlocks.togglePre(483476);">Hide</span>  &nbsp; <span id="copycode483476" onclick="return processCodeBlocks.copyCode(483476);">Copy Code</span></div><pre id="pre483476" style="margin-top: 0px;" class="notranslate" lang="vbscript"><span class="code-keyword">set</span> myObj = <span class="code-keyword">CreateObject</span>(<span class="code-string">"</span><span class="code-string">IExample2.object"</span>)
myObj.<span class="code-keyword">string</span> = <span class="code-string">"</span><span class="code-string">Hello World"</span>
MsgBox myObj.<span class="code-keyword">string</span>, <span class="code-digit">0</span>, <span class="code-string">"</span><span class="code-string">GetString return"</span></pre>
<blockquote>
<p><b>In conclusion</b>, if you wish to allow a script to set the value 
of some data member of your object, add a function to set the value, and
 mark it as <code>propput</code> in the IDL file. In the IDL file, the 
function name will simply be the member name. The second argument passed
 to the function should be marked <code>[in]</code> and be the desired 
value. If you wish to allow a script to retrieve the value of some data 
member of your object, add a function to retrieve the value, and mark it
 as <code>propget</code> in the IDL file. In the IDL file, the function 
name will simply be the member name. The second argument passed to the 
function should be marked <code>[out, retval]</code> and be a pointer to where you return the value.</p></blockquote>
<p><b>Note:</b> You do not need to supply both a <code>propget</code> and a <code>propset</code>
 for a given member. You can supply one or the other. For example, if we
 wanted to make the string member a read-only value, then we would 
eliminate our <code>SetString</code> function, and remove that <code>propput</code> line from our IDL file (as well as remove <code>SetString</code> from <i>IExample2.h</i>'s VTable definition).</p>
<h2><a name="C">An</a> updated example C application</h2>
<p>Because we changed the data types passed to <code>SetString</code> and <code>GetString</code>, we must update our C/C++ clients to pass the correct data types. This is fairly trivial, and simply involves using <code>SysAllocString</code> where we need to get a <code>BSTR</code>, or <code>SysFreeString</code> where we need to free one. The updated C example is in the directory <i>IExampleApp2</i>.</p>
<h2><a name="EXE">A</a> COM component in an EXE</h2>
<p>Instead of packaging our COM component into a DLL, we could instead 
package it into its own EXE. The advantage of this is that the EXE runs 
in its own process space, and therefore, any crash of the application 
doesn't crash the COM component (or vice versa, necessarily). The 
disadvantage is that the OS must do "data marshalling" to allow data to 
be passed between process boundaries, so things can run more slowly.</p>
<p>The great news is that very little in our DLL needs to be changed. In the directory <i>IExampleExe</i>, you'll find a project to build an EXE out of the code we used to build <code>IExample2</code>. I've changed the name of the files <i>IExample2.c</i> to <i>IExampleExe.c</i>, <i>IExample2.h</i> to <i>IExampleExe.h</i>, and <i>IExample2.idl</i> to <i>IExampleExe.idl</i>. I've also searched and replaced all instances of <code>IExample2</code> with <code>IExampleExe</code>. So now, our object is referred to as <code>IExampleExe</code>. And of course, I replaced the GUIDs in <i>IExampleExe.h</i> and <i>IExampleExe.idl</i>
 with newly generated ones so that this EXE component won't conflict 
with our DLL components. Since we're creating an EXE, we no longer need a
 DEF file, so that has been removed from the project.</p>
<p>In <i>IExampleExe.c</i>, we have to replace the <code>DllMain</code> function with a <code>WinMain</code> function. Our <code>WinMain</code> must do the initialization of our <code>IClassFactory</code> and global variables, just like <code>DllMain</code> did. But our <code>WinMain</code> must also call the OLE APIs <code>CoInitialize</code> to initialize COM, and then call <code>CoRegisterClassObject</code>
 to add our EXE to COM's running task list. What's that? It's simply an 
internal list COM maintains of all the currently running EXEs which are 
COM components. If our EXE is not in this list, then no application can 
use our COM component. And, our EXE is not in that list until it calls <code>CoRegisterClassObject</code>. Since it is our <code>WinMain</code> that calls <code>CoRegisterClassObject</code>, it stands to reason that no app can use our COM component until our EXE is started.</p>
<p>After our EXE is added to the running task list, it simply does a message loop until it receives a <code>WM_QUIT</code> message.</p>
<p>While our EXE is in memory, spinning around that message loop, an application can call <code>CoCreateInstance</code> (or <code>CoGetClassObject</code>/<code>CreateInstance</code>) to get one of our <code>IExampleExe</code>
 objects and call its functions. To call those functions, the 
application need do nothing more than the IExample2App demo did. The OS 
handles all of the needed details to make it happen.</p>
<p>When our EXE is ready to terminate, it calls <code>CoRevokeClassObject</code> to remove itself from COM's running task list, and then calls <code>CoUninitialize</code> to free up the COM resources.</p>
<p>That's the extent of the differences (although I did add a little code in the <code>Release</code> functions of our <code>IExampleExe</code> object and <code>IClassFactory</code> object to check if we want to unload the DLL when all apps have <code>Release</code>d our objects).</p>
<p>When registering a COM component in an EXE, versus a DLL, instead of creating a key named "<code>InprocServer32</code>", we create a key named "<code>LocalServer32</code>". In the directory <i>RegIExampleExe</i>, is an example of registering <code>IExampleExe</code>. (No uninstall utility has been provided. It is a trivial exercise left up to you to accomplish).</p>
<p>To test out this new EXE component, you can simply modify <i>IExample2App.c</i> to reference the GUIDs for <code>IExampleExe</code>, by changing it to <code>#include IExampleExe.h</code>:</p><div class="pre-action-link" id="premain425772" style="width:100%;display:block;"><span id="prehide425772" onclick="processCodeBlocks.togglePre(425772);">Hide</span>  &nbsp; <span id="copycode425772" onclick="return processCodeBlocks.copyCode(425772);">Copy Code</span></div><pre id="pre425772" style="margin-top: 0px;" class="notranslate">#include "../IExampleExe/IExampleExe.h"</pre>
<p>Remember that you must install/register our COM component once, and then run our component (<i>IExample.exe</i>) to get it into COM's task list <b>before</b> you run the modified <i>IExample2App.exe</i> test program.</p>
<h2>What's next?</h2>
<p>In the next chapter, we'll look at the <code>IDispatch</code> 
functions from the point of view of a script engine. How does a script 
engine translate some code in its own language to a call to our object's
 <code>IDispatch</code> functions?</p>


						</div>
						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/COM" data-country="US" data-loadonview="true" data-tags="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=300x250&c=906294"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=300x250&c=906294"  width="300px" height="250px" target="_blank"/></a></noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

    <ul class="rrssb-buttons clearfix rrssb-1">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=COM%20in%20plain%20C%2c%20Part%202%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f13862%2fCOM-in-plain-C-Part-2%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=COM+in+plain+C%2c+Part+2+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f13862%2fCOM-in-plain-C-Part-2" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                        C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f13862%2fCOM-in-plain-C-Part-2" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f13862%2fCOM-in-plain-C-Part-2&amp;title=COM+in+plain+C%2c+Part+2+-+CodeProject&amp;summary=&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f13862%2fCOM-in-plain-C-Part-2&amp;title=COM+in+plain+C%2c+Part+2+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f13862%2fCOM-in-plain-C-Part-2&amp;description=COM+in+plain+C%2c+Part+2+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    

<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/member_unknown.gif" style="border-width:0px;transform:rotate(1deg);">
    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="https://www.codeproject.com/Members/Jeff-Glatt">Jeff Glatt</a></b>

        <table>
        <tbody><tr>
            <td rowspan="2" valign="middle" nowrap="nowrap">
            
            </td>
            <td nowrap="nowrap">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle"></span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
                </div>
            </td>
            <td rowspan="2" style="padding-left:15px">
                <a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn" title="" class="button unfollowed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Have the articles and posts from this member appear in your Timeline so you can stay up to date." style="display: inline-block;">Follow<div class="tiny-text" style="margin-top:-3px;">this Member</div><div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have the articles and posts from this member appear in your Timeline so you can stay up to date.</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn" title="" class="button followed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Stop following this Member" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Member</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">United States <img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/US.gif" alt="United States" width="16px" height="11px"></span>
            </td>
        </tr>
        </tbody></table>
    </div>

    <div class="description">
        No Biography provided

        
    </div>

</div><br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/COM" data-country="US" data-loadonview="true" data-tags="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5,pos_bottom" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=728x90&c=906294"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=728x90&c=906294"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellspacing="0" cellpadding="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="3px" border="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="button new-message compose float-left">
<a rel="nofollow" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;floc=/Articles/13862/COM-in-plain-C-Part-2" name="Frm_HoverNL" target="_top">Add a Comment or Question&nbsp;</a>
</div><div class="admin-links float-left align-middle" style="width:90px;line-height:24px;margin-top:4px;">
&nbsp;<a href="https://www.codeproject.com/KB/FAQs/MessageBoardsFAQ.aspx"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/help_sm.png" title="FAQ" alt="FAQ" style="border-width:0;width:16px;height:16px;vertical-align:middle;"></a>
</div><div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="295130"><input type="hidden" name="sbo" value="fm"><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search subdue" autocomplete="off" name="qf" value="Search Comments"><input type="image" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/search.gif">
</form>
</div><div class="tooltip email-alert" id="ctl00_MessageBoard_SubscribeDiv">
	<span class="nowrap medium-text">Email Alerts</span><div class="tooltip-flyout" style="width: 335px;margin-top: 24px;left: -270px;padding: 7px;">
		<b>Email me</b><input type="checkbox" id="ctl00_MessageBoard_SubscribeNew"><label for="ctl00_MessageBoard_SubscribeNew">New Posts</label><input type="checkbox" id="ctl00_MessageBoard_SubscribeReplies"><label for="ctl00_MessageBoard_SubscribeReplies">Replies to Posts</label><br><br><b>Send them</b><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeInstant"><label for="ctl00_MessageBoard_SubscribeInstant">Instantly</label><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeDaily"><label for="ctl00_MessageBoard_SubscribeDaily">Daily</label>&nbsp; <b>For</b> <select id="ctl00_MessageBoard_MessageType" class="tiny-text" style="width:80px;">
			<option value="0" selected="selected">
				All Types
			</option><option value="128">
				Announcements
			</option>
		</select><button class="button safe float-right update">Update</button>
	</div>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?floc=%2fArticles%2f13862%2fCOM-in-plain-C-Part-2&amp;fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="295130"><input type="hidden" name="currentQS" value="floc=%2fArticles%2f13862%2fCOM-in-plain-C-Part-2&amp;fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True"><input type="hidden" name="floc" value="/Articles/13862/COM-in-plain-C-Part-2">Spacing<select size="1" class="dropdown" name="spc">
<option selected="selected" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view">
<option selected="selected" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="selected" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table width="100%" cellspacing="0" cellpadding="2px" border="0">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=26#xx0xx">Next</a></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table class="fixed-layout blank-background" width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr id="F5069301_h0" class="header hover-row root">
<td class="subject-line normal vote-hi" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx5069301xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5069301" parent="0" thread="5069301" href="https://www.codeproject.com/Messages/5069301/For-64-bit-OS.aspx">For 64-bit OS</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">dc_2000</span><span class="date">4-Jun-15  5:50</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=660507">dc_2000</a></span></td><td class="date"><span>4-Jun-15  5:50&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5069301_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="660507" msgid="5069301" votingtype="GoodOrBad" done="true"><a href="#xx5069301xx" onclick="return rateItem(5, 5069301,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',660507);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5069301xx" onclick="return rateItem(1, 5069301,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',660507);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">I'm not sure if it was mentioned anywhere, if you want 
this to work on a 64-bit OS you will need to also build this in-proc DLL
 as a 64-bit project (otherwise the 32-bit version will not be able to 
be loaded into 64-bit processes and you'll get a lot of weird errors.)<br>
<br>
Also the registration/un-registration part needs to be adjusted for 
64-bit OS. For (un-)registration of the 64-bit in-proc DLL from a 32-bit
 process use the KEY_WOW64_64KEY flag when creating/opening keys. And 
for (un-)registration of the 32-bit in-proc DLL from a 64-bit process 
use the KEY_WOW64_32KEY flag.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=5069301&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=5069301&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5069301" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5069301" data-ref="3_5069301" class="rating-label" name="RateItem_5069301"><span class="rating-result"><span>5.00/5 (1 vote)</span></span></span><a href="https://www.codeproject.com/Messages/5069301/For-64-bit-OS.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5069301"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="660507" msgid="5069301"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4504477_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4504477xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4504477" parent="0" thread="4504477" href="https://www.codeproject.com/Messages/4504477/Error-on-invoking-a-method.aspx">Error on invoking a method</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">ATILLA67</span><span class="date">25-Feb-13  19:18</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1207124">ATILLA67</a></span></td><td class="date"><span>25-Feb-13  19:18&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4504477_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="1207124" msgid="4504477" votingtype="GoodOrBad" done="true"><a href="#xx4504477xx" onclick="return rateItem(5, 4504477,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1207124);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4504477xx" onclick="return rateItem(1, 4504477,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1207124);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hello I have a strange error. I can create the com component with create instance, but invoking a method<br>
gives me : GetTypeInfo: failed (8002801d; Bibliothek nicht registriert.)<br>
<br>
What is that? I register the com component with the register example?<br>
<br>
<br>
Yours,<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4504477&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4504477&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4504477" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4504477" data-ref="3_4504477" class="rating-label" name="RateItem_4504477"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4504477/Error-on-invoking-a-method.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4504477"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="1207124" msgid="4504477"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4500573_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4500573xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4500573" parent="0" thread="4500573" href="https://www.codeproject.com/Messages/4500573/Register-as-Service.aspx">Register as Service</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">ATILLA67</span><span class="date">20-Feb-13  12:47</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1207124">ATILLA67</a></span></td><td class="date"><span>20-Feb-13  12:47&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4500573_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="1207124" msgid="4500573" votingtype="GoodOrBad" done="true"><a href="#xx4500573xx" onclick="return rateItem(5, 4500573,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1207124);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4500573xx" onclick="return rateItem(1, 4500573,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1207124);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">What step are evident to make the com exe  running as service??<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4500573&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4500573&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4500573" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4500573" data-ref="3_4500573" class="rating-label" name="RateItem_4500573"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4500573/Register-as-Service.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4500573"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="1207124" msgid="4500573"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4481214_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4481214xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4481214" parent="0" thread="4481214" href="https://www.codeproject.com/Messages/4481214/Is-that-an-error.aspx">Is that an error???</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">ligand</span><span class="date">26-Jan-13  2:16</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3756817">ligand</a></span></td><td class="date"><span>26-Jan-13  2:16&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4481214_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="3756817" msgid="4481214" votingtype="GoodOrBad" done="true"><a href="#xx4481214xx" onclick="return rateItem(5, 4481214,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3756817);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4481214xx" onclick="return rateItem(1, 4481214,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3756817);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">In RegIExampleExe.c file which I got from the source code zip file, the  5th line is <br>
<br>
<div class="pre-action-link" id="premain776482" style="width:100%;display:block;"><span id="prehide776482" onclick="processCodeBlocks.togglePre(776482);">Hide</span>  &nbsp; <span id="preShrink776482" onclick="processCodeBlocks.shrinkExpand(776482);">Shrink</span> <img id="preimg776482" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(776482);">  &nbsp; <span id="copycode776482" onclick="return processCodeBlocks.copyCode(776482);">Copy Code</span></div><pre id="pre776482" style="margin-top: 0px;" class="notranslate" lang="c++"><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-string">"</span><span class="code-string">../IExample2/IExample2.h"</span></span></pre><br>
<br>
Obviously, it should be<br>
 <br>
<div class="pre-action-link" id="premain990140" style="width:100%;display:block;"><span id="prehide990140" onclick="processCodeBlocks.togglePre(990140);">Hide</span>  &nbsp; <span id="preShrink990140" onclick="processCodeBlocks.shrinkExpand(990140);">Shrink</span> <img id="preimg990140" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(990140);">  &nbsp; <span id="copycode990140" onclick="return processCodeBlocks.copyCode(990140);">Copy Code</span></div><pre id="pre990140" style="margin-top: 0px;" class="notranslate" lang="c++"><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-string">"</span><span class="code-string">../iexampleexe/IExampleExe.h"</span></span></pre><br>
<br>
Otherwise, I used the old  "REGIEXAMPLEEXE.exe" to register the 
"IExample.exe" as COM, but found the IExampleExe registrated with the 
CLSID of IExample2<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4481214&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4481214&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4481214" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4481214" data-ref="3_4481214" class="rating-label" name="RateItem_4481214"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4481214/Is-that-an-error.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4481214"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="3756817" msgid="4481214"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4446960_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4446960xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4446960" parent="0" thread="4446960" href="https://www.codeproject.com/Messages/4446960/0x80080005-on-IExampleExe.aspx">0x80080005 on IExampleExe</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">ATILLA67</span><span class="date">7-Dec-12  12:46</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1207124">ATILLA67</a></span></td><td class="date"><span>7-Dec-12  12:46&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4446960_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="1207124" msgid="4446960" votingtype="GoodOrBad" done="true"><a href="#xx4446960xx" onclick="return rateItem(5, 4446960,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1207124);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4446960xx" onclick="return rateItem(1, 4446960,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1207124);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hello Mr. Glatt,<br>
<br>
compiling the src is straitforward, it registers correct( I assume) but 
when I try a createInstance(from cpp, and from scriptingside)<br>
I get an 0x80080005 Error in starting the Server.-&gt; CoCreateInstance: failed<br>
<br>
Should I make some other tweaks??<br>
<br>
Yours,<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4446960&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4446960&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4446960" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4446960" data-ref="3_4446960" class="rating-label" name="RateItem_4446960"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4446960/0x80080005-on-IExampleExe.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4446960"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="1207124" msgid="4446960"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4478480_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx4478480xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4478480" parent="4446960" thread="4446960" href="https://www.codeproject.com/Messages/4478480/Re-0x80080005-on-IExampleExe.aspx">Re: 0x80080005 on IExampleExe</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">ligand</span><span class="date">23-Jan-13  4:21</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3756817">ligand</a></span></td><td class="date"><span>23-Jan-13  4:21&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4478480_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="3756817" msgid="4478480" votingtype="GoodOrBad" done="true"><a href="#xx4478480xx" onclick="return rateItem(5, 4478480,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3756817);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4478480xx" onclick="return rateItem(1, 4478480,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3756817);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4446960);" href="https://www.codeproject.com/Messages/4446960/0x80080005-on-IExampleExe.aspx"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>This
 maybe less administrator access right. Restart your Visual Studio or 
Command Prompt console with administrator privilege, and try it.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4478480&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4478480&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4446960" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4478480" data-ref="3_4478480" class="rating-label" name="RateItem_4478480"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4478480/Re-0x80080005-on-IExampleExe.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4478480"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="3756817" msgid="4478480"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4076757_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4076757xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4076757" parent="0" thread="4076757" href="https://www.codeproject.com/Messages/4076757/Typelib-essential-with-COM-component-in-an-EXE.aspx">Typelib essential with COM component in an EXE</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Reinier T</span><span class="date">13-Nov-11  21:57</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=8398163">Reinier T</a></span></td><td class="date"><span>13-Nov-11  21:57&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4076757_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="8398163" msgid="4076757" votingtype="GoodOrBad" done="true"><a href="#xx4076757xx" onclick="return rateItem(5, 4076757,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',8398163);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4076757xx" onclick="return rateItem(1, 4076757,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',8398163);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Thank you very much for this excellent set of articles. I
 have done some COM programming fifteen years ago, but only now, after 
reading your work, I start to understand what I was doing back then.<br>
I had one remark about the last section "A COM component in an EXE". I 
have been able to do that in plain C for a custom interface (derived 
from IUnknown, not IDispatch), but not before making the mistake first 
of omitting the typelib. From your article, it looks like the typelib is
 required for dual interfaces only.<br>
It would be nice to mention in that section that COM now has to marshal 
the data since it has to travel between processes, and that it can do 
that in a generic way only if it has a typelibrary available. Much 
better than implementing your own marshaling routines.<br><br><div class="modified">modified  13-Nov-11 21:07pm.</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4076757&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4076757&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4076757" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4076757" data-ref="3_4076757" class="rating-label" name="RateItem_4076757"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4076757/Typelib-essential-with-COM-component-in-an-EXE.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4076757"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="8398163" msgid="4076757"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3758803_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx3758803xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="3758803" parent="0" thread="3758803" href="https://www.codeproject.com/Messages/3758803/My-vote-of-5.aspx">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">LittleEd</span><span class="date">4-Feb-11  12:21</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1159653">LittleEd</a></span></td><td class="date"><span>4-Feb-11  12:21&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3758803_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="1159653" msgid="3758803" votingtype="GoodOrBad" done="true"><a href="#xx3758803xx" onclick="return rateItem(5, 3758803,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1159653);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx3758803xx" onclick="return rateItem(1, 3758803,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1159653);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">more of the same, excellent<br>
regarding the COM registration how do we know what fields are required 
by the registry, u kind of pull them out the air? Gooled and MSDN'd but 
no joy<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=3758803&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3758803" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF3758803" data-ref="3_3758803" class="rating-label" name="RateItem_3758803"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/3758803/My-vote-of-5.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_3758803"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="1159653" msgid="3758803"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3672556_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx3672556xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="3672556" parent="0" thread="3672556" href="https://www.codeproject.com/Messages/3672556/My-vote-of-5.aspx">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">yao2007</span><span class="date">21-Nov-10  6:55</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5666108">yao2007</a></span></td><td class="date"><span>21-Nov-10  6:55&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3672556_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="5666108" msgid="3672556" votingtype="GoodOrBad" done="true"><a href="#xx3672556xx" onclick="return rateItem(5, 3672556,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5666108);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx3672556xx" onclick="return rateItem(1, 3672556,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5666108);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">excellent<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=3672556&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3672556" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF3672556" data-ref="3_3672556" class="rating-label" name="RateItem_3672556"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/3672556/My-vote-of-5.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_3672556"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5666108" msgid="3672556"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3519477_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx3519477xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="3519477" parent="0" thread="3519477" href="https://www.codeproject.com/Messages/3519477/My-vote-of-5.aspx">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">sprice86</span><span class="date">29-Jun-10  15:35</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-pro-16.png" title="Professional" alt="professional" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=736400">sprice86</a></span></td><td class="date"><span>29-Jun-10  15:35&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3519477_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="736400" msgid="3519477" votingtype="GoodOrBad" done="true"><a href="#xx3519477xx" onclick="return rateItem(5, 3519477,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',736400);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx3519477xx" onclick="return rateItem(1, 3519477,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',736400);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">This is the best written article I have seen on CodeProject<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=3519477&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3519477" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF3519477" data-ref="3_3519477" class="rating-label" name="RateItem_3519477"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/3519477/My-vote-of-5.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_3519477"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="736400" msgid="3519477"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3299389_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx3299389xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="3299389" parent="0" thread="3299389" href="https://www.codeproject.com/Messages/3299389/Why-same-dispatch-ID-in-IExample2-idl.aspx">Why same dispatch ID in IExample2.idl?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Hou Tianze</span><span class="date">10-Dec-09  5:37</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2407417">Hou Tianze</a></span></td><td class="date"><span>10-Dec-09  5:37&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3299389_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="2407417" msgid="3299389" votingtype="GoodOrBad" done="true"><a href="#xx3299389xx" onclick="return rateItem(5, 3299389,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',2407417);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx3299389xx" onclick="return rateItem(1, 3299389,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',2407417);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hi Jeff,<br>
<br>
Can you help to explain the following two lines inside IExample2.idl:<br>
[id(<b>1</b>), propput] HRESULT Buffer([in] BSTR);<br>
[id(<b>1</b>), propget] HRESULT Buffer([out, retval] BSTR *);<br>
<br>
Why are the two Buffer() functions having the same ID 1 instead of two different IDs?<br>
<br>
Thanks.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=3299389&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=3299389&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3299389" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF3299389" data-ref="3_3299389" class="rating-label" name="RateItem_3299389"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/3299389/Why-same-dispatch-ID-in-IExample2-idl.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_3299389"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="2407417" msgid="3299389"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4135720_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx4135720xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4135720" parent="3299389" thread="3299389" href="https://www.codeproject.com/Messages/4135720/Re-Why-same-dispatch-ID-in-IExample2-idl.aspx">Re: Why same dispatch ID in IExample2.idl?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">23-Jan-12  2:13</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>23-Jan-12  2:13&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4135720_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="4135720" votingtype="GoodOrBad" done="true"><a href="#xx4135720xx" onclick="return rateItem(5, 4135720,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4135720xx" onclick="return rateItem(1, 4135720,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,3299389);" href="https://www.codeproject.com/Messages/3299389/Why-same-dispatch-ID-in-IExample2-idl.aspx"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Because these two lines are <u>both</u>
 defining the same, one function called Buffer(). You must have only one
 DISPID (number) per function, and I chose the number 1 for Buffer(). 
What we're doing is telling the script engine there are two different 
ways of calling Buffer(). One way the engine can pass us a BSTR it want 
us to store. Well, actually we store a copy of it. A second way the 
engine can pass us a handle where we return a copy of the BSTR we 
stored. The first way is the propput version. The second way is the 
propget version.<br>
<br>
It's more or less the same concept as an overloaded function in a C++ 
class. But this is not a C++ class, and this is not a C++ include. This 
is our language-independent type library. This is how we specify the 
overloaded function here.<br>
<br>
And as my article notes, now there are two different ways that VBScript 
(or JScript, or Python, or C/C++, etc) can call Buffer() depending upon 
which of the two things it wants to do (ie, give one piece of data to my
 COM object, or retrieve one piece of data from my COM object. Note: 
this propput/propput stuff is just to let a script writer set/retrieve 
data using syntax that looks more natural/commonplace to him).<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4135720&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4135720&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3299389" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4135720" data-ref="3_4135720" class="rating-label" name="RateItem_4135720"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4135720/Re-Why-same-dispatch-ID-in-IExample2-idl.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4135720"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="4135720"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3299330_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx3299330xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="3299330" parent="0" thread="3299330" href="https://www.codeproject.com/Messages/3299330/Trivial-errors-typos.aspx">Trivial errors/typos</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Hou Tianze</span><span class="date">10-Dec-09  4:33</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2407417">Hou Tianze</a></span></td><td class="date"><span>10-Dec-09  4:33&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3299330_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="2407417" msgid="3299330" votingtype="GoodOrBad" done="true"><a href="#xx3299330xx" onclick="return rateItem(5, 3299330,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',2407417);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx3299330xx" onclick="return rateItem(1, 3299330,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',2407417);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">First, I'd like to thank Jeff for this great series of 
articles which have given an in-depth view of the COM technology. It is 
especially useful for a COM novice like me to grasp the concept and 
understand how this massive beast works internally <img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/smiley_smile.gif" alt="Smile | :)" align="top"> <br>
<br>
Here are some, what I think, trivial typos/errors I've found in this Part 2 post:<br>
<br>
To modify IExample2App.c to IExampleExeApp.c which is to test out the 
EXE COM object, additional to the changes mentioned in the article, you 
have also make the following change, otherwise, CoGetClassObject() 
function call will fail:<br>
In line 20, change the second parameter of the CoGetClassObject() from <b>CLSCTX_INPROC_SERVER</b> to <b>CLSCTX_LOCAL_SERVER</b><br>
<br>
Also, you don't actually have to run IExample.exe prior to running the 
testing exe (IExampleExeApp.exe), it seems that the COM library will 
handle this for us.<br>
<br>
Others:<br>
Typo: But in order to declare a function as <b>propget</b>,<br>
Fix: But in order to declare a function as <b>propput</b>,<br>
<br>
Typo: And in order to declare a function as <b>propput</b><br>
Fix: And in order to declare a function as <b>propget</b><br>
<br>
Line 522 of iexampleexe\IExampleExe.c:<br>
Typo: <b>#define</b> ALLOW_UNLOADING<br>
Fix: <b>#ifdef</b> ALLOW_UNLOADING<br>
<br>
regiexampleexe\RegIExampleExe.c:<br>
Line 5:<br>
Typo: #include "<b>../IExample/IExampleExe.h</b>"<br>
Fix: #include "<b>../IExampleExe/IExampleExe.h</b>"<br>
<br>
Then you need to replace all <b>CLSID_IExample2</b> with <b>CLSID_IExampleExe</b><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=3299330&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=3299330&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3299330" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF3299330" data-ref="3_3299330" class="rating-label" name="RateItem_3299330"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/3299330/Trivial-errors-typos.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_3299330"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="2407417" msgid="3299330"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2844764_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx2844764xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2844764" parent="0" thread="2844764" href="https://www.codeproject.com/Messages/2844764/re-A-VBScript-example.aspx">re: A VBScript example</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">kennn</span><span class="date">15-Dec-08  12:19</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=208547">kennn</a></span></td><td class="date"><span>15-Dec-08  12:19&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2844764_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="208547" msgid="2844764" votingtype="GoodOrBad" done="true"><a href="#xx2844764xx" onclick="return rateItem(5, 2844764,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',208547);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2844764xx" onclick="return rateItem(1, 2844764,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',208547);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">The Article section entitled "A VBScript example" gives a
 detailed explanation of when the script engine calls GetIDsOfNames and 
Invoke. But when does the script engine call GetTypeInfoCount and 
GetTypeInfo?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2844764&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2844764&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2844764" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2844764" data-ref="3_2844764" class="rating-label" name="RateItem_2844764"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2844764/re-A-VBScript-example.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2844764"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="208547" msgid="2844764"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4135727_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx4135727xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4135727" parent="2844764" thread="2844764" href="https://www.codeproject.com/Messages/4135727/Re-re-A-VBScript-example.aspx">Re: re: A VBScript example</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">23-Jan-12  2:24</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>23-Jan-12  2:24&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4135727_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="4135727" votingtype="GoodOrBad" done="true"><a href="#xx4135727xx" onclick="return rateItem(5, 4135727,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4135727xx" onclick="return rateItem(1, 4135727,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2844764);" href="https://www.codeproject.com/Messages/2844764/re-A-VBScript-example.aspx"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Typically,
 the script engine does this when the script writer puts a line in his 
code, telling the engine he wants to load a particular COM object. In 
VBScript, that happens with the Createobject() call. The engine gets 
both a pointer to the COM object, and its ITypeInfo object (and then 
holds both until the script "deletes/frees" the COM object, or just 
terminates).<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4135727&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=4135727&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2844764" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4135727" data-ref="3_4135727" class="rating-label" name="RateItem_4135727"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4135727/Re-re-A-VBScript-example.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4135727"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="4135727"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2569705_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx2569705xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2569705" parent="0" thread="2569705" href="https://www.codeproject.com/Messages/2569705/everything-works-You-are-number-one-Many-thanks.aspx">everything works! You are number one. Many thanks...</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">mustafa_badici</span><span class="date">26-May-08  9:02</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5110849">mustafa_badici</a></span></td><td class="date"><span>26-May-08  9:02&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2569705_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="5110849" msgid="2569705" votingtype="GoodOrBad" done="true"><a href="#xx2569705xx" onclick="return rateItem(5, 2569705,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5110849);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2569705xx" onclick="return rateItem(1, 2569705,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5110849);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">everything works! You are number one. Many thanks...<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2569705&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2569705&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2569705" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2569705" data-ref="3_2569705" class="rating-label" name="RateItem_2569705"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2569705/everything-works-You-are-number-one-Many-thanks.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2569705"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5110849" msgid="2569705"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3008789_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx3008789xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="3008789" parent="2569705" thread="2569705" href="https://www.codeproject.com/Messages/3008789/Re-everything-works-You-are-number-one-Many-thanks.aspx">Re: everything works! You are number one. Many thanks...</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Member 3710051</span><span class="date">17-Apr-09  20:21</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3710051">Member 3710051</a></span></td><td class="date"><span>17-Apr-09  20:21&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3008789_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="3710051" msgid="3008789" votingtype="GoodOrBad" done="true"><a href="#xx3008789xx" onclick="return rateItem(5, 3008789,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3710051);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx3008789xx" onclick="return rateItem(1, 3008789,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3710051);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2569705);" href="https://www.codeproject.com/Messages/2569705/everything-works-You-are-number-one-Many-thanks.aspx"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Everything compiles well in VC++ 6 but the registration fails ...<br>
<br>
How did you get the part 2 code to compile and work?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=3008789&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=3008789&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2569705" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF3008789" data-ref="3_3008789" class="rating-label" name="RateItem_3008789"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/3008789/Re-everything-works-You-are-number-one-Many-thanks.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_3008789"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="3710051" msgid="3008789"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2496058_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx2496058xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2496058" parent="0" thread="2496058" href="https://www.codeproject.com/Messages/2496058/Make-it-work-as-activeX-and-display-in-internet-ex.aspx">Make it work as activeX and display in internet explorer</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">DrunkenMonster</span><span class="date">7-Apr-08  7:35</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5037740">DrunkenMonster</a></span></td><td class="date"><span>7-Apr-08  7:35&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2496058_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="5037740" msgid="2496058" votingtype="GoodOrBad" done="true"><a href="#xx2496058xx" onclick="return rateItem(5, 2496058,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5037740);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2496058xx" onclick="return rateItem(1, 2496058,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5037740);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">how to display this to an internet explorer....<br>
<br>
using ur code i created an directx based application..<br>
<br>
where i have initilizedirecx(void * hWnd) , draw() and release() functions..<br>
<br>
how to call the initializedirectx function from IE..<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2496058&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2496058&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2496058" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2496058" data-ref="3_2496058" class="rating-label" name="RateItem_2496058"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2496058/Make-it-work-as-activeX-and-display-in-internet-ex.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2496058"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5037740" msgid="2496058"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2493459_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx2493459xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2493459" parent="0" thread="2493459" href="https://www.codeproject.com/Messages/2493459/I-think-the-registry-example-is-not-fully-correct.aspx">I think the registry example is not fully correct</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">FriedrichDominicus</span><span class="date">4-Apr-08  8:22</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3382646">FriedrichDominicus</a></span></td><td class="date"><span>4-Apr-08  8:22&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2493459_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="3382646" msgid="2493459" votingtype="GoodOrBad" done="true"><a href="#xx2493459xx" onclick="return rateItem(5, 2493459,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3382646);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2493459xx" onclick="return rateItem(1, 2493459,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3382646);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Well may be that I'm wrong about it but it seems you are using the wrong <br>
UUID for the registration. It should IMHO not be the CoClass UUID but the <br>
UUID of the type library. IIUC then this should be the LIBID_xxxx.<br>
<br>
But anyway I learned very much from it, so thanks.<br>
<br>
Regards<br>
Friedrich<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2493459&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2493459&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2493459" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2493459" data-ref="3_2493459" class="rating-label" name="RateItem_2493459"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2493459/I-think-the-registry-example-is-not-fully-correct.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2493459"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="3382646" msgid="2493459"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2423720_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx2423720xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2423720" parent="0" thread="2423720" href="https://www.codeproject.com/Messages/2423720/Invoking-methods-without-a-h.aspx">Invoking methods without a .h</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Member 4134890</span><span class="date">12-Feb-08  2:03</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=4134890">Member 4134890</a></span></td><td class="date"><span>12-Feb-08  2:03&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2423720_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="4134890" msgid="2423720" votingtype="GoodOrBad" done="true"><a href="#xx2423720xx" onclick="return rateItem(5, 2423720,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',4134890);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2423720xx" onclick="return rateItem(1, 2423720,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',4134890);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">I need to call methods of a COM object but I don't have 
the .h file. Scripting languages work with it. I need to do it from 
C(++), so I guess I would need to do something like what the scripting 
engines do.<br>
<br>
You said "In the next chapter, we'll look at the IDispatch functions 
from the point of view of a script engine. How does a script engine 
translate some code in its own language to a call to our object's 
IDispatch functions?" but part 3 talks about collections, and as far as I
 can see, none of the following chapters talk about this!<br>
<br>
So, from C++, how can I load a COM object from the GUID (or better: from
 a name like Excel.Application), and call its methods based on the type 
library, lacking the header file?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2423720&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2423720&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2423720" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2423720" data-ref="3_2423720" class="rating-label" name="RateItem_2423720"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2423720/Invoking-methods-without-a-h.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2423720"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="4134890" msgid="2423720"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2375663_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx2375663xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2375663" parent="0" thread="2375663" href="https://www.codeproject.com/Messages/2375663/VB-ERROR-430-Class-Doesnt-support-automation.aspx">VB ERROR 430: Class Doesn't support automation...</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author"><font color="maroon">gUrM33T</font></span><span class="date">2-Jan-08  15:00</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=547523"><font color="maroon">gUrM33T</font></a></span></td><td class="date"><span>2-Jan-08  15:00&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2375663_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="547523" msgid="2375663" votingtype="GoodOrBad" done="true"><a href="#xx2375663xx" onclick="return rateItem(5, 2375663,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',547523);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2375663xx" onclick="return rateItem(1, 2375663,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',547523);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">When library is used in VB, everything works fine the 
first time and then I start getting this error message. Can you please 
explain why? If I restart VB, it again works for first time and then 
start giving the same error in further tries.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2375663&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2375663&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2375663" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2375663" data-ref="3_2375663" class="rating-label" name="RateItem_2375663"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2375663/VB-ERROR-430-Class-Doesnt-support-automation.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2375663"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="547523" msgid="2375663"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2375671_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx2375671xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2375671" parent="2375663" thread="2375663" href="https://www.codeproject.com/Messages/2375671/Re-VB-ERROR-430-Class-Doesnt-support-automation.aspx">Re: VB ERROR 430: Class Doesn't support automation...</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author"><font color="maroon">gUrM33T</font></span><span class="date">2-Jan-08  15:26</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=547523"><font color="maroon">gUrM33T</font></a></span></td><td class="date"><span>2-Jan-08  15:26&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2375671_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="547523" msgid="2375671" votingtype="GoodOrBad" done="true"><a href="#xx2375671xx" onclick="return rateItem(5, 2375671,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',547523);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2375671xx" onclick="return rateItem(1, 2375671,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',547523);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2375663);" href="https://www.codeproject.com/Messages/2375663/VB-ERROR-430-Class-Doesnt-support-automation.aspx"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Now
 I tried to set the ThreadingModel to Apartment and it's working fine 
now. Please can you explain the difference between Apartment and Both 
threading model and which one is better to use?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2375671&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2375671&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2375663" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2375671" data-ref="3_2375671" class="rating-label" name="RateItem_2375671"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2375671/Re-VB-ERROR-430-Class-Doesnt-support-automation.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2375671"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="547523" msgid="2375671"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2260238_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx2260238xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2260238" parent="0" thread="2260238" href="https://www.codeproject.com/Messages/2260238/Invoke-a-Method.aspx">Invoke a Method</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">xfinger</span><span class="date">6-Oct-07  18:11</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=203993">xfinger</a></span></td><td class="date"><span>6-Oct-07  18:11&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2260238_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="203993" msgid="2260238" votingtype="GoodOrBad" done="true"><a href="#xx2260238xx" onclick="return rateItem(5, 2260238,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',203993);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2260238xx" onclick="return rateItem(1, 2260238,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',203993);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Jeff, would you show us how to invoke a method by its IDs?<br>
thanks<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2260238&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2260238&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2260238" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2260238" data-ref="3_2260238" class="rating-label" name="RateItem_2260238"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2260238/Invoke-a-Method.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2260238"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="203993" msgid="2260238"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2260535_h0" class="header hover-row">
<td class="subject-line normal vote-hi" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx2260535xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2260535" parent="2260238" thread="2260238" href="https://www.codeproject.com/Messages/2260535/Re-Invoke-a-Method.aspx">Re: Invoke a Method</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">7-Oct-07  13:25</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>7-Oct-07  13:25&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2260535_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="2260535" votingtype="GoodOrBad" done="true"><a href="#xx2260535xx" onclick="return rateItem(5, 2260535,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2260535xx" onclick="return rateItem(1, 2260535,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2260238);" href="https://www.codeproject.com/Messages/2260238/Invoke-a-Method.aspx"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Oh
 that's easy. If you already know the ID of the function, then you just 
pass that to Invoke(). You don't need to call GetIDsOfNames(). The whole
 point of GetIDsOfNames is if you know only the name of the function, 
but not its ID. Once you have the ID, then you can call Invoke to 
(indirectly) call that function.<br>
<br>
Note that some programmers use a "TypeInfo browser" to find out the IDs 
of the various functions in a COM object. Then the programmer simply 
uses those IDs, instead of bothering with GetIDsOfNames. After all, 
GetIDsOfNames can incur extra overhead. This works ok as long as the 
author of the COM object doesn't create a new version in which he has 
changed all the previous ID numbers of the functions (which would be a 
foolish and unnecessary thing to do).<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2260535&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2260535&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2260238" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2260535" data-ref="3_2260535" class="rating-label" name="RateItem_2260535"><span class="rating-result"><span>5.00/5 (1 vote)</span></span></span><a href="https://www.codeproject.com/Messages/2260535/Re-Invoke-a-Method.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2260535"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="2260535"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2263662_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx2263662xx"></a><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2263662" parent="2260535" thread="2260238" href="https://www.codeproject.com/Messages/2263662/Re-Invoke-a-Method.aspx">Re: Invoke a Method</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">xfinger</span><span class="date">9-Oct-07  15:23</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=203993">xfinger</a></span></td><td class="date"><span>9-Oct-07  15:23&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2263662_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="203993" msgid="2263662" votingtype="GoodOrBad" done="true"><a href="#xx2263662xx" onclick="return rateItem(5, 2263662,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',203993);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2263662xx" onclick="return rateItem(1, 2263662,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',203993);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2260535);" href="https://www.codeproject.com/Messages/2260535/Re-Invoke-a-Method.aspx"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Ok, with the help of Ole i came up with the function to call a method  with its ID:<br>
void InvokeHelperV(SOMECOMSERVER *this, const DISPID dwDispID, WORD 
wFlags, VARTYPE vtRet, void* pvRet, const BYTE* pbParamInfo, va_list 
argList);<br>
after of course, prepare the parameters.<br>
<br>
so, let's pretend i have a <b>COMSERVER</b>, i dont have the C style Interface but have its ID and want to receive the <b>Event message</b>, how should i tell the SOMECOMSERVER i want that ID event?<br>
<br>
C++ compiler do this:<br>
<div class="pre-action-link" id="premain778558" style="width:100%;display:block;"><span id="prehide778558" onclick="processCodeBlocks.togglePre(778558);">Hide</span>  &nbsp; <span id="preShrink778558" onclick="processCodeBlocks.shrinkExpand(778558);">Shrink</span> <img id="preimg778558" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(778558);">  &nbsp; <span id="copycode778558" onclick="return processCodeBlocks.copyCode(778558);">Copy Code</span></div><pre id="pre778558" style="margin-top: 0px;" class="notranslate">BEGIN_EVENTSINK_MAP(CMyDlg, CDialog)&lt;br /&gt;
	ON_EVENT(SOMECOMSERVER, IDC_MONITOR_COM, 1, OnComEvent, VTS_I4 VTS_I4 VTS_I4 VTS_I4 VTS_I4 VTS_I4 VTS_I4 VTS_I4 VTS_I4 VTS_I4 )&lt;br /&gt;
END_EVENTSINK_MAP()</pre><br>
<br>
and i know the typelib is like:<br>
<br>
<div class="pre-action-link" id="premain614302" style="width:100%;display:block;"><span id="prehide614302" onclick="processCodeBlocks.togglePre(614302);">Hide</span>  &nbsp; <span id="preShrink614302" onclick="processCodeBlocks.shrinkExpand(614302);">Shrink</span> <img id="preimg614302" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(614302);">  &nbsp; <span id="copycode614302" onclick="return processCodeBlocks.copyCode(614302);">Copy Code</span></div><pre id="pre614302" style="margin-top: 0px;" class="notranslate">library <b>somecomserver</b>&lt;br /&gt;
{&lt;br /&gt;
  importlib("stdole2.tlb");&lt;br /&gt;
&lt;br /&gt;
  // Forward declare all types defined in this typelib&lt;br /&gt;
  dispinterface _SOMECOMEvents;&lt;br /&gt;
  interface ISOMECOM;&lt;br /&gt;
&lt;br /&gt;
  [&lt;br /&gt;
    uuid(CA345660-7738-9C95-044E-34567506DF55),&lt;br /&gt;
    helpstring("ISOMECOMSERVER Event Interface")&lt;br /&gt;
  ]&lt;br /&gt;
  dispinterface _ISOMECOMEvents {&lt;br /&gt;
      properties:&lt;br /&gt;
      methods:&lt;br /&gt;
          [id(0x00000001), helpstring("Event OnComEvent")]&lt;br /&gt;
          void OnComEvent(&lt;br /&gt;
                          [in] long Parm1, &lt;br /&gt;
                          [in] long Parm2, &lt;br /&gt;
                          [in] long Parm3, &lt;br /&gt;
                          [in] long Parm4, &lt;br /&gt;
                          [in] long Parm5, &lt;br /&gt;
                          [in] long Parm6, &lt;br /&gt;
                          [in] long Parm7, &lt;br /&gt;
                          [in] long Parm8, &lt;br /&gt;
                          [in] long Parm9, &lt;br /&gt;
                          [in] long Parm10);&lt;br /&gt;
  }; &lt;br /&gt;
   [&lt;br /&gt;
      uuid(0ABC7719-B341-415B-6669-788BEa45679F),&lt;br /&gt;
      version(1.0),&lt;br /&gt;
      helpstring("SOMECOM Class")&lt;br /&gt;
    ]&lt;br /&gt;
    coclass SOMECOM {&lt;br /&gt;
        [default] interface ISOMECOM;&lt;br /&gt;
        [default, source] dispinterface _ISOMECOMEvents;&lt;br /&gt;
    };&lt;br /&gt;
}</pre><br>
<br>
Do you know how to acomplish it?<br>
 <br>
<br>
Best Regards<br>
Alexander<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2263662&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=295130&amp;select=2263662&amp;floc=/Articles/13862/COM-in-plain-C-Part-2&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2260238" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2263662" data-ref="3_2263662" class="rating-label" name="RateItem_2263662"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2263662/Re-Invoke-a-Method.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2263662"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="203993" msgid="2263662"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellspacing="0" cellpadding="2px">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 14-Jan-20  11:58 &nbsp; &nbsp; Last Update: 14-Jan-20  12:12</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26"><span class="nav-link selected">1</span><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26#xx0xx">2</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=51#xx0xx">3</a> <a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?fid=295130&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26#xx0xx">Next »</a></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_general.gif" alt="General" width="16px" height="16px" align="top"> General &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_news.gif" alt="News" width="16px" height="16px" align="top"> News &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_idea.gif" alt="Suggestion" width="16px" height="16px" align="top"> Suggestion &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_question.gif" alt="Question" width="16px" height="16px" align="top"> Question &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_bug.gif" alt="Bug" width="16px" height="16px" align="top"> Bug &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_answer.gif" alt="Answer" width="16px" height="16px" align="top"> Answer &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_joke.gif" alt="Joke" width="16px" height="16px" align="top"> Joke &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_kudos.gif" alt="Praise" width="16px" height="16px" align="top"> Praise &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_rant.gif" alt="Rant" width="16px" height="16px" align="top"> Rant &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/msg_admin.gif" alt="Admin" width="16px" height="16px" align="top"> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner">
                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div class="browse-code"><a href="https://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=13862">Browse Code</a></div>
<div><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=13862">View Stats</a></div>
<div><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=13862">Revisions</a></div>
<div><a href="#_comments">Comments (67)</a></div>
<div>Posted 20 Apr 2006</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/VC6" data-id="4">VC6</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Cplusplus" data-id="78">C++</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/C" data-id="80">C</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Visual-Studio" data-id="103">Visual-Studio</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/COM" data-id="130">COM</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>235.4K views</div><div>5.8K downloads</div><div>160 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

                <div id="RHSticky" class="container-article-info-sticky">
        		    

<div class="article-summary">

    
    

</div>

				    <div id="ctl00_SectionSponsor" class="padded-top" style="width:160px;margin:10px auto">
					    <div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/COM" data-country="US" data-showindicator="true" data-tags="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=160x200&c=312483"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=160x200&c=312483"  width="160px" height="200px" target="_blank"/></a></noscript></div>
				    </div>

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/COM" data-country="US" data-tags="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=160x600&c=312483"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=160x600&c=312483"  width="160px" height="600px" target="_blank"/></a></noscript></div>
				    </div>

                    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="theme1-background" style="height:2px;margin:5px 0" id="stickyStop"></div>

		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part-2?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2006 by Jeff Glatt<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2020 <br>
                <br>
				Web03 
				2.8.200113.1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="COM%20in%20plain%20C,%20Part%202%20-%20CodeProject_files/DFPAudiencePixel.gif" style="border-width:0px;height:1px;width:1px;">



<script type="text/javascript"> // IMMEDIATE script

var readLaterList

var notificationAlert

var followService_ctl00_ActionLinks_ArticleFollow;

var bookmark_medium_true_false_ = null;

function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(null, 13862,2,1,true,true,0,'LargeStars', null, 88625);
}

function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                        if (!$('#' + containerId).attr('alreadyRequested')){
                            $.ajax({
                                url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId+'&wd=130',
                            })
                            .done(function (data) {
                                $('#' + containerId).html(data);
                                $('#' + loadingId).hide();
                            });

                            $('#' + containerId).attr('alreadyRequested', 'true');
                        }
                    }

document.addEventListener('DOMContentLoaded', function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});
function ChkRtctl00_RateArticle(val) {
}

var followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 295130,
};
var subscriptions_ctl00_MessageBoard;
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	processCodeBlocks.Initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	$('#RHSticky').sticky($('#stickyStop'));
	$('#ctl00_StickyBlock').sticky($('#stickyStop'));
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	readLaterList = new ReadLaterList('ReadLaterListIcon', 'ItemsToRead','/script/Bookmarks/WebServices/BookmarkService.aspx','https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=small',true);
	readLaterList.initialise();
	
	notificationAlert = new NotificationAlert('ctl00_MemberBar_Messages_NotificationCount','Notifications','/script/Membership/Ajax/NotificationList.aspx');
	notificationAlert.initialise();
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar && sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc && !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	followService_ctl00_ActionLinks_ArticleFollow = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_ActionLinks_ArticleFollow.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 2,
	        objectId       : 13862
	    },
	    followButtonId   : 'ctl00_ActionLinks_ArticleFollow_FollowBtn',
	    unfollowButtonId : 'ctl00_ActionLinks_ArticleFollow_UnfollowBtn'
	}, false);
	
	bookmark_medium_true_false_ = new Bookmark('[data-type="bookmark"]','https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=medium',false,true);
	bookmark_medium_true_false_.Initialise();
	
	$('#clear-rate_ctl00_RateArticle_RCD').click(function () {    $('#ctl00_RateArticle_RCD').hide(); return false;});
	
	new starRating('#ctl00_RateArticle_RateItemWrapper', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
	  $('#ctl00_RateArticle_VR').mouseenter(function() {     getVotesHistogram(13862,2   ,'ctl00_RateArticle_HistogramR','ctl00_RateArticle_LoadingR');
	  });
	
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 1,
	        objectId       : 88625
	    },
	    followButtonId   : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn',
	    unfollowButtonId : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn'
	}, false);
	
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : true,
	    allowReporting      : false,
	    allowRating         : true,
	    allowRatingDisplay  : true,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://codeproject.freetls.fastly.net',
	    switchMsgCallback   : null,
	    getVoteFormMethod   : getVoteFormHtml,
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    getRatingUrl        : '/script/Ratings/Ajax/GetRatings.aspx',
	    getRatingRefKey     : 'obrs',
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl(forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	var followService = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	var followAttributeIds = [];
	followService.initAttributeUI(undefined, followAttributeIds);

})
</script>










<style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div></body></html>