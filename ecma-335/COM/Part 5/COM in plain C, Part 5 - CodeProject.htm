<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>COM in plain C, Part 5 - CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/Main.css">

    <script type="text/javascript" async="" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/analytics.js"></script><script type="text/javascript" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/jquery.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/article.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/MemberProfilePopup.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/a.js" defer="defer"></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="Add a connectable object (source/sink).">
<meta name="Keywords" content="C++, Windows, Visual-Studio, Dev, COM, Beginner,COM / COM+,Platforms, Frameworks &amp; Libraries,Free source code, tutorials">
<meta name="Author" content="Jeff Glatt">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5">
<meta name="twitter: card" content="summary">
<meta name="twitter: site" content="@CodeProject">
<meta property="og:url" content="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5">
<meta property="og:title" content="COM in plain C, Part 5">
<meta property="og:description" content="Add a connectable object (source/sink).">

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Artificial Intelligence" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=31">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5"
   },
  "headline": "COM in plain C, Part 5",
  "url": "https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5",
  "discussionUrl": "https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5#_comments",
  "isFamilyFriendly": "true",
  "image": "https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "C++,Windows,Visual-Studio,Dev,COM,Beginner",
  "commentCount": "24",
  "editor" : {
    "@type" : "Person",
    "name" : "Smitha Nishant",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=28970"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "Add a connectable object (source/sink).",
  "articleSection": "COM / COM+",
  "author" : [{
      "@type" : "Person",
      "name" : "Jeff Glatt",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=88625"
    }],
  "datePublished": "2006-05-22",
  "dateCreated": "2006-05-22",
  "dateModified": "2006-05-22"
,
  "aggregateRating" : {
    "@type" : "aggregateRating",
    "ratingValue" : 4.94,
    "ratingCount" : 35,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/8/Platforms-Frameworks-Libraries.aspx",
      "name" : "Platforms, Frameworks & Libraries"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/COM/",
      "name" : "COM / COM+"
    }
  }]
}</script>


	<!-- base href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5" -->
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





<!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" type="text/javascript" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': '55e1d411-e955-4cb4-9978-1528f21616a2'});
    </script>


<style type="text/css"></style></head>	

<body class="firefox firefox72">

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">14,417,643 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		<span id="ctl00_MemberBar_ReadLaterList_ReadLaterListDiv" class="tooltip member-message">
	<span id="ReadLaterListIcon" class="readlaterlist-count openable hidden"></span>
	<div class="tooltip-flyout readlaterlist-dropdown">
		<div id="ItemsToRead" class="readlaterlist-list"></div>
	</div>
</span><span id="ctl00_MemberBar_Messages_NotificationDiv" class="tooltip member-message">
	<a id="ctl00_MemberBar_Messages_NotificationCount" title="1 message" class="notification-count openable" href="https://www.codeproject.com/script/Membership/MyNotifications.aspx">1</a>

	<div class="tooltip-flyout notification-dropdown">
		

		<div id="ctl00_MemberBar_Messages_Confirm" class="bold spaced">
            <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/caution.png" style="width:20px;height:20px;vertical-align:bottom">
            <a id="ctl00_MemberBar_Messages_EmailConfirm" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f14183%2fCOM-in-plain-C-Part-5">Click here to confirm your email address. </a>
		</div>

		
		
		<div id="Notifications" class="notification-list">
			<img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/loading24.gif" alt="loading" style="margin:auto;">
		</div>
		<div class="spaced">
			
		</div>
	</div>
</span><span id="ctl00_MemberBar_TotalPoints" title="Total reputation points"><a class="bold member-rep-box silver" title="Reputation points earned: 830" href="https://www.codeproject.com/script/Reputation/List.aspx?mid=527156">830</a></span><span id="ctl00_MemberBar_CurRat" class="member-links tooltip openable">
				<a id="ctl00_MemberBar_MyProfile" class="me desktop-only tablet-only" dir="ltr" href="https://www.codeproject.com/Members/jon57">jon57</a>
                <a id="ctl00_MemberBar_MyProfileMob" class="me mobile-only" href="https://www.codeproject.com/Members/jon57">☰</a>
                <div class="tooltip-flyout">
					
					<div class="list-item"><a id="ctl00_MemberBar_MySettingsDefault" href="https://www.codeproject.com/script/Membership/Modify.aspx">My Settings</a></div>
					
					<div class="list-item"><a id="ctl00_MemberBar_MyBookmarks" href="https://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2">My Bookmarks</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyArticles" href="https://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=527156">My Articles</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyMessages" href="https://www.codeproject.com/script/Forums/Messages.aspx?fmid=527156">My Messages</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyQuestions" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=questions&amp;mid=527156&amp;showall=True">My Questions</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyAnswers" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=answers&amp;mid=527156&amp;showall=True">My Answers</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyComments" href="https://www.codeproject.com/script/comments/MemberComments.aspx?mid=527156">My Comments</a></div>
					
					
					<div id="ctl00_MemberBar_MyFollowingHolder">
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowing" href="https://www.codeproject.com/script/follow/Edit.aspx">Things I Follow</a></div>
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowers" href="https://www.codeproject.com/script/follow/Followers.aspx">My Followers</a></div>
					</div>
					
        
					<form name="unsubForm" id="unsubForm" action="/script/Membership/LogOff.aspx?rp=%2fArticles%2f14183%2fCOM-in-plain-C-Part-5" method="post" class="tight">
                    <input type="hidden" name="AntiForgeryToken" value="e82756ee-ccd1-43de-910d-7f5dd2636494">
                    <input type="submit" value="Sign out" class="list-item border-none extended align-left" onclick="return doSignout();" style="background-color: transparent; color: #999; cursor:pointer">
                    
                    </form>

                    <script type="text/javascript">//<!--
			        function doSignout()
			        {
    			        document.unsubForm.action = "/script/Membership/LogOff.aspx?rp=%2fArticles%2f14183%2fCOM-in-plain-C-Part-5"
				        document.unsubForm.submit();
				        return true;
			        }//-->
			        </script>
                    
				</div>
			</span>

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/Beginners" data-country="US" data-tags="C++, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=728x90&c=411022"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=728x90&c=411022"  width="728px" height="90px" target="_blank"/></a></noscript></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table class="search" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><input tabindex="2" class="search subdue" id="sb_tb" autocomplete="off" value="Search for articles, questions, tips" name="q"></td><td><input type="image" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		
		
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/write13.png" width="13" height="13"> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="https://www.codeproject.com/script/Articles/ImportArticle.aspx">
			<img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/write13.png" width="13" height="13"> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/write13.png" width="13" height="13"> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">View VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">View ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=93" style="padding-left:30px">View SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues.aspx">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript.aspx">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools.aspx">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift.aspx">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database.aspx">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1942421/Linux-Programming.aspx">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android.aspx">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS.aspx">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1540733/SharePoint.aspx">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development.aspx">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch.aspx">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">stuff</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="https://www.codeproject.com/KB/showcase/">Product Showcase</a></li>
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Contests/Winners.aspx?obtid=1&amp;cmpTpId=2&amp;cid=0">Most Valuable Professionals</a></li>
		

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="https://www.codeproject.com/Forums/1939564/Where-I-am-Member-Photos.aspx">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>
		<li></li>
		

		
		<li class="openable"><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">Non-English Language
			<span class="has-submenu">&gt;</span></a>
		<ul>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		
		</ul>
		</li><li class="last"></li>
		
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> » <a href="https://www.codeproject.com/Chapters/8/Platforms-Frameworks-Libraries.aspx">Platforms, Frameworks &amp; Libraries</a> » <a href="https://www.codeproject.com/KB/COM/">COM / COM+</a> » <a href="https://www.codeproject.com/KB/COM/#Beginners">Beginners</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
                
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    <a id="ctl00_ActionLinks_ArticleFollow_FollowBtn" title="" class="button unfollowed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Have any updates for this Article appear in your Timeline so you can stay up to date" style="display: inline-block;">Follow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have any updates for this Article appear in your Timeline so you can stay up to date</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_ActionLinks_ArticleFollow_UnfollowBtn" title="" class="button followed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Stop following this Article" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Article</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

</div>



<span id="ctl00_ActionLinks_BookmarkMd_bookmark" data-type="bookmark" data-ref="2_14183_1" data-size="medium" data-mode="bookmark"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark48.png" style="width:24px;height:24px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span> 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?display=Print" class="tooltip" title="">
   <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/print48.png" style="border:0" width="24px" height="24px">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="/Articles/14183/COM-in-plain-C-Part-5" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="aaFtZLYp0pZQtymGDhH2Hsqd3uO+uTB5X/KRuvJv/JCpErEwKR/8GR7epmVz0j4D2RdUcOSI2Op3u2Ha/I+haug5IUBEKQGCpGg+5lsqnu7eGEieMb5KpwR1S3eRkKJnxewu606ARbFgaPP8+CWsMKyiwxG1QOAvpFEUcLpu0vq2I16SWq97WXcuYq0vmgsc0iB5qG2N2LGI7aISJTinmjarDzFgAC2YBxB/Kpdrx9NVv4YnwcE3NJPGqZSz1i4mO7zv4780P0f4neD9i8K+cGUYxyp6Y9gmhLIWCbzDToJbev2oyLQvbAVeMo5lkEwYd/vXngVrt5R6haCYz1I/+sTU7bLT10Hqoz8SMgZlclQAjScZ1n/jB6pgxbVc7cna2g8kYE6dmMeofnBQGfPMhrMV7/jWvK4ylo+aTzMoVWrhqLr8TUhhMxZYEKmbPDsenmEy5Zf7zhJyXzeDa+RneC4/p8QbNG7hywLCJ3oJ0uFyrG7q8tw9DyERQiKQLhsJzHpBtmGwl0E7WxMJtKNZiguVY05iXpJCIe+TWbnaUf4s7Pr0aaziUk9DX9m3FnAP52S8SCF40rCwgokRGWvcPCdLpIvb4KTevGMeSfDoLGt293+ARGYrr0Two4iCBoEHRWbCKhQWru+WpRxm7l6CwuYjBplQfG+AVy9mHkl8BAFzVrLe2gHhRykZAQXytS8gs+LDr8LGYTk25u/CsP0p+nR178wG/1T5ofWfG6bK+Hc4D0rrf3gJUG4bnFuQM9OKE6B6G9K6CvfkDFWudiLKa7TBuf7ebQ9+0ZyNV4WLojcPUkDGsUou5jr00B+RSqh3Jg1iT0QI4vvl+Avk8IhsPBdoZpVJHNjKb/10luYSi6/tvufi0NKLhCdQETvNvfw5AKnc4oOVg1l0lDQA11JozlPWW8C1tOjVY+B5746WXzWhsjHayo2LPFBGREUWysL68svJLCj1rz/gkHPD1R2LDV180IMsXVE6ktdnqErwi/xSTXZboc0/XmFJXnkcTtTI/0CoubszIR/yjNkTF8fr2yzF14D6Uo9Ys3xOgLIqxIQB4M0eh6E9+mA+jA1D/P8ibPWZwoNOVq3yD8sqzW1PWsEzMtfv6ZTUjFJ9BzO+x0QfOdjdCxqI5MIaSkoAdeFzgpHkT16FAZDgf4++Fj9Ooyn8ZrbV2vOVRuhsVET9PMWC1wn32hdzg7sp+PVAQMMBDdDe9N8qqfG6cho8p/hULDjUgKFxgIYqpk5YyVC4WHQ/jSiQYACB8f1MGI3nMQYWWq5lxmcYHKI6dlBzLaxmev2p0WvVJWba8c9bavSshMcn5tb9BmFV/c0LH8ntYSGPkWO3g5I7+S8/M/kfDcyWSXZFabjvoUKSi2REbvKETVmP2FTGEJW46Wwdgi85JGbac/xFoIPFPYCoLbb4sy8+uR1BHE7yyvLBzqoEl/NImQkyfGzVhPBaqbQOMFTdopIxz0P4vWBlAzUqduTuKjCs41anCBhQhjEe4vZcoQG1KSGH8AgJ99/Pgnt0dwUsaL6cOY+A937a9VIA+iWWdnbYMHeOudmGhPJX6e0Dd2KFu0vQlWuWLpueYy4KjN1Jnyr3sR5frlLbo9GkV7/om0jXKHlTeD8sVydvaG9ifxSiso/BWB0lYPWW8PsIAmGjWYd7BM5VqD4AuqsFQTH9DEgxTRAPNdzgcxrEobeQ57t3vaXaOdF51OMrbIyaWESZKTSr1N+veC8UBKAu6EIUX7g57NHyaJgyugbdy3NUlQqiDKsOCrH/s6govGHIHci1Xmt/CjJc4Zel6xG2yJi+0N7JKe9U42hJiomU1WiNr2jIw+qzfj5GQUByqsxGPNkljzjhkVKIM6Yt3s3Wf/Jc53HxqPDogwqti8CIzf4fBlPKjFc4Klj8fCPJfn2qPuJej0wjYdAPhU42iY0HibjETwcXzdhVOLApKAgbZFiM9jSYCgIUE4cI5ApXp1LtZIIEDO/v+3/MUuzMHkKKWczBIroPZQeC0l+F3QTtFFeg+m0GZRZLyPOvJ0z69VUZ2dZ+mROcoD43iIsb2WjtibcUnZB2IEnblUfJ5VfIeYrCM59DNuO8MPqLQDNdaIiJbDP0P+BS5BRdDrfYRZn0VWSps3DFmCEKqjU2mhOKwf0656xRtn+K2aM4VTj0RRu5cHEJR3soFvUk/v9Bss4f3ehrTFeI1IrUZyd8Y/0vkzcXpXrHGMvGUJCcQSQqwXycl1O4vuloSH+rahgnWb4E6mCmtneyMKUSmxjawWNjUpQqXeWrKsH6siv//a/VPiXNh2jxezgrCOnSeqYJFrJoTs6cnz5GGaMRMVttkMH68D3e4jfLftwsUQDC9z5iNPCeN0hzOwSYXOzC1y5qg3Vtoh8mF+NAURVp8SRHCgj1qnN9Uv5OjwhPzvY5JTZgNnEyi8Ofv9hshYwh5NEAwUrg4DZ6qhgRuVWY77A=">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">COM in plain C, Part 5</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

                                

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625" rel="author">Jeff Glatt</a></span> 

                                        <div class="flex-item" style="margin-top:-7px;height:35px">
                                            <div id="ctl00_RateArticle_RateItemWrapper" class="container-rating small-text" name="RateItem_14183">

	<table class="small-text" width="100%" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right">
			<span class="align-right"></span>
			<img class="loading invisible" alt="loading..." src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/loading16.gif" width="16px" height="16px"> 
		</td>

	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tbody><tr>
				
				<td id="ctl00_RateArticle_StartForm" nowrap="nowrap" align="right"><b>Rate me!</b> </td>

				<td id="ctl00_RateArticle_VoteFormDiv" class="nowrap tooltip rating-stars-voter-large" style="padding-top:1px">

                    
					

<meta itemprop="upvoteCount" content="34">


<table id="ctl00_RateArticle_ItemRating_RatingTable" style="margin:0 1px;" class="hide-on-hover float-left" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td class="nowrap">

        <div style="width:120px;height:28px;position:relative" class="nowrap rating-stars-large"><div style="width:118px;height:24px;" class="clipped align-left float-left"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/stars-fill-lg.png"></div><div style="width:2px;height:24px;position:relative" class="clipped"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/stars-empty-lg.png" style="position:absolute;top:0;right:0"></div>

		
	</div></td>
		<td id="ctl00_RateArticle_ItemRating_VR" class="nowrap">
		<span id="ctl00_RateArticle_ItemRating_VotesR">4.94  (35 votes)</span>
		
	</td>
	</tr>
</tbody></table>

<span id="ctl00_RateArticle_ItemRating_RatingText"></span>


                    
					<span id="ctl00_RateArticle_RB" class="ajaxHist radio voting show-on-hover" style="display: none;">
						<span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5" style="display: none;"></span> 
					<div class="rating-star-block"><a href="#" rating="1" class="star outline" title="vote 1">vote 1</a><a href="#" rating="2" class="star outline" title="vote 2">vote 2</a><a href="#" rating="3" class="star outline" title="vote 3">vote 3</a><a href="#" rating="4" class="star outline" title="vote 4">vote 4</a><a href="#" rating="5" class="star outline" title="vote 5">vote 5</a></div></span>

                    
					

                    
	                <div id="ctl00_RateArticle_RCD" class="hover-container tooltip-flyout rating-comment" style="top:12px">
		                Add a reason or comment to your vote:
                        <a href="#" id="clear-rate_ctl00_RateArticle_RCD" title="close" class="rating-close">x</a>
                        <br>
                        <textarea class="RateComment" rows="5" cols="60" style="width:96%;"></textarea>
		                <span id="ctl00_RateArticle_CommentReq" class="subdue">Adding a comment to your rating is optional</span>
		            </div>

                    
                        

				</td>

				
                <td id="ctl00_RateArticle_VR" class="nowrap show-on-hover tooltip" style="display: none;">

		            <span id="ctl00_RateArticle_VotesR">4.94  (35 votes)</span>

                    
					<div id="ctl00_RateArticle_histPHR" class="speech-bubble-container-up-right" style="width:175px;margin-top:24px;right:-15px;top:6px">
						<div class="speech-bubble-up-right">
							<div id="ctl00_RateArticle_HistogramR">

</div>
							<img id="ctl00_RateArticle_LoadingR" class="align-middle" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/loading24.gif" style="border-width:0px;">
						</div>
						<div class="speech-bubble-pointer-up-right">
							<div class="speech-bubble-pointer-up-right-inner"></div>
						</div>
					</div>
                </td>


				<td style="padding-left:5px">	
					<input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button" style="display: none;">
				</td>
			</tr>
			</tbody></table>

			
		</td>
	</tr>
	</tbody></table>

</div>
                                        </div>
                                    </div>

                                    <div class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">22 May 2006</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_description" class="summary">Add a connectable object (source/sink).</div><span id="ctl00_thumbnailUrl" class="date" content="https://codeproject.global.ssl.fastly.net/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					
					

						
					

					<div id="ctl00_confirmError" class="advise"><img style="float:left;margin-right:10px" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/warning48.png" width="48px" height="48px"><b>Is your email address OK?</b> You are signed up for our 
						newsletters but your email address is either unconfirmed, or has not been 
						reconfirmed in a long time. Please <b>click <a id="ctl00_RequestConfirmLink2" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f14183%2fCOM-in-plain-C-Part-5">here</a> to have a confirmation email
                        sent</b> so we can confirm your email address and start sending you 
                        newsletters again. Alternatively, you can 
						<a id="ctl00_SubscribeLink2" href="https://www.codeproject.com/script/Membership/Subscribe.aspx">update your subscriptions</a>.</div>

						
						<div id="contentdiv" class="text">
						



<ul class="download">
<li><a href="https://www.codeproject.com/KB/COM/com_in_c5/com_in_c5_src.zip">Download source files - 246 Kb</a> </li></ul>
<h2>Contents</h2>
<ul>
<li><a href="#WRAP">Wrapping a callback function in a COM object</a> 
</li><li><a href="#CONNECT">IConnectionPointContainer and IConnectionPoint objects</a> 
</li><li><a href="#C1">An example C app</a> 
</li><li><a href="#SCRIPT">Adding support for script languages</a> 
</li><li><a href="#C2">Another example C app</a> 
</li><li><a href="#VB">A VBScript example</a> 
</li><li><a href="#MULT">Multiple types of callback objects</a> 
</li><li><a href="#MULT2">Multiple callback objects</a> </li></ul>
<h2>Introduction</h2>
<p>Often, it's convenient for a DLL function we call to "callback" into 
one of our own functions so that we can do some additional tasks at a 
particular point, or be notified that something has happened. For 
example, consider the standard C library function <code>qsort</code>. The fourth argument passed to <code>qsort</code> is a pointer to some function we provide to compare two items. In this way, when we call <code>qsort</code>, <code>qsort</code> allows us to determine the order that items are sorted, while <code>qsort</code> itself does the work of actually reordering the items.</p>
<p>We can't just provide any arbitrary function to <code>qsort</code>. The guy who wrote <code>qsort</code>
 specified exactly what arguments would be passed to our "compare" 
callback function, what our function returns, and of course, specified 
exactly what the purpose of our callback function is. Furthermore, <code>qsort</code> determines when our callback function is actually called (because it is <code>qsort</code> itself that calls our function). The guy who designed <code>qsort</code> mandated that our compare callback function <b>must</b> be defined as so:</p><div class="pre-action-link" id="premain524534" style="width:100%;display:block;"><span id="prehide524534" onclick="processCodeBlocks.togglePre(524534);">Hide</span>  &nbsp; <span id="copycode524534" onclick="return processCodeBlocks.copyCode(524534);">Copy Code</span></div><pre id="pre524534" style="margin-top: 0px;" class="notranslate">int (__cdecl *compare)(const void *elem1, const void *elem2);</pre>
<p>Let's create our own version of <code>qsort</code>, which we'll call <code>Sort</code>. (Actually, we'll cheat to make this simpler, and just do a bubble sort.) And let's assume that we'll put this in a DLL named <i>ISort.dll</i>.</p>
<p>Instead of passing <code>Sort</code> a pointer to the compare function each time, let's design this so that the app will first call a separate <code>SetCompare</code> function to allow our DLL to store the pointer in some global. Let's also put a function in the DLL called <code>UnsetCompare</code> that an app can call to clear that function pointer. So here's our DLL source code (that we'll put in a file called <i>ISort.c</i>):</p><div class="pre-action-link" id="premain382108" style="width:100%;display:block;"><span id="prehide382108" onclick="processCodeBlocks.togglePre(382108);">Hide</span>  &nbsp; <span id="preShrink382108" onclick="processCodeBlocks.shrinkExpand(382108);">Shrink</span> <img id="preimg382108" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(382108);">  &nbsp; <span id="copycode382108" onclick="return processCodeBlocks.copyCode(382108);">Copy Code</span></div><pre id="pre382108" style="margin-top: 0px;" processed="true" class="notranslate">// A global to store the pointer to the app's Compare function
int (STDMETHODCALLTYPE *CompareFunc)(const void *, const void *);

void STDMETHODCALLTYPE SetCompare(
     int (STDMETHODCALLTYPE *compare)(const void *, const void *))
{
   // Save the compare function ptr in a global
   CompareFunc = compare;
}

void STDMETHODCALLTYPE UnsetCompare(void)
{
   CompareFunc = 0;
}

HRESULT STDMETHODCALLTYPE Sort(void *base, 
        DWORD numElems, DWORD sizeElem)
{
   void   *hi;
   void      *p;
   void   *lo;
   void   *tmp;

   // Has the app set its Compare function pointer yet?
   if (!CompareFunc) return(E_FAIL);

   // Do the (bubble) sort
   if ((tmp = GlobalAlloc(GMEM_FIXED, sizeElem)))
   {
      hi = ((char *)base + ((numElems - 1) * sizeElem));
      lo = base;

      while (hi &gt; base)
      {
         lo = base;
         p = ((char*)base + sizeElem);
         while (p &lt;= hi)
         {
            if ((*CompareFunc)(p, lo) &gt; 0) lo = p;
            (char *)p += sizeElem;
         }

         CopyMemory(tmp, lo, sizeElem);
         CopyMemory(lo, hi, sizeElem);
         CopyMemory(hi, tmp, sizeElem);
         (char *)hi -= sizeElem;
      }

      GlobalFree(tmp);
      return(S_OK);
   }

   return(E_OUTOFMEMORY);
}</pre>
<p>Now, let's write an app that uses our DLL to sort an array of five <code>DWORD</code>s. First, the app calls <code>SetCompare</code> to specify its compare callback function (which we'll name <code>Compare</code>). Then, the app calls <code>Sort</code>. Finally, when our app is finished using <code>Sort</code>, and we wish to make sure that any additional calls to <code>Sort</code> do not accidentally cause it to call our <code>Compare</code> function, we call <code>UnsetCompare</code>.</p><div class="pre-action-link" id="premain147800" style="width:100%;display:block;"><span id="prehide147800" onclick="processCodeBlocks.togglePre(147800);">Hide</span>  &nbsp; <span id="copycode147800" onclick="return processCodeBlocks.copyCode(147800);">Copy Code</span></div><pre id="pre147800" style="margin-top: 0px;" class="notranslate">// An array of 5 DWORDs to be sorted
DWORD Array[5] = {2, 3, 1, 5, 4};

// Our Compare function
int STDMETHODCALLTYPE Compare(const void *elem1, const void *elem2)
{
   // Do a compare of the two elements. We know that
   // we passed an array of DWORD values to Sort()
   if (*((DWORD *)elem1) == *((DWORD *)elem2)) return 0;
   if (*((DWORD *)elem1) *lt; *((DWORD *)elem2)) return -1;
   return 1;
}

int main(int argc, char **argv)
{
   // Give ISort.dll our Compare function ptr
   SetCompare(Compare);

   // Sort of array of 5 DWORDs
   Sort(&amp;Array[0], 5, sizeof(DWORD));

   UnsetCompare();

   return 0;
}</pre>
<h2><a name="WRAP">Wrapping</a> a callback function in a COM object</h2>
<p>COM also has a facility to allow callbacks, but as you may have 
feared, it's not quite as straight-forward as our example above. In the 
directory named <i>ISort</i>, you'll find the files to a COM object that implements our above Sort DLL.</p>
<p>First of all, we have to wrap our <code>Sort</code> function inside some COM object. After all, we're going to turn <i>ISort.dll</i> into a COM component. Let's define an <code>ISort</code> object, using the <code>DECLARE_INTERFACE_</code> macro Microsoft provides. Like all COM objects, its VTable begins with the <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code> functions. We won't bother adding any <code>IDispatch</code> function to it. (Our <code>ISort</code> is not useable by script languages such as VBScript). And then, we'll add the <code>Sort</code> function as the first extra function. Here's the definition that we'll put in <i>ISort.h</i>:</p><div class="pre-action-link" id="premain62968" style="width:100%;display:block;"><span id="prehide62968" onclick="processCodeBlocks.togglePre(62968);">Hide</span>  &nbsp; <span id="copycode62968" onclick="return processCodeBlocks.copyCode(62968);">Copy Code</span></div><pre id="pre62968" style="margin-top: 0px;" class="notranslate">#undef INTERFACE
#define INTERFACE  ISort
DECLARE_INTERFACE_ (INTERFACE, IUnknown)
{
   STDMETHOD  (QueryInterface) (THIS_ REFIID, void **) PURE;
   STDMETHOD_ (ULONG, AddRef)  (THIS) PURE;
   STDMETHOD_ (ULONG, Release) (THIS) PURE;
   STDMETHOD  (Sort)           (THIS_ void *, DWORD, DWORD) PURE;
};</pre>
<p>So our app is going to get an instance of our <code>ISort</code> object and call its <code>Sort</code>
 function. You've now had plenty of experience writing C/C++ apps that 
get a COM object and call its functions. That's nothing new.</p>
<p>And of course, we need to run <i>GUIDGEN.EXE</i> to generate a GUID for our <code>ISort</code> object and its VTable. We'll give them names of <code>CLSID_ISort</code> and <code>IID_ISort</code> respectively, and put them in <i>ISort.h</i>.</p><div class="pre-action-link" id="premain569344" style="width:100%;display:block;"><span id="prehide569344" onclick="processCodeBlocks.togglePre(569344);">Hide</span>  &nbsp; <span id="copycode569344" onclick="return processCodeBlocks.copyCode(569344);">Copy Code</span></div><pre id="pre569344" style="margin-top: 0px;" class="notranslate">// ISort object's GUID
// {619321BA-4907-4596-874A-AEFF082F0014}
DEFINE_GUID(CLSID_ISort, 0x619321ba, 0x4907, 0x4596,
 0x87, 0x4a, 0xae, 0xff, 0x8, 0x2f, 0x0, 0x14);

// ISort VTable's GUID
// {4C9A7D40-D0ED-45ea-9520-1CB9095973F8}
DEFINE_GUID(IID_ISort, 0x4c9a7d40, 0xd0ed, 0x45ea,
 0x95, 0x20, 0x1c, 0xb9, 0x9, 0x59, 0x73, 0xf8);</pre>
<p>And like we typically do, we'll need to add at least one, extra, private data member to our <code>ISort</code> object -- a reference count member. So, we'll define a <code>MyRealISort</code> inside <i>ISort.c</i> that adds this extra private member to our <code>ISort</code>:</p><div class="pre-action-link" id="premain236525" style="width:100%;display:block;"><span id="prehide236525" onclick="processCodeBlocks.togglePre(236525);">Hide</span>  &nbsp; <span id="copycode236525" onclick="return processCodeBlocks.copyCode(236525);">Copy Code</span></div><pre id="pre236525" style="margin-top: 0px;" class="notranslate">typedef struct {
   ISortVtbl   *lpVtbl;   // ISort's VTable
   DWORD       count;     // ISort's reference count
} MyRealISort;</pre>
<p>By now, all of this should be quite familiar to you.</p>
<p>All that's left is to provide some way for an app to give us a pointer to its <code>Compare</code> function so our <code>Sort</code> function can call it. So, do we simply add <code>SetCompare</code> and <code>UnsetCompare</code> functions to our <code>ISort</code> VTable? Nope.</p>
<p>Here's where it starts to get complicated. Microsoft needed some 
standard way to allow an app to provide its callback functions to a COM 
object. Microsoft decided that an app should wrap its callback functions
 in a COM object. What particular COM object? That depends.</p>
<p>Remember how it was the author of <code>qsort</code> who determined what arguments were passed to the callback, and what it returned? Well, since we're the guys writing our <code>ISort</code>
 object, we get to make up our own COM object that the app must use to 
wrap any callback functions we require. So, let's just define our own 
COM object that we'll call an <code>ICompare</code>. Of course, we must start its VTable with the three functions <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code>.
 So, what do we want next? Let's see... Do we want to support script 
languages supplying us a compare function (such as a VBScript function)?
 If so, we'd put some <code>IDispatch</code> functions next. No, let's skip that, and for now, only allow a C/C++ app to provide us with a compare callback.</p>
<p>Let's add an extra function to <code>ICompare</code>. We'll call it <code>Compare</code>.
 That will be the app's compare callback. (So now, you see how the app 
has to wrap its callback in our own defined COM object.) Here's the 
definition of our <code>ICompare</code> (which we'll add to <i>ISort.h</i>):</p><div class="pre-action-link" id="premain384021" style="width:100%;display:block;"><span id="prehide384021" onclick="processCodeBlocks.togglePre(384021);">Hide</span>  &nbsp; <span id="copycode384021" onclick="return processCodeBlocks.copyCode(384021);">Copy Code</span></div><pre id="pre384021" style="margin-top: 0px;" class="notranslate">#undef INTERFACE
#define INTERFACE  ICompare
DECLARE_INTERFACE_ (INTERFACE, IUnknown)
{
   STDMETHOD  (QueryInterface) (THIS_ REFIID, void **) PURE;
   STDMETHOD_ (ULONG, AddRef)  (THIS) PURE;
   STDMETHOD_ (ULONG, Release) (THIS) PURE;
   STDMETHOD_ (long, Compare)  (THIS_ const void *, 
                                const void *) PURE;
};</pre>
<p>We do need to run <i>GUIDGEN.EXE</i> to create a GUID for our <code>ICompare</code>'s VTable. (We won't need a GUID for the object itself). We'll give it the name of <code>DIID_Compare</code>. (Traditionally, Microsoft prepends a <i>D</i> to the names of GUIDs intended for VTables that wrap callbacks. We'll just follow the tradition.)</p><div class="pre-action-link" id="premain617916" style="width:100%;display:block;"><span id="prehide617916" onclick="processCodeBlocks.togglePre(617916);">Hide</span>  &nbsp; <span id="copycode617916" onclick="return processCodeBlocks.copyCode(617916);">Copy Code</span></div><pre id="pre617916" style="margin-top: 0px;" class="notranslate">// ICompare VTable's GUID
// {4115B8E2-1823-4bbc-B10D-3D33AAA12ACF}
DEFINE_GUID(DIID_ICompare, 0x4115b8e2, 0x1823, 0x4bbc,
 0xb1, 0xd, 0x3d, 0x33, 0xaa, 0xa1, 0x2a, 0xcf);</pre>
<p>Let's go back to our app. Now, we have to put a COM object inside our app code. Specifically, we have to create an <code>ICompare</code> object, and have our <code>Compare</code> callback be its extra function. Because we'll need only one <code>ICompare</code> object, we'll simply declare it static. We'll also have to <code>#include ISort.h</code> because that contains the definition of the <code>ICompare</code> object, its VTable, and its GUID. So, here's the code we insert to replace the <code>Compare</code> function in our above app code:</p><div class="pre-action-link" id="premain654223" style="width:100%;display:block;"><span id="prehide654223" onclick="processCodeBlocks.togglePre(654223);">Hide</span>  &nbsp; <span id="preShrink654223" onclick="processCodeBlocks.shrinkExpand(654223);">Shrink</span> <img id="preimg654223" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(654223);">  &nbsp; <span id="copycode654223" onclick="return processCodeBlocks.copyCode(654223);">Copy Code</span></div><pre id="pre654223" style="margin-top: 0px;" processed="true" class="notranslate">#include "ISort.h"

// Here's our app's ICompare object. We need only one of these,
// so we'll just declare it static. That way, we don't have to
// allocate it, free it, nor maintain any reference count.
static ICompare   MyCompare;

// This is ICompare's QueryInterface. It returns a pointer
// to our ICompare object.
HRESULT STDMETHODCALLTYPE QueryInterface(ICompare *this,
      REFIID vTableGuid, void **ppv)
{
   // Since this is an ICompare object, we must recognize
   // ICompare VTable's GUID, which is defined for us in
   // ISort.h. Our ICompare can also masquerade as an IUnknown.
   if (!IsEqualIID(vTableGuid, &amp;IID_IUnknown) &amp;&amp;
      !IsEqualIID(vTableGuid, &amp;DIID_ICompare))
   {
      *ppv = 0;
      return(E_NOINTERFACE);
   }

   *ppv = this;

   // Normally, we'd call our AddRef function here. But since
   // our ICompare isn't allocated, we don't need to bother
   // with reference counting.
   return(NOERROR);
}

ULONG STDMETHODCALLTYPE AddRef(ICompare *this)
{
   // Our one and only ICompare isn't allocated. Instead, it's
   // statically declared above (MyCompare). So we'll just
   // return 1.
   return(1);
}

ULONG STDMETHODCALLTYPE Release(ICompare *this)
{
   // Our one and only ICompare isn't allocated, so we
   // never need worry about freeing it.
   return(1);
}

// This is the extra function for ICompare. It is called
// Compare. The ISort object will call this function when
// we call ISort's Sort function.
long STDMETHODCALLTYPE Compare(ICompare *this,
      const void *elem1, const void *elem2)
{
   // Do a compare of the two elements. We know that
   // we passed an array of DWORD values to Sort().
   if (*((DWORD *)elem1) == *((DWORD *)elem2)) return 0;
   if (*((DWORD *)elem1) &lt; *((DWORD *)elem2)) return -1;
   return 1;
}

// Our ICompare VTable. We need only one of these, so we can
// declare it static.
static const ICompareVtbl ICompare_Vtbl = {QueryInterface,
AddRef,
Release,
Compare};</pre>
<p>Notice that our <code>Compare</code> function is there. It's simply wrapped inside an <code>ICompare</code> object now. (And the first argument passed to it is now a pointer to our <code>ICompare</code> object, which will be our statically declared <code>MyCompare</code>, in this case.)</p>
<p>Now, we're left with the really convoluted job. How does our app give its <code>ICompare</code> object to our <code>ISort</code> object (inside <i>ISort.dll</i>)?
 I really wish I could say that this is going to be simple and 
easy-to-understand, but unfortunately, due to some dubious design 
decisions by the MS guys who devised this whole scheme, it's going to be
 a painfully twisted trip through the house of horrors.</p>
<h2><a name="CONNECT">IConnectionPointContainer</a> and IConnectionPoint objects</h2>
<p>To let an app give its <code>ICompare</code> object to our <code>ISort</code> object, we have to add some things to our <code>ISort</code>
 object. Specifically, we have to add two sub-objects to it. (Hopefully,
 in the last chapter, you have read and understand how to create an 
object that has sub-objects.)</p>
<p>One good thing is that Microsoft has already defined these two 
sub-objects (and their VTable GUIDs) in some include files that ship 
with your compiler. The two sub-objects are called <code>IConnectionPointContainer</code> and <code>IConnectionPoint</code>. All we need to do is add them to our <code>ISort</code> object. Since we've already defined a <code>MyRealISort</code>, we'll just embed these two sub-objects inside it. And since we know that an app is going to give us a pointer to an <code>ICompare</code> object, let's also add a place to store that inside <code>MyRealISort</code>.</p><div class="pre-action-link" id="premain64596" style="width:100%;display:block;"><span id="prehide64596" onclick="processCodeBlocks.togglePre(64596);">Hide</span>  &nbsp; <span id="copycode64596" onclick="return processCodeBlocks.copyCode(64596);">Copy Code</span></div><pre id="pre64596" style="margin-top: 0px;" class="notranslate">typedef struct {
   ISortVtbl                 *lpVtbl;
   DWORD                     count;
   IConnectionPointContainer container;
   IConnectionPoint          point;
   ICompare                  *compare;
} MyRealISort;</pre>
<p>Note that our base object is our <code>ISort</code> itself. We could notate it like so:</p><div class="pre-action-link" id="premain683206" style="width:100%;display:block;"><span id="prehide683206" onclick="processCodeBlocks.togglePre(683206);">Hide</span>  &nbsp; <span id="copycode683206" onclick="return processCodeBlocks.copyCode(683206);">Copy Code</span></div><pre id="pre683206" style="margin-top: 0px;" class="notranslate">typedef struct {
   ISort                     iSort;
   DWORD                     count;
   IConnectionPointContainer container;
   IConnectionPoint          point;
   ICompare                  *compare;
} MyRealISort;</pre>
<p>But since an <code>ISort</code> has only its one <code>lpVtbl</code> member, both definitions amount to the same thing.</p>
<p>As you'll remember from the last chapter, the base object's <code>QueryInterface</code> must recognize the GUIDs of all of its sub-object's VTables, as well as its own VTable. So our <code>ISort</code> <code>QueryInterface</code> must look like so:</p><div class="pre-action-link" id="premain913516" style="width:100%;display:block;"><span id="prehide913516" onclick="processCodeBlocks.togglePre(913516);">Hide</span>  &nbsp; <span id="preShrink913516" onclick="processCodeBlocks.shrinkExpand(913516);">Shrink</span> <img id="preimg913516" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(913516);">  &nbsp; <span id="copycode913516" onclick="return processCodeBlocks.copyCode(913516);">Copy Code</span></div><pre id="pre913516" style="margin-top: 0px;" processed="true" class="notranslate">HRESULT STDMETHODCALLTYPE QueryInterface(ISort *this, 
        REFIID vTableGuid, void **ppv)
{
   // Because an IConnectionPointContainer
   // is a sub-object of our ISort, we
   // must return a pointer to this sub-object
   // if the app asks for it. Because
   // we've embedded our IConnectionPointContainer
   // object inside of our
   // MyRealISort, we can get that sub-object
   // very easily using pointer arithmetic.
   if (IsEqualIID(vTableGuid, &amp;IID_IConnectionPointContainer))
      *ppv = ((unsigned char *)this + 
               offsetof(MyRealISort, container));

   else if (IsEqualIID(vTableGuid, &amp;IID_IUnknown) || 
            IsEqualIID(vTableGuid, &amp;IID_ISort))
      *ppv = this;

   else
   {
      *ppv = 0;
      return(E_NOINTERFACE);
   }

   this-&gt;lpVtbl-&gt;AddRef(this);

   return(NOERROR);
}</pre>
<p>But wait. Did we forget to also check for our <code>IConnectionPoint</code>
 sub-object's VTable GUID, and return a pointer to that? No, we didn't 
forget. Unfortunately, the MS guys who thought up this design kind of 
broke the rules. The <code>IConnectionPoint</code> sub-object is not gotten by calling the base object's <code>QueryInterface</code> (nor the <code>QueryInterface</code> of our <code>IConnectionPointContainer</code> sub-object). In a moment, we'll see how it's gotten.</p>
<p>The <code>IConnectionPointContainer</code> sub-object can serve two purposes.</p>
<p>First of all, by passing an <code>IConnectionPointContainer</code> VTable GUID to our <code>ISort</code>'s <code>QueryInterface</code> function, an app can determine whether our <code>ISort</code> accepts callback functions. Incidentally, in COM documentation, such an object (i.e., one that provides an <code>IConnectionPointContainer</code>) is described as <i>sourcing events</i>. If <code>QueryInterface</code> returns a pointer to an <code>IConnectionPointContainer</code>, then the object can source events. (If not, then a 0 is returned.)</p>
<p>Secondly, the <code>IConnectionPointContainer</code> has a function to get an <code>IConnectionPoint</code> sub-object. That function is called <code>FindConnectionPoint</code>.</p>
<p>So, let's write the functions of our <code>IConnectionPointContainer</code> sub-object. Because it's a sub-object of <code>ISort</code>, and <code>ISort</code> is the base object, our <code>IConnectionPointContainer</code>'s <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code> functions simply delegate to <code>ISort</code>'s <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code>.</p><div class="pre-action-link" id="premain409933" style="width:100%;display:block;"><span id="prehide409933" onclick="processCodeBlocks.togglePre(409933);">Hide</span>  &nbsp; <span id="copycode409933" onclick="return processCodeBlocks.copyCode(409933);">Copy Code</span></div><pre id="pre409933" style="margin-top: 0px;" class="notranslate">STDMETHODIMP QueryInterface_Connect(IConnectionPointContainer *this,
                                    REFIID vTableGuid, void **ppv)
{
   // Because this is a sub-object of our ISort (ie, MyRealISort) object,
   // we delegate to ISort's QueryInterface. And because we embedded the
   // IConnectionPointContainer directly inside of MyRealISort, all we need
   // is a little pointer arithmetic to get our ISort.
   return(QueryInterface((ISort *)((char *)this - 
          offsetof(MyRealISort, container)), vTableGuid, ppv));
}

STDMETHODIMP_(ULONG) AddRef_Connect(IConnectionPointContainer *this)
{
   // Because we're a sub-object of ISort, delegate to its AddRef()
   // in order to increment ISort's reference count.
   return(AddRef((ISort *)((char *)this - offsetof(MyRealISort, container))));
}

STDMETHODIMP_(ULONG) Release_Connect(IConnectionPointContainer *this)
{
   // Because we're a sub-object of ISort, delegate to its Release()
   // in order to decrement ISort's reference count.
   return(Release((ISort *)((char *)this - offsetof(MyRealISort, container))));
}</pre>
<p>For now, we're going to use a stub for the <code>EnumConnectionPoints</code> function.</p><div class="pre-action-link" id="premain626585" style="width:100%;display:block;"><span id="prehide626585" onclick="processCodeBlocks.togglePre(626585);">Hide</span>  &nbsp; <span id="copycode626585" onclick="return processCodeBlocks.copyCode(626585);">Copy Code</span></div><pre id="pre626585" style="margin-top: 0px;" class="notranslate">STDMETHODIMP EnumConnectionPoints(IConnectionPointContainer *this,
             IEnumConnectionPoints **enumPoints)
{
   *enumPoints = 0;
   return(E_NOTIMPL);
}</pre>
<p>The real work is in <code>FindConnectionPoint</code>. The app passes us a handle to where it wants us to return <code>ISort</code>'s <code>IConnectionPoint</code> sub-object. Since we've embedded it directly inside <code>MyRealISort</code>, it's easy to locate.</p>
<p>The app also passes us the VTable GUID we defined for our <code>ICompare</code>
 (callback) object. That's how we know that the app really does mean to 
provide us with the correct object that we require. We don't want to 
return a <code>IConnectionPoint</code> if the app isn't prepared to give us an <code>ICompare</code> object.</p><div class="pre-action-link" id="premain837131" style="width:100%;display:block;"><span id="prehide837131" onclick="processCodeBlocks.togglePre(837131);">Hide</span>  &nbsp; <span id="preShrink837131" onclick="processCodeBlocks.shrinkExpand(837131);">Shrink</span> <img id="preimg837131" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(837131);">  &nbsp; <span id="copycode837131" onclick="return processCodeBlocks.copyCode(837131);">Copy Code</span></div><pre id="pre837131" style="margin-top: 0px;" processed="true" class="notranslate">STDMETHODIMP FindConnectionPoint(IConnectionPointContainer *this,
             REFIID vTableGuid, IConnectionPoint **ppv) 
{
   // Is the app asking us to return an IConnectionPoint object it can use
   // to give us its ICompare object? The app asks this by passing us
   // ICompare VTable's GUID (which we defined in ISort.h).
   if (IsEqualIID(vTableGuid, &amp;DIID_ICompare))
   {
      MyRealISort  *iSort;

      // The app obviously wants to give its ICompare object to our
      // ISort. In order to do that, we need to give the app a standard
      // IConnectionPoint. This is easy to do since we embedded both
      // our IConnectionPointContainer and IConnectionPoint inside of our 
      // ISort. All we need is a little pointer arithmetic.
      iSort = (MyRealISort *)((char *)this - offsetof(MyRealISort, container));
      *ppv = &amp;iSort-&gt;point;

      // Because we're giving the app a pointer to our IConnectionPoint,
      // and our IConnectionPoint is a sub-object of ISort, we need to
      // increment ISort's reference count. The easiest way to do this is
      // to call our IConnectionPointContainer's AddRef, because all we do
      // there is delegate to our ISort's AddRef.
      AddRef_Connect(this);

      return(S_OK);
   }

   // We don't support any other app callback objects for our ISort.
   // All we've defined, and support, is an ICompare object. Tell
   // the app we don't know anything about the GUID he passed to us, and
   // do not give him any IConnectionPoint object.
   *ppv = 0;
   return(E_NOINTERFACE);
}</pre>
<p>That takes care of our <code>IConnectionPointContainer</code>'s functions. Now we need to write our <code>IConnectionPoint</code>'s functions.</p>
<p>Since <code>IConnectionPoint</code> is also a sub-object of <code>ISort</code> (just like <code>IConnectionPointContainer</code>), its <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code> will delegate to <code>ISort</code>'s <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code>. I won't bother reproducing those functions since they are almost identical to <code>IConnectionPointContainer</code>'s.</p>
<p>For now, we're going to use a stub for the <code>EnumConnections</code> function.</p>
<p>The <code>GetConnectionInterface</code> function simply copies <code>ICompare</code>'s VTable GUID to a buffer that the app passes. Later, we'll see the use for this.</p>
<p>The <code>GetConnectionPointContainer</code> function returns a pointer to the <code>IConnectionPointContainer</code> sub-object that created this <code>IConnectionPoint</code> object. What this implies is that, as long as the app is holding onto some <code>IConnectionPoint</code> sub-object that our <code>IConnectionPointContainer</code> gives to the app, our <code>IConnectionPointContainer</code> must stick around. This is no problem here since we've embedded both our <code>IConnectionPointContainer</code> and <code>IConnectionPoint</code> inside our <code>MyRealISort</code> (and our <code>MyRealISort</code> is going to stick around until all its sub-objects and base object are <code>Release</code>d).</p>
<p>The above three functions are fairly trivial, so I'll simply refer you to the source code in <i>Sort.c</i>.</p>
<p>The real work is in the <code>Advise</code> and <code>Unadvise</code> functions. This is how an app actually gives us its <code>ICompare</code>. <code>Advise</code> essentially does the same task as our <code>SetCompare</code> function did. And <code>Unadvise</code> does what our <code>UnsetCompare</code> did.</p>
<p>Let's look at <code>Advise</code>:</p><div class="pre-action-link" id="premain909023" style="width:100%;display:block;"><span id="prehide909023" onclick="processCodeBlocks.togglePre(909023);">Hide</span>  &nbsp; <span id="preShrink909023" onclick="processCodeBlocks.shrinkExpand(909023);">Shrink</span> <img id="preimg909023" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(909023);">  &nbsp; <span id="copycode909023" onclick="return processCodeBlocks.copyCode(909023);">Copy Code</span></div><pre id="pre909023" style="margin-top: 0px;" processed="true" class="notranslate">STDMETHODIMP Advise(IConnectionPoint *this, IUnknown *obj, DWORD *cookie) 
{
   HRESULT     hr;
   MyRealISort *iSort;

   // Get our MyRealISort that this IConnectionPoint sub-object belongs
   // to. Because this IConnectPoint sub-object is embedded directly
   // inside its MyRealISort, all we need is a little pointer arithmetic.
   iSort = (MyRealISort *)((char *)this - offsetof(MyRealISort, point));

   // We allow only one ICompare for our ISort, so see if the app already
   // called our Advise(), and we got one. If so, let the app know that it
   // is trying to give us more ICompares than we allow.
   if (iSort-&gt;compare) return(CONNECT_E_ADVISELIMIT);
 
   // Ok, we haven't yet gotten the one ICompare we allow from the app. Get
   // the app's ICompare object. We do this by calling the QueryInterface
   // function of the app object passed to us. We pass ICompare VTable's
   // GUID (which we defined in ISort.h).
   //
   // Save the app's ICompare pointer in our ISort compare member, so we
   // can get it when we need it.
   hr = obj-&gt;lpVtbl-&gt;QueryInterface(obj, &amp;DIID_ICompare, &amp;iSort-&gt;compare);

   // We need to return (to the app) some value that will clue our Unadvise()
   // function below how to locate this app ICompare. The simpliest thing is
   // to just use the app's ICompare pointer as that return value.
   *cookie = (DWORD)iSort-&gt;compare;

   return(hr);
}</pre>
<p>Actually, the app doesn't pass a pointer to its <code>ICompare</code>
 object. That would be too easy, straight-forward, and understandable, 
and obviously that wasn't the goal for the MS programmers who designed 
this thing. Rather, the app passes us some app object from which we can 
request the app to give us its <code>ICompare</code>. Our <code>Advise</code> function is expected to call that object's <code>QueryInterface</code> function, passing the <code>ICompare</code> VTable's GUID to request the app's <code>ICompare</code>. I guess that MS thought this would be a good way to double-check that the app really is giving us an <code>ICompare</code> (except, don't you know that if an app is so badly written, it can't figure out what it should be doing with <code>Advise</code>, then its <code>QueryInterface</code> will probably return the wrong object too?). Our course, the app's <code>QueryInterface</code> will automatically do an <code>AddRef</code> on the <code>ICompare</code> it gives to us, so we are expected to <code>Release</code> the app's <code>ICompare</code> when done with it.</p>
<p>Our <code>Advise</code> function stores the app's <code>ICompare</code> pointer in our <code>MyRealISort</code>'s <code>compare</code> member, so we can access it when we need it, and finally <code>Release</code> it.</p>
<p><code>Advise</code> must return some <code>DWORD</code> value, of our own choosing, to the app. The app is expected to store this <code>DWORD</code> value, and later pass it to our <code>Unadvise</code> function. We can choose any <code>DWORD</code> value we want, but this value should somehow help our <code>Unadvise</code> function when the app later wants us to give back (i.e., <code>Release</code>) its <code>ICompare</code>. Indeed, the app later calls our <code>Unadvise</code> when the app no longer wants us to call its callback functions, and to instead <code>Release</code> its <code>ICompare</code>. So, let's look at <code>Unadvise</code>:</p><div class="pre-action-link" id="premain204231" style="width:100%;display:block;"><span id="prehide204231" onclick="processCodeBlocks.togglePre(204231);">Hide</span>  &nbsp; <span id="preShrink204231" onclick="processCodeBlocks.shrinkExpand(204231);">Shrink</span> <img id="preimg204231" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(204231);">  &nbsp; <span id="copycode204231" onclick="return processCodeBlocks.copyCode(204231);">Copy Code</span></div><pre id="pre204231" style="margin-top: 0px;" processed="true" class="notranslate">STDMETHODIMP Unadvise(IConnectionPoint *this, DWORD cookie) 
{
   MyRealISort *iSort;

   // Get the MyRealISort that this IConnectionPoint sub-object belongs
   // to. Because this IConnectPoint sub-object is embedded directly
   // inside its MyRealISort, all we need is a little pointer arithmetic.
   iSort = (MyRealISort *)((char *)this - offsetof(MyRealISort, point));

   // Use the passed value to find wherever we stored his ICompare pointer.
   // Well, since we allow only one ICompare for our ISort, we already
   // know we stored it in our ISort-&gt;compare member. And Advise()
   // returned that pointer as the "cookie" value. So we already got the
   // ICompare right now.
   //        
   // Let's just make sure the cookie he passed is really the pointer we
   // expect.
   if (cookie &amp;&amp; (ICompare *)cookie == iSort-&gt;compare)
   {
      // Release the app's ICompare
      ((ICompare *)cookie)-&gt;lpVtbl-&gt;Release((ICompare *)cookie);

      // We no longer have the app's ICompare, so clear the ISort
      // compare member.
      iSort-&gt;compare = 0;
      
      return(S_OK);
   }
   return(CONNECT_E_NOCONNECTION);
}</pre>
<p>The rest of the code in <i>Sort.c</i> is almost exactly the same as in our very first chapter's <i>IExample.c</i>. The only difference is that, after our <code>IClassFactory</code>'s <code>CreateInstance</code> allocates our <code>MyRealISort</code>, we must initialize the sub-objects inside it, and initialize any other private data members.</p>
<p>You can compile our COM object into <i>ISORT.DLL</i>. To register it, simply take the register utility for <code>IExample</code> (in the directory <i>RegIExample</i>), and replace all instances of <code>IExample</code> with <code>ISort</code>.</p>
<h2><a name="C1">An</a> example C app</h2>
<p>In the directory <i>ISortApp</i> is an example C app that uses our ISort DLL. Previously, we discussed the <code>ICompare</code> functions, so all that's really new here is how the app calls our <code>Advise</code> function to give us its <code>ICompare</code> object, and then later calls <code>Unadvice</code> to ask us to release it. This is a fairly trivial example, so you can peruse the comments in <i>ISortApp.c</i>.</p>
<p>Because COM event connections can be fairly complicated, I've 
supplied a second example of an object that uses callbacks. In the 
directory <i>IExampleEvts</i> is the source to another COM DLL. This DLL implements an object (<code>IExampleEvts</code>) that has an extra function called <code>DoSomething</code>. This function has the ability to call any of up to five different app callbacks. So we have defined an <code>IFeedback</code> object to wrap all five of those callback functions. Its definition is in <i>IExampleEvts.h</i>.
 (A callback object can contain numerous extra, callback functions. And 
each function can have a different purpose, take different arguments, 
and return different values.)</p>
<p>Take the time to peruse these examples and fully understand what is 
going on. Things are going to get more complicated as we go on from 
here.</p>
<h2><a name="SCRIPT">Adding</a> support for script languages</h2>
<p>In order to support script languages, we need to add some <code>IDispatch</code> functions. Let's take our <code>IExampleEvts</code> COM object and adapt it for use with script languages.</p>
<p>First, let's create a new directory named <i>IExampleEvts2</i>, and copy the original sources there. Then, we'll rename the files, replacing all instances of <code>IExampleEvts</code> with <code>IExampleEvts2</code>, and all instances of <code>IFeedback</code> with <code>IFeedback2</code>. I've done this for you already. I also ran <i>GUIDGEN.EXE</i>
 and made new GUIDs for the objects and their VTables. Since we're going
 to also need a type library, I created a new GUID for that too.</p>
<p>We need to add <code>IDispatch</code> functions to both our <code>IExampleEvts2</code> VTable and our <code>IFeedback2</code> VTable. You can compare the original <i>IExampleEvts.h</i> with the new <i>IExampleEvts2.h</i> to see the changes. Note that both VTables now have the five standard <code>IDispatch</code> functions added, and also the macros now specify that both VTables are based on an <code>IDispatch</code> (instead of <code>IUnknown</code>).</p>
<p>In <i>IExampleEvts2.c</i>, I've added the five <code>IDispatch</code> functions to our <code>IExampleEvts2</code> object and its statically declared VTable. I also added a static variable <code>MyTypeInfo</code> to hold an <code>ITypeInfo</code> that Microsoft's <code>GetTypeInfoOfGuid</code> creates for us (and which we use with <code>DispInvoke</code>). This is same thing we did when we added support to our <code>IExample2</code> object back in chapter 2. There's nothing new to any of these changes so far.</p>
<p>We do have to change our <code>DoSomething</code> function. No longer can we call any callback function directly (referencing it via the <code>lpVtbl</code>
 of the object). This is because a script engine will not actually have 
function pointers in its VTable for those extra callback functions. 
Instead, we must call it indirectly using the callback object's (<code>IFeedback</code>'s) <code>Invoke</code> function. We must pass the appropriate DISPID of the function we wish to call.</p>
<p>The only new thing appears in our <i>IExampleEvts2.IDL</i> file (i.e., the file that <i>MIDL.EXE</i> compiles into our <i>.TLB</i> type library file). Notice how we've defined <code>IFeedback2</code>'s VTable (which we arbitrarily label as <code>IFeedback2VTbl</code>). This is similar to how we define our <code>IExampleEvts2</code> VTable, except that we don't use the <code>dual</code> keyword on <code>IFeedback2</code>'s
 VTable. Script engines can't utilize a dual VTable for a callback 
object. I've arbitrarily chosen to use DISPID 1 for the first callback 
function (<code>Callback1</code>), 2 for the second callback function, etc.</p>
<p>The other new thing is how we define our <code>IExampleEvts2</code> object itself as so:</p><div class="pre-action-link" id="premain717661" style="width:100%;display:block;"><span id="prehide717661" onclick="processCodeBlocks.togglePre(717661);">Hide</span>  &nbsp; <span id="copycode717661" onclick="return processCodeBlocks.copyCode(717661);">Copy Code</span></div><pre id="pre717661" style="margin-top: 0px;" class="notranslate">coclass IExampleEvts2
{
   [default] interface IExampleEvts2VTbl;
   [source, default] interface IFeedback2VTbl;
}</pre>
<p>The first interface line should look familiar. It's the same as how 
we've always marked an object's VTable in any IDL file. But the second 
interface line tells anyone using our type library that <code>IExampleEvts2</code> supports a callback object whose VTable is described by <code>IFeedback2Vtbl</code>. The "<code>source</code>" keyword indicates this is a callback VTable. The "<code>default</code>" keyword means that this VTable is the one a script engine should use for any callback object associated with our <code>IExampleEvts2</code> object.</p>
<p>You can compile our COM object into <i>IExampleEvts2.DLL</i>. To register it, simply take the register utility for <code>IExample2</code> (in the directory <i>RegIExample2</i>) and replace all instances of <code>IExample2</code> with <code>IExampleEvts2</code>.</p>
<h2><a name="C2">Another</a> example C app</h2>
<p>In the directory <i>IExampleEvts2App</i> is an example C app that uses our IExampleEvts2 DLL. Compare this with the original source in <i>IExampleEvtsApp</i>. Notice that we've added the five standard <code>IDispatch</code> functions to our <code>IFeedback2</code> object.</p>
<p>Although <i>IExampleEvts2.IDL</i> did not define the <code>IFeedback2</code> VTable as "dual", we've nevertheless included the extra functions (<code>Callback1</code> through <code>Callback5</code>) in our actual statically declared VTable (<code>IFeedback2_Vtbl</code>). In this way, we can fool <code>DispInvoke</code> into using this VTable as if it really was declared as dual. Also, notice that the type library we load is <code>IExampleEvts2</code>'s type library, because that is where the <code>IFeedback2</code> VTable is described. And the <code>ITypeInfo</code> we ask <code>GetTypeInfoOfGuid</code> to create is for an <code>IFeedback2</code> VTable. We use this <code>ITypeInfo</code> with our <code>IFeedback2</code>'s <code>Invoke</code> function.</p>
<h2><a name="VB">A</a> VBScript example</h2>
<p>In the <i>IExampleEvts2</i> directory is a VBScript example named <i>IExampleEvts2.vbs</i> as so:</p><div class="pre-action-link" id="premain278948" style="width:100%;display:block;"><span id="prehide278948" onclick="processCodeBlocks.togglePre(278948);">Hide</span>  &nbsp; <span id="copycode278948" onclick="return processCodeBlocks.copyCode(278948);">Copy Code</span></div><pre id="pre278948" style="margin-top: 0px;" class="notranslate" lang="vbscript"><span class="code-keyword">Set</span> myobj = WScript.<span class="code-keyword">CreateObject</span>(<span class="code-string">"</span><span class="code-string">IExampleEvts2.object"</span>, <span class="code-string">"</span><span class="code-string">label_"</span>)
myobj.DoSomething()

<span class="code-keyword">sub</span> label_Callback1()
   Wscript.echo <span class="code-string">"</span><span class="code-string">Callback1 is called"</span>
<span class="code-keyword">end</span> <span class="code-keyword">sub</span></pre>
<p>The first line uses the Windows Scripting Shell's <code>CreateObject</code> to get an instance of our <code>IExampleEvts2</code> object (which should have been registered with the ProdID of <i>IExampleEvts2.object</i>). The reason we use the Script Shell's <code>CreateObject</code> instead of the VB engine's <code>CreateObject</code>,
 is because the former allows us to pass a second argument -- a string 
that is prepended to the name of any callback function. Here, we've 
specified the string <i>label</i>. So for example, when our <code>IExampleEvts2</code> <code>DoSomething</code> calls the script engine's <code>IFeedback2</code>'s <code>Invoke</code> and passes a DISPID of 1 (i.e., for <code>Callback1</code>), then the VBScript function that gets called is <code>label_Callback1</code>.</p>
<p>In fact, we've provided a VB function by that name, which simply displays a message box.</p>
<h2><a name="MULT">Multiple</a> types of callback objects</h2>
<p>An object can support numerous types of callback objects. For example, if we wanted, we could have our <code>ISort</code> object support being given both an <code>ICompare</code> and <code>IFeedback2</code> callback objects. In this case, we would need a separate <code>IConnectionPoint</code> object for each. In that case, we'd need to put both the <code>ICompare</code> and <code>IFeedback2</code> VTables in our IDL file, and reference them both in our object like so:</p><div class="pre-action-link" id="premain160990" style="width:100%;display:block;"><span id="prehide160990" onclick="processCodeBlocks.togglePre(160990);">Hide</span>  &nbsp; <span id="copycode160990" onclick="return processCodeBlocks.copyCode(160990);">Copy Code</span></div><pre id="pre160990" style="margin-top: 0px;" class="notranslate">coclass IExampleEvts2
{
   [default] interface IExampleEvts2VTbl;
   [source, default] interface IFeedback2VTbl;
   [source] interface ICompareVtbl;
}</pre>
<p>But note that only one source interface can be marked as default, and
 a script engine can use only the default one (i.e., a script can't 
provide us any <code>ICompare</code> callback functions).</p>
<p>Furthermore, we have to provide real code for our <code>IConnectionPointContainer</code>'s <code>EnumConnectionPoints</code> function. This function should return another object that can enumerate each of the different types of <code>IConnectPoint</code>s
 that we support. (The object it returns is a standard enumerator object
 such as the enumerator we used in our Collections chapter.)</p>
<p>Because callback objects are usually used in conjunction with 
scripting (and script engines can't support multiple types of callback 
objects per a single coclass object), I'm going to delve further into 
multiple types of callback objects.</p>
<h2><a name="MULT2">Multiple</a> callback objects</h2>
<p>In our example objects, we allowed an app (or script engine) to provide us only one <code>IFeedback2</code> object (which we stored in our <code>MyRealIExampleEvts2</code>'s <code>feedback</code> member). But theoretically, an app may provide us with as many <code>IFeedback2</code> callback objects as it desires. In our <code>IConnectionPoint</code>'s <code>Advise</code>, we simply refused to accept more than one <code>IFeedback2</code> from an app/engine. If you wish to allow an app/engine to provide more <code>IFeedback2</code>s, then instead of a <code>feedback</code> member, you may wish to define another struct that can be linked into a list, and also has a member to store an <code>IFeedback2</code> pointer. You would <code>GlobalAlloc</code> one of these structs in <code>Advise</code>, and link them into a list whose head would be stored in some <code>MyRealIExampleEvts2</code> member.</p>
<p>You would also need to modify <code>DoSomething</code> to loop through the entire list, and call each <code>IFeedback2</code>'s <code>Invoke</code>.</p>
<p>But again, since the primary use of callback objects is for 
scripting, and most uses will involve only one callback object, we'll 
skip developing an example to illustrate.</p>
<h2>What's next?</h2>
<p>In the next article, we'll examine how to turn a C app into an 
ActiveX script host (i.e., how to run scripts from your C app, and how a
 script calls C functions in your app, and your app calls functions in 
the script, to control your app and exchange data with a script).</p>


						</div>
						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/Beginners" data-country="US" data-loadonview="true" data-tags="C++, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=300x250&c=571981"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=300x250&c=571981"  width="300px" height="250px" target="_blank"/></a></noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

    <ul class="rrssb-buttons clearfix rrssb-1">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=COM%20in%20plain%20C%2c%20Part%205%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f14183%2fCOM-in-plain-C-Part-5%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=COM+in+plain+C%2c+Part+5+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f14183%2fCOM-in-plain-C-Part-5" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                        C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14183%2fCOM-in-plain-C-Part-5" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14183%2fCOM-in-plain-C-Part-5&amp;title=COM+in+plain+C%2c+Part+5+-+CodeProject&amp;summary=&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14183%2fCOM-in-plain-C-Part-5&amp;title=COM+in+plain+C%2c+Part+5+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14183%2fCOM-in-plain-C-Part-5&amp;description=COM+in+plain+C%2c+Part+5+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    

<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/member_unknown.gif" style="border-width:0px;transform:rotate(1deg);">
    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="https://www.codeproject.com/Members/Jeff-Glatt">Jeff Glatt</a></b>

        <table>
        <tbody><tr>
            <td rowspan="2" valign="middle" nowrap="nowrap">
            
            </td>
            <td nowrap="nowrap">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle"></span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
                </div>
            </td>
            <td rowspan="2" style="padding-left:15px">
                <a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn" title="" class="button unfollowed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Have the articles and posts from this member appear in your Timeline so you can stay up to date." style="display: inline-block;">Follow<div class="tiny-text" style="margin-top:-3px;">this Member</div><div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have the articles and posts from this member appear in your Timeline so you can stay up to date.</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn" title="" class="button followed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Stop following this Member" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Member</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">United States <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/US.gif" alt="United States" width="16px" height="11px"></span>
            </td>
        </tr>
        </tbody></table>
    </div>

    <div class="description">
        No Biography provided

        
    </div>

</div><br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/Beginners" data-country="US" data-loadonview="true" data-tags="C++, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5,pos_bottom" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=728x90&c=571981"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=728x90&c=571981"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellspacing="0" cellpadding="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="3px" border="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="button new-message compose float-left">
<a rel="nofollow" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;floc=/Articles/14183/COM-in-plain-C-Part-5" name="Frm_HoverNL" target="_top">Add a Comment or Question&nbsp;</a>
</div><div class="admin-links float-left align-middle" style="width:90px;line-height:24px;margin-top:4px;">
&nbsp;<a href="https://www.codeproject.com/KB/FAQs/MessageBoardsFAQ.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/help_sm.png" title="FAQ" alt="FAQ" style="border-width:0;width:16px;height:16px;vertical-align:middle;"></a>
</div><div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="308357"><input type="hidden" name="sbo" value="fm"><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search subdue" autocomplete="off" name="qf" value="Search Comments"><input type="image" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/search.gif">
</form>
</div><div class="tooltip email-alert" id="ctl00_MessageBoard_SubscribeDiv">
	<span class="nowrap medium-text">Email Alerts</span><div class="tooltip-flyout" style="width: 335px;margin-top: 24px;left: -270px;padding: 7px;">
		<b>Email me</b><input type="checkbox" id="ctl00_MessageBoard_SubscribeNew"><label for="ctl00_MessageBoard_SubscribeNew">New Posts</label><input type="checkbox" id="ctl00_MessageBoard_SubscribeReplies"><label for="ctl00_MessageBoard_SubscribeReplies">Replies to Posts</label><br><br><b>Send them</b><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeInstant"><label for="ctl00_MessageBoard_SubscribeInstant">Instantly</label><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeDaily"><label for="ctl00_MessageBoard_SubscribeDaily">Daily</label>&nbsp; <b>For</b> <select id="ctl00_MessageBoard_MessageType" class="tiny-text" style="width:80px;">
			<option value="0" selected="selected">
				All Types
			</option><option value="128">
				Announcements
			</option>
		</select><button class="button safe float-right update">Update</button>
	</div>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?floc=%2fArticles%2f14183%2fCOM-in-plain-C-Part-5&amp;fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="308357"><input type="hidden" name="currentQS" value="floc=%2fArticles%2f14183%2fCOM-in-plain-C-Part-5&amp;fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True"><input type="hidden" name="floc" value="/Articles/14183/COM-in-plain-C-Part-5">Spacing<select size="1" class="dropdown" name="spc">
<option selected="selected" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view">
<option selected="selected" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="selected" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table width="100%" cellspacing="0" cellpadding="2px" border="0">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span> <span class="nav-link disabled">Next</span></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table class="fixed-layout blank-background" width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr id="F4798468_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4798468xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4798468" parent="0" thread="4798468" href="https://www.codeproject.com/Messages/4798468/I-need-to-find-a-way-to-call-the-vbscript-inside-a.aspx">I need to find a way to call the vbscript inside an html file</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">gupse gunes</span><span class="date">11-Apr-14  7:55</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=6723925">gupse gunes</a></span></td><td class="date"><span>11-Apr-14  7:55&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4798468_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="6723925" msgid="4798468" votingtype="GoodOrBad" done="true"><a href="#xx4798468xx" onclick="return rateItem(5, 4798468,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',6723925);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4798468xx" onclick="return rateItem(1, 4798468,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',6723925);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">I tried the callback function iexampleevts2 and it works
 with the vbs file many thanks for the great article it helped me a lot.
 I also need to have a callback function defined in a vbscript or 
javascript in an html file. I tried to copy and paste the vbs into an 
html file but it seems  WScript.CreateObject does not work in html.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=4798468&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=4798468&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4798468" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4798468" data-ref="3_4798468" class="rating-label" name="RateItem_4798468"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4798468/I-need-to-find-a-way-to-call-the-vbscript-inside-a.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4798468"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="6723925" msgid="4798468"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4073919_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4073919xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4073919" parent="0" thread="4073919" href="https://www.codeproject.com/Messages/4073919/Event-Sink-in-DLL-not-Firing.aspx">Event Sink in DLL not Firing</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">rveach</span><span class="date">9-Nov-11  17:46</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=4818802">rveach</a></span></td><td class="date"><span>9-Nov-11  17:46&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4073919_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="4818802" msgid="4073919" votingtype="GoodOrBad" done="true"><a href="#xx4073919xx" onclick="return rateItem(5, 4073919,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',4818802);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4073919xx" onclick="return rateItem(1, 4073919,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',4818802);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hi, I am trying to make a DLL Wrapper for Java to 
support an application through a COM interface. I have gotten alot of it
 working, thanks some to your articles, but I am having problems with 
the Events not firing. Everything returns a good return code when I am 
advising it of my class.<br>
Now the same code works fine in a regular EXE, so there is something special that prevents it from working in a DLL.<br>
<br>
Do you have any ideas what the problem could be and how to fix it?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=4073919&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=4073919&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4073919" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4073919" data-ref="3_4073919" class="rating-label" name="RateItem_4073919"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4073919/Event-Sink-in-DLL-not-Firing.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4073919"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="4818802" msgid="4073919"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4080886_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx4080886xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4080886" parent="4073919" thread="4073919" href="https://www.codeproject.com/Messages/4080886/Re-Event-Sink-in-DLL-not-Firing.aspx">Re: Event Sink in DLL not Firing</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">rveach</span><span class="date">17-Nov-11  10:23</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=4818802">rveach</a></span></td><td class="date"><span>17-Nov-11  10:23&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4080886_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="4818802" msgid="4080886" votingtype="GoodOrBad" done="true"><a href="#xx4080886xx" onclick="return rateItem(5, 4080886,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',4818802);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4080886xx" onclick="return rateItem(1, 4080886,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',4818802);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4073919);" href="https://www.codeproject.com/Messages/4073919/Event-Sink-in-DLL-not-Firing.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I figured out my problem.<br>
<br>
<b>The thread that created the sink object</b> needs to also pump the thread's message queue using the window's function <b>'GetMessage'</b>.<br>
<br>
This is why the windows executable was working correctly, it already 
have a message pump for the window that was created. I figured this out 
when I put a breakpoint in the sink object when the invoke was being 
called and looked at the stack trace. 'GetMessage' was the first thing 
on the trace that came from my code.<br>
<br>
In this instance, I believe why 'GetMessage' is the answer is because I 
believe the COM's code is calling 'PostThreadMessage' to notify me that a
 sink event has occurred and 'GetMessage' looks at these messages and 
somehow knows they are COM related and handle them on its own.<br>
<br>
<b>PS</b>: Notice I said <i>the thread</i> that created the sink. If you
 create the sink in one thread and have the message pump in another, you
 will receive the message from the COM about the sink, but it won't know
 how to handle it automatically since this thread has nothing loaded 
about the COM in its space. So the sink object's invoke is never called.<br>
<br>
So Java could access the same COM everywhere, I made the 2nd thread 
control everything about the COM, and any native methods that were 
called redirect the request to the that thread. So no matter what thread
 Java is running in, it will always have access to the same COM without 
having to reload everything.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=4080886&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=4080886&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4073919" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4080886" data-ref="3_4080886" class="rating-label" name="RateItem_4080886"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4080886/Re-Event-Sink-in-DLL-not-Firing.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4080886"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="4818802" msgid="4080886"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2731895_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx2731895xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2731895" parent="0" thread="2731895" href="https://www.codeproject.com/Messages/2731895/Got-Code-Could-not-connect-object-Error-80020009.aspx">Got Code: Could not connect object Error: 80020009</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Pacsoft</span><span class="date">19-Sep-08  19:02</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5320348">Pacsoft</a></span></td><td class="date"><span>19-Sep-08  19:02&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2731895_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="5320348" msgid="2731895" votingtype="GoodOrBad" done="true"><a href="#xx2731895xx" onclick="return rateItem(5, 2731895,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5320348);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2731895xx" onclick="return rateItem(1, 2731895,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5320348);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hi, Jeff,<br>
<br>
I used the code from Part 2 as an aid to write an EXE application that is driven by a a script and works perfectly.<br>
<br>
However, now that I have used code from Part 5 as an aid to write an EXE
 to source events to a VB Script, when I run the script I got the 
message "Could not connect to object". <br>
<br>
I have verified that the FindConnectionPoint is actually called and returns valid data, but Advise got never called.<br>
<br>
Any ideas ?<br>
<br>
Pacsoft<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=2731895&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=2731895&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2731895" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2731895" data-ref="3_2731895" class="rating-label" name="RateItem_2731895"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2731895/Got-Code-Could-not-connect-object-Error-80020009.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2731895"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5320348" msgid="2731895"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2641249_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx2641249xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2641249" parent="0" thread="2641249" href="https://www.codeproject.com/Messages/2641249/Where-is-the-IFeedback2s-Invoke-in-VBScript-exampl.aspx">Where is the "IFeedback2's Invoke" in VBScript example?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">yanxinxin1985</span><span class="date">17-Jul-08  6:13</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=4431965">yanxinxin1985</a></span></td><td class="date"><span>17-Jul-08  6:13&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2641249_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="4431965" msgid="2641249" votingtype="GoodOrBad" done="true"><a href="#xx2641249xx" onclick="return rateItem(5, 2641249,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',4431965);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2641249xx" onclick="return rateItem(1, 2641249,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',4431965);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">The series of articles are great! I've learned a lot from them, thanks!  <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/smiley_wink.gif" alt="Wink | ;)" align="top">  <br>
<br>
There is a problem I don't understand in this part, please give me a hand. In the C example, "<code>IFeedback2</code>'s <code>IDispatch</code> functions" are well defined, however, where is the "<code>IFeedback2</code>'s <code>IDispatch</code> function definition" in VBScript example?  How can it work fine without <code>Invoke </code>function?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=2641249&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=2641249&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2641249" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2641249" data-ref="3_2641249" class="rating-label" name="RateItem_2641249"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2641249/Where-is-the-IFeedback2s-Invoke-in-VBScript-exampl.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2641249"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="4431965" msgid="2641249"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2568489_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx2568489xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2568489" parent="0" thread="2568489" href="https://www.codeproject.com/Messages/2568489/are-these-used-to-create-events.aspx">are these used to create events</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">dbrower256</span><span class="date">25-May-08  1:37</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5179524">dbrower256</a></span></td><td class="date"><span>25-May-08  1:37&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2568489_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="5179524" msgid="2568489" votingtype="GoodOrBad" done="true"><a href="#xx2568489xx" onclick="return rateItem(5, 2568489,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5179524);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2568489xx" onclick="return rateItem(1, 2568489,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5179524);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Are the techniques and interfaces of part 5 the way that events work in Visual Basic?<br>
<br>
Daniel<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=2568489&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=2568489&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2568489" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2568489" data-ref="3_2568489" class="rating-label" name="RateItem_2568489"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2568489/are-these-used-to-create-events.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2568489"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5179524" msgid="2568489"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1885965_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx1885965xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1885965" parent="0" thread="1885965" href="https://www.codeproject.com/Messages/1885965/Can-a-COM-server-dll-be-implemented-as-a-regular-d.aspx">Can a COM server dll be implemented as a regular dll?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">ehaerim</span><span class="date">9-Feb-07  7:09</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=658032">ehaerim</a></span></td><td class="date"><span>9-Feb-07  7:09&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1885965_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="658032" msgid="1885965" votingtype="GoodOrBad" done="true"><a href="#xx1885965xx" onclick="return rateItem(5, 1885965,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',658032);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1885965xx" onclick="return rateItem(1, 1885965,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',658032);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Jeff, thanks for your good article.  I've printed all your 8 articles for COM in plain C.<br>
<br>
Maybe after reading all of them, I may be able to do what I want, but at this moment everything is foggy, so please help me.<br>
<br>
I have a scenario like this:<br>
 <br>
An application(App_A) allows me to extend its functionality by writing a
 regular DLL only.  I would like to make it work as a COM DLL server 
with an event source interface.<br>
 <br>
For example, let's name the regular DLL as MyDLL.dll and it will have the following exported functions:<br>
1) Initialize(void* pInit);<br>
2) SendInfo(void* pInfo);<br>
 <br>
Now, App_A loads MyDLL.dll and calls 'Initialize' and 'SendInfo' in sequence.<br>
And within 'SendInfo' I would like to fire an event for another application(App_B).  Then App_B will handle the event.  <br>
 <br>
In summary, MyDLL.dll <br>
1) Must be <b>regular</b> DLL. =&gt; This limitation is tough for me.<br>
2) Should work as a COM DLL server with an event source interface and 
fire an event for external event sink within App_B so that App_B could 
receive that event fired from MyDLL.dll.<br>
 <br>
Do you think this is possible?  Maybe it is necessary to use pure C, not C++.  Of course, C++ would be preferrable if possible.<br>
 <br>
I need your help please.  A sample would be most appreciated.<br>
 <br>
HaeRim<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1885965&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1885965&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1885965" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1885965" data-ref="3_1885965" class="rating-label" name="RateItem_1885965"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1885965/Can-a-COM-server-dll-be-implemented-as-a-regular-d.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1885965"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="658032" msgid="1885965"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1889088_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx1889088xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1889088" parent="1885965" thread="1885965" href="https://www.codeproject.com/Messages/1889088/Re-Can-a-COM-server-dll-be-implemented-as-a-regula.aspx">Re: Can a COM server dll be implemented as a regular dll?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">11-Feb-07  23:10</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>11-Feb-07  23:10&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1889088_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="1889088" votingtype="GoodOrBad" done="true"><a href="#xx1889088xx" onclick="return rateItem(5, 1889088,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1889088xx" onclick="return rateItem(1, 1889088,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1885965);" href="https://www.codeproject.com/Messages/1885965/Can-a-COM-server-dll-be-implemented-as-a-regular-d.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I'm totally confused why you have to deal with event sinks/sources at all.<br>
<br>
Why do you have to deal with event sinks? Do you not have the source to 
App_B, and it requires event sourcing in order to be able to communicate
 with it?<br>
<br>
Hopefully, App_B has either a COM interface that doesn't involve the 
very ugly event sink stuff, or has some other C-assessible method for 
invoking it and passing it arguments.<br>
<br>
If the former, then your DLL merely has to call CreateInstance to get 
one of App_B's "application objects" (once you find out what it's GUID 
is). Then you can call its functions directly within your DLL.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1889088&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1889088&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1885965" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1889088" data-ref="3_1889088" class="rating-label" name="RateItem_1889088"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1889088/Re-Can-a-COM-server-dll-be-implemented-as-a-regula.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1889088"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1889088"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1809796_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx1809796xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1809796" parent="0" thread="1809796" href="https://www.codeproject.com/Messages/1809796/Does-COM-need-to-be-Rebased.aspx">Does COM need to be Rebased?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Hunt Chang</span><span class="date">18-Dec-06  22:23</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1474499">Hunt Chang</a></span></td><td class="date"><span>18-Dec-06  22:23&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1809796_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="1474499" msgid="1809796" votingtype="GoodOrBad" done="true"><a href="#xx1809796xx" onclick="return rateItem(5, 1809796,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1474499);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1809796xx" onclick="return rateItem(1, 1809796,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1474499);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hi,<br>
<br>
First off, Thanks to Mr. Glatt. I have learned a lot from this series of articles about COM. <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/rose.gif" alt="Rose | [Rose]" align="top"> <br>
<br>
A question about COM need some help.<br>
<br>
Since COM is intrinsic a DLL; and we know sometimes we have to rebase 
the DLL to match certain program needs, then should we do the same thing
 to COM?<br>
<br>
About COM, what I have learned is the client program call for COM 
service thru its vtable. It seems this kind of calling structure should 
not need the help of rebase. But frankly I can not make it sure in its 
concept by myself. <br>
<br>
Thanks in advance for anyone's tip and share,<br>
<br>
Hunt  <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/smiley_squeamish.gif" alt="Unsure | :~" align="top"><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1809796&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1809796&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1809796" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1809796" data-ref="3_1809796" class="rating-label" name="RateItem_1809796"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1809796/Does-COM-need-to-be-Rebased.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1809796"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="1474499" msgid="1809796"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1810810_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx1810810xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1810810" parent="1809796" thread="1809796" href="https://www.codeproject.com/Messages/1810810/Re-Does-COM-need-to-be-Rebased.aspx">Re: Does COM need to be Rebased?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">19-Dec-06  11:02</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>19-Dec-06  11:02&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1810810_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="1810810" votingtype="GoodOrBad" done="true"><a href="#xx1810810xx" onclick="return rateItem(5, 1810810,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1810810xx" onclick="return rateItem(1, 1810810,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1809796);" href="https://www.codeproject.com/Messages/1809796/Does-COM-need-to-be-Rebased.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>A DLL doesn't need to be rebased, and I definitely wouldn't do that with a DLL which may be loaded by numerous processes.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1810810&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1810810&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1809796" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1810810" data-ref="3_1810810" class="rating-label" name="RateItem_1810810"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1810810/Re-Does-COM-need-to-be-Rebased.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1810810"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1810810"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1810944_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx1810944xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1810944" parent="1810810" thread="1809796" href="https://www.codeproject.com/Messages/1810944/Re-Does-COM-need-to-be-Rebased.aspx">Re: Does COM need to be Rebased?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Hunt Chang</span><span class="date">19-Dec-06  12:06</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1474499">Hunt Chang</a></span></td><td class="date"><span>19-Dec-06  12:06&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1810944_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="1474499" msgid="1810944" votingtype="GoodOrBad" done="true"><a href="#xx1810944xx" onclick="return rateItem(5, 1810944,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1474499);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1810944xx" onclick="return rateItem(1, 1810944,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1474499);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1810810);" href="https://www.codeproject.com/Messages/1810810/Re-Does-COM-need-to-be-Rebased.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Mr. Glatt,<br>
<br>
Thanks a lot for your fast response. <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/rose.gif" alt="Rose | [Rose]" align="top"> <br>
<br>
But I am a little bit confused, do you mean the "COM" does not need to be rebased or all the general "DLLs"?<br>
<br>
I can understand if we rebase a DLL used by lots of process may mess up 
the thing even more, but I can not understand the meaning of "A DLL 
doesn't need to be rebased".  Why is that?<br>
<br>
You know this is a very different guide and opinion. I am not a mature 
programmer of C or C++, my question is just because there are too many 
articles say so, "some time we have to rebase the DLL to fit it into 
certain virtual memory", and even MS offers a tool of "rebase", then 
why?<br>
<br>
Hunt<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1810944&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1810944&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1809796" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1810944" data-ref="3_1810944" class="rating-label" name="RateItem_1810944"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1810944/Re-Does-COM-need-to-be-Rebased.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1810944"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="1474499" msgid="1810944"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1811318_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="74px"><a name="xx1811318xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1811318" parent="1810944" thread="1809796" href="https://www.codeproject.com/Messages/1811318/Re-Does-COM-need-to-be-Rebased.aspx">Re: Does COM need to be Rebased?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">19-Dec-06  17:02</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>19-Dec-06  17:02&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1811318_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:74px;"><span class="voteform vertical" ownerid="88625" msgid="1811318" votingtype="GoodOrBad" done="true"><a href="#xx1811318xx" onclick="return rateItem(5, 1811318,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1811318xx" onclick="return rateItem(1, 1811318,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1810944);" href="https://www.codeproject.com/Messages/1810944/Re-Does-COM-need-to-be-Rebased.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Do
 not rebase your COM DLLs. You don't need to do that for _any_ DLLs. If 
another article tells you that is _required_, then that article is 
incorrect. Rebasing a DLL may be fine if you're sure it's going to be 
loaded in a process that doesn't load any other DLL rebased to the same 
address. But you can't be sure of that with a COM component (unless you 
plan to use it only with software you yourself write). Don't do it, or 
you're asking for trouble.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1811318&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1811318&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1809796" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1811318" data-ref="3_1811318" class="rating-label" name="RateItem_1811318"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1811318/Re-Does-COM-need-to-be-Rebased.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1811318"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1811318"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1811528_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="92px"><a name="xx1811528xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1811528" parent="1811318" thread="1809796" href="https://www.codeproject.com/Messages/1811528/Re-Does-COM-need-to-be-Rebased.aspx">Re: Does COM need to be Rebased?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Hunt Chang</span><span class="date">19-Dec-06  22:01</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1474499">Hunt Chang</a></span></td><td class="date"><span>19-Dec-06  22:01&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1811528_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:92px;"><span class="voteform vertical" ownerid="1474499" msgid="1811528" votingtype="GoodOrBad" done="true"><a href="#xx1811528xx" onclick="return rateItem(5, 1811528,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1474499);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1811528xx" onclick="return rateItem(1, 1811528,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1474499);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1811318);" href="https://www.codeproject.com/Messages/1811318/Re-Does-COM-need-to-be-Rebased.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Mr. Glatt,<br>
<br>
Thanks very much, I got your point.<br>
<br>
Hunt <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/smiley_biggrin.gif" alt="Big Grin | :-D" align="top"><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1811528&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1811528&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1809796" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1811528" data-ref="3_1811528" class="rating-label" name="RateItem_1811528"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1811528/Re-Does-COM-need-to-be-Rebased.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1811528"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="1474499" msgid="1811528"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1552351_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx1552351xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1552351" parent="0" thread="1552351" href="https://www.codeproject.com/Messages/1552351/Exe-and-DCOM-error.aspx">Exe and DCOM error</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">czatcodeguru</span><span class="date">28-Jun-06  7:23</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3130730">czatcodeguru</a></span></td><td class="date"><span>28-Jun-06  7:23&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1552351_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="3130730" msgid="1552351" votingtype="GoodOrBad" done="true"><a href="#xx1552351xx" onclick="return rateItem(5, 1552351,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3130730);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1552351xx" onclick="return rateItem(1, 1552351,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3130730);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hey,<br>
<br>
thanks for this great tutorial.<br>
<br>
I have a wsc script and wrapper, which simple gives the script an own 
process. The wrapper is written in Labwindos from National Instruments. 
But I hate the NI IDE and I would like to replace it, with a simple c 
program. <br>
<br>
I start compiling the examples and the dll stuff is working without any 
problems. But I have some problems to compile the "exe". <br>
<br>
First, it looks like that there is a "#ifdef" missing:<br>
<div class="pre-action-link" id="premain831537" style="width:100%;display:block;"><span id="prehide831537" onclick="processCodeBlocks.togglePre(831537);">Hide</span>  &nbsp; <span id="preShrink831537" onclick="processCodeBlocks.shrinkExpand(831537);">Shrink</span> <img id="preimg831537" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(831537);">  &nbsp; <span id="copycode831537" onclick="return processCodeBlocks.copyCode(831537);">Copy Code</span></div><pre id="pre831537" style="margin-top: 0px;" class="notranslate">	OutstandingObjects = (DWORD)-1;
#else
	OutstandingObjects = 0;
#endif</pre><br>
I replace this and I tried it with both ways (-1 and 0).<br>
<br>
Now, when I start the script-client-example the server starts but then I
 get a DCOM timeout error in the event log and a activex object error 
from the script engine:<br>
<br>
(Sorry, the os is a german installation and I have to translate it - but my english is very bad.)<br>
<br>
Event Log:<br>
<br>
Event Number: 10010<br>
Source: DCOM<br>
The Server did not response in the given time interval.<br>
<br>
<br>
Script Engine:<br>
<br>
Runtime Error in Microsoft VBScrip: ActiveX-Component cannot create object: 'IExampleExe.object'<br>
<br>
<br>
<br>
Can you give me a hint, how to solve this?<br>
<br>
Thankx,<br>
<br>
CZ<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1552351&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1552351&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1552351" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1552351" data-ref="3_1552351" class="rating-label" name="RateItem_1552351"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1552351/Exe-and-DCOM-error.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1552351"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="3130730" msgid="1552351"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1552796_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx1552796xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1552796" parent="1552351" thread="1552351" href="https://www.codeproject.com/Messages/1552796/Re-Exe-and-DCOM-error.aspx">Re: Exe and DCOM error</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">28-Jun-06  11:58</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>28-Jun-06  11:58&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1552796_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="1552796" votingtype="GoodOrBad" done="true"><a href="#xx1552796xx" onclick="return rateItem(5, 1552796,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1552796xx" onclick="return rateItem(1, 1552796,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1552351);" href="https://www.codeproject.com/Messages/1552351/Exe-and-DCOM-error.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I
 think that a DCOM component needs to be started as a service, and 
probably needs some other things done. I haven't worked with DCOM.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1552796&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1552796&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1552351" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1552796" data-ref="3_1552796" class="rating-label" name="RateItem_1552796"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1552796/Re-Exe-and-DCOM-error.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1552796"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1552796"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1553973_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx1553973xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1553973" parent="1552796" thread="1552351" href="https://www.codeproject.com/Messages/1553973/Re-Exe-and-DCOM-error.aspx">Re: Exe and DCOM error</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">czatcodeguru</span><span class="date">29-Jun-06  6:11</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3130730">czatcodeguru</a></span></td><td class="date"><span>29-Jun-06  6:11&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1553973_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="3130730" msgid="1553973" votingtype="GoodOrBad" done="true"><a href="#xx1553973xx" onclick="return rateItem(5, 1553973,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3130730);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1553973xx" onclick="return rateItem(1, 1553973,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3130730);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1552796);" href="https://www.codeproject.com/Messages/1552796/Re-Exe-and-DCOM-error.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Hey Jeff,<br>
<br>
thanks for your answer. AFAIK DCOM is just the extension of COM managed 
by the os. But I am not a expert. I just found this information in the 
jungle of my Visual C++ 6.0 help files:<br>
<br>
<div class="pre-action-link" id="premain126850" style="width:100%;display:block;"><span id="prehide126850" onclick="processCodeBlocks.togglePre(126850);">Hide</span>  &nbsp; <span id="preShrink126850" onclick="processCodeBlocks.shrinkExpand(126850);">Shrink</span> <img id="preimg126850" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(126850);">  &nbsp; <span id="copycode126850" onclick="return processCodeBlocks.copyCode(126850);">Copy Code</span></div><pre id="pre126850" style="margin-top: 0px;" class="notranslate">Article ID: Q158582  
The information in this article applies to: 
Microsoft COM/DCOM libraries included with: Microsoft Windows NT 4.0 Microsoft Windows 95 with DCOM support 


SUMMARY
COM server and client applications that were written before the introduction of DCOM can be configured to use DCOM by making appropriate changes to the server application's registry entries. The server and client applications do not need to be rewritten. This procedure can be applied to any COM server and client, including those created using MFC or Visual Basic. </pre><br>
<br>
Can you help me to get your Example exe server running? I don't know which client example application to use.<br>
<br>
Thanks for your work,<br>
<br>
CZ<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1553973&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1553973&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1552351" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1553973" data-ref="3_1553973" class="rating-label" name="RateItem_1553973"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1553973/Re-Exe-and-DCOM-error.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1553973"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="3130730" msgid="1553973"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1534200_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx1534200xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1534200" parent="0" thread="1534200" href="https://www.codeproject.com/Messages/1534200/Differences-between-an-OCX-and-a-DLL.aspx">Differences between an OCX and a DLL</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jahanshahi</span><span class="date">15-Jun-06  13:10</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2896030">Jahanshahi</a></span></td><td class="date"><span>15-Jun-06  13:10&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1534200_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="2896030" msgid="1534200" votingtype="GoodOrBad" done="true"><a href="#xx1534200xx" onclick="return rateItem(5, 1534200,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',2896030);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1534200xx" onclick="return rateItem(1, 1534200,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',2896030);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Dear Jeff,<br>
<br>
  I eagarly follow your series in COM development in plain C. I should confess that it is more than interesting for me.<br>
<br>
I've always doubted if the underlying file format of a DLL and an OCX 
are the same. For example if we bury an automation server into a DLL and
 add a type library resource for it we can simply change the type from a
 .DLL to an .OCX and use it without problem. Can this be true?<br>
<br>
Mohsen <br>
<br>
Mohsen Jahanshahi<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1534200&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1534200&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1534200" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1534200" data-ref="3_1534200" class="rating-label" name="RateItem_1534200"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1534200/Differences-between-an-OCX-and-a-DLL.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1534200"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="2896030" msgid="1534200"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1534802_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx1534802xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1534802" parent="1534200" thread="1534200" href="https://www.codeproject.com/Messages/1534802/Re-Differences-between-an-OCX-and-a-DLL.aspx">Re: Differences between an OCX and a DLL</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">15-Jun-06  21:03</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>15-Jun-06  21:03&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1534802_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="1534802" votingtype="GoodOrBad" done="true"><a href="#xx1534802xx" onclick="return rateItem(5, 1534802,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1534802xx" onclick="return rateItem(1, 1534802,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1534200);" href="https://www.codeproject.com/Messages/1534200/Differences-between-an-OCX-and-a-DLL.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I
 haven't worked with OCX files, but I do know that they are ActiveX 
"controls". As such, I would assume that they must implement certain, 
defined COM objects such as IOleObject, IOleControl, IViewObject, etc. I
 do not know if they need to be registered via any particular registry 
keys, or not.<br>
<br>
This is not something I'm planning on covering in this series, so you'll have to seek out other sources of information.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1534802&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1534802&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1534200" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1534802" data-ref="3_1534802" class="rating-label" name="RateItem_1534802"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1534802/Re-Differences-between-an-OCX-and-a-DLL.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1534802"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1534802"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1516880_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx1516880xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1516880" parent="0" thread="1516880" href="https://www.codeproject.com/Messages/1516880/COM-development.aspx">COM development.</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">kravnus1</span><span class="date">5-Jun-06  4:32</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1829210">kravnus1</a></span></td><td class="date"><span>5-Jun-06  4:32&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1516880_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="1829210" msgid="1516880" votingtype="GoodOrBad" done="true"><a href="#xx1516880xx" onclick="return rateItem(5, 1516880,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1829210);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1516880xx" onclick="return rateItem(1, 1516880,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1829210);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hi Jeff,<br>
<br>
 I do notice that you are relying plenty on internal workings on the C 
compiler. For example expecting certain fields to be there at these 
offset. I started reading from the first part of this series. I must say
 well done. However I am not not that comfortable with using pointer 
arithmetic when moving between sub type. I have read that portion and 
find it uncomfortable to use it. Yes it is correct but it relies too 
much on it's alignment of the fields. Anyway I don't see how one can 
overcome this limitation;I too depend on memory alignment since at times
 it is not easy with the VC compiler. <br>
<br>
 I believe the biggest grip is emulating CPP on C........ The headache and amount of typing one has to do. Argh!<br>
 <br>
 Anyway, good job in digging out on the internal on C++ and the COM technology!<br>
<br>
John<br><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1516880&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1516880&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1516880" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1516880" data-ref="3_1516880" class="rating-label" name="RateItem_1516880"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1516880/COM-development.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1516880"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="1829210" msgid="1516880"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1527741_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx1527741xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1527741" parent="1516880" thread="1516880" href="https://www.codeproject.com/Messages/1527741/Re-COM-development.aspx">Re: COM development.</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">12-Jun-06  13:05</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>12-Jun-06  13:05&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1527741_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="1527741" votingtype="GoodOrBad" done="true"><a href="#xx1527741xx" onclick="return rateItem(5, 1527741,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1527741xx" onclick="return rateItem(1, 1527741,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1516880);" href="https://www.codeproject.com/Messages/1516880/COM-development.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I
 use the offsetof() macro to access private data fields of my COM 
objects. By "private", I mean that nobody accesses them except for the 
functions of my own COM object. Unless your C compiler's offsetof() 
macro is severely broken, it will always calculate the correct offset, 
regardless of "memory alignment of fields". So the pointer arithmetic 
will always work. This is a non-issue.<br>
<br>
Actually, I don't think that it's all that difficult to do COM in C, 
versus C++. And in fact, in translating various C++ COM examples to C, 
I've uncovered lots and lots of bugs, lack of proper error checking, and
 other questionable practices. The big gripe I have with C++ code is 
that, doing proper error checking makes it every bit as much a 
"headache" and involves an "amount of typing", such that few C++ 
programmers do it. For example, they think nothing of declaring some 
object as a data member of another object, and then fail to consider the
 ramifications of there being a problem creating that sub-object. Even 
if the code has the bare-minimum error checking needed to avoid 
crashing, there typically are memory leaks from some things being 
"allocated" but never "released".<br>
If you look at MS example C++ COM code, you'll be horrified about the 
lack of error checking. (They even do an explicit new without checking 
whether it failed). And it appears that lots and lots of programmers 
just use variations on this code without fixing these things. Why? 
Because programmers are misled that using C++ is so "easy" and "simple",
 and that the compiler does all of the messy low level details for you, 
including error checking. No, that's not the case if you want to write 
code that behaves in a responsible manner. Really, the main advantage of
 C++ is reusability, not ease of use. And if you organize your C COM 
objects into separate source files, follow a logical naming convention 
for global functions, and make judicious use of the static keyword (for 
example like how I did in the multiple interface COM example), then the C
 code is equally reusuable, and frankly, I think it's a lot more 
readable/understandable.<br>
<br>
The benefits of C++ are vastly overrated, and often misrepresented.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1527741&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1527741&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1516880" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1527741" data-ref="3_1527741" class="rating-label" name="RateItem_1527741"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1527741/Re-COM-development.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1527741"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1527741"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1529851_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx1529851xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1529851" parent="1527741" thread="1516880" href="https://www.codeproject.com/Messages/1529851/Re-COM-development-modified.aspx">Re: COM development. [modified]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">kravnus1</span><span class="date">13-Jun-06  13:02</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1829210">kravnus1</a></span></td><td class="date"><span>13-Jun-06  13:02&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1529851_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="1829210" msgid="1529851" votingtype="GoodOrBad" done="true"><a href="#xx1529851xx" onclick="return rateItem(5, 1529851,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1829210);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1529851xx" onclick="return rateItem(1, 1529851,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1829210);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1527741);" href="https://www.codeproject.com/Messages/1527741/Re-COM-development.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I
 believe we all suffer from the lack of documentation for C++ COM or 
matter a fact COM itself. You are right that the samples are not bullet 
proof but who is <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/smiley_smile.gif" alt="Smile | :)" align="top">
  You are right that C++ CAN lead to mysterious bugs but I have seen C 
that equally provides bad code. Any language can but it is the 
programmer's duty to check them. C++ simple? HA! I have been bitten by 
using ppl's code badly. <br>
<br>
I have double checked on the offset on the MSVC++ v6.0 compiler and the 
problem of inconsistent holes does not exist. But I do not have the 
certainty nor should it be a habit to expect every compiler to have the 
same member alignment. Fortunately most default settings are MSVC++ 
compliant. But if it is non standard then ............ <br>
<br>
the following is what can go wrong. <br>
<br>
#include &lt; stddef.h &gt; //problem on page????? showing output, so leaving spaces<br>
#include &lt; stdio.h &gt;<br>
<br>
<br>
<br>
struct nonAlignMem{<br>
	int i;<br>
	int b;<br>
	char c;<br>
	char d;<br>
	int e;<br>
}tmpMem0;<br>
<br>
<br>
#pragma pack(2)<br>
<br>
struct alignMem{<br>
	int i;<br>
	int b;<br>
	char c;<br>
	char d;<br>
	int e;<br>
}tmpMem1;<br>
<br>
<br>
<br>
int main(int argc,char **argv)<br>
{<br>
<br>
	<br>
	printf("sizeof %d \n",sizeof(tmpMem0));<br>
	printf("offset of c %d \n",offsetof(struct nonAlignMem,c) );<br>
	printf("offset of d %d \n",offsetof(struct nonAlignMem,d) );<br>
	printf("offset of e %d \n",offsetof(struct nonAlignMem,e) );<br>
<br>
	<br>
	<br>
	printf("sizeof %d \n",sizeof(tmpMem1));<br>
	printf("offset of c %d \n",offsetof(struct alignMem,c) );<br>
	printf("offset of d %d \n",offsetof(struct alignMem,d) );<br>
	printf("offset of e %d \n",offsetof(struct alignMem,e) );<br>
<br>
<br>
	return 0;<br>
<br>
<br>
<br>
}<br>
<br>
<br>
check the output for the offset for e. Your program can use pragma to eliminate the possibility of this happening.<br>
<br>
BTW, I use C++ but like C more thanks to it's simplicity. Heck Unix was written in C!<br>
<br>
John<br>
<br>
PS: I am tempted in using your code in production.<br>
<br>
<br>
 -- modified at 12:04 Tuesday 13th June, 2006<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1529851&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1529851&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1516880" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1529851" data-ref="3_1529851" class="rating-label" name="RateItem_1529851"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1529851/Re-COM-development-modified.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1529851"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="1829210" msgid="1529851"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1530161_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="74px"><a name="xx1530161xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1530161" parent="1529851" thread="1516880" href="https://www.codeproject.com/Messages/1530161/Re-COM-development.aspx">Re: COM development.</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">13-Jun-06  16:30</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>13-Jun-06  16:30&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1530161_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:74px;"><span class="voteform vertical" ownerid="88625" msgid="1530161" votingtype="GoodOrBad" done="true"><a href="#xx1530161xx" onclick="return rateItem(5, 1530161,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1530161xx" onclick="return rateItem(1, 1530161,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1529851);" href="https://www.codeproject.com/Messages/1529851/Re-COM-development-modified.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>It
 doesn't matter. You're presumably going to use one compiler to compile 
all of the source files to make the DLL. (It won't make sense 
otherwise). So the offsetof() macro will work the same wherever it is 
used in those sources.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1530161&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1530161&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1516880" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1530161" data-ref="3_1530161" class="rating-label" name="RateItem_1530161"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1530161/Re-COM-development.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1530161"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1530161"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1530482_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="92px"><a name="xx1530482xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1530482" parent="1530161" thread="1516880" href="https://www.codeproject.com/Messages/1530482/Re-COM-development.aspx">Re: COM development.</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">kravnus1</span><span class="date">13-Jun-06  22:47</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1829210">kravnus1</a></span></td><td class="date"><span>13-Jun-06  22:47&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1530482_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:92px;"><span class="voteform vertical" ownerid="1829210" msgid="1530482" votingtype="GoodOrBad" done="true"><a href="#xx1530482xx" onclick="return rateItem(5, 1530482,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1829210);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1530482xx" onclick="return rateItem(1, 1530482,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1829210);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1530161);" href="https://www.codeproject.com/Messages/1530161/Re-COM-development.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>do you have any other contribution articles beside COM? Would like to read them.<br>
<br>
John<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1530482&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1530482&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1516880" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1530482" data-ref="3_1530482" class="rating-label" name="RateItem_1530482"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1530482/Re-COM-development.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1530482"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="1829210" msgid="1530482"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1530542_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="110px"><a name="xx1530542xx"></a><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1530542" parent="1530482" thread="1516880" href="https://www.codeproject.com/Messages/1530542/Re-COM-development-modified.aspx">Re: COM development. [modified]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">14-Jun-06  0:58</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>14-Jun-06  0:58&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1530542_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:110px;"><span class="voteform vertical" ownerid="88625" msgid="1530542" votingtype="GoodOrBad" done="true"><a href="#xx1530542xx" onclick="return rateItem(5, 1530542,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1530542xx" onclick="return rateItem(1, 1530542,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1530482);" href="https://www.codeproject.com/Messages/1530482/Re-COM-development.aspx"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Toward
 the top of this page, you'll see my name under the article's title. 
This is a clickable link. Click on my name, and it will present a page 
listing all of my Code Project articles. (You can can click on some 
author's name of any Code Project article to see the other articles he 
has written. This is a standard Code Project navigation feature).<br>
<br>
Note that I rewrote the IE article since it duplicated a lot of the info
 in this COM series, and the code base was updated quite a bit since the
 article was originally written. <br>
<br>
<div class="ForumMod">modified on Wednesday, August 6, 2008 11:52 PM</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1530542&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=308357&amp;select=1530542&amp;floc=/Articles/14183/COM-in-plain-C-Part-5&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1516880" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1530542" data-ref="3_1530542" class="rating-label" name="RateItem_1530542"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1530542/Re-COM-development-modified.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1530542"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1530542"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellspacing="0" cellpadding="2px">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 14-Jan-20  11:58 &nbsp; &nbsp; Last Update: 14-Jan-20  12:16</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/14183/COM-in-plain-C-Part-5?fid=308357&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=25"><span class="nav-link selected">1</span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_general.gif" alt="General" width="16px" height="16px" align="top"> General &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_news.gif" alt="News" width="16px" height="16px" align="top"> News &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_idea.gif" alt="Suggestion" width="16px" height="16px" align="top"> Suggestion &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_question.gif" alt="Question" width="16px" height="16px" align="top"> Question &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_bug.gif" alt="Bug" width="16px" height="16px" align="top"> Bug &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_answer.gif" alt="Answer" width="16px" height="16px" align="top"> Answer &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_joke.gif" alt="Joke" width="16px" height="16px" align="top"> Joke &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_kudos.gif" alt="Praise" width="16px" height="16px" align="top"> Praise &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_rant.gif" alt="Rant" width="16px" height="16px" align="top"> Rant &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/msg_admin.gif" alt="Admin" width="16px" height="16px" align="top"> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner">
                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div class="browse-code"><a href="https://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=14183">Browse Code</a></div>
<div><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=14183">View Stats</a></div>
<div><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=14183">Revisions</a></div>
<div><a href="#_comments">Comments (24)</a></div>
<div>Posted 22 May 2006</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Cplusplus" data-id="78">C++</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Visual-Studio" data-id="103">Visual-Studio</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/COM" data-id="130">COM</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>102.9K views</div><div>2K downloads</div><div>99 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

                <div id="RHSticky" class="container-article-info-sticky">
        		    

<div class="article-summary">

    
    

</div>

				    <div id="ctl00_SectionSponsor" class="padded-top" style="width:160px;margin:10px auto">
					    <div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/Beginners" data-country="US" data-showindicator="true" data-tags="C++, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=160x200&c=528284"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=160x200&c=528284"  width="160px" height="200px" target="_blank"/></a></noscript></div>
				    </div>

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/Beginners" data-country="US" data-tags="C++, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=160x600&c=528284"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=160x600&c=528284"  width="160px" height="600px" target="_blank"/></a></noscript></div>
				    </div>

                    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="theme1-background" style="height:2px;margin:5px 0" id="stickyStop"></div>

		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/14183/COM-in-plain-C-Part-5?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2006 by Jeff Glatt<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2020 <br>
                <br>
				Web03 
				2.8.200113.1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="COM%20in%20plain%20C,%20Part%205%20-%20CodeProject_files/DFPAudiencePixel.gif" style="border-width:0px;height:1px;width:1px;">



<script type="text/javascript"> // IMMEDIATE script

var readLaterList

var notificationAlert

var followService_ctl00_ActionLinks_ArticleFollow;

var bookmark_medium_true_false_ = null;

function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(null, 14183,2,1,true,true,0,'LargeStars', null, 88625);
}

function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                        if (!$('#' + containerId).attr('alreadyRequested')){
                            $.ajax({
                                url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId+'&wd=130',
                            })
                            .done(function (data) {
                                $('#' + containerId).html(data);
                                $('#' + loadingId).hide();
                            });

                            $('#' + containerId).attr('alreadyRequested', 'true');
                        }
                    }

document.addEventListener('DOMContentLoaded', function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});
function ChkRtctl00_RateArticle(val) {
}

var followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 308357,
};
var subscriptions_ctl00_MessageBoard;
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	processCodeBlocks.Initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	$('#RHSticky').sticky($('#stickyStop'));
	$('#ctl00_StickyBlock').sticky($('#stickyStop'));
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	readLaterList = new ReadLaterList('ReadLaterListIcon', 'ItemsToRead','/script/Bookmarks/WebServices/BookmarkService.aspx','https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=small',true);
	readLaterList.initialise();
	
	notificationAlert = new NotificationAlert('ctl00_MemberBar_Messages_NotificationCount','Notifications','/script/Membership/Ajax/NotificationList.aspx');
	notificationAlert.initialise();
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar && sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc && !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	followService_ctl00_ActionLinks_ArticleFollow = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_ActionLinks_ArticleFollow.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 2,
	        objectId       : 14183
	    },
	    followButtonId   : 'ctl00_ActionLinks_ArticleFollow_FollowBtn',
	    unfollowButtonId : 'ctl00_ActionLinks_ArticleFollow_UnfollowBtn'
	}, false);
	
	bookmark_medium_true_false_ = new Bookmark('[data-type="bookmark"]','https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=medium',false,true);
	bookmark_medium_true_false_.Initialise();
	
	$('#clear-rate_ctl00_RateArticle_RCD').click(function () {    $('#ctl00_RateArticle_RCD').hide(); return false;});
	
	new starRating('#ctl00_RateArticle_RateItemWrapper', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
	  $('#ctl00_RateArticle_VR').mouseenter(function() {     getVotesHistogram(14183,2   ,'ctl00_RateArticle_HistogramR','ctl00_RateArticle_LoadingR');
	  });
	
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 1,
	        objectId       : 88625
	    },
	    followButtonId   : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn',
	    unfollowButtonId : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn'
	}, false);
	
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : true,
	    allowReporting      : false,
	    allowRating         : true,
	    allowRatingDisplay  : true,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://codeproject.freetls.fastly.net',
	    switchMsgCallback   : null,
	    getVoteFormMethod   : getVoteFormHtml,
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    getRatingUrl        : '/script/Ratings/Ajax/GetRatings.aspx',
	    getRatingRefKey     : 'obrs',
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl(forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	var followService = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	var followAttributeIds = [];
	followService.initAttributeUI(undefined, followAttributeIds);

})
</script>










<style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div></body></html>