<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>COM in plain C, Part 7 - CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/Main.css">

    <script type="text/javascript" async="" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/analytics.js"></script><script type="text/javascript" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/jquery.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/article.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/MemberProfilePopup.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/a.js" defer="defer"></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="An ActiveX Script Host with custom COM objects. This allows a script to call C functions in your app.">
<meta name="Keywords" content="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Intermediate,COM / COM+,Platforms, Frameworks &amp; Libraries,Free source code, tutorials">
<meta name="Author" content="Jeff Glatt">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7">
<meta name="twitter: card" content="summary">
<meta name="twitter: site" content="@CodeProject">
<meta property="og:url" content="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7">
<meta property="og:title" content="COM in plain C, Part 7">
<meta property="og:description" content="An ActiveX Script Host with custom COM objects. This allows a script to call C functions in your app.">

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Artificial Intelligence" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=31">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7"
   },
  "headline": "COM in plain C, Part 7",
  "url": "https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7",
  "discussionUrl": "https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7#_comments",
  "isFamilyFriendly": "true",
  "image": "https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "VC6,C++,C,Windows,Visual-Studio,Dev,COM,Intermediate",
  "commentCount": "14",
  "editor" : {
    "@type" : "Person",
    "name" : "Smitha Nishant",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=28970"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "An ActiveX Script Host with custom COM objects. This allows a script to call C functions in your app.",
  "articleSection": "COM / COM+",
  "author" : [{
      "@type" : "Person",
      "name" : "Jeff Glatt",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=88625"
    }],
  "datePublished": "2006-08-03",
  "dateCreated": "2006-08-03",
  "dateModified": "2006-08-08"
,
  "aggregateRating" : {
    "@type" : "aggregateRating",
    "ratingValue" : 5.00,
    "ratingCount" : 15,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/8/Platforms-Frameworks-Libraries.aspx",
      "name" : "Platforms, Frameworks & Libraries"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/COM/",
      "name" : "COM / COM+"
    }
  }]
}</script>


	<!-- base href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7" -->
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





<!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" type="text/javascript" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': '55e1d411-e955-4cb4-9978-1528f21616a2'});
    </script>


<style type="text/css"></style></head>	

<body class="firefox firefox72">

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">14,417,643 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		<span id="ctl00_MemberBar_ReadLaterList_ReadLaterListDiv" class="tooltip member-message">
	<span id="ReadLaterListIcon" class="readlaterlist-count openable hidden"></span>
	<div class="tooltip-flyout readlaterlist-dropdown">
		<div id="ItemsToRead" class="readlaterlist-list"></div>
	</div>
</span><span id="ctl00_MemberBar_Messages_NotificationDiv" class="tooltip member-message">
	<a id="ctl00_MemberBar_Messages_NotificationCount" title="1 message" class="notification-count openable" href="https://www.codeproject.com/script/Membership/MyNotifications.aspx">1</a>

	<div class="tooltip-flyout notification-dropdown">
		

		<div id="ctl00_MemberBar_Messages_Confirm" class="bold spaced">
            <img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/caution.png" style="width:20px;height:20px;vertical-align:bottom">
            <a id="ctl00_MemberBar_Messages_EmailConfirm" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f15037%2fCOM-in-plain-C-Part-7">Click here to confirm your email address. </a>
		</div>

		
		
		<div id="Notifications" class="notification-list">
			<img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/loading24.gif" alt="loading" style="margin:auto;">
		</div>
		<div class="spaced">
			
		</div>
	</div>
</span><span id="ctl00_MemberBar_TotalPoints" title="Total reputation points"><a class="bold member-rep-box silver" title="Reputation points earned: 834" href="https://www.codeproject.com/script/Reputation/List.aspx?mid=527156">834</a></span><span id="ctl00_MemberBar_CurRat" class="member-links tooltip openable">
				<a id="ctl00_MemberBar_MyProfile" class="me desktop-only tablet-only" dir="ltr" href="https://www.codeproject.com/Members/jon57">jon57</a>
                <a id="ctl00_MemberBar_MyProfileMob" class="me mobile-only" href="https://www.codeproject.com/Members/jon57">☰</a>
                <div class="tooltip-flyout">
					
					<div class="list-item"><a id="ctl00_MemberBar_MySettingsDefault" href="https://www.codeproject.com/script/Membership/Modify.aspx">My Settings</a></div>
					
					<div class="list-item"><a id="ctl00_MemberBar_MyBookmarks" href="https://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2">My Bookmarks</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyArticles" href="https://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=527156">My Articles</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyMessages" href="https://www.codeproject.com/script/Forums/Messages.aspx?fmid=527156">My Messages</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyQuestions" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=questions&amp;mid=527156&amp;showall=True">My Questions</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyAnswers" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=answers&amp;mid=527156&amp;showall=True">My Answers</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyComments" href="https://www.codeproject.com/script/comments/MemberComments.aspx?mid=527156">My Comments</a></div>
					
					
					<div id="ctl00_MemberBar_MyFollowingHolder">
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowing" href="https://www.codeproject.com/script/follow/Edit.aspx">Things I Follow</a></div>
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowers" href="https://www.codeproject.com/script/follow/Followers.aspx">My Followers</a></div>
					</div>
					
        
					<form name="unsubForm" id="unsubForm" action="/script/Membership/LogOff.aspx?rp=%2fArticles%2f15037%2fCOM-in-plain-C-Part-7" method="post" class="tight">
                    <input type="hidden" name="AntiForgeryToken" value="e82756ee-ccd1-43de-910d-7f5dd2636494">
                    <input type="submit" value="Sign out" class="list-item border-none extended align-left" onclick="return doSignout();" style="background-color: transparent; color: #999; cursor:pointer">
                    
                    </form>

                    <script type="text/javascript">//<!--
			        function doSignout()
			        {
    			        document.unsubForm.action = "/script/Membership/LogOff.aspx?rp=%2fArticles%2f15037%2fCOM-in-plain-C-Part-7"
				        document.unsubForm.submit();
				        return true;
			        }//-->
			        </script>
                    
				</div>
			</span>

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/COM" data-country="US" data-tags="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Intermediate,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=728x90&c=445756"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=728x90&c=445756"  width="728px" height="90px" target="_blank"/></a></noscript></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table class="search" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><input tabindex="2" class="search subdue" id="sb_tb" autocomplete="off" value="Search for articles, questions, tips" name="q"></td><td><input type="image" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		
		
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/write13.png" width="13" height="13"> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="https://www.codeproject.com/script/Articles/ImportArticle.aspx">
			<img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/write13.png" width="13" height="13"> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/write13.png" width="13" height="13"> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">View VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">View ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=93" style="padding-left:30px">View SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues.aspx">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript.aspx">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools.aspx">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift.aspx">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database.aspx">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1942421/Linux-Programming.aspx">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android.aspx">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS.aspx">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1540733/SharePoint.aspx">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development.aspx">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch.aspx">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">stuff</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="https://www.codeproject.com/KB/showcase/">Product Showcase</a></li>
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Contests/Winners.aspx?obtid=1&amp;cmpTpId=2&amp;cid=0">Most Valuable Professionals</a></li>
		

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="https://www.codeproject.com/Forums/1939564/Where-I-am-Member-Photos.aspx">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>
		<li></li>
		

		
		<li class="openable"><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">Non-English Language
			<span class="has-submenu">&gt;</span></a>
		<ul>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		
		</ul>
		</li><li class="last"></li>
		
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> » <a href="https://www.codeproject.com/Chapters/8/Platforms-Frameworks-Libraries.aspx">Platforms, Frameworks &amp; Libraries</a> » <a href="https://www.codeproject.com/KB/COM/">COM / COM+</a> » <a href="https://www.codeproject.com/KB/COM/#COM">COM</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
                
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    <a id="ctl00_ActionLinks_ArticleFollow_FollowBtn" title="" class="button unfollowed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Have any updates for this Article appear in your Timeline so you can stay up to date" style="display: inline-block;">Follow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have any updates for this Article appear in your Timeline so you can stay up to date</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_ActionLinks_ArticleFollow_UnfollowBtn" title="" class="button followed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Stop following this Article" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Article</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

</div>



<span id="ctl00_ActionLinks_BookmarkMd_bookmark" data-type="bookmark" data-ref="2_15037_1" data-size="medium" data-mode="bookmark"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/bookmark48.png" style="width:24px;height:24px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span> 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?display=Print" class="tooltip" title="">
   <img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/print48.png" style="border:0" width="24px" height="24px">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="/Articles/15037/COM-in-plain-C-Part-7" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="nT3080Bd3uILAbMdAGVexuyPR2AydN5qz9C+hah+s6I84rIwyPwkR5I+XKmGjB8zXgpznxFQdtGiZCKf+dLdrhWIWjr8r9e+nbyafDKiJ17jQcG5WqDlB12Q0vX71lKde8R/Ab2jyygnIkzgtlMoUjSrW30JkWkr7kqeE4JJi3SU8ABdD8nkBNYviGt75Mw29g1A1yQXvgujXDKPL7cC1ZP7RbBBML2pQ564PYIBXnv8Itr8uGkOnCBoGrbPPKcqYeb5I+B9YGs15njjyfmmHas0SFSitPe34+57BP2mgW5brXNJ9Rh8VbwEkpO21HP8RDjqjP13CL57E65LeCXgp2wB2EExN4LzITerRIbSCUIeIilc0UqomV9uDXbNc55OG/s2a2pk3KYMLfcrALk5JZf5muNpGdZkGL8UoY4U1VmZOaqF3ATgvIBa1beNhoYTCSreMs8l/XXOlNnoy0SyZ48TgXqvV8biBQ5luG9u7kk0TuHUb2gJAFuVl/lmVGOqozOGvEYSzNe+vqczSIfp0qYlmG+Oc+Et8BYlcHrbBBXo+k3ffljRgL9bvXZVzeekZNT5vzv3Q3/pU1d/YLh9cB/LStZJj2cRm0mIm2hId1G5x1Z/yzH/s4yIf7Ds0WyRdE1tWzdYoJCaM4Qq6Bd8tmQ49PiZXQuUIp8XYRNuhI8WXle5Nj5RIzP4y7m0vPMKw6vh51nWQ1rF6LKXjvT+baRzwM835O2JXZC5FC4u87bW/pV87UJFM0tK0wEXlQhsib2Hs8iUYPYo67ToBc6HGoUkmrAUMrG39lH6LqWhpeVWmo0RBvg2QXc1LbirjWeT+V2Fq3tN0ztIZdpv0lLWn8LpzWF7EKQUtkZAzsnOZWdppoXpu78P0eEnmK8fsdQOYGV8ac65s5gsqir7O0nACPRwc1k+sJo9vfkHcguVMbmSMmokmsqhlv9CaRExOBxllXapj9CebIyAr5UqSwRiHkIJCX3OaiDNPJztuYgswA6GTn5N9QunMWCZpnf4gOzk0PTbs9+waNsAmiauNHrWDThtDxwU2sEeMrsfJKJ9exBejAWIPWA0VqyZnJ3qxbi1vOoti9Oqf4yHUSyjP14mmHRhiXOLMTFZsHRaGPdhme8nCRqoLLk+d5fEE5WUFHzg9OBzVSV59OTV/C6ipu/j5wCGyn3X90PUK1/IqaR1ZJdO9UiDj/9LH/hz+dtJhVixE2KoTclRZMYBUkrqpAtZx6BATp2BoyIq2+dtvLpxFJ5saQJ763kYaStxCtv+Xi9FMldCh7iJMj2ZMIrvj3glfBdRjwxd0edAPcWG4ZxPlZQcfPi/Rb7566+5wiTV6bHUR0haEz2jfwze07g7srr4C3frX23ZSarDr2h7lnEw1nS6Ii437mA/c2Ovm0aD1qo1kKqrNop/BmeGprrSer+T6taO21xTUAdxHBNl+QWG0MA/qOaoxjix/hJ0u6m/iqCDkD2ezk4cxm50N+wQmvk2oQuf7w+KNsxMYQnXeYTtEd3r+/CVShdp+/8UuhvPmdo3sW+ZYgASVoqz/iKrX1Ol4SEnxwo2o1IR6GyDAulr7jKQAd7kynnRUS+dSGtfEVdVB+fV9DkIxmiwaiHgbmxF4Dp4RpZ9cyUVHdYVkiF5jeAA7xCGsjRRm4BXPwnBeaEE7C4rdRiKU00w9Y8NWr/8fuRFO97RTrc5OXo0IBpp51Wf0i7UQ4rVO21YW6tGDnuTlDdVv0Tyz3JbamzgXr/fAbWPGHL/n+H2nPTRJKas46q4RqoF9n9Lk3lDeeWz8uSI8IWM+XgGoyvcpFrpRufoJ0jFaHouHhJUEACbhUC//2pYvehnZxEbcUUyb7uix7E/WX04M0Z+1qjoPFgdKlG8XAwJ6GK2APcp+Qbpsw2LVyk2A+yI955EcIN/TFCnP1fCsrw/NWWjRHocgQKyTK8jhbNjUOq8bXpmLdd/0eW/hMmMTMSCadUzdqe9lWQHAoE/2aIWJPtQ5pL9ryDV0wS88Qjh8MktTNNxmGPMA9dn2bEhP8g8COxHmNHjzt7J6ZVAFjOecui7iNABPdQXk5KXjSko6aGNnr1ohilntjN39/xcbLKY4nkb15/pUr1L6LxS12zMnnuGOuHjQ9hqwUWrzua2eYioL6S+8nzuprJPvZxPlbgmEk2yKUFhG3EphqAutilVkLK/GR1B/E49d4MYgQdq3DlqTxlmHuXHG2ioMEAtzrZtgXvhmNgFUugqBpEFm0yxP4YixykgOZGiEEITa5cWcs2cvb8bPEwv/Y9/W9MwI/3II54sQhDuLwzlYd2bSytAiMygZBfrxdzeqJws24n+y6FY19iBcTGevL1JL3MVrA/4U6K9hEO6Ck8UAY6OtoL5tZJLC1W/LWsKZNtNg7hvDomYG/7M2eVyK3B4yJVjSiWzatQof0CpYQY0lYTXZMpKyA==">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">COM in plain C, Part 7</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

                                

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625" rel="author">Jeff Glatt</a></span> 

                                        <div class="flex-item" style="margin-top:-7px;height:35px">
                                            <div id="ctl00_RateArticle_RateItemWrapper" class="container-rating small-text" name="RateItem_15037">

	<table class="small-text" width="100%" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right">
			<span class="align-right"></span>
			<img class="loading invisible" alt="loading..." src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/loading16.gif" width="16px" height="16px"> 
		</td>

	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tbody><tr>
				
				<td id="ctl00_RateArticle_StartForm" nowrap="nowrap" align="right"><b>Rate me!</b> </td>

				<td id="ctl00_RateArticle_VoteFormDiv" class="nowrap tooltip rating-stars-voter-large" style="padding-top:1px">

                    
					

<meta itemprop="upvoteCount" content="14">


<table id="ctl00_RateArticle_ItemRating_RatingTable" style="margin:0 1px;" class="hide-on-hover float-left" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td class="nowrap">

        <div style="width:120px;height:28px;position:relative" class="nowrap rating-stars-large"><div style="width:120px;height:24px;" class="clipped align-left float-left"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/stars-fill-lg.png"></div><div style="width:0px;height:24px;position:relative" class="clipped"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/stars-empty-lg.png" style="position:absolute;top:0;right:0"></div>

		
	</div></td>
		<td id="ctl00_RateArticle_ItemRating_VR" class="nowrap">
		<span id="ctl00_RateArticle_ItemRating_VotesR">5.00  (15 votes)</span>
		
	</td>
	</tr>
</tbody></table>

<span id="ctl00_RateArticle_ItemRating_RatingText"></span>


                    
					<span id="ctl00_RateArticle_RB" class="ajaxHist radio voting show-on-hover" style="display: none;">
						<span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5" style="display: none;"></span> 
					<div class="rating-star-block"><a href="#" rating="1" class="star outline" title="vote 1">vote 1</a><a href="#" rating="2" class="star outline" title="vote 2">vote 2</a><a href="#" rating="3" class="star outline" title="vote 3">vote 3</a><a href="#" rating="4" class="star outline" title="vote 4">vote 4</a><a href="#" rating="5" class="star outline" title="vote 5">vote 5</a></div></span>

                    
					

                    
	                <div id="ctl00_RateArticle_RCD" class="hover-container tooltip-flyout rating-comment" style="top:12px">
		                Add a reason or comment to your vote:
                        <a href="#" id="clear-rate_ctl00_RateArticle_RCD" title="close" class="rating-close">x</a>
                        <br>
                        <textarea class="RateComment" rows="5" cols="60" style="width:96%;"></textarea>
		                <span id="ctl00_RateArticle_CommentReq" class="subdue">Adding a comment to your rating is optional</span>
		            </div>

                    
                        

				</td>

				
                <td id="ctl00_RateArticle_VR" class="nowrap show-on-hover tooltip" style="display: none;">

		            <span id="ctl00_RateArticle_VotesR">5.00  (15 votes)</span>

                    
					<div id="ctl00_RateArticle_histPHR" class="speech-bubble-container-up-right" style="width:175px;margin-top:24px;right:-15px;top:6px">
						<div class="speech-bubble-up-right">
							<div id="ctl00_RateArticle_HistogramR">

</div>
							<img id="ctl00_RateArticle_LoadingR" class="align-middle" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/loading24.gif" style="border-width:0px;">
						</div>
						<div class="speech-bubble-pointer-up-right">
							<div class="speech-bubble-pointer-up-right-inner"></div>
						</div>
					</div>
                </td>


				<td style="padding-left:5px">	
					<input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button" style="display: none;">
				</td>
			</tr>
			</tbody></table>

			
		</td>
	</tr>
	</tbody></table>

</div>
                                        </div>
                                    </div>

                                    <div class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">8 Aug 2006</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_description" class="summary">An ActiveX Script Host with custom COM objects. This allows a script to call C functions in your app.</div><span id="ctl00_thumbnailUrl" class="date" content="https://codeproject.global.ssl.fastly.net/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					
					

						
					

					<div id="ctl00_confirmError" class="advise"><img style="float:left;margin-right:10px" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/warning48.png" width="48px" height="48px"><b>Is your email address OK?</b> You are signed up for our 
						newsletters but your email address is either unconfirmed, or has not been 
						reconfirmed in a long time. Please <b>click <a id="ctl00_RequestConfirmLink2" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f15037%2fCOM-in-plain-C-Part-7">here</a> to have a confirmation email
                        sent</b> so we can confirm your email address and start sending you 
                        newsletters again. Alternatively, you can 
						<a id="ctl00_SubscribeLink2" href="https://www.codeproject.com/script/Membership/Subscribe.aspx">update your subscriptions</a>.</div>

						
						<div id="contentdiv" class="text">
						



<ul class="download">
<li><a href="https://www.codeproject.com/KB/COM/com_in_c7/com_in_c7_src.zip">Download source files - 380 Kb</a> </li></ul>
<h2>Contents</h2>
<ul>
<li><a href="#DECLARE">Declaring our custom COM object</a> 
</li><li><a href="#IDL">Our IDL file and type library</a> 
</li><li><a href="#REG">Register our COM object with the engine</a> 
</li><li><a href="#HOW">How a script calls our COM object functions</a> 
</li><li><a href="#MULTI">Our IProvideMultipleClassInfo object</a> 
</li><li><a href="#APP">Application and document objects</a> 
</li><li><a href="#C">A C++ example host</a> </li></ul>
<h2><a name="INTRO">Introduction</a></h2>
<p>In the previous chapter, we learned how to run a script from our 
application. But in order for that script to be able to call C functions
 in our application, and ultimately, exchange data with our application,
 we need to add another, custom COM object to our application. Our C 
functions (that are callable by the script) will be wrapped in this COM 
object. As you'll recall from Chapter 2, in order for a script to call 
functions in our COM object, we will need to add the <code>IDispatch</code> standard functions to it (as well as the <code>IUnknown</code> standard functions).</p>
<p>In a nutshell, what we're going to do is create our own custom COM 
object, just like we did in Chapter 2. We're going to define it as 
containing the <code>IUnknown</code> functions, followed by the <code>IDispatch</code> functions, followed by whatever extra functions that we'd like the script to be able to call. And, we'll also write an <i>.IDL</i>
 file in order to create a type library (so that the script can discover
 what the names of our extra functions are, what arguments they are 
passed, and what they return). All we're doing is creating our own 
custom, script-accessible object, exactly like we did in Chapter 2. But 
instead of putting this object in its own DLL, it will be part of our 
executable.</p>
<h2><a name="DECLARE">Declaring</a> our custom COM object</h2>
<p>We can choose to call our custom COM object anything we'd like. Let's arbitrarily call it an <code>IApp</code>.</p>
<p>Let's provide three functions that a script may call, named <code>Output</code>, <code>SetTitle</code>, and <code>GetTitle</code>. The <code>Output</code> function will display a line of text in our main window's EDIT control. We'll use another custom window message (<code>WM_APP</code> + 1) with <code>PostMessage</code> to pass off this line to our main window procedure to display -- just like we did in our <code>IActiveScriptSite</code>'s <code>OnHandleError</code> function. The <code>SetTitle</code> function will change the text in our main window's title bar. And, the <code>GetTitle</code> function will retrieve the title bar text. We'll put these three functions in our <code>IApp</code> object, after the <code>IUnknown</code> and <code>IDispatch</code> functions.</p>
<p>In the directory <i>ScriptHost4</i> is a version of our Script Host that adds this <code>IApp</code> object. The source file named <i>AppObject.c</i> contains most of the new code.</p>
<p>We'll need a unique GUID for our <code>IApp</code> object, so I've run <i>GUIDGEN.EXE</i> to create one, and given it the name <code>CLSID_IApp</code>. We'll also need a GUID for <code>IApp</code>'s VTable, so I created another GUID and gave it the name <code>IDD_IApp</code>. I've put these two GUIDs in the source files named <i>Guids.c</i> and <i>Guids.h</i>.</p>
<p>As you'll recall from Chapter 2, we use a special macro to declare our <code>IApp</code> object's VTable (and the object itself). Here's the declaration:</p><div class="pre-action-link" id="premain899180" style="width:100%;display:block;"><span id="prehide899180" onclick="processCodeBlocks.togglePre(899180);">Hide</span>  &nbsp; <span id="copycode899180" onclick="return processCodeBlocks.copyCode(899180);">Copy Code</span></div><pre id="pre899180" style="margin-top: 0px;" class="notranslate">#undef  INTERFACE
#define INTERFACE IApp
DECLARE_INTERFACE_ (INTERFACE, IDispatch)
{
   // IUnknown functions
   STDMETHOD  (QueryInterface)(THIS_ REFIID, void **) PURE;
   STDMETHOD_ (ULONG, AddRef)(THIS) PURE;
   STDMETHOD_ (ULONG, Release)(THIS) PURE;
   // IDispatch functions
   STDMETHOD_ (ULONG, GetTypeInfoCount)(THIS_ UINT *) PURE;
   STDMETHOD_ (ULONG, GetTypeInfo)(THIS_ UINT, LCID, ITypeInfo **) PURE;
   STDMETHOD_ (ULONG, GetIDsOfNames)(THIS_ REFIID, LPOLESTR *, UINT,
               LCID, DISPID *) PURE;
   STDMETHOD_ (ULONG, Invoke)(THIS_ DISPID, REFIID, LCID, WORD,
               DISPPARAMS *, VARIANT *, EXCEPINFO *, UINT *) PURE;
   // Extra functions
   STDMETHOD  (Output)(THIS_ BSTR) PURE;
   STDMETHOD  (SetTitle)(THIS_ BSTR) PURE;
   STDMETHOD  (GetTitle)(THIS_ BSTR *) PURE;
};</pre>
<p>Remember that the above macro also automatically defines our <code>IApp</code> as containing one member, <code>lpVtbl</code>,
 which is a pointer to the above VTable. But as is so often the case, we
 need to add extra, private members to our object, so we'll also define a
 <code>MyRealIApp</code> struct, as so:</p><div class="pre-action-link" id="premain342578" style="width:100%;display:block;"><span id="prehide342578" onclick="processCodeBlocks.togglePre(342578);">Hide</span>  &nbsp; <span id="copycode342578" onclick="return processCodeBlocks.copyCode(342578);">Copy Code</span></div><pre id="pre342578" style="margin-top: 0px;" class="notranslate">typedef struct {
  IApp                      iApp;
  IProvideMultipleClassInfo classInfo;
} MyRealIApp;</pre>
<p>Our <code>MyRealIApp</code> wraps our <code>IApp</code>, as well as a standard COM sub-object known as an <code>IProvideMultipleClassInfo</code>, which we'll examine later.</p>
<p>We need to declare the global VTable for our <code>IApp</code>, and also our <code>IProvideMultipleClassInfo</code> sub-object's VTable:</p><div class="pre-action-link" id="premain548007" style="width:100%;display:block;"><span id="prehide548007" onclick="processCodeBlocks.togglePre(548007);">Hide</span>  &nbsp; <span id="copycode548007" onclick="return processCodeBlocks.copyCode(548007);">Copy Code</span></div><pre id="pre548007" style="margin-top: 0px;" class="notranslate">// Our IApp VTable.
IAppVtbl IAppTable = {
  QueryInterface,
  AddRef,
  Release,
  GetTypeInfoCount,
  GetTypeInfo,
  GetIDsOfNames,
  Invoke,
  Output,
  SetTitle,
  GetTitle};

// Our IProvideMultipleClassInfo VTable.
IProvideMultipleClassInfoVtbl IProvideMultipleClassInfoTable = {
  QueryInterface_CInfo,
  AddRef_CInfo,
  Release_CInfo,
  GetClassInfo_CInfo,
  GetGUID_CInfo,
  GetMultiTypeInfoCount_CInfo,
  GetInfoOfIndex_CInfo};</pre>
<p>For our purposes, we'll need only one <code>IApp</code> object. All running scripts will share this one object (so it's important to employ some synchronization in our <code>IApp</code>
 functions if they access any global data and we have multiple script 
threads running). The easiest thing to do then is to declare our <code>IApp</code> object as a global, and call a function at the start of our program to initialize it.</p>
<p>We'll also be loading two <code>ITypeInfo</code>s -- one for <code>IApp</code>'s VTable, and one for our <code>IApp</code> object itself. And, we'll need to store those <code>ITypeInfo</code>s somewhere. Because we need only one of each, I'll declare two global variables for those.</p><div class="pre-action-link" id="premain874615" style="width:100%;display:block;"><span id="prehide874615" onclick="processCodeBlocks.togglePre(874615);">Hide</span>  &nbsp; <span id="copycode874615" onclick="return processCodeBlocks.copyCode(874615);">Copy Code</span></div><pre id="pre874615" style="margin-top: 0px;" class="notranslate">// For our purposes, we need only one IApp object, so
// we'll declare it global
MyRealIApp   MyIApp;

// The ITypeInfo for our IApp object. We need only 1 so we make it global
ITypeInfo   *IAppObjectTypeInfo;

// The ITypeInfo for our IApp VTable. We need only one of these
ITypeInfo   *IAppVTableTypeInfo;

void initMyRealIAppObject(void)
{
   // Initialize the sub-object VTable pointers
   MyIApp.iApp.lpVtbl = &amp;IAppTable;
   MyIApp.classInfo.lpVtbl = &amp;IProvideMultipleClassInfoTable;

   // Haven't yet loaded the ITypeInfos for IApp's VTable, nor IApp itself
   IAppObjectTypeInfo = IAppVTableTypeInfo = 0;
}</pre>
<h2><a name="IDL">Our</a> IDL file and type library</h2>
<p>We need to create an <i>.IDL</i> file so <i>MIDL.EXE</i> can compile a type library for us. Our IDL file defines our <code>IApp</code> VTable, and the <code>IApp</code> object itself. This is essentially the same thing that we did in Chapter 2 when we defined our <code>IExample2</code> custom COM object. You'll find a source file named <i>ScriptHost.idl</i> to peruse.</p>
<p>Note that <code>IApp</code>'s VTable is declared as a dual interface. This will allow our <code>IDispatch</code>
 functions to use some standard COM calls to do most of the work of 
those functions. Again, this is the same thing as what we did with <code>IExample2</code>'s <code>IDispatch</code> functions.</p>
<p>Also notice that our <code>SetTitle</code> and <code>GetTitle</code> functions are declared as <code>propput</code> and <code>propget</code>, and reference the same DISPID number. So, these two functions work to set and fetch the value of a variable named <code>Title</code> as far as the script is concerned. Again, this should be familiar to you from Chapter 2.</p>
<p>One thing we're going to do differently than <code>IExample2</code> concerns the actual type library that <i>MIDL.EXE</i> will create for us (i.e., <i>ScriptHost.tlb</i>). With <code>IExample2</code>,
 we simply left the type library as a separate file. With our 
application, we are instead going to embed that type library file in our
 EXE's resources and use the COM function <code>LoadTypeLib</code> to extract/load it from our resources.</p>
<p>I've created an <i>.RC</i> file for our application's resources. In <i>ScriptHost.rc</i>, you'll see the following statement:</p><div class="pre-action-link" id="premain195075" style="width:100%;display:block;"><span id="prehide195075" onclick="processCodeBlocks.togglePre(195075);">Hide</span>  &nbsp; <span id="copycode195075" onclick="return processCodeBlocks.copyCode(195075);">Copy Code</span></div><pre id="pre195075" style="margin-top: 0px;" class="notranslate">1 TYPELIB MOVEABLE PURE "debug/ScriptHost.tlb"</pre>
<p>This takes the type library file (<i>ScriptHost.tlb</i>, compiled by <i>MIDL.EXE</i> and placed in the <i>Debug</i> directory), and embeds it into our EXE's resources, giving it a resource ID number of 1. The type of the resource is <code>TYPELIB</code>, which indicates that this resource is a type library file. We do not need to ship our type library file (<i>ScriptHost.tlb</i>) as a separate file because now it is embedded right inside of our EXE.</p>
<p>Here's a function that takes a GUID and creates an <code>ITypeInfo</code>
 for whatever that GUID refers to. The function extracts the info from 
our embedded type library resource. For example, to get an <code>ITypeInfo</code> for our <code>IApp</code> VTable, we simply pass the GUID for <code>IApp</code>'s VTable. We also pass a handle where the <code>ITypeInfo</code> is returned.</p><div class="pre-action-link" id="premain330781" style="width:100%;display:block;"><span id="prehide330781" onclick="processCodeBlocks.togglePre(330781);">Hide</span>  &nbsp; <span id="copycode330781" onclick="return processCodeBlocks.copyCode(330781);">Copy Code</span></div><pre id="pre330781" style="margin-top: 0px;" class="notranslate">HRESULT getITypeInfoFromExe(const GUID *guid, ITypeInfo **iTypeInfo) 
{
   wchar_t    fileName[MAX_PATH];
   ITypeLib   *typeLib;
   HRESULT    hr;

   // Assume an error
   *iTypeInfo = 0;

   // Load the type library from our EXE's resources
   GetModuleFileNameW(0, &amp;fileName[0], MAX_PATH);
   if (!(hr = LoadTypeLib(&amp;fileName[0], &amp;typeLib)))
   {
      // Let Microsoft's GetTypeInfoOfGuid() create a generic ITypeInfo
      // for the requested item (whose GUID is passed)
      hr = typeLib-&gt;lpVtbl-&gt;GetTypeInfoOfGuid(typeLib, guid, iTypeInfo);

      // We no longer need the type library
      typeLib-&gt;lpVtbl-&gt;Release(typeLib);
   }

   return(hr);
}</pre>
<h2><a name="REG">Register</a> our COM object with the engine</h2>
<p>To register our COM object with the engine, we must call the engine <code>IActiveScript</code>'s <code>AddNamedItem</code>
 function once. We must also decide upon a string name for this COM 
object, which the script will use to call our COM functions. This name 
should be a legal variable name in any of the language engines we use. A
 good generic approach is to use all alphabetic characters for the 
string name (without spaces), which is supported by almost every 
language as a variable name.</p>
<p>Let's arbitrarily decide upon a string name of "application". We need
 to register our COM object before we actually run the script, but after
 we initialize the engine. So we'll add the call to <code>AddNamedItem</code> in <code>runScript</code> after we call <code>SetScriptSite</code>, but before we load the script and pass it off to <code>ParseScriptText</code>. Here is the line we add:</p><div class="pre-action-link" id="premain286754" style="width:100%;display:block;"><span id="prehide286754" onclick="processCodeBlocks.togglePre(286754);">Hide</span>  &nbsp; <span id="copycode286754" onclick="return processCodeBlocks.copyCode(286754);">Copy Code</span></div><pre id="pre286754" style="margin-top: 0px;" class="notranslate">args-&gt;EngineActiveScript-&gt;lpVtbl-&gt;AddNamedItem(args-&gt;EngineActiveScript,
    "application", SCRIPTITEM_ISVISIBLE|SCRIPTITEM_NOCODE)</pre>
<p>The second argument is our string name, which is "application" here. The third argument is some flags. The <code>SCRIPTITEM_ISVISIBLE</code>
 flag means that the script can call our object's functions. (Without 
this flag, the script will not be able to call any of our functions. 
There may be a reason why you'd want this, but not here.) <code>SCRIPTITEM_NOCODE</code>
 means that the object's functions are C code inside our executable. It 
is possible to actually add an object to a script where the object's 
functions are contained in another script you add to the engine. In that
 case, you would not use <code>SCRIPTITEM_NOCODE</code>, but here we want it because our object's functions are indeed C functions in our executable.</p>
<p>As soon as we call <code>AddNamedItem</code>, the script engine will call our <code>IActiveScriptSite</code>'s <code>GetItemInfo</code> function to retrieve a pointer to our custom COM object and/or its <code>ITypeInfo</code>. So now, we need to replace the former stub code with useful instructions. Here it is:</p><div class="pre-action-link" id="premain670586" style="width:100%;display:block;"><span id="prehide670586" onclick="processCodeBlocks.togglePre(670586);">Hide</span>  &nbsp; <span id="preShrink670586" onclick="processCodeBlocks.shrinkExpand(670586);">Shrink</span> <img id="preimg670586" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(670586);">  &nbsp; <span id="copycode670586" onclick="return processCodeBlocks.copyCode(670586);">Copy Code</span></div><pre id="pre670586" style="margin-top: 0px;" processed="true" class="notranslate">STDMETHODIMP GetItemInfo(MyRealIActiveScriptSite *this, LPCOLESTR
   objectName, DWORD dwReturnMask, IUnknown **objPtr, ITypeInfo **typeInfo)
{
   HRESULT   hr;

   // Assume failure
   hr = E_FAIL;
   if (dwReturnMask &amp; SCRIPTINFO_IUNKNOWN) *objPtr = 0;
   if (dwReturnMask &amp; SCRIPTINFO_ITYPEINFO) *typeInfo = 0;

   // Does the engine want our IApp object (has the string name "application")?
   if (!lstrcmpiW(objectName, "application"))
   {
      // Does the engine want a pointer to our IApp object returned?
      if (dwReturnMask &amp; SCRIPTINFO_IUNKNOWN)
      {
         // Give the engine a pointer to our IApp object. Engine will call
         // its AddRef() function, and later Release() it when done
         *objPtr = getAppObject();
      }

      // Does the engine want the ITypeInfo for our IApp object returned?
      if (dwReturnMask &amp; SCRIPTINFO_ITYPEINFO)
      {
         // Make sure we have an ITypeInfo for our IApp object. (The script
         // engine needs to figure out what args are passed to our IApp's
         // extra functions, and what those functions return. And for that,
         // it needs IApp's ITypeInfo). The engine will call its AddRef()
         // function, and later Release() it when done
         if ((hr = getAppObjectITypeInfo(typeInfo))) goto bad;
      }

      hr = S_OK;
   }
bad:
   return(hr);
}</pre>
<p>Notice that the engine will pass the string name we gave to the 
object (i.e., "application"), so we do a string compare to ensure that 
the engine is indeed asking for our <code>IApp</code> object. The engine will also pass some handles where it wants us to return a pointer to the object and/or its <code>ITypeInfo</code>. If the engine wants a pointer to our object, it passes the <code>SCRIPTINFO_IUNKNOWN</code> flag. If it wants our object's <code>ITypeInfo</code>, then it passes the <code>SCRIPTINFO_ITYPEINFO</code> flag. Note that both flags can be passed simultaneously. We simply call our <code>getAppObject</code> and/or <code>getAppObjectITypeInfo</code> functions (in <i>AppObject.c</i>) to fill in the engine's handles.</p>
<h2><a name="HOW">How</a> a script calls our COM object functions</h2>
<p>When we call <code>AddNamedItem</code>, our COM object is added to 
the engine, and exposed to the script as if it were an object that the 
script itself created. For example, if a VBScript wants to call our COM 
object's <code>Output</code> function, it will do so as follows:</p><div class="pre-action-link" id="premain135265" style="width:100%;display:block;"><span id="prehide135265" onclick="processCodeBlocks.togglePre(135265);">Hide</span>  &nbsp; <span id="copycode135265" onclick="return processCodeBlocks.copyCode(135265);">Copy Code</span></div><pre id="pre135265" style="margin-top: 0px;" class="notranslate" lang="vbscript"><span class="code-sdkkeyword">application</span>.Output(<span class="code-string">"</span><span class="code-string">Some text"</span>)</pre>
<p>In VBScript, a dot follows an object name. Notice that the script references our <code>IApp</code> object using our string name of "application". The VBScript does not need to call <code>CreateObject</code>. Because our application has registered our object via <code>AddNamedItem</code>, our object is automatically available to the script just by using our chosen string name.</p>
<p>If the script wants to set our Title property (i.e., call our <code>SetTitle</code> function), it can do so as follows:</p><div class="pre-action-link" id="premain28234" style="width:100%;display:block;"><span id="prehide28234" onclick="processCodeBlocks.togglePre(28234);">Hide</span>  &nbsp; <span id="copycode28234" onclick="return processCodeBlocks.copyCode(28234);">Copy Code</span></div><pre id="pre28234" style="margin-top: 0px;" class="notranslate" lang="vbscript"><span class="code-sdkkeyword">application</span>.Title = <span class="code-string">"</span><span class="code-string">Some text"</span></pre>
<p>If the script wants to retrieve the value of our <code>Title</code> property (i.e., call our <code>GetTitle</code> function), it can do so as follows:</p><div class="pre-action-link" id="premain971082" style="width:100%;display:block;"><span id="prehide971082" onclick="processCodeBlocks.togglePre(971082);">Hide</span>  &nbsp; <span id="copycode971082" onclick="return processCodeBlocks.copyCode(971082);">Copy Code</span></div><pre id="pre971082" style="margin-top: 0px;" class="notranslate" lang="vbscript">title = <span class="code-sdkkeyword">application</span>.Title</pre>
<p>There is an example VBScript named <i>script.vbs</i> (in the <i>ScriptHost4</i> directory) which calls our <code>IApp</code> functions.</p>
<h2><a name="MULTI">Our</a> IProvideMultipleClassInfo object</h2>
<p>Our <code>IProvideMultipleClassInfo</code> object functions (in <i>AppObject.c</i>) are called by the engine when it needs to get GUIDs and/or <code>ITypeInfo</code> objects related to our <code>IApp</code> object. The engine may ask for the GUID of our <code>IApp</code> [default] VTable, or it may ask for the GUID of any [default, source] VTable our <code>IApp</code> object has (if we had one such VTable), or may ask for our <code>IApp</code>'s <code>ITypeInfo</code> object (i.e., not one of its VTables' <code>ITypeInfo</code>s).</p>
<h2><a name="APP">Application</a> and document objects</h2>
<p>Suppose we have a text editor application. The app is a "multiple 
document" app, meaning that the user can edit several different text 
files, each open in its own MDI window.</p>
<p>In this case, our <code>IApp</code> object would be more or less an 
"application object"; that is, it would contain functions to control the
 overall operation of our app. For example, it may have a function to 
show or hide the toolbar or status bar. We'd need only one <code>IApp</code> object.</p>
<p>We'd define a second custom object, which we'll arbitrarily call an <code>IDocument</code>
 object. This object would have functions that control one text editor 
window and its contents. For example, perhaps, we'd have a function to 
insert some text at the current cursor position, and another function to
 move the cursor to a certain position in the document. Every time we 
create/load another text file, we'd create another <code>IDocument</code> object just for this new document. So, if the user has several editor windows open, we'd have several <code>IDocument</code> objects (one per window).</p>
<p>Because we're going to have several instances of the same object, we would not call the engine's <code>AddNamedItem</code> to register our <code>IDocument</code> object. (Indeed, if the user has not yet opened any documents, we may not have any instance of an <code>IDocument</code> object.) So, how may the script gain access to a particular <code>IDocument</code> object (assuming the script wishes to alter the contents of that document)? Typically, our <code>IApp</code> object will have some function the script may call, which will return an <code>IDocument</code> object. Maybe, the script will pass the "name" of the document it desires. Or maybe, our <code>IApp</code> will have a function that simply returns the currently active document's <code>IDocument</code>. (It's up to you how you want to do this).</p>
<p>Typically, you'd have a linked list of some "document" structures which the <code>IApp</code> could search through to find/retrieve the appropriate <code>IDocument</code> object. For example, maybe, we would define a <code>GetDocument</code> function for our <code>IApp</code>. <code>GetDocument</code> would be passed the <code>BSTR</code> name of the desired <code>IDocument</code> to fetch. Our IDL file definition may look like this:</p><div class="pre-action-link" id="premain274964" style="width:100%;display:block;"><span id="prehide274964" onclick="processCodeBlocks.togglePre(274964);">Hide</span>  &nbsp; <span id="copycode274964" onclick="return processCodeBlocks.copyCode(274964);">Copy Code</span></div><pre id="pre274964" style="margin-top: 0px;" class="notranslate">[id(3)] HRESULT GetDocument([in] BSTR name, [out, retval] IDispatch **document);</pre>
<p>Of course, in order for a script to call our <code>IDocument</code>'s functions, our <code>IDocument</code> must have the standard <code>IDispatch</code> functions in its VTable. In that case, it can (and should, as far as the script engine is concerned) masquerade as an <code>IDispatch</code>. So that's what we indicate that <code>GetDocument</code> returns.</p>
<p>So for example, a VBScript may fetch a document named <i>test.txt</i>, like so:</p><div class="pre-action-link" id="premain687895" style="width:100%;display:block;"><span id="prehide687895" onclick="processCodeBlocks.togglePre(687895);">Hide</span>  &nbsp; <span id="copycode687895" onclick="return processCodeBlocks.copyCode(687895);">Copy Code</span></div><pre id="pre687895" style="margin-top: 0px;" class="notranslate" lang="vbscript"><span class="code-keyword">SET</span> doc = <span class="code-sdkkeyword">application</span>.GetDocument(<span class="code-string">"</span><span class="code-string">test.txt"</span>)</pre>
<p>In the directory <i>ScriptHost5</i> is a rudimentary text file 
viewer. It's a simple MDI app that can open numerous text files for 
viewing; each file in its own window. We have an <code>IApp</code> object with one extra function called <code>CreateDocument</code>. This is passed the <code>BSTR</code>
 filename of a text file to load. It creates a new MDI child window, and
 loads/displays that text file in the window. (Actually, we simply 
create a blank document.) <code>CreateDocument</code> also creates a new <code>IDocument</code> object for that window, and returns it to the script.</p>
<p>Our <code>IDocument</code> object contains a function called <code>WriteText</code>. This is passed a <code>BSTR</code> of text, and this text replaces any other text in the window.</p>
<p>There is a VBScript file named <i>test.vbs</i> in the <i>ScriptHost5</i> directory. It simply calls our <code>IApp</code>'s <code>CreateDocument</code> twice, to create two <code>IDocument</code> objects, naming them "Document 1" and "Document 2". It calls the <code>WriteText</code> function of each <code>IDocument</code>. For "Document 1", it sets the text "This is document 1.". For "Document 2", it sets the text "This is document 2.".</p>
<p>Note that the ScriptHost5 is hardwired to load and run <i>text.vbs</i>, just for the sake of simplicity.</p>
<p>From this example, you should notice how our <code>IApp</code> object controls the overall operation of our viewer, whereas the <code>IDocument</code> controls each individual document. Note the additions we made to <i>ScriptHost.idl</i> to define our two custom objects (and note that both have dual VTables, so we use standard COM functions to do most of the <code>IDispatch</code> work). Also note that we need another GUID for <code>IDocument</code>'s VTable in our IDL file. But we don't define the <code>IDocument</code> object itself in our IDL file. We don't need to, since the script doesn't ever create one of these via <code>CoCreateInstance</code>, but rather, indirectly fetches one that our app itself creates.</p>
<h2><a name="C">A</a> C++ example host</h2>
<p>In the directory <i>ScriptHost6</i> is a C++ version of ScriptHost5. You'll notice in <i>AppObject.h</i> that we declare our <code>MyRealIApp</code> and <code>MyRealIDocument</code> as classes based upon our <code>IApp</code> and <code>IDocument</code>. The COM functions are then made members of their respective classes. Notice that, whereas in the C example our <code>MyRealApp</code>'s functions took a pointer to the <code>MyRealApp</code> as the first argument, this is omitted in the C++ version. That's because it becomes the hidden "<code>this</code>" pointer. And, we do not need to declare and initialize the pointers to any VTables. The C++ compiler does all that for us.</p>
<p>Furthermore, whenever we call a COM function, we omit the <code>-&gt;lpVtbl</code>, and do not pass a pointer to the object as the first argument.</p>
<p>Also, in <i>IActiveScriptSite.h</i>, we declare our <code>MyRealIActiveScriptSite</code> as a class based upon both an <code>IActiveScriptSite</code> and an <code>IActiveScriptSiteWindow</code>. Notice that we no longer need a separate <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code> for each sub-object. We declare only the base object's <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code>, and then the C++ compiler automatically generates those functions, with proper delegation, for other sub-objects.</p>


						</div>
						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/COM" data-country="US" data-loadonview="true" data-tags="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Intermediate,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=300x250&c=445756"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=300x250&c=445756"  width="300px" height="250px" target="_blank"/></a></noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

    <ul class="rrssb-buttons clearfix rrssb-1">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=COM%20in%20plain%20C%2c%20Part%207%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f15037%2fCOM-in-plain-C-Part-7%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=COM+in+plain+C%2c+Part+7+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f15037%2fCOM-in-plain-C-Part-7" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                        C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f15037%2fCOM-in-plain-C-Part-7" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f15037%2fCOM-in-plain-C-Part-7&amp;title=COM+in+plain+C%2c+Part+7+-+CodeProject&amp;summary=&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f15037%2fCOM-in-plain-C-Part-7&amp;title=COM+in+plain+C%2c+Part+7+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f15037%2fCOM-in-plain-C-Part-7&amp;description=COM+in+plain+C%2c+Part+7+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    

<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/member_unknown.gif" style="border-width:0px;transform:rotate(1deg);">
    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="https://www.codeproject.com/Members/Jeff-Glatt">Jeff Glatt</a></b>

        <table>
        <tbody><tr>
            <td rowspan="2" valign="middle" nowrap="nowrap">
            
            </td>
            <td nowrap="nowrap">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle"></span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
                </div>
            </td>
            <td rowspan="2" style="padding-left:15px">
                <a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn" title="" class="button unfollowed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Have the articles and posts from this member appear in your Timeline so you can stay up to date." style="display: inline-block;">Follow<div class="tiny-text" style="margin-top:-3px;">this Member</div><div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have the articles and posts from this member appear in your Timeline so you can stay up to date.</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn" title="" class="button followed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Stop following this Member" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Member</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">United States <img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/US.gif" alt="United States" width="16px" height="11px"></span>
            </td>
        </tr>
        </tbody></table>
    </div>

    <div class="description">
        No Biography provided

        
    </div>

</div><br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/COM" data-country="US" data-loadonview="true" data-tags="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Intermediate,rating4.5,pos_bottom" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=728x90&c=445756"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=728x90&c=445756"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellspacing="0" cellpadding="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="3px" border="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="button new-message compose float-left">
<a rel="nofollow" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;floc=/Articles/15037/COM-in-plain-C-Part-7" name="Frm_HoverNL" target="_top">Add a Comment or Question&nbsp;</a>
</div><div class="admin-links float-left align-middle" style="width:90px;line-height:24px;margin-top:4px;">
&nbsp;<a href="https://www.codeproject.com/KB/FAQs/MessageBoardsFAQ.aspx"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/help_sm.png" title="FAQ" alt="FAQ" style="border-width:0;width:16px;height:16px;vertical-align:middle;"></a>
</div><div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="329935"><input type="hidden" name="sbo" value="fm"><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search subdue" autocomplete="off" name="qf" value="Search Comments"><input type="image" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/search.gif">
</form>
</div><div class="tooltip email-alert" id="ctl00_MessageBoard_SubscribeDiv">
	<span class="nowrap medium-text">Email Alerts</span><div class="tooltip-flyout" style="width: 335px;margin-top: 24px;left: -270px;padding: 7px;">
		<b>Email me</b><input type="checkbox" id="ctl00_MessageBoard_SubscribeNew"><label for="ctl00_MessageBoard_SubscribeNew">New Posts</label><input type="checkbox" id="ctl00_MessageBoard_SubscribeReplies"><label for="ctl00_MessageBoard_SubscribeReplies">Replies to Posts</label><br><br><b>Send them</b><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeInstant"><label for="ctl00_MessageBoard_SubscribeInstant">Instantly</label><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeDaily"><label for="ctl00_MessageBoard_SubscribeDaily">Daily</label>&nbsp; <b>For</b> <select id="ctl00_MessageBoard_MessageType" class="tiny-text" style="width:80px;">
			<option value="0" selected="selected">
				All Types
			</option><option value="128">
				Announcements
			</option>
		</select><button class="button safe float-right update">Update</button>
	</div>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?floc=%2fArticles%2f15037%2fCOM-in-plain-C-Part-7&amp;fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="329935"><input type="hidden" name="currentQS" value="floc=%2fArticles%2f15037%2fCOM-in-plain-C-Part-7&amp;fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True"><input type="hidden" name="floc" value="/Articles/15037/COM-in-plain-C-Part-7">Spacing<select size="1" class="dropdown" name="spc">
<option selected="selected" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view">
<option selected="selected" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="selected" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table width="100%" cellspacing="0" cellpadding="2px" border="0">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span> <span class="nav-link disabled">Next</span></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table class="fixed-layout blank-background" width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr id="F1715648_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx1715648xx"></a><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1715648" parent="0" thread="1715648" href="https://www.codeproject.com/Messages/1715648/Debug-Interfaces.aspx">Debug Interfaces</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Anthony Fountaine</span><span class="date">17-Oct-06  8:51</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=334636">Anthony Fountaine</a></span></td><td class="date"><span>17-Oct-06  8:51&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1715648_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="334636" msgid="1715648" votingtype="GoodOrBad" done="true"><a href="#xx1715648xx" onclick="return rateItem(5, 1715648,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',334636);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1715648xx" onclick="return rateItem(1, 1715648,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',334636);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Jeff I have been reading you articles and have to say 
they have been great.  I'm not sure if you are going to continue on with
 the series or not.  One area I have found to be lacking on the web is 
the debug interfaces for scripting.  It would be nice to see someone 
show how to single step the script.<br>
<br>
Great Work!!!!!<br>
Tony<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1715648&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1715648&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1715648" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1715648" data-ref="3_1715648" class="rating-label" name="RateItem_1715648"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1715648/Debug-Interfaces.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1715648"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="334636" msgid="1715648"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1716312_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx1716312xx"></a><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1716312" parent="1715648" thread="1715648" href="https://www.codeproject.com/Messages/1716312/Re-Debug-Interfaces-modified.aspx">Re: Debug Interfaces [modified]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">17-Oct-06  14:11</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>17-Oct-06  14:11&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1716312_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="1716312" votingtype="GoodOrBad" done="true"><a href="#xx1716312xx" onclick="return rateItem(5, 1716312,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1716312xx" onclick="return rateItem(1, 1716312,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1715648);" href="https://www.codeproject.com/Messages/1715648/Debug-Interfaces.aspx"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>In fact, I do have a debugger app finished, and am planning on doing an article about that.<br>
<br>
The planned roadmap is:<br>
<br>
1) The two article discusses some miscellaneous Script Host topics, such
 as calling a particular function in a script, querying/setting 
variables, implementing "macros" that are loaded once and remain loaded,
 etc.<br>
<br>
2) The next article (or two) discuss adding debugger support to a Script
 Host. This will feature a demo "IDE" that loads/displays a script in a 
"text window", lets the user double-click upon any line in the script to
 toggle a breakpoint, and has "docking windows" that display the current
 variables and callstack while running/debugging the script. The IDE has
 menu items to single step, step over, and run (to the next breakpoint).<br>
<br>
3) The remaining articles discuss creating a ActiveX script engine in C.
 This is the "big finish". This article includes a demo script engine in
 C that implements an "interpreted C-like" language with debugging 
support.<br>
<br>
In fact, the examples for the first 2 have been completed. The problem 
is with #3. I have actually completed the example script engine based 
upon available Microsoft docs and examples. But, the only known, 
publically published Microsoft example engine with debugging support 
(SampleScript) crashes with every Microsoft example of Active Host 
debugging. For some unknown reason, Microsoft's "Program Debug Manager" 
and "Debugger Helper APIs" simply do not work with the way that 
SampleScript implements its debugger API. I was able to work around this
 by simply bypassing these MS components in my demo IDE and going 
straight to the engine's COM components. Unfortunately, (and quite 
stupidly), Microsoft's VBScript engine appears to require that a host 
use the Debugger Helper APIs. So it's a catch-22 situation. You must use
 the Debugger Helper API if you want to debug VBscript. But if you use 
the Debugger Helper API, then you can't write your own script engine 
with debugger support, because there is something the engine needs to do
 to make it work, which MS isn't telling anyone (except the VBscript and
 JScript developers).<br>
<br>
So, the articles have been put on hold until I can track down the needed
 information that MS hasn't supplied. But so far, in my studies of MS's 
ActiveX Debugging implementation, I have to say that I'm quite 
unimpressed with the quality of the work produced by the MS developers 
who came up with, and implemented, this stuff. To be blunt, it's poor 
quality work. MS' own example script engine should not be crashing its 
Program Debug Manager.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1716312&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1716312&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1715648" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1716312" data-ref="3_1716312" class="rating-label" name="RateItem_1716312"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1716312/Re-Debug-Interfaces-modified.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1716312"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1716312"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1725480_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx1725480xx"></a><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1725480" parent="1716312" thread="1715648" href="https://www.codeproject.com/Messages/1725480/Re-Debug-Interfaces.aspx">Re: Debug Interfaces</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Anthony Fountaine</span><span class="date">24-Oct-06  18:41</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=334636">Anthony Fountaine</a></span></td><td class="date"><span>24-Oct-06  18:41&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1725480_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="334636" msgid="1725480" votingtype="GoodOrBad" done="true"><a href="#xx1725480xx" onclick="return rateItem(5, 1725480,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',334636);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1725480xx" onclick="return rateItem(1, 1725480,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',334636);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1716312);" href="https://www.codeproject.com/Messages/1716312/Re-Debug-Interfaces-modified.aspx"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Jeff,<br>
<br>
I can't wait to read the coming articles.<br>
<br>
5 Stars!!!<br>
<br>
Cheers,<br>
Tony<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1725480&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1725480&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1715648" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1725480" data-ref="3_1725480" class="rating-label" name="RateItem_1725480"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1725480/Re-Debug-Interfaces.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1725480"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="334636" msgid="1725480"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1797797_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="74px"><a name="xx1797797xx"></a><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1797797" parent="1725480" thread="1715648" href="https://www.codeproject.com/Messages/1797797/Re-Debug-Interfaces-modified.aspx">Re: Debug Interfaces [modified]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">10-Dec-06  3:39</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>10-Dec-06  3:39&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1797797_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:74px;"><span class="voteform vertical" ownerid="88625" msgid="1797797" votingtype="GoodOrBad" done="true"><a href="#xx1797797xx" onclick="return rateItem(5, 1797797,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1797797xx" onclick="return rateItem(1, 1797797,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1725480);" href="https://www.codeproject.com/Messages/1725480/Re-Debug-Interfaces.aspx"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Don't
 know when I'll get around to finishing the article about the Debugging 
API, but the code example is done, so I've tossed a zip file of it on my
 FTP site. The code is profusely commented so you should be able to 
glean what you need to know from that.<br>
<br>
Incidentally, this example does NOT use Microsoft's "Debug helper 
objects". Quite frankly, those things are buggy as hell. They seem to 
work with VB script. But they do NOT work with the one known example 
ActiveX debugging script engine that Microsoft ever released source to, 
named SampleScript. They crash the engine. And since this is the only 
example MS source ever released, that means other engines (undoubtably 
using that MS source as a basis) won't work with the Debug Helper 
objects.<br>
<br>
My example instead implements a "full smart host". As such it works with
 VBscript as well as a script engine I made based upon the example of 
SampleScript.<br>
<br>
This is the only example I know of a full smart host debugger. All of 
the MS examples I've ever seen use the Debug Helper objects (ack, 
ptooie). I had to read between the lines of the scant, inadequate 
documentation on MSDN, and experiment, to figure it all out.<br>
<br>
Get the Debugger Host example at:<br>
<br>
http://home.roadrunner.com/~jgglatt/debughost.zip<br>
<br>
<br>
 -- modified at 0:14 Tuesday 9th October, 2007<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1797797&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1797797&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1715648" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1797797" data-ref="3_1797797" class="rating-label" name="RateItem_1797797"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1797797/Re-Debug-Interfaces-modified.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1797797"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1797797"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1800857_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="92px"><a name="xx1800857xx"></a><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1800857" parent="1797797" thread="1715648" href="https://www.codeproject.com/Messages/1800857/Re-Debug-Interfaces.aspx">Re: Debug Interfaces</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Anthony Fountaine</span><span class="date">12-Dec-06  9:09</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=334636">Anthony Fountaine</a></span></td><td class="date"><span>12-Dec-06  9:09&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1800857_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:92px;"><span class="voteform vertical" ownerid="334636" msgid="1800857" votingtype="GoodOrBad" done="true"><a href="#xx1800857xx" onclick="return rateItem(5, 1800857,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',334636);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1800857xx" onclick="return rateItem(1, 1800857,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',334636);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1797797);" href="https://www.codeproject.com/Messages/1797797/Re-Debug-Interfaces-modified.aspx"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Jeff,<br>
<br>
Thanks for the help on this.  I downloaded the example but the file activdbg.h is missing.<br>
<br>
Cheers,<br>
Tony<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1800857&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1800857&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1715648" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1800857" data-ref="3_1800857" class="rating-label" name="RateItem_1800857"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1800857/Re-Debug-Interfaces.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1800857"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="334636" msgid="1800857"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1801438_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="110px"><a name="xx1801438xx"></a><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1801438" parent="1800857" thread="1715648" href="https://www.codeproject.com/Messages/1801438/Re-Debug-Interfaces-modified.aspx">Re: Debug Interfaces [modified]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">12-Dec-06  16:01</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>12-Dec-06  16:01&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1801438_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:110px;"><span class="voteform vertical" ownerid="88625" msgid="1801438" votingtype="GoodOrBad" done="true"><a href="#xx1801438xx" onclick="return rateItem(5, 1801438,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1801438xx" onclick="return rateItem(1, 1801438,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1800857);" href="https://www.codeproject.com/Messages/1800857/Re-Debug-Interfaces.aspx"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>That's a Microsoft include file.<br>
<br>
Some of the basic Active Scripting include .H files (such as ActivScp.h) are in Microsoft's Platform SDK.<br>
<br>
But, the active script debugging header files (such as ActivDbg.h) are 
packaged in Microsoft's Script Debugger. When you download that, you'll 
find it creates a directory that has those needed .H files in it. You'll
 copy those .H files to where your compiler keeps its include files. So 
yeah, you have to download a totally useless Microsoft utility (Script 
Debugger) just so you can get the needed DLLs (PDM.DLL) and include file
 (ActiveDbg.h) in order to add Active Script debugging to your own 
application.<br>
<br>
Worse, MS doesn't let you distribute PDM.DLL with your own app, so you 
have to tell users of your application that they have to download and 
install this useless Microsoft Script Debugger in order for your 
application's debugging to work on their systems.<br>
<br>
I think it's pretty clear that MS pulled the rug out from under the 
ActiveX Script programmers right before they were ready to finalize 
ActiveX Script Debugging. (And it appears that MS diverted all resources
 to this really buggy, bloated, feature-starved, poorly-documented, slow
 .NET crap). <br>
<br>
<br>
<br>
 -- modified at 0:17 Tuesday 9th October, 2007<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1801438&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1801438&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1715648" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1801438" data-ref="3_1801438" class="rating-label" name="RateItem_1801438"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1801438/Re-Debug-Interfaces-modified.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1801438"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1801438"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4681789_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="92px"><a name="xx4681789xx"></a><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4681789" parent="1797797" thread="1715648" href="https://www.codeproject.com/Messages/4681789/Re-Debug-Interfaces-modified.aspx">Re: Debug Interfaces [modified]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">andi_mihai</span><span class="date">17-Oct-13  7:04</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1100748">andi_mihai</a></span></td><td class="date"><span>17-Oct-13  7:04&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4681789_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:92px;"><span class="voteform vertical" ownerid="1100748" msgid="4681789" votingtype="GoodOrBad" done="true"><a href="#xx4681789xx" onclick="return rateItem(5, 4681789,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1100748);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4681789xx" onclick="return rateItem(1, 4681789,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1100748);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1797797);" href="https://www.codeproject.com/Messages/1797797/Re-Debug-Interfaces-modified.aspx"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Hi Jeff,<br>
<br>
Great articles, any chance you can re-upload the debughost.zip file? the initial link doesn't seem to be working any more<br>
<br>
Thnaks.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=4681789&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=4681789&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1715648" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4681789" data-ref="3_4681789" class="rating-label" name="RateItem_4681789"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4681789/Re-Debug-Interfaces-modified.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4681789"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="1100748" msgid="4681789"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1864213_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx1864213xx"></a><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1864213" parent="1716312" thread="1715648" href="https://www.codeproject.com/Messages/1864213/Re-Debug-Interfaces.aspx">Re: Debug Interfaces</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Garth J Lancaster</span><span class="date">27-Jan-07  8:07</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/icn-pro-16.png" title="Professional" alt="professional" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=12169">Garth J Lancaster</a></span></td><td class="date"><span>27-Jan-07  8:07&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1864213_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="12169" msgid="1864213" votingtype="GoodOrBad" done="true"><a href="#xx1864213xx" onclick="return rateItem(5, 1864213,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',12169);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1864213xx" onclick="return rateItem(1, 1864213,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',12169);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1716312);" href="https://www.codeproject.com/Messages/1716312/Re-Debug-Interfaces-modified.aspx"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Jeff - are you taking requests ?<br>
<br>
item 4) if you could show how to add a collection object - for example, 
if you were using VBScript from ASP you would have a 'responses' 
collection. Ive looked at using AddNamedItem to do it but Im out of my 
depth .. <br>
<br>
cheers, 'G'<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1864213&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1864213&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1715648" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1864213" data-ref="3_1864213" class="rating-label" name="RateItem_1864213"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1864213/Re-Debug-Interfaces.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1864213"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="12169" msgid="1864213"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1672468_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx1672468xx"></a><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1672468" parent="0" thread="1672468" href="https://www.codeproject.com/Messages/1672468/How-to-export-interfaces-without-OleView.aspx">How to export interfaces without OleView</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">markpetryk</span><span class="date">17-Sep-06  22:36</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2912022">markpetryk</a></span></td><td class="date"><span>17-Sep-06  22:36&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1672468_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="2912022" msgid="1672468" votingtype="GoodOrBad" done="true"><a href="#xx1672468xx" onclick="return rateItem(5, 1672468,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',2912022);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1672468xx" onclick="return rateItem(1, 1672468,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',2912022);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hi Jeff,<br>
<br>
Thanks again for the articles.  I've linked to them from qtnode.net and continue my COM research/education.  One question,<br>
<br>
How might I be able to generate an interface file (IDL) when I don't 
have one, or a dll, and the Server is running in an .exe file?  It 
exports its interfaces through IDispach making them available to Visual 
Basic.  I just don't know how to generate my C++ support interface 
support files for my application.<br>
<br>
Sorry if this is a bit off topic - this COM stuff makes my head spin. <br>
<br>
Writing an application without COM is a bit like a christmas garland without the berries!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1672468&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1672468&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1672468" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1672468" data-ref="3_1672468" class="rating-label" name="RateItem_1672468"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1672468/How-to-export-interfaces-without-OleView.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1672468"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="2912022" msgid="1672468"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1797772_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx1797772xx"></a><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1797772" parent="1672468" thread="1672468" href="https://www.codeproject.com/Messages/1797772/Re-How-to-export-interfaces-without-OleView.aspx">Re: How to export interfaces without OleView</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">10-Dec-06  2:27</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>10-Dec-06  2:27&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1797772_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="1797772" votingtype="GoodOrBad" done="true"><a href="#xx1797772xx" onclick="return rateItem(5, 1797772,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1797772xx" onclick="return rateItem(1, 1797772,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1672468);" href="https://www.codeproject.com/Messages/1672468/How-to-export-interfaces-without-OleView.aspx"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>If
 the COM component has a type library, it's not too difficult to create 
an IDL file from it. There should be a registry key under 
HKEY_CLASSES_ROOT/TypeLib indicating where its type library is. Call 
LoadTypeLib() to get its ITypeLib object. Then call the ITypeLib's 
GetTypeInfoType to enumerate the items you want (ie, functions, or 
properties). And for each object in the DLL, you can call the ITypeLib's
 GetTypeInfo to get its ITypeInfo object. You can call the ItypeInfo's 
GetTypeAttr() to determine how many functions are in the object, and 
GetFuncDesc() to get information for each function (one at a time). All 
the info is there, you just need to extract it, and then write out a 
properly formatted IDL file.<br>
<br>
Look for an example of a COM object browser. It will show you how to do 
those above calls to enumerate the info. But actually, it sounds like 
all you need is an object browser to show you what the COM component has
 to offer. I don't know why you'd need an IDL file unless you're 
planning on creating your own version of the COM component.<br><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1797772&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1797772&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1672468" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1797772" data-ref="3_1797772" class="rating-label" name="RateItem_1797772"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1797772/Re-How-to-export-interfaces-without-OleView.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1797772"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1797772"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1616960_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx1616960xx"></a><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1616960" parent="0" thread="1616960" href="https://www.codeproject.com/Messages/1616960/about-the-license-of-translating-the-article.aspx">about  the license of translating the article</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Black.Stone</span><span class="date">9-Aug-06  6:34</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=55612">Black.Stone</a></span></td><td class="date"><span>9-Aug-06  6:34&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1616960_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="55612" msgid="1616960" votingtype="GoodOrBad" done="true"><a href="#xx1616960xx" onclick="return rateItem(5, 1616960,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',55612);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1616960xx" onclick="return rateItem(1, 1616960,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',55612);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">First thanks for your articles,it's very excellent.<br>
I'm a chinese.I would like to translate it into chinese and put it on my msn's space，but i don't know the license about it.<br>
<br>
It is greatly appreciated if you allow me to do. <br>
<br>
<div class="ForumSig">I'm sorry for my poor english!</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1616960&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1616960&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1616960" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1616960" data-ref="3_1616960" class="rating-label" name="RateItem_1616960"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1616960/about-the-license-of-translating-the-article.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1616960"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="55612" msgid="1616960"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1617623_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx1617623xx"></a><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1617623" parent="1616960" thread="1616960" href="https://www.codeproject.com/Messages/1617623/Re-about-the-license-of-translating-the-article.aspx">Re: about  the license of translating the article</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">9-Aug-06  11:47</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>9-Aug-06  11:47&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1617623_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="1617623" votingtype="GoodOrBad" done="true"><a href="#xx1617623xx" onclick="return rateItem(5, 1617623,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1617623xx" onclick="return rateItem(1, 1617623,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1616960);" href="https://www.codeproject.com/Messages/1616960/about-the-license-of-translating-the-article.aspx"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>It's ok with me.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1617623&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1617623&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1616960" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1617623" data-ref="3_1617623" class="rating-label" name="RateItem_1617623"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1617623/Re-about-the-license-of-translating-the-article.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1617623"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1617623"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1618469_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx1618469xx"></a><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1618469" parent="1617623" thread="1616960" href="https://www.codeproject.com/Messages/1618469/Re-about-the-license-of-translating-the-article.aspx">Re: about  the license of translating the article</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Black.Stone</span><span class="date">9-Aug-06  22:06</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=55612">Black.Stone</a></span></td><td class="date"><span>9-Aug-06  22:06&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1618469_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="55612" msgid="1618469" votingtype="GoodOrBad" done="true"><a href="#xx1618469xx" onclick="return rateItem(5, 1618469,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',55612);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1618469xx" onclick="return rateItem(1, 1618469,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',55612);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1617623);" href="https://www.codeproject.com/Messages/1617623/Re-about-the-license-of-translating-the-article.aspx"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Thanks<img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/smiley_smile.gif" alt="Smile | :)" align="top">  <br>
<br>
My windows live spaces is <a href="http://blackstoneex.spaces.live.com/" rel="nofollow noopener">http://blackstoneex.spaces.live.com/</a>[<a href="http://blackstoneex.spaces.live.com/" target="_blank" title="New Window" rel="nofollow noopener">^</a>],I will translate your article  at once and put it on my  spaces.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1618469&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1618469&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1616960" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1618469" data-ref="3_1618469" class="rating-label" name="RateItem_1618469"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1618469/Re-about-the-license-of-translating-the-article.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1618469"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="55612" msgid="1618469"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1793312_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx1793312xx"></a><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1793312" parent="1617623" thread="1616960" href="https://www.codeproject.com/Messages/1793312/Re-about-the-license-of-translating-the-article.aspx">Re: about  the license of translating the article</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Black.Stone</span><span class="date">7-Dec-06  4:08</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=55612">Black.Stone</a></span></td><td class="date"><span>7-Dec-06  4:08&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1793312_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="55612" msgid="1793312" votingtype="GoodOrBad" done="true"><a href="#xx1793312xx" onclick="return rateItem(5, 1793312,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',55612);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1793312xx" onclick="return rateItem(1, 1793312,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',55612);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1617623);" href="https://www.codeproject.com/Messages/1617623/Re-about-the-license-of-translating-the-article.aspx"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I had translated it into chinese.<br>
<br>
Part 1:<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!155.entry" rel="nofollow noopener">http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!155.entry</a>[<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!155.entry" target="_blank" rel="nofollow noopener">^</a>]<br>
<br>
Part 2:<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!170.entry" rel="nofollow noopener">http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!170.entry</a>[<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!170.entry" target="_blank" rel="nofollow noopener">^</a>]<br>
<br>
Part 3:<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!216.entry" rel="nofollow noopener">http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!216.entry</a>[<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!216.entry" target="_blank" rel="nofollow noopener">^</a>]<br>
<br>
Part 4:<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!222.entry" rel="nofollow noopener">http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!222.entry</a>[<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!222.entry" target="_blank" rel="nofollow noopener">^</a>]<br>
<br>
Part 5:<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!224.entry" rel="nofollow noopener">http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!224.entry</a>[<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!224.entry" target="_blank" rel="nofollow noopener">^</a>]<br>
<br>
Part 6:<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!226.entry" rel="nofollow noopener">http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!226.entry</a>[<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!226.entry" target="_blank" rel="nofollow noopener">^</a>]<br>
<br>
Part 7:<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!227.entry" rel="nofollow noopener">http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!227.entry</a>[<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!227.entry" target="_blank" rel="nofollow noopener">^</a>]<br>
<br>
Thanks again!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1793312&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=329935&amp;select=1793312&amp;floc=/Articles/15037/COM-in-plain-C-Part-7&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1616960" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1793312" data-ref="3_1793312" class="rating-label" name="RateItem_1793312"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1793312/Re-about-the-license-of-translating-the-article.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1793312"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="55612" msgid="1793312"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellspacing="0" cellpadding="2px">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 14-Jan-20  11:58 &nbsp; &nbsp; Last Update: 14-Jan-20  12:18</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/15037/COM-in-plain-C-Part-7?fid=329935&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=15"><span class="nav-link selected">1</span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_general.gif" alt="General" width="16px" height="16px" align="top"> General &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_news.gif" alt="News" width="16px" height="16px" align="top"> News &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_idea.gif" alt="Suggestion" width="16px" height="16px" align="top"> Suggestion &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_question.gif" alt="Question" width="16px" height="16px" align="top"> Question &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_bug.gif" alt="Bug" width="16px" height="16px" align="top"> Bug &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_answer.gif" alt="Answer" width="16px" height="16px" align="top"> Answer &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_joke.gif" alt="Joke" width="16px" height="16px" align="top"> Joke &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_kudos.gif" alt="Praise" width="16px" height="16px" align="top"> Praise &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_rant.gif" alt="Rant" width="16px" height="16px" align="top"> Rant &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/msg_admin.gif" alt="Admin" width="16px" height="16px" align="top"> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner">
                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div class="browse-code"><a href="https://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=15037">Browse Code</a></div>
<div><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=15037">View Stats</a></div>
<div><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=15037">Revisions</a></div>
<div><a href="#_comments">Comments (14)</a></div>
<div>Posted 3 Aug 2006</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/VC6" data-id="4">VC6</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Cplusplus" data-id="78">C++</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/C" data-id="80">C</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Visual-Studio" data-id="103">Visual-Studio</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/COM" data-id="130">COM</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>78.8K views</div><div>1.7K downloads</div><div>81 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

                <div id="RHSticky" class="container-article-info-sticky">
        		    

<div class="article-summary">

    
    

</div>

				    <div id="ctl00_SectionSponsor" class="padded-top" style="width:160px;margin:10px auto">
					    <div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/COM" data-country="US" data-showindicator="true" data-tags="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Intermediate,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=160x200&c=708618"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=160x200&c=708618"  width="160px" height="200px" target="_blank"/></a></noscript></div>
				    </div>

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/COM" data-country="US" data-tags="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Intermediate,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=160x600&c=851777"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/COM&sz=160x600&c=851777"  width="160px" height="600px" target="_blank"/></a></noscript></div>
				    </div>

                    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="theme1-background" style="height:2px;margin:5px 0" id="stickyStop"></div>

		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/15037/COM-in-plain-C-Part-7?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2006 by Jeff Glatt<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2020 <br>
                <br>
				Web03 
				2.8.200113.1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="COM%20in%20plain%20C,%20Part%207%20-%20CodeProject_files/DFPAudiencePixel.gif" style="border-width:0px;height:1px;width:1px;">



<script type="text/javascript"> // IMMEDIATE script

var readLaterList

var notificationAlert

var followService_ctl00_ActionLinks_ArticleFollow;

var bookmark_medium_true_false_ = null;

function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(null, 15037,2,1,true,true,0,'LargeStars', null, 88625);
}

function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                        if (!$('#' + containerId).attr('alreadyRequested')){
                            $.ajax({
                                url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId+'&wd=130',
                            })
                            .done(function (data) {
                                $('#' + containerId).html(data);
                                $('#' + loadingId).hide();
                            });

                            $('#' + containerId).attr('alreadyRequested', 'true');
                        }
                    }

document.addEventListener('DOMContentLoaded', function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});
function ChkRtctl00_RateArticle(val) {
}

var followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 329935,
};
var subscriptions_ctl00_MessageBoard;
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	processCodeBlocks.Initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	$('#RHSticky').sticky($('#stickyStop'));
	$('#ctl00_StickyBlock').sticky($('#stickyStop'));
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	readLaterList = new ReadLaterList('ReadLaterListIcon', 'ItemsToRead','/script/Bookmarks/WebServices/BookmarkService.aspx','https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=small',true);
	readLaterList.initialise();
	
	notificationAlert = new NotificationAlert('ctl00_MemberBar_Messages_NotificationCount','Notifications','/script/Membership/Ajax/NotificationList.aspx');
	notificationAlert.initialise();
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar && sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc && !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	followService_ctl00_ActionLinks_ArticleFollow = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_ActionLinks_ArticleFollow.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 2,
	        objectId       : 15037
	    },
	    followButtonId   : 'ctl00_ActionLinks_ArticleFollow_FollowBtn',
	    unfollowButtonId : 'ctl00_ActionLinks_ArticleFollow_UnfollowBtn'
	}, false);
	
	bookmark_medium_true_false_ = new Bookmark('[data-type="bookmark"]','https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=medium',false,true);
	bookmark_medium_true_false_.Initialise();
	
	$('#clear-rate_ctl00_RateArticle_RCD').click(function () {    $('#ctl00_RateArticle_RCD').hide(); return false;});
	
	new starRating('#ctl00_RateArticle_RateItemWrapper', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
	  $('#ctl00_RateArticle_VR').mouseenter(function() {     getVotesHistogram(15037,2   ,'ctl00_RateArticle_HistogramR','ctl00_RateArticle_LoadingR');
	  });
	
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 1,
	        objectId       : 88625
	    },
	    followButtonId   : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn',
	    unfollowButtonId : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn'
	}, false);
	
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : true,
	    allowReporting      : false,
	    allowRating         : true,
	    allowRatingDisplay  : true,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://codeproject.freetls.fastly.net',
	    switchMsgCallback   : null,
	    getVoteFormMethod   : getVoteFormHtml,
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    getRatingUrl        : '/script/Ratings/Ajax/GetRatings.aspx',
	    getRatingRefKey     : 'obrs',
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl(forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	var followService = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	var followAttributeIds = [];
	followService.initAttributeUI(undefined, followAttributeIds);

})
</script>










<style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div></body></html>