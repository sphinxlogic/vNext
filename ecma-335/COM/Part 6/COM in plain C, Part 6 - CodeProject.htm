<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>COM in plain C, Part 6 - CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/Main.css">

    <script type="text/javascript" async="" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/analytics.js"></script><script type="text/javascript" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/jquery.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/article.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/MemberProfilePopup.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/a.js" defer="defer"></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="How to write an ActiveX Script Host in C.">
<meta name="Keywords" content="C++, Windows, Visual-Studio, Dev, COM, Beginner,COM / COM+,Platforms, Frameworks &amp; Libraries,Free source code, tutorials">
<meta name="Author" content="Jeff Glatt">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6">
<meta name="twitter: card" content="summary">
<meta name="twitter: site" content="@CodeProject">
<meta property="og:url" content="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6">
<meta property="og:title" content="COM in plain C, Part 6">
<meta property="og:description" content="How to write an ActiveX Script Host in C.">

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Artificial Intelligence" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=31">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6"
   },
  "headline": "COM in plain C, Part 6",
  "url": "https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6",
  "discussionUrl": "https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6#_comments",
  "isFamilyFriendly": "true",
  "image": "https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "C++,Windows,Visual-Studio,Dev,COM,Beginner",
  "commentCount": "15",
  "editor" : {
    "@type" : "Person",
    "name" : "Smitha Nishant",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=28970"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "How to write an ActiveX Script Host in C.",
  "articleSection": "COM / COM+",
  "author" : [{
      "@type" : "Person",
      "name" : "Jeff Glatt",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=88625"
    }],
  "datePublished": "2006-07-23",
  "dateCreated": "2006-07-23",
  "dateModified": "2006-07-23"
,
  "aggregateRating" : {
    "@type" : "aggregateRating",
    "ratingValue" : 4.89,
    "ratingCount" : 32,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/8/Platforms-Frameworks-Libraries.aspx",
      "name" : "Platforms, Frameworks & Libraries"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/COM/",
      "name" : "COM / COM+"
    }
  }]
}</script>


	<!-- base href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6" -->
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





<!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" type="text/javascript" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': '55e1d411-e955-4cb4-9978-1528f21616a2'});
    </script>


<style type="text/css"></style></head>	

<body class="firefox firefox72">

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">14,417,643 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		<span id="ctl00_MemberBar_ReadLaterList_ReadLaterListDiv" class="tooltip member-message">
	<span id="ReadLaterListIcon" class="readlaterlist-count openable hidden"></span>
	<div class="tooltip-flyout readlaterlist-dropdown">
		<div id="ItemsToRead" class="readlaterlist-list"></div>
	</div>
</span><span id="ctl00_MemberBar_Messages_NotificationDiv" class="tooltip member-message">
	<a id="ctl00_MemberBar_Messages_NotificationCount" title="1 message" class="notification-count openable" href="https://www.codeproject.com/script/Membership/MyNotifications.aspx">1</a>

	<div class="tooltip-flyout notification-dropdown">
		

		<div id="ctl00_MemberBar_Messages_Confirm" class="bold spaced">
            <img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/caution.png" style="width:20px;height:20px;vertical-align:bottom">
            <a id="ctl00_MemberBar_Messages_EmailConfirm" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f14905%2fCOM-in-plain-C-Part-6">Click here to confirm your email address. </a>
		</div>

		
		
		<div id="Notifications" class="notification-list">
			<img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/loading24.gif" alt="loading" style="margin:auto;">
		</div>
		<div class="spaced">
			
		</div>
	</div>
</span><span id="ctl00_MemberBar_TotalPoints" title="Total reputation points"><a class="bold member-rep-box silver" title="Reputation points earned: 832" href="https://www.codeproject.com/script/Reputation/List.aspx?mid=527156">832</a></span><span id="ctl00_MemberBar_CurRat" class="member-links tooltip openable">
				<a id="ctl00_MemberBar_MyProfile" class="me desktop-only tablet-only" dir="ltr" href="https://www.codeproject.com/Members/jon57">jon57</a>
                <a id="ctl00_MemberBar_MyProfileMob" class="me mobile-only" href="https://www.codeproject.com/Members/jon57">☰</a>
                <div class="tooltip-flyout">
					
					<div class="list-item"><a id="ctl00_MemberBar_MySettingsDefault" href="https://www.codeproject.com/script/Membership/Modify.aspx">My Settings</a></div>
					
					<div class="list-item"><a id="ctl00_MemberBar_MyBookmarks" href="https://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2">My Bookmarks</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyArticles" href="https://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=527156">My Articles</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyMessages" href="https://www.codeproject.com/script/Forums/Messages.aspx?fmid=527156">My Messages</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyQuestions" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=questions&amp;mid=527156&amp;showall=True">My Questions</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyAnswers" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=answers&amp;mid=527156&amp;showall=True">My Answers</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyComments" href="https://www.codeproject.com/script/comments/MemberComments.aspx?mid=527156">My Comments</a></div>
					
					
					<div id="ctl00_MemberBar_MyFollowingHolder">
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowing" href="https://www.codeproject.com/script/follow/Edit.aspx">Things I Follow</a></div>
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowers" href="https://www.codeproject.com/script/follow/Followers.aspx">My Followers</a></div>
					</div>
					
        
					<form name="unsubForm" id="unsubForm" action="/script/Membership/LogOff.aspx?rp=%2fArticles%2f14905%2fCOM-in-plain-C-Part-6" method="post" class="tight">
                    <input type="hidden" name="AntiForgeryToken" value="e82756ee-ccd1-43de-910d-7f5dd2636494">
                    <input type="submit" value="Sign out" class="list-item border-none extended align-left" onclick="return doSignout();" style="background-color: transparent; color: #999; cursor:pointer">
                    
                    </form>

                    <script type="text/javascript">//<!--
			        function doSignout()
			        {
    			        document.unsubForm.action = "/script/Membership/LogOff.aspx?rp=%2fArticles%2f14905%2fCOM-in-plain-C-Part-6"
				        document.unsubForm.submit();
				        return true;
			        }//-->
			        </script>
                    
				</div>
			</span>

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/Beginners" data-country="US" data-tags="C++, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=728x90&c=693339"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=728x90&c=693339"  width="728px" height="90px" target="_blank"/></a></noscript></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table class="search" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><input tabindex="2" class="search subdue" id="sb_tb" autocomplete="off" value="Search for articles, questions, tips" name="q"></td><td><input type="image" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		
		
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/write13.png" width="13" height="13"> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="https://www.codeproject.com/script/Articles/ImportArticle.aspx">
			<img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/write13.png" width="13" height="13"> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/write13.png" width="13" height="13"> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">View VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">View ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=93" style="padding-left:30px">View SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues.aspx">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript.aspx">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools.aspx">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift.aspx">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database.aspx">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1942421/Linux-Programming.aspx">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android.aspx">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS.aspx">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1540733/SharePoint.aspx">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development.aspx">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch.aspx">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">stuff</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="https://www.codeproject.com/KB/showcase/">Product Showcase</a></li>
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Contests/Winners.aspx?obtid=1&amp;cmpTpId=2&amp;cid=0">Most Valuable Professionals</a></li>
		

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="https://www.codeproject.com/Forums/1939564/Where-I-am-Member-Photos.aspx">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>
		<li></li>
		

		
		<li class="openable"><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">Non-English Language
			<span class="has-submenu">&gt;</span></a>
		<ul>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		
		</ul>
		</li><li class="last"></li>
		
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> » <a href="https://www.codeproject.com/Chapters/8/Platforms-Frameworks-Libraries.aspx">Platforms, Frameworks &amp; Libraries</a> » <a href="https://www.codeproject.com/KB/COM/">COM / COM+</a> » <a href="https://www.codeproject.com/KB/COM/#Beginners">Beginners</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
                
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    <a id="ctl00_ActionLinks_ArticleFollow_FollowBtn" title="" class="button unfollowed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Have any updates for this Article appear in your Timeline so you can stay up to date" style="display: inline-block;">Follow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have any updates for this Article appear in your Timeline so you can stay up to date</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_ActionLinks_ArticleFollow_UnfollowBtn" title="" class="button followed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Stop following this Article" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Article</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

</div>



<span id="ctl00_ActionLinks_BookmarkMd_bookmark" data-type="bookmark" data-ref="2_14905_1" data-size="medium" data-mode="bookmark"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark48.png" style="width:24px;height:24px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span> 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?display=Print" class="tooltip" title="">
   <img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/print48.png" style="border:0" width="24px" height="24px">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="/Articles/14905/COM-in-plain-C-Part-6" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="SXQJIB1xaPDhlsHdqiBIF/rf8n2ElwDkFUYaMj6DD6Y6tFfEOIAkP8pF9FEJgTj+zAPXANfWe/hf1zTQAL47vN5cTdOIoViPA3fnwtZWXjzVbIVpI5frEF6KmRwufjbvoKjI+80Y3v7+DK4rWOYBwYz5YwPI26a7r/GQPqMqzRjRZF1OmkxhWV7zek+J9P0Tq3q8tmhX0Uy7gCl5PUf8/Xn/uxIshDC0Muj5Pf5XPXKxf0wprgO00Ku1KyqNBSHNhI28oCtl81hIgExjuINj6f/tKBA0T8AWZMZWRUbHwgYN4DoGHNO8sue1xSGYhB0HgiG6dV0aYbwL2deOcNoDUWYdMelIYdf+pOLMlu5aQ9b9CgUL98SSBxE/Tvdvc4h/D4HkqUXlCF/Sf3W2W99wqLzOcCJsw+/hy0Un88ZEby4QScr2CBKdYPuhNQfDUOxJMWun8ZwuioVmGFvNOQ5Vs0YtJ2mx/e8qp6EFGoo7wQjVSf/wzHtI445yNTevB3fQWxcYfs9t5J4jXBSlNreSXbLwsSsbsEVScXJgUqVxOaIlNFeWTbnf2lyKGlLGKcBOgut7MRpiB34q9LhTgIZy2o+6GkmkfvbO/5vuMlY+gKyYbIKhhBS1EZh+eH237hDIBpe0VQXn5InzjwGbcs7eNqdGqDuUwSb+X/MkzNmGPv14Hq5o6Zv5G6VqhBH0m8nO1tJBveSM5jEQYDOTVGsqC5ebcrRPGV/EKzVAlJWd2ip02MPPOC2jbZnhgUnfIuv8qLu9hoCziHRvVH45+WEeUuE9QSjVBed86QAT5uv5a231NhbZkuqbUgXB99aaNnB9WHRqala5Si3DcTvRJJmrsySUAt46Uu9z4jG1faIyfvagYGbD3FuV+ZJQf7U0TCHznk06GrDi6OaSW6gkaZ4HEtHPjcH4OvMB8iiEMeNs6DcSQrgnJBhqKnAAEcrJ4V7JcMjQarIMkn9dgnvIC0/B7BzRIpN/sHfbs7Ogc+QMToqY6sgMET9Xh3FmvdMVJhvZRWknEjWBBAfLrMXEqDpdsMrZSG7XtgFlgtGPEjEWi+qCJZfLa/DtzrohpWJ5MpJVBA88R4CiBUCjzbc14oJTk95mSYhkLSAK+jzw7v3BPP+xqUWVcApfeiTd5P1pjw5ucvJDZPe2Zs0E8qN7uHVVnzldJEesxE9L7q8ydNkRLsugtGSWIWzJ6LSKn6mwRutX2oPNdOlk14groXZ8m9eBmDJrGZgXb4f5sQVbfPVlIszE2zDB86C8cgyikztpyk/6aIH9jkRfFtHJFTfocwKHqZr/I4Yj3D52XNOb/2zVXLgH1EjSO1GuC103RgLLuJS2ZD2ATKro4T1qxkAXjmYscpdP1e1Vw5nZycOx23zAKgKrfaLpe33JxzpZENvTdBQZrZWTAUrnWlWN4pmxc0/vBZon2wazV/T/HBkZ+e2xWlBQg+4vO34N/3CM6ngdWkjAeo889AnNq7D+P8S3DCR7Q8wKSb9lNJCMbmaTTIyV4DyYaW0MJmBu0M30F+E7YwndH0qMqmjGLTkEWj0inECrevcUx/ci3YIUnFGBPHhEYKj/kIFwSr7luODPAFncxDfF9T6Tgu29lhoVmjnXwM8K3z83b9vhEC9pvZHJvjT9RFRfbIpzhHR2S6vqUo8mByg7O/2bsMHdGC2AFT1myXAxpPkv/PKJyda3mgbbP10zp6iSrARIID+xf+RRZqpYaPQR96rdnCsXBt543dAPeBfmQdh6MV2lcucBY6TGByjAB7dsOSkDjokWR/BuLOdPIIcWaXI5qccY+3+E37aK6EDhq6WT2VWlUXqMDzMHzFEoM6MGO6lzodqM39OTmsKHvZnd+DGBpaGku6zt02eRh+Zj3IM+dplqQSwEHYvEXF0rPZLDq/JlPLvFDlwv8V7qzcVl/aijckt9aU4O9XO//oSianwbSYQr6vUsNAEhodCnPs+SwqzMSAk8WgyvpjyHQESIr+LFJJWEUYNJ4l5z+MUu29HsJ+yYfETglo4mo7onExf5we0nt+pqlHg09Gbcy2K8KwoYGYoLOAp4BE2gysNnAUKwBsem35bUwJL6Cv3cO0qFZmBXxGbzSpuq2NNLUdshyxXrq2zjCmoR9m3SXO3B7haOinvG2zgnpxRS7L29Ohm+JRHQRC/FRXsDT/+73s52kzLldo7FBkdTLnwin8vf3DcIyZskbrtk34kWzr6m5HETNHLhVbWiOXLi+zurm/k1dvgoWDHpDMwkmw2CDsgYfmxvtzuF+5+nIzN+aHWaRyAQFJh5NLhN4o/EkrFT1vk2JHN9F9bT8vMsoC1VErdAbSDiEVYcJ3R8U6bOflx8mxc93tw2W0cx9ThI2DLUo2H2l/hiy5IgflavBw6uu7OaPKE/2zaoTN0lvPEzX34agtXBoiIrcOnIGmxEr17FLEFotgabh7yBfLRrHxkO8OJbsBT2cJc=">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">COM in plain C, Part 6</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

                                

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625" rel="author">Jeff Glatt</a></span> 

                                        <div class="flex-item" style="margin-top:-7px;height:35px">
                                            <div id="ctl00_RateArticle_RateItemWrapper" class="container-rating small-text" name="RateItem_14905">

	<table class="small-text" width="100%" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right">
			<span class="align-right"></span>
			<img class="loading invisible" alt="loading..." src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/loading16.gif" width="16px" height="16px"> 
		</td>

	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tbody><tr>
				
				<td id="ctl00_RateArticle_StartForm" nowrap="nowrap" align="right"><b>Rate me!</b> </td>

				<td id="ctl00_RateArticle_VoteFormDiv" class="nowrap tooltip rating-stars-voter-large" style="padding-top:1px">

                    
					

<meta itemprop="upvoteCount" content="31">


<table id="ctl00_RateArticle_ItemRating_RatingTable" style="margin:0 1px;" class="hide-on-hover float-left" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td class="nowrap">

        <div style="width:120px;height:28px;position:relative" class="nowrap rating-stars-large"><div style="width:117px;height:24px;" class="clipped align-left float-left"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/stars-fill-lg.png"></div><div style="width:3px;height:24px;position:relative" class="clipped"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/stars-empty-lg.png" style="position:absolute;top:0;right:0"></div>

		
	</div></td>
		<td id="ctl00_RateArticle_ItemRating_VR" class="nowrap">
		<span id="ctl00_RateArticle_ItemRating_VotesR">4.89  (32 votes)</span>
		
	</td>
	</tr>
</tbody></table>

<span id="ctl00_RateArticle_ItemRating_RatingText"></span>


                    
					<span id="ctl00_RateArticle_RB" class="ajaxHist radio voting show-on-hover" style="display: none;">
						<span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5" style="display: none;"></span> 
					<div class="rating-star-block"><a href="#" rating="1" class="star outline" title="vote 1">vote 1</a><a href="#" rating="2" class="star outline" title="vote 2">vote 2</a><a href="#" rating="3" class="star outline" title="vote 3">vote 3</a><a href="#" rating="4" class="star outline" title="vote 4">vote 4</a><a href="#" rating="5" class="star outline" title="vote 5">vote 5</a></div></span>

                    
					

                    
	                <div id="ctl00_RateArticle_RCD" class="hover-container tooltip-flyout rating-comment" style="top:12px">
		                Add a reason or comment to your vote:
                        <a href="#" id="clear-rate_ctl00_RateArticle_RCD" title="close" class="rating-close">x</a>
                        <br>
                        <textarea class="RateComment" rows="5" cols="60" style="width:96%;"></textarea>
		                <span id="ctl00_RateArticle_CommentReq" class="subdue">Adding a comment to your rating is optional</span>
		            </div>

                    
                        

				</td>

				
                <td id="ctl00_RateArticle_VR" class="nowrap show-on-hover tooltip" style="display: none;">

		            <span id="ctl00_RateArticle_VotesR">4.89  (32 votes)</span>

                    
					<div id="ctl00_RateArticle_histPHR" class="speech-bubble-container-up-right" style="width:175px;margin-top:24px;right:-15px;top:6px">
						<div class="speech-bubble-up-right">
							<div id="ctl00_RateArticle_HistogramR">

</div>
							<img id="ctl00_RateArticle_LoadingR" class="align-middle" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/loading24.gif" style="border-width:0px;">
						</div>
						<div class="speech-bubble-pointer-up-right">
							<div class="speech-bubble-pointer-up-right-inner"></div>
						</div>
					</div>
                </td>


				<td style="padding-left:5px">	
					<input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button" style="display: none;">
				</td>
			</tr>
			</tbody></table>

			
		</td>
	</tr>
	</tbody></table>

</div>
                                        </div>
                                    </div>

                                    <div class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">23 Jul 2006</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_description" class="summary">How to write an ActiveX Script Host in C.</div><span id="ctl00_thumbnailUrl" class="date" content="https://codeproject.global.ssl.fastly.net/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					
					

						
					

					<div id="ctl00_confirmError" class="advise"><img style="float:left;margin-right:10px" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/warning48.png" width="48px" height="48px"><b>Is your email address OK?</b> You are signed up for our 
						newsletters but your email address is either unconfirmed, or has not been 
						reconfirmed in a long time. Please <b>click <a id="ctl00_RequestConfirmLink2" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f14905%2fCOM-in-plain-C-Part-6">here</a> to have a confirmation email
                        sent</b> so we can confirm your email address and start sending you 
                        newsletters again. Alternatively, you can 
						<a id="ctl00_SubscribeLink2" href="https://www.codeproject.com/script/Membership/Subscribe.aspx">update your subscriptions</a>.</div>

						
						<div id="contentdiv" class="text">
						



<ul class="download">
<li><a href="https://www.codeproject.com/KB/COM/com_in_c6/com_in_c6_src.zip">Download source files - 305 Kb</a> </li></ul>
<h2>Contents</h2>
<ul>
<li><a href="#INTRO">Introduction</a> 
</li><li><a href="#GUID">Choosing/opening an engine</a> 
</li><li><a href="#HOST">Our IActiveScriptSite object</a> 
</li><li><a href="#SCRIPT">An example VBScript</a> 
</li><li><a href="#INIT">Initializing the engine</a> 
</li><li><a href="#ADD">Adding a script to the engine</a> 
</li><li><a href="#RUN">Running scripts</a> 
</li><li><a href="#CLOSE">Closing an engine</a> 
</li><li><a href="#LOAD">Loading a script</a> 
</li><li><a href="#ENUM">Enumerating installed engines</a> 
</li><li><a href="#THREAD">Running a script in another thread</a> </li></ul>
<h2><a name="INTRO">Introduction</a></h2>
<p>When creating an application, it's desirable to provide the end user 
with a "macro language" he can use to write scripts (i.e., text files 
containing "instructions" or "commands") which control the operation of 
your application. For example, if you've created an email program, 
perhaps you'd like to let the end user write some script which can send 
an email to a particular address. To do that, perhaps your macro 
language will provide a <code>SendMail</code> function that the script 
calls, passing an email address, and text body, (each double-quoted), 
and the syntax would look like so:</p><div class="pre-action-link" id="premain347922" style="width:100%;display:block;"><span id="prehide347922" onclick="processCodeBlocks.togglePre(347922);">Hide</span>  &nbsp; <span id="copycode347922" onclick="return processCodeBlocks.copyCode(347922);">Copy Code</span></div><pre id="pre347922" style="margin-top: 0px;" class="notranslate">SendMail("somebody@somewhere.com", "hello")</pre>
<p>With a macro language, the end user can write a script to 
automatically perform repetitive operations (hence the term "automation"
 is used to describe a script controlling an application), or perhaps 
even add new functionality to your application (if your macro language 
is powerful/flexible enough).</p>
<p>Microsoft decided to add a macro language to many of its products 
such as Word, Excel, etc. In fact, MS decided to use a simplified 
variation of Visual Basic as the basis for the macro language. So, MS 
put that simplified version of the Visual Basic interpreter (without 
features such as being able to compile a script into an executable, and 
other advanced features) into a DLL. Then, MS put particular COM objects
 inside that DLL which Word or Excel could obtain/use to tell the 
interpreter to run a VB script, and interact with the application's own 
functions. For example, one of the special COM objects is an <code>IActiveScript</code> object. MS called their new, simplified VB-interpreter-in-a-DLL (with a COM interface) <b>VBScript</b>. And the DLL, with that specific set of COM objects, is referred to as an <b>ActiveX Script Engine</b>.</p>
<p>Then, MS got to thinking that it would be nice to give the end user 
his choice of macro language. For example, some end users may want to 
write their scripts using a Java-like language instead of VBScript. So, 
MS also created another DLL containing an interpreter that implemented a
 simplified variation of Java. This interpreter was called <b>JavaScript</b>.
 The JavaScript DLL contained the same set of COM objects as the 
VBScript DLL. MS devised these COM objects so that they were mostly 
"language neutral". In other words, Excel could give the JavaScript DLL a
 JavaScript file to run in the exact same way that Excel could give the 
VBScript DLL a VBScript file to run. So now, the end user had his choice
 of two ActiveX Script Engines to use. Later, other third parties 
packaged their interpreters into a DLL, with these same set of COM 
objects, and now you can find ActiveX Script Engines in a variety of 
other languages such as Python, Perl, etc. And any of them can be used 
with any application that supports any ActiveX Script Engine.</p>
<p>An application that utilizes an ActiveX Script Engine is referred to as an <b>ActiveX Script Host</b>.</p>
<p>In order for an application to interact with the engine, the 
application (EXE) has to have its own, special COM object inside of it 
known as an <code>IActiveScriptSite</code> object. The application calls one of the engine's COM object functions to give it a pointer to the application's <code>IActiveScriptSite</code>
 COM object. Then, the engine and application can communicate, and 
coordinate the running of a script via their COM objects' functions.</p>
<p>This article will detail how to write an ActiveX Script Host -- that 
is, how to write an application (EXE) that can load one of these ActiveX
 Script Engines (DLL), and call the engine's COM objects to run some 
script (text file) containing instructions in that engine's language. In
 our particular example, we'll use the VBScript engine, and so our 
example script file will contain VBScript instructions. But we could 
easily use any other engine, and write our script using that engine's 
language instead.</p>
<blockquote>
<p><b>In conclusion</b>, an ActiveX Script Engine is an interpreter that
 contains some standard COM objects defined by Microsoft. It can be used
 by any application (i.e., executable) that knows how to utilize those 
COM objects. Such an application is called an ActiveX Script Host. A 
properly written host should be able to use any engine interchangeably.</p></blockquote>
<h2><a name="GUID">Choosing/opening</a> an engine</h2>
<p>Every ActiveX script engine must have its own unique GUID. So, if you
 know what particular engine you wish to use, you can pass that engine's
 GUID to the function <code>CoCreateInstance</code> to open that script engine and get its <code>IActiveScript</code> object (just like in the very first chapter, we wrote an application that passed our <code>IExample</code> object's GUID to <code>CoCreateInstance</code> and got an <code>IExample</code> object). You should be able to find the engine's GUID in some include file shipped with the engine's "development kit".</p>
<p>An ActiveX engine can also associate itself with files whose names 
end in a particular extension, just like an application can set a file 
association. The engine's installer will have setup a registry key with 
the associated file extension. For example, the VBScript engine 
associates itself with files whose names end in <i>.vbs</i>. Your 
application can look up the file association in the registry, and get 
the engine's GUID that way. (Then, once you have the GUID, you can call <code>CoCreateInstance</code>).</p>
<p>Here is a function that is passed a file extension, for which you 
wish to get the associated engine's GUID, and a buffer big enough to 
retrieve that GUID. The function looks up the appropriate registry keys 
to find that engine's GUID, and copies it to the buffer:</p><div class="pre-action-link" id="premain70518" style="width:100%;display:block;"><span id="prehide70518" onclick="processCodeBlocks.togglePre(70518);">Hide</span>  &nbsp; <span id="preShrink70518" onclick="processCodeBlocks.shrinkExpand(70518);">Shrink</span> <img id="preimg70518" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(70518);">  &nbsp; <span id="copycode70518" onclick="return processCodeBlocks.copyCode(70518);">Copy Code</span></div><pre id="pre70518" style="margin-top: 0px;" processed="true" class="notranslate">HRESULT getEngineGuid(LPCTSTR extension, GUID *guidBuffer)
{
   wchar_t   buffer[100];
   HKEY      hk;
   DWORD     size;
   HKEY      subKey;
   DWORD     type;

   // See if this file extension is associated
   // with an ActiveX script engine
   if (!RegOpenKeyEx(HKEY_CLASSES_ROOT, extension, 0, 
       KEY_QUERY_VALUE|KEY_READ, &amp;hk))
   {
      type = REG_SZ;
      size = sizeof(buffer);
      size = RegQueryValueEx(hk, 0, 0, &amp;type, 
             (LPBYTE)&amp;buffer[0], &amp;size);
      RegCloseKey(hk);
      if (!size)
      {
         // The engine set an association.
         // We got the Language string in buffer[]. Now
         // we can use it to look up the engine's GUID

         // Open HKEY_CLASSES_ROOT\{LanguageName}
again:   size = sizeof(buffer);
         if (!RegOpenKeyEx(HKEY_CLASSES_ROOT, (LPCTSTR)&amp;buffer[0], 0, 
                           KEY_QUERY_VALUE|KEY_READ, &amp;hk))
         {
            // Read the GUID (in string format)
            // into buffer[] by querying the value of CLSID
            if (!RegOpenKeyEx(hk, "CLSID", 0, 
                KEY_QUERY_VALUE|KEY_READ, &amp;subKey))
            {
               size = RegQueryValueExW(subKey, 0, 0, &amp;type, 
                      (LPBYTE)&amp;buffer[0], &amp;size);
               RegCloseKey(subKey);
            }
            else if (extension)
            {
               // If an error, see if we have a "ScriptEngine"
               // key under here that contains
               // the real language name
               if (!RegOpenKeyEx(hk, "ScriptEngine", 0, 
                   KEY_QUERY_VALUE|KEY_READ, &amp;subKey))
               {
                  size = RegQueryValueEx(subKey, 0, 0, &amp;type, 
                        (LPBYTE)&amp;buffer[0], &amp;size);
                  RegCloseKey(subKey);
                  if (!size)
                  {
                     RegCloseKey(hk);
                     extension = 0;
                     goto again;
                  }
               }
            }
         }

         RegCloseKey(hk);

         if (!size)
         {
            // Convert the GUID string to a GUID
            // and put it in caller's guidBuffer
            if ((size = CLSIDFromString(&amp;buffer[0], guidBuffer)))
               MessageBox(0, "Can't convert engine GUID", 
                          "Error", MB_OK|MB_ICONEXCLAMATION);
            return(size);
         }
      }
   }

   MessageBox(0, "Can't get engine GUID from registry", 
              "Error", MB_OK|MB_ICONEXCLAMATION);
   return(E_FAIL);
}</pre>
<p>So, to look up VBScript's GUID, we can call <code>getEngineGuid</code>, passing the associated file extension of ".vbs" as so:</p><div class="pre-action-link" id="premain152416" style="width:100%;display:block;"><span id="prehide152416" onclick="processCodeBlocks.togglePre(152416);">Hide</span>  &nbsp; <span id="copycode152416" onclick="return processCodeBlocks.copyCode(152416);">Copy Code</span></div><pre id="pre152416" style="margin-top: 0px;" class="notranslate">GUID  guidBuffer;

// Find the script engine to use for files that end with a .VBS extension.
// NOTE: Microsoft's VBscript engine sets up an association in the
// registry for this extension.
getEngineGuid(".vbs", &amp;guidBuffer);</pre>
<p>Now, to load/open the VBScript engine, and get its <code>IActiveScript</code> object (into our variable we'll name <code>activeScript</code>), we can call <code>CoCreateInstance</code>. Note that the <code>IActiveScript</code> object's GUID is defined by Microsoft, using the name <code>IID_IActiveScript</code>, in an include file called <i>activscp.h</i> which can be found in the Platform SDK.</p><div class="pre-action-link" id="premain472826" style="width:100%;display:block;"><span id="prehide472826" onclick="processCodeBlocks.togglePre(472826);">Hide</span>  &nbsp; <span id="copycode472826" onclick="return processCodeBlocks.copyCode(472826);">Copy Code</span></div><pre id="pre472826" style="margin-top: 0px;" class="notranslate">#include &lt;window.h&gt;
#include &lt;objbase.h&gt;
#include &lt;activscp.h&gt;

IActiveScript  *activeScript;

CoCreateInstance(&amp;guidBuffer, 0, CLSCTX_ALL, 
                 &amp;IID_IActiveScript, 
                 (void **)&amp;activeScript);</pre>
<p>We will also need to get another of the engine's COM objects, called an <code>IActiveScriptParse</code> object. This is a sub-object of the <code>IActiveScript</code> object, so we can pass the <code>IActiveScriptParse</code>'s GUID to the <code>IActiveScript</code>'s <code>QueryInterface</code> function. Microsoft has defined <code>IActiveScriptPars</code>e's GUID with the name <code>IID_IActiveScriptParse</code>. Here, we get this object into our variable named <code>activeScriptParse</code>:</p><div class="pre-action-link" id="premain273615" style="width:100%;display:block;"><span id="prehide273615" onclick="processCodeBlocks.togglePre(273615);">Hide</span>  &nbsp; <span id="copycode273615" onclick="return processCodeBlocks.copyCode(273615);">Copy Code</span></div><pre id="pre273615" style="margin-top: 0px;" class="notranslate">IActiveScriptParse  *activeScriptParse;

activeScript-&gt;lpVtbl-&gt;QueryInterface(activeScript, 
             &amp;IID_IActiveScriptParse, 
             (void **)&amp;activeScriptParse);</pre>
<p>
</p><blockquote><b>In conclusion</b>, each ActiveX Script Engine has its own unique GUID. A host can open an engine (and get the engine's <code>IActiveScript</code> and <code>IActiveScriptParse</code> objects) in the same way that any other COM component is accessed -- by passing that unique GUID to <code>CoCreateInstance</code>.
 Furthermore, an engine may be associated with a particular file 
extension, so an engine's GUID can be "looked up" by querying the file 
extension's registry key.</blockquote>
<p></p>
<h2><a name="HOST">Our</a> IActiveScriptSite object</h2>
<p>We need to supply our own COM object called an <code>IActiveScriptSite</code> object. Microsoft has already defined its GUID and VTable (i.e., an <code>IActiveScriptSiteVtbl</code> struct) for us. All we need to do is write the functions for it. Of course, an <code>IActiveScriptSite</code> VTable starts with the <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code> functions. It contains 8 more functions called <code>GetLCID</code>, <code>GetItemInfo</code>, <code>GetDocVersionString</code>, <code>OnScriptTerminate</code>, <code>OnStateChange</code>, <code>OnScriptError</code>, <code>OnEnterScript</code>, and <code>OnLeaveScript</code>. Most of these functions are called by the engine when it wants to notify us of something. For example, our <code>OnEnterScript</code> function is called whenever some function in the script is called. Our <code>OnScriptError</code>
 is called when/if there's an error in the script itself. Other 
functions are meant for us to provide information to the engine. For 
example, the engine calls our <code>GetLCID</code> to ask us what language LCID to use for any dialogs the engine may display.</p>
<p>For now, most of our <code>IActiveScriptSite</code> functions can be stub routines that do nothing except return <code>S_OK</code>.</p>
<p>We'll also provide another sub-object of our <code>IActiveScriptSite</code>. This sub-object is referred to as <code>IActiveScriptSiteWindow</code>.
 This sub-object is used by the engine to interact with any application 
windows we may have open. This is an optional object. We don't need to 
provide it, but if our application opens its own windows, then this is a
 useful object to provide.</p>
<p>Because we'll need an <code>IActiveScriptSiteWindow</code> sub-object, we'll define a <code>MyRealIActiveScriptSite</code> struct to wrap both our <code>IActiveScriptSite</code> and <code>IActiveScriptSiteWindow</code>, as so:</p><div class="pre-action-link" id="premain73426" style="width:100%;display:block;"><span id="prehide73426" onclick="processCodeBlocks.togglePre(73426);">Hide</span>  &nbsp; <span id="copycode73426" onclick="return processCodeBlocks.copyCode(73426);">Copy Code</span></div><pre id="pre73426" style="margin-top: 0px;" class="notranslate">typedef struct {
   // The IActiveScriptSite must be the base object.
   IActiveScriptSite        site;
   IActiveScriptSiteWindow  siteWnd;
   // Our IActiveScriptSiteWindow sub-object
   // for this IActiveScriptSite.
} MyRealIActiveScriptSite;</pre>
<p>For our purposes, we're going to need only one <code>IActiveScriptSite</code> (and its <code>IActiveScriptSiteWindow</code>), so the easiest thing is to just declare it globally, and also declare the VTables globally:</p><div class="pre-action-link" id="premain198947" style="width:100%;display:block;"><span id="prehide198947" onclick="processCodeBlocks.togglePre(198947);">Hide</span>  &nbsp; <span id="copycode198947" onclick="return processCodeBlocks.copyCode(198947);">Copy Code</span></div><pre id="pre198947" style="margin-top: 0px;" class="notranslate">// Our IActiveScriptSite VTable.
IActiveScriptSiteVtbl SiteTable = {
 QueryInterface,
 AddRef,
 Release,
 GetLCID,
 GetItemInfo,
 GetDocVersionString,
 OnScriptTerminate,
 OnStateChange,
 OnScriptError,
 OnEnterScript,
 OnLeaveScript};

// IActiveScriptSiteWindow VTable.
IActiveScriptSiteWindowVtbl SiteWindowTable = {
 siteWnd_QueryInterface,
 siteWnd_AddRef,
 siteWnd_Release,
 GetSiteWindow,
 EnableModeless};

// Here's our IActiveScript and its IActiveScriptSite sub-object, wrapped
// in our MyRealIActiveScriptSite struct.
MyRealIActiveScriptSite  MyActiveScriptSite;</pre>
<p>And of course, we need to initialize its VTable pointers at the start of our program:</p><div class="pre-action-link" id="premain257594" style="width:100%;display:block;"><span id="prehide257594" onclick="processCodeBlocks.togglePre(257594);">Hide</span>  &nbsp; <span id="copycode257594" onclick="return processCodeBlocks.copyCode(257594);">Copy Code</span></div><pre id="pre257594" style="margin-top: 0px;" class="notranslate">// Initialize the lpVtbl members of our IActiveScriptSite and
// IActiveScriptSiteWindow sub-objects
MyActiveScriptSite.site.lpVtbl = &amp;SiteTable;
MyActiveScriptSite.siteWnd.lpVtbl = &amp;SiteWindowTable;</pre>
<p>In the directory <i>ScriptHost</i>, is an example of a simple ActiveX Script Host. The source file, <i>IActiveScriptSite.c</i>, contains the VTables and functions for our <code>IActiveScriptSite</code> and <code>IActiveScriptSiteWindow</code> objects (which are wrapped up in our own <code>MyRealIActiveScriptSite</code>
 struct). As mentioned in this example, most of the functions are simply
 stub routines that do nothing. The only non-trivial function is <code>OnScriptError</code>. The engine calls our <code>OnScriptError</code>
 function if there is a syntax error in the script (i.e., the script 
itself is written/formatted incorrectly), or there's a runtime error in 
the script (for example, the engine runs out of memory while executing 
the script).</p>
<p>The engine passes one of its own COM objects called an <code>IActiveScriptError</code>.
 This object has functions we can call to get information about the 
error, such as the line number in the script where the error occurred, 
and a text message that describes the error. (Note: The line number is 
referenced from 0, so the first line in the script is line number 0.)</p>
<p>All we do is call some <code>IActiveScriptError</code> functions to get some information, reformat it, and display it to the user in a message box.</p><div class="pre-action-link" id="premain655345" style="width:100%;display:block;"><span id="prehide655345" onclick="processCodeBlocks.togglePre(655345);">Hide</span>  &nbsp; <span id="preShrink655345" onclick="processCodeBlocks.shrinkExpand(655345);">Shrink</span> <img id="preimg655345" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(655345);">  &nbsp; <span id="copycode655345" onclick="return processCodeBlocks.copyCode(655345);">Copy Code</span></div><pre id="pre655345" style="margin-top: 0px;" processed="true" class="notranslate">STDMETHODIMP OnScriptError(MyRealIActiveScriptSite *this, 
             IActiveScriptError *scriptError)
{
   ULONG        lineNumber;
   BSTR         desc;
   EXCEPINFO    ei;
   OLECHAR      wszOutput[1024];

   // Call GetSourcePosition() to retrieve the line # where
   // the error occurred in the script
   scriptError-&gt;lpVtbl-&gt;GetSourcePosition(scriptError, 0, &amp;lineNumber, 0);

   // Call GetSourceLineText() to retrieve the line in the script that
   // has an error.
   desc = 0;
   scriptError-&gt;lpVtbl-&gt;GetSourceLineText(scriptError, &amp;desc);

   // Call GetExceptionInfo() to fill in our EXCEPINFO struct with more
   // information.
   ZeroMemory(&amp;ei, sizeof(EXCEPINFO));
   scriptError-&gt;lpVtbl-&gt;GetExceptionInfo(scriptError, &amp;ei);

   // Format the message we'll display to the user
   wsprintfW(&amp;wszOutput[0], L"%s\nLine %u: %s\n%s", ei.bstrSource,
      lineNumber + 1, ei.bstrDescription, desc ? desc : "");

   // Free what we got from the IActiveScriptError functions
   SysFreeString(desc);
   SysFreeString(ei.bstrSource);
   SysFreeString(ei.bstrDescription);
   SysFreeString(ei.bstrHelpFile);

   // Display the message
   MessageBoxW(0, &amp;wszOutput[0], "Error", 
               MB_SETFOREGROUND|MB_OK|MB_ICONEXCLAMATION);
 
   return(S_OK);
}</pre>
<p>Note that the <code>IActiveScriptError</code> object is good only for the lifetime of our <code>OnScriptError</code> function. In other words, when our <code>OnScriptError</code> returns, that particular <code>IActiveScriptError</code> object disappears (unless we explicitly <code>AddRef</code> it). Also note that the <code>IActiveScriptError</code>'s functions return copies of any information we request, so we have to eventually free any <code>BSTR</code>s it returns to us.</p>
<p>
</p><blockquote><b>In conclusion</b>, a Script Host must provide a standard COM object called an <code>IActiveScriptSite</code>. It may also optionally provide an <code>IActiveScriptSiteWindow</code>, which is a sub-object of the <code>IActiveScriptSite</code>. In a minimal implementation, the functions can simply be stub functions that do nothing. But, the <code>OnScriptError</code> function is typically used to inform the user of any error that occurs in the script.</blockquote>
<p></p>
<h2><a name="SCRIPT">An</a> example VBScript</h2>
<p>Let's run the following VBScript, which simply displays a message box with the text "Hello world":</p><div class="pre-action-link" id="premain819416" style="width:100%;display:block;"><span id="prehide819416" onclick="processCodeBlocks.togglePre(819416);">Hide</span>  &nbsp; <span id="copycode819416" onclick="return processCodeBlocks.copyCode(819416);">Copy Code</span></div><pre id="pre819416" style="margin-top: 0px;" class="notranslate" lang="vbscript">MsgBox <span class="code-string">"</span><span class="code-string">Hello world"</span></pre>
<p>To make it easy, we'll simply embed this script as a string right inside of our executable, as global data declared like so:</p><div class="pre-action-link" id="premain889115" style="width:100%;display:block;"><span id="prehide889115" onclick="processCodeBlocks.togglePre(889115);">Hide</span>  &nbsp; <span id="copycode889115" onclick="return processCodeBlocks.copyCode(889115);">Copy Code</span></div><pre id="pre889115" style="margin-top: 0px;" class="notranslate">wchar_t VBscript[] = L"MsgBox \"Hello world\"";</pre>
<p>There is one important thing to note. I've declared this string a 
wide (UNICODE) data type, and initialized it as so (i.e., the datatype <code>wchar_t</code> indicates wide characters, and the <b>L</b>
 qualifier on the string also indicates as much). All script engine 
functions expect wide character strings. So, when we give the VBScript 
engine our script to run, it must be in UNICODE format, even if our 
executable itself isn't internally using UNICODE.</p>
<h2><a name="INIT">Initializing</a> the engine</h2>
<p>Before we can run our script, we first have to open the engine and get its <code>IActiveScript</code> object (via <code>CoCreateInstance</code>) and its <code>IActiveScriptParse</code> sub-object, as shown earlier.</p>
<p>When an engine is first open, it is in the <i>unitialized state</i>. 
Before we can give the engine any scripts to run, we must initialize the
 engine (once only). This merely involves a call to the engine <code>IActiveScriptParse</code>'s <code>Init</code> function.</p>
<p>Furthermore, we need to give the engine a pointer to our <code>IActiveScriptSite</code> object. Again, we need to do this once only. This merely involves a call to the engine <code>IActiveScript</code>'s <code>SetScriptSite</code> function, passing a pointer to our <code>IActiveScriptSite</code> (which is embedded at the start of our <code>MyRealIActiveScriptSite</code>, so a simple cast does the trick).</p>
<p>Here then, are the two calls we need to do once only after the engine is opened:</p><div class="pre-action-link" id="premain126700" style="width:100%;display:block;"><span id="prehide126700" onclick="processCodeBlocks.togglePre(126700);">Hide</span>  &nbsp; <span id="copycode126700" onclick="return processCodeBlocks.copyCode(126700);">Copy Code</span></div><pre id="pre126700" style="margin-top: 0px;" class="notranslate">// Let the engine do any initialization it needs to do.
activeScriptParse-&gt;lpVtbl-&gt;InitNew(activeScriptParse);

// Give the engine our IActiveScriptSite object.
activeScript-&gt;lpVtbl-&gt;SetScriptSite(activeScript,
     (IActiveScriptSite *)&amp;MyActiveScriptSite);</pre>
<p>After the above two calls, the engine will automatically switch to the <i>initialized state</i>. It is now ready for us to add scripts to the engine.</p>
<p><b>Note:</b> The engine's <code>SetScriptSite</code> function may call our <code>IActiveScriptSite</code>'s <code>QueryInterface</code> to ask us to return several sub-objects. For example, perhaps, we'll be asked to return a pointer to our <code>IActiveScriptSiteWindow</code> sub-object. When we call <code>SetScriptSite</code>,
 we should be prepared to provide any requested sub-objects. If we need 
to do any pre-initialization of our own COM objects, we should do that <b>before</b> calling <code>SetScriptSite</code>.</p>
<p>
</p><blockquote><b>In conclusion</b>, before running any scripts, the host must call an engine's <code>Init</code> and <code>SetScriptSite</code> functions, to initialize the engine, and to give a pointer to the host's <code>IActiveScriptSite</code> object, respectively. This should be done once only, after the engine is opened.</blockquote>
<p></p>
<h2><a name="ADD">Adding</a> a script to the engine</h2>
<p>In order to run a script, we first need to give that script to the 
engine. We do this by passing a memory buffer, containing the script, to
 the engine <code>IActiveScriptParse</code>'s <code>ParseScriptText</code>
 function. Remember that the script must be in wide-character format. It
 must also be null-terminated. Since our VBScript is already in a memory
 buffer (i.e., it's a global variable inside of our executable, declared
 as <code>wchar_t</code> and null-terminated), all we need to do is pass the address of that global, as so:</p><div class="pre-action-link" id="premain277553" style="width:100%;display:block;"><span id="prehide277553" onclick="processCodeBlocks.togglePre(277553);">Hide</span>  &nbsp; <span id="copycode277553" onclick="return processCodeBlocks.copyCode(277553);">Copy Code</span></div><pre id="pre277553" style="margin-top: 0px;" class="notranslate">activeScriptParse-&gt;lpVtbl-&gt;ParseScriptText(activeScriptParse, 
                   &amp;VBscript[0], 0, 0, 0, 0, 0, 0, 0, 0);</pre>
<p><code>ParseScriptText</code> takes a lot of other arguments, but for our purposes here, we can leave them all set to 0.</p>
<p>So, what happens when we call <code>ParseScriptText</code>? First of 
all, the engine checks the syntax of the script to ensure that it is a 
correctly written script. Here, the VB engine makes sure that our script
 contains legal VB instructions. If there's a syntax error, the engine's
 <code>ParseScriptText</code> will call our <code>IActiveScriptSite</code>'s <code>OnHandleError</code>. The engine will not internally add the script, and (after our <code>OnHandleError</code> function returns) <code>ParseScriptText</code> will return an error (non-zero) value.</p>
<p>If the script is syntactically correct, then the engine makes its own
 copy of our script, perhaps reformatting it into some internal 
structures of its own choosing, in preparation of running the script. 
But the engine does not run the script at this point, because the engine
 is still in its initialized state. An engine will not run any script we
 add to the engine until we put the engine into either its <i>start</i> or <i>connected</i> states.</p>
<p>If all goes well, <code>ParseScriptText</code> returns 0 for success.
 The engine now has its own internally formatted version of our script, 
prepared for running. (At this point, if we had allocated the buffer 
containing the script, we could free it now if desired.)</p>
<p>
</p><blockquote><b>In conclusion</b>, in order for a script to be run, 
the host must first pass a memory buffer containing the script 
(formatted in wide characters, and null-terminated) to the engine's <code>ParseScriptText</code>
 function. This causes the engine to make its own copy of the script in 
preparation of running the script. But the script does not run while the
 engine is still in its initialized state.</blockquote>
<p></p>
<h2><a name="RUN">Running</a> scripts</h2>
<p>To run our VBScript, we simply need to switch the engine to either its <i>start</i> or <i>connected</i>
 state. We'll later discuss the differences between the two states, but 
for now, we'll simply switch to the connected state. We change the 
engine's state by calling its <code>IActiveScript</code>'s <code>SetScriptState</code>, passing the desired state, which here is the constant <code>SCRIPTSTATE_CONNECTED</code> (defined in MS' <i>activscp.h</i> include file).</p><div class="pre-action-link" id="premain318024" style="width:100%;display:block;"><span id="prehide318024" onclick="processCodeBlocks.togglePre(318024);">Hide</span>  &nbsp; <span id="copycode318024" onclick="return processCodeBlocks.copyCode(318024);">Copy Code</span></div><pre id="pre318024" style="margin-top: 0px;" class="notranslate">activeScript-&gt;lpVtbl-&gt;SetScriptState(activeScript, SCRIPTSTATE_CONNECTED);</pre>
<p>As soon as we make this call, the engine starts executing any <i>immediate instructions</i>
 in the script. What is an immediate instruction? That depends upon the 
language. In VBScript, immediate instructions are any instructions at 
the start of the script which are not enclosed in some 
subroutine/function. Since our example script contains one instruction 
which happens to fit that description, that instruction is immediately 
executed. We should see a message box pop up with the string "Hello 
World".</p>
<p><code>SetScriptState</code> will not return until all of those 
immediate instructions are done. In this case, it won't return until we 
dismiss that message box. And since that's the last immediate 
instruction in our VBScript, <code>SetScriptState</code> returns. At this point, we don't have any further use for the script nor the engine, so we can close down the engine.</p>
<h2><a name="CLOSE">Closing</a> an engine</h2>
<p>To close an engine, we simply call its <code>IActiveScript</code>'s <code>Close</code> function, as so:</p><div class="pre-action-link" id="premain676320" style="width:100%;display:block;"><span id="prehide676320" onclick="processCodeBlocks.togglePre(676320);">Hide</span>  &nbsp; <span id="copycode676320" onclick="return processCodeBlocks.copyCode(676320);">Copy Code</span></div><pre id="pre676320" style="margin-top: 0px;" class="notranslate">activeScript-&gt;lpVtbl-&gt;Close(activeScript);</pre>
<p>This should cause the engine to stop any running scripts, free any 
internal resources that are no longer needed, and switch to the <i>closed</i> state. It should call our <code>IActiveScriptSite</code>'s <code>Release</code> function, and free anything that it obtained from us (such as freeing the copy it made of our script).</p>
<p>After <code>Close</code> returns, we can then call the engine <code>IActiveScriptParse</code>'s and <code>IActiveScript</code>'s <code>Release</code> functions, like so:</p><div class="pre-action-link" id="premain999116" style="width:100%;display:block;"><span id="prehide999116" onclick="processCodeBlocks.togglePre(999116);">Hide</span>  &nbsp; <span id="copycode999116" onclick="return processCodeBlocks.copyCode(999116);">Copy Code</span></div><pre id="pre999116" style="margin-top: 0px;" class="notranslate">activeScript-&gt;lpVtbl-&gt;Release(activeScript);
activeScript-&gt;lpVtbl-&gt;Release(activeScript);</pre>
<p>We're now done with the engine.</p>
<h2><a name="LOAD">Loading</a> a script</h2>
<p>Of course, our script language wouldn't be much use to an end user if
 he couldn't write his own scripts to run. So, instead of hard-coding a 
VBScript inside of our executable, let's present a file dialog to the 
end user so he can pick out a VBScript on disk. Then, we'll load the 
script into a memory buffer, making sure that the script is in wide 
character format and null-terminated, and pass that memory buffer to <code>ParseScriptText</code>.</p>
<p>I won't bother discussing how to present a file dialog to the end user to get his choice of filename.</p>
<p>After the user chooses the filename, we'll pass it to a function called <code>loadUnicodeScript</code>, which returns a memory buffer containing the script, formatted in wide characters and null-terminated.</p><div class="pre-action-link" id="premain886764" style="width:100%;display:block;"><span id="prehide886764" onclick="processCodeBlocks.togglePre(886764);">Hide</span>  &nbsp; <span id="preShrink886764" onclick="processCodeBlocks.shrinkExpand(886764);">Shrink</span> <img id="preimg886764" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(886764);">  &nbsp; <span id="copycode886764" onclick="return processCodeBlocks.copyCode(886764);">Copy Code</span></div><pre id="pre886764" style="margin-top: 0px;" processed="true" class="notranslate">OLECHAR * loadUnicodeScript(LPCTSTR fn)
{
   OLECHAR  *script;
   HANDLE   hfile;

   // Assume an error
   script = 0;

   // Open the file
   if ((hfile = CreateFile(fn, GENERIC_READ, FILE_SHARE_READ, 0, 
        OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, 0)) != INVALID_HANDLE_VALUE)
   {
      DWORD  filesize;
      char   *psz;

      // Get a buffer to read in the file, with room to nul-terminate
      filesize = GetFileSize(hfile, 0);
      if ((psz = (char *)GlobalAlloc(GMEM_FIXED, filesize + 1)))
      {
         DWORD  read;

         // Read in the file
         ReadFile(hfile, psz, filesize, &amp;read, 0);

         // Get a buffer to convert to UNICODE, plus an extra wchar_t
         // to nul-terminate it
         if ((script = (OLECHAR *)GlobalAlloc(GMEM_FIXED, (filesize + 1)
             * sizeof(OLECHAR))))
         {
            // Convert to UNICODE and nul-terminate
            MultiByteToWideChar(CP_ACP, 0, psz, filesize, script, filesize + 1);
            script[filesize] = 0;
         }
         else
            display_sys_error(0);

         GlobalFree(psz);
      }
      else
          display_sys_error(0);

      CloseHandle(hfile);
   }
   else
      display_sys_error(0);

   return(script);
}

void display_sys_error(DWORD err)
{
   TCHAR   buffer[160];

   if (!err) err = GetLastError();
   buffer[0] = 0;
   FormatMessage(FORMAT_MESSAGE_FROM_SYSTEM, 0, err,
      MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), &amp;buffer[0], 160, 0);
   MessageBox(0, &amp;buffer[0], "Error", MB_OK);
}</pre>
<p><b>Note:</b> <code>loadUnicodeScript</code> assumes that the file on 
disk is not Unicode. If there's a chance that you may be loading a disk 
file that is already in Unicode format, then you shouldn't convert it 
again. In this case, <code>loadUnicodeScript</code> will need to be 
modified to check any "signature" in the file. Consult other 
documentation for more information about different text file encoding.</p>
<p>We can make minor changes to our code to run the script. We simply call <code>loadUnicodeScript</code> to load the disk script into a memory buffer, and pass this buffer to <code>ParseScriptText</code>. Afterwards, we can free the buffer, and change the engine's state to <i>connected</i>, to run the script:</p><div class="pre-action-link" id="premain15279" style="width:100%;display:block;"><span id="prehide15279" onclick="processCodeBlocks.togglePre(15279);">Hide</span>  &nbsp; <span id="copycode15279" onclick="return processCodeBlocks.copyCode(15279);">Copy Code</span></div><pre id="pre15279" style="margin-top: 0px;" class="notranslate">LPOLESTR   str;

// Load the script from disk.
str = loadUnicodeScript(fn);

// Have the script engine parse it and internally prepare it to be run.
hr = activeScriptParse-&gt;lpVtbl-&gt;ParseScriptText(activeScriptParse, str,
    0, 0, 0, 0, 0, 0, 0, 0);

// We no longer need the loaded script.
GlobalFree(str);

// Execute the script's immediate instructions.
activeScript-&gt;lpVtbl-&gt;SetScriptState(activeScript, SCRIPTSTATE_CONNECTED);</pre>
<h2><a name="ENUM">Enumerating</a> installed engines</h2>
<p>When the user picks out a script to run, we don't want to assume that
 it will be a VBScript. Perhaps it will be a Jscript, or a script 
associated with a Python engine, etc.</p>
<p>What we'll do is take the filename he picked, isolate the file extension on the name, and pass that extension to <code>getEngineGuid</code>. That will give us the GUID for the appropriate engine we need to open.</p>
<p>But what happens if the filename has no extension, or it has an 
extension that isn't associated with any installed script engine? In 
this case, we'll need to present the end user with a list of installed 
ActiveX Script Engines, and let him manually choose the engine he wants.
 Then, we'll get the GUID of that chosen engine, and open it.</p>
<p>Microsoft's OLE functions provide COM objects we can obtain and use 
to get a list of installed engines and their GUIDs. The COM object we 
need to obtain is known as an <code>ICatInformation</code>, and in particular, we want the <code>ICatInformation</code> object that lists script engines. We can obtain one of these objects by calling <code>CoCreateInstance</code>. We can then call its <code>EnumClassesOfCategories</code> to get a sub-object whose <code>Next</code> function enumerates the script engine GUIDs. We further can call <code>ProgIDFromCLSID</code> to get each engine's name (as registered by the engine's installer).</p>
<p>In the directory <i>ScriptHost2</i> is an example of a windowed (GUI)
 C application that presents a window with a "Run script" menu item. 
When the user selects this menu item, a file dialog is presented to get 
the name of the script to run. After picking the script name, the 
application isolates the extension, and tries to lookup the engine GUID 
associated with this extension. If no such engine is found, then the 
application presents a dialog box listing the installed engines so the 
user can pick the desired engine to use.</p>
<p>The source file <i>ChooseEngine.c</i> contains the code for presenting the list of installed engines and getting the GUID of the chosen engine.</p>
<h2><a name="THREAD">Running</a> a script in another thread</h2>
<p>There is one problem with our GUI app. The script runs in the same 
thread as our user interface. The disadvantage of this is that, if the 
script were to do some never-ending loop, we'd be stuck in that call to <code>SetScriptState</code>
 forever, with no way for the user to abort the script. Indeed, the user
 interface is totally tied up while the script is running, so the user 
can't even move our application window.</p>
<p>For this reason, it is best to launch a separate thread to run a 
script. But there's one big caveat. Most of the engine's COM functions 
can be called only by the thread that calls <code>SetScriptSite</code>. 
So, we need to let our "script thread" do most of the 
setup/initialization and cleanup involved in running a script. Another 
caveat is that our <code>IActiveScriptSite</code> functions will be called within our script thread, so if we have any data that is accessed by both our <code>IActiveScriptSite</code>
 functions and UI thread functions, we'll need some sort of 
synchronization, such as a critical section around any access to that 
data.</p>
<p>In the directory <i>ScriptHost3</i> is a modified version of <b>ScriptHost2</b> which runs the script in a secondary thread. Essentially, what we've done is turn our function <code>runScript</code> into the entry point of a second thread. Not too much alteration is necessary because <code>runScript</code>
 already does all the initialization and cleanup that would need to be 
done by the script thread. Most of the alteration concerns thread 
initialization and cleanup. First of all, the Windows operating system 
specifies that a thread can be passed only a single parameter (of our 
own choosing). But our <code>runScript</code> takes two arguments -- a 
filename, and a GUID. We need to define a new, single struct that wraps 
both of these. We'll call it a <code>MYARGS</code> struct, and define it as so:</p><div class="pre-action-link" id="premain973960" style="width:100%;display:block;"><span id="prehide973960" onclick="processCodeBlocks.togglePre(973960);">Hide</span>  &nbsp; <span id="copycode973960" onclick="return processCodeBlocks.copyCode(973960);">Copy Code</span></div><pre id="pre973960" style="margin-top: 0px;" class="notranslate">typedef struct {
   IActiveScript  *EngineActiveScript;
   HANDLE         ThreadHandle;
   TCHAR          Filename[MAX_PATH];
   GUID           Guid;
} MYARGS;</pre>
<p>Then, we'll pass <code>runScript</code> a pointer to our <code>MYARGS</code>.</p>
<p><code>MYARGS</code> has two extra members. <code>ThreadHandle</code> stores a handle to the script thread. We'll also let the script thread store the engine's <code>IActiveScript</code> object pointer in our <code>MYARGS</code>. This is so that the main thread can also gain access to it later.</p>
<p>Since we're going to launch only one script at a time, we'll declare a global <code>MYARGS</code>:</p><div class="pre-action-link" id="premain594781" style="width:100%;display:block;"><span id="prehide594781" onclick="processCodeBlocks.togglePre(594781);">Hide</span>  &nbsp; <span id="copycode594781" onclick="return processCodeBlocks.copyCode(594781);">Copy Code</span></div><pre id="pre594781" style="margin-top: 0px;" class="notranslate">MYARGS MyArgs;</pre>
<p>Our main thread initializes its <code>ThreadHandle</code> member to 0 at the start of our app. We use this member to determine whether the script thread is running. When <code>ThreadHandle</code> is 0, the script thread isn't running. When not 0, it is the handle to the running script thread.</p>
<p><code>runScript</code> needs to call <code>CoInitialize</code> once the thread starts. Each thread is responsible for initializing COM for itself. And of course, <code>runScript</code> must call <code>CoUninitialize</code> when done. Furthermore, we're going to change our main thread's call from <code>CoInitialize</code> to <code>CoInitializeEx</code> and pass the value <code>COINIT_MULTITHREADED</code>. This ensures that, if our main thread calls any <code>IActiveScript</code>
 function, then the engine won't block our main thread and force the 
function to be executed in our script thread. This is very important 
when we want our main thread to abort our script thread via <code>InterruptScriptThread</code>. We don't want to trust the script thread to abort itself, which it wouldn't be able to do if it was "hung".</p>
<p><b>Note:</b> In order for the compiler to recognize <code>CoInitializeEx</code>, you must <code>#define</code> the symbol <code>_WIN32_WINNT</code> to be 0x0400 (or greater), and this must be done before you <code>#include objbase.h</code>.</p>
<p>When our main (UI) thread handles the <code>IDM_FILE_RUNSCRIPT</code> message, it fills in <code>MYARG</code>'s
 filename and GUID fields with the name of the script to run and the 
GUID of the engine to use. Then, our main thread creates/launches the 
script thread with a call to <code>CreateThread</code>, passing our <code>MYARGS</code>, as so:</p><div class="pre-action-link" id="premain734829" style="width:100%;display:block;"><span id="prehide734829" onclick="processCodeBlocks.togglePre(734829);">Hide</span>  &nbsp; <span id="copycode734829" onclick="return processCodeBlocks.copyCode(734829);">Copy Code</span></div><pre id="pre734829" style="margin-top: 0px;" class="notranslate">MyArgs.ThreadHandle = CreateThread(0, 0, runScript, &amp;MyArgs, 0, &amp;wParam);</pre>
<p><b>Note:</b> If your script thread, or your <code>IActiveScriptSite</code> functions, call any C language functions, then use <code>beginthread</code>
 instead. And check your C/C++ "Code Generation" settings to be sure you
 use a multi-threaded C library. In my example code, I do not call any C
 library functions that are sensitive to multi-threading, so I can use <code>CreateThread</code>.</p>
<p>Note that we save the handle of the thread in <code>MYARGS</code>'s <code>ThreadHandle</code>. If the script thread launched OK, this is now non-zero. When our script thread terminates, it will reset <code>ThreadHandle</code> to 0.</p>
<p>There are two more matters to discuss related to what to do if the 
script thread has a problem running the script, and also what to do if 
our main thread needs to abort the script thread.</p>
<p>To make it easier for our main thread to cleanly abort any script, our script thread (and our <code>IActiveScriptSite</code>
 functions) should avoid doing anything that would cause the thread to 
"pause" or "wait for something". One example would be calling <code>MessageBox</code>. <code>MessageBox</code> causes a thread to wait until the user dismisses the message box. Another potential problem could be calling <code>SendMessage</code>.
 This waits for a window procedure to fully process the message and 
return. And if the window procedure thread does something that causes it
 to pause or wait, then the thread calling <code>SendMessage</code> also is doomed to pause and wait too.</p>
<p>In <code>runScript</code>, we called our function <code>display_COM_error</code>, which in turn calls <code>MessageBox</code>.
 This is not good. What we'll do is simply pass off any error message to
 our UI thread, and let our main thread display any error message box. 
To do this, we'll use <code>PostMessage</code>. For the message number, we'll use <code>WM_APP</code> (i.e., our own custom message number). For the <code>WPARAM</code> argument, we'll pass the address of the error string. If we pass a 0 for the <code>WPARAM</code> argument, then this means the <code>LPARAM</code> argument is an error number that we should pass to <code>display_sys_error</code> to get an error message to display. For the <code>LPARAM</code> argument, we'll pass an <code>HRESULT</code> error number. If we pass a 0 for the <code>HRESULT</code>, this means that the error string is a wide character string that has been <code>GlobalAlloc()</code>'ed. Our main thread will need to use <code>MessageBoxW</code> to display it, and then must subsequently <code>GlobalFree</code> it.</p>
<p>So for example, in <code>runScript</code>, we change the following error handling from...</p><div class="pre-action-link" id="premain42078" style="width:100%;display:block;"><span id="prehide42078" onclick="processCodeBlocks.togglePre(42078);">Hide</span>  &nbsp; <span id="copycode42078" onclick="return processCodeBlocks.copyCode(42078);">Copy Code</span></div><pre id="pre42078" style="margin-top: 0px;" class="notranslate">if ((hr = activeScriptParse-&gt;lpVtbl-&gt;InitNew(activeScriptParse)))
   display_COM_error("Can't initialize engine : %08X", hr);</pre>
<p>...to...</p><div class="pre-action-link" id="premain410409" style="width:100%;display:block;"><span id="prehide410409" onclick="processCodeBlocks.togglePre(410409);">Hide</span>  &nbsp; <span id="copycode410409" onclick="return processCodeBlocks.copyCode(410409);">Copy Code</span></div><pre id="pre410409" style="margin-top: 0px;" class="notranslate">if ((hr = activeScriptParse-&gt;lpVtbl-&gt;InitNew(activeScriptParse)))
   PostMessage(MainWindow, WM_APP, (WPARAM)"Can't initialize engine : %08X", hr);</pre>
<p>We need to modify <code>loadUnicodeScript</code> slightly so that it doesn't call <code>display_sys_error</code>, but instead calls <code>PostMessage</code> to pass off the error message display to the main thread.</p>
<p>There's one more place where our script thread could potentially call <code>MessageBox</code>, and that's in our <code>IActiveScriptSite</code>'s <code>OnScriptError</code>. Let's rewrite it so that it <code>GlobalAlloc()</code>s the error message and then <code>PostMessage()</code>s it to the main thread to display. You can peruse the updated code in <i>IActiveScriptSite.c</i>.</p>
<p>And we need to add code to our main window procedure to handle <code>WM_APP</code>, as so:</p><div class="pre-action-link" id="premain656655" style="width:100%;display:block;"><span id="prehide656655" onclick="processCodeBlocks.togglePre(656655);">Hide</span>  &nbsp; <span id="copycode656655" onclick="return processCodeBlocks.copyCode(656655);">Copy Code</span></div><pre id="pre656655" style="margin-top: 0px;" class="notranslate">case WM_APP:
{
   // Our script thread posts a WM_APP if it needs
   // us to display an error message.
   // wParam = A pointer to the string
   // to display. If 0, then lParam is an error
   // number to be passed to display_sys_error().
   // lParam = The HRESULT. If 0, then wParam
   //          is an allocated WCHAR string which we must
   // free with GlobalFree().
   if (!wParam)
      display_sys_error((DWORD)lParam);
   else if (!lParam)
   {
      MessageBoxW(hwnd, (const WCHAR *)wParam, 
                  "Error", MB_OK|MB_ICONEXCLAMATION);
      GlobalFree((void *)wParam);
   }
   else
      display_COM_error((LPCTSTR)wParam, (HRESULT)lParam);
   return(0);
}</pre>
<p><b>Note:</b> You may wish to use <code>RegisterWindowMessage</code> to get your own custom message number, rather than using <code>WM_APP</code>. But for our purposes, <code>WM_APP</code> suffices.</p>
<p>There's just one thing left -- how to abort the script from the main thread. Let's do this in our <code>WM_CLOSE</code> processing, so if the user tries to close our window while a script is running, we'll force the script to abort. The engine <code>IActiveScript</code>'s <code>InterruptScriptThread</code> function is one of the few functions that can be called by any thread. We pass the value <code>SCRIPTTHREADID_ALL</code>,
 which simply means to abort all running scripts we've given to the 
engine (i.e., if we had created numerous threads, each simultaneously 
running its own VBScript, this would cause the VB engine to abort all of
 those script threads). Alternately, if we wanted to abort only a 
particular script thread, we could pass that thread's ID.</p><div class="pre-action-link" id="premain396525" style="width:100%;display:block;"><span id="prehide396525" onclick="processCodeBlocks.togglePre(396525);">Hide</span>  &nbsp; <span id="copycode396525" onclick="return processCodeBlocks.copyCode(396525);">Copy Code</span></div><pre id="pre396525" style="margin-top: 0px;" class="notranslate">case WM_CLOSE:
{
   // Is a script running?
   if (MyArgs.ThreadHandle)
   {
      // Abort the script by calling InterruptScriptThread.
      MyArgs.EngineActiveScript-&gt;lpVtbl-&gt;InterruptScriptThread(
          MyArgs.EngineActiveScript, SCRIPTTHREADID_ALL, 0, 0);
   ...</pre>
<p>When <code>InterruptScriptThread</code> returns, that doesn't mean 
that the thread has terminated. It simply means that the engine has 
marked the running script for termination. We still have to "wait" for 
the thread to terminate. We'll do that by testing when <code>ThreadHandle</code>
 is 0. (Remember that the script thread zeroes it upon termination.) But
 there's one other problem. If the script thread is somehow "sleeping" 
or waiting for something itself, for example, in a call to <code>MessageBox</code>,
 then the engine will never get a chance to terminate it. We've been 
careful to avoid calling such functions ourselves, but note that 
VBScript has a <code>msgbox</code> function it too can call.</p>
<p>To get around this problem, we'll increment a count, and <code>Sleep()</code>
 in between increments. When the count "times out", we'll assume the 
script is locked up, and brute-force terminate it ourselves by calling <code>TerminateThread</code>.</p><div class="pre-action-link" id="premain720102" style="width:100%;display:block;"><span id="prehide720102" onclick="processCodeBlocks.togglePre(720102);">Hide</span>  &nbsp; <span id="copycode720102" onclick="return processCodeBlocks.copyCode(720102);">Copy Code</span></div><pre id="pre720102" style="margin-top: 0px;" class="notranslate">wParam = 0;
while (MyArgs.ThreadHandle &amp;&amp; ++wParam &lt; 25) Sleep(100);
if (MyArgs.ThreadHandle) TerminateThread(MyArgs.ThreadHandle, 0);</pre>
<p>
</p><blockquote><b>In conclusion</b>, a script should be run in a separate thread than the main UI. The script thread must <code>CoInitialize</code> itself. Most of the engine's COM functions can be called only from the script thread. Our <code>IActiveScriptSite</code>'s
 functions are also called within the script thread. The script thread 
should avoid doing anything that makes it "wait" or "pause". The UI 
thread may force the script to abort via <code>InterruptScriptThread</code>, but may also need to do a "time out" to brute-force terminate the script thread, if necessary.</blockquote>
<p></p>
<h2>Conclusion</h2>
<p>This chapter demonstrates how to use an ActiveX Script Engine to run a
 script. But while it's useful to be able to simply run a script, we 
haven't yet seen how that script can directly interact with the 
functions in our app, and exchange data. For this, we'll need to add 
another COM object to our app. This will be the focus of the next 
chapter.</p>


						</div>
						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/Beginners" data-country="US" data-loadonview="true" data-tags="C++, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=300x250&c=693339"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=300x250&c=693339"  width="300px" height="250px" target="_blank"/></a></noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

    <ul class="rrssb-buttons clearfix rrssb-1">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=COM%20in%20plain%20C%2c%20Part%206%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f14905%2fCOM-in-plain-C-Part-6%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=COM+in+plain+C%2c+Part+6+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f14905%2fCOM-in-plain-C-Part-6" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                        C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14905%2fCOM-in-plain-C-Part-6" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14905%2fCOM-in-plain-C-Part-6&amp;title=COM+in+plain+C%2c+Part+6+-+CodeProject&amp;summary=&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14905%2fCOM-in-plain-C-Part-6&amp;title=COM+in+plain+C%2c+Part+6+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14905%2fCOM-in-plain-C-Part-6&amp;description=COM+in+plain+C%2c+Part+6+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    

<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/member_unknown.gif" style="border-width:0px;transform:rotate(1deg);">
    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="https://www.codeproject.com/Members/Jeff-Glatt">Jeff Glatt</a></b>

        <table>
        <tbody><tr>
            <td rowspan="2" valign="middle" nowrap="nowrap">
            
            </td>
            <td nowrap="nowrap">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle"></span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
                </div>
            </td>
            <td rowspan="2" style="padding-left:15px">
                <a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn" title="" class="button unfollowed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Have the articles and posts from this member appear in your Timeline so you can stay up to date." style="display: inline-block;">Follow<div class="tiny-text" style="margin-top:-3px;">this Member</div><div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have the articles and posts from this member appear in your Timeline so you can stay up to date.</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn" title="" class="button followed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Stop following this Member" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Member</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">United States <img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/US.gif" alt="United States" width="16px" height="11px"></span>
            </td>
        </tr>
        </tbody></table>
    </div>

    <div class="description">
        No Biography provided

        
    </div>

</div><br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/Beginners" data-country="US" data-loadonview="true" data-tags="C++, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5,pos_bottom" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=728x90&c=693339"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=728x90&c=693339"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellspacing="0" cellpadding="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="3px" border="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="button new-message compose float-left">
<a rel="nofollow" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;floc=/Articles/14905/COM-in-plain-C-Part-6" name="Frm_HoverNL" target="_top">Add a Comment or Question&nbsp;</a>
</div><div class="admin-links float-left align-middle" style="width:90px;line-height:24px;margin-top:4px;">
&nbsp;<a href="https://www.codeproject.com/KB/FAQs/MessageBoardsFAQ.aspx"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/help_sm.png" title="FAQ" alt="FAQ" style="border-width:0;width:16px;height:16px;vertical-align:middle;"></a>
</div><div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="325716"><input type="hidden" name="sbo" value="fm"><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search subdue" autocomplete="off" name="qf" value="Search Comments"><input type="image" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/search.gif">
</form>
</div><div class="tooltip email-alert" id="ctl00_MessageBoard_SubscribeDiv">
	<span class="nowrap medium-text">Email Alerts</span><div class="tooltip-flyout" style="width: 335px;margin-top: 24px;left: -270px;padding: 7px;">
		<b>Email me</b><input type="checkbox" id="ctl00_MessageBoard_SubscribeNew"><label for="ctl00_MessageBoard_SubscribeNew">New Posts</label><input type="checkbox" id="ctl00_MessageBoard_SubscribeReplies"><label for="ctl00_MessageBoard_SubscribeReplies">Replies to Posts</label><br><br><b>Send them</b><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeInstant"><label for="ctl00_MessageBoard_SubscribeInstant">Instantly</label><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeDaily"><label for="ctl00_MessageBoard_SubscribeDaily">Daily</label>&nbsp; <b>For</b> <select id="ctl00_MessageBoard_MessageType" class="tiny-text" style="width:80px;">
			<option value="0" selected="selected">
				All Types
			</option><option value="128">
				Announcements
			</option>
		</select><button class="button safe float-right update">Update</button>
	</div>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?floc=%2fArticles%2f14905%2fCOM-in-plain-C-Part-6&amp;fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="325716"><input type="hidden" name="currentQS" value="floc=%2fArticles%2f14905%2fCOM-in-plain-C-Part-6&amp;fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True"><input type="hidden" name="floc" value="/Articles/14905/COM-in-plain-C-Part-6">Spacing<select size="1" class="dropdown" name="spc">
<option selected="selected" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view">
<option selected="selected" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="selected" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table width="100%" cellspacing="0" cellpadding="2px" border="0">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span> <span class="nav-link disabled">Next</span></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table class="fixed-layout blank-background" width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr id="F4304180_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4304180xx"></a><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4304180" parent="0" thread="4304180" href="https://www.codeproject.com/Messages/4304180/Using-same-concept-with-VBScript.aspx">Using same concept with VBScript</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Techiz</span><span class="date">9-Jul-12  10:41</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=7460616">Techiz</a></span></td><td class="date"><span>9-Jul-12  10:41&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4304180_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="7460616" msgid="4304180" votingtype="GoodOrBad" done="true"><a href="#xx4304180xx" onclick="return rateItem(5, 4304180,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',7460616);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4304180xx" onclick="return rateItem(1, 4304180,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',7460616);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hi Jeff, It is a great artical and I have learned a lot reading this.<br>
I have a question, I want to add a script in the VBScript.dll sites. now the that will return me a IDispatch.<br>
<br>
I want to know that if it is possible to load different scripts in the 
different sites and then cross refer them from the objects that 
implement IActiveScript interface.<br>
<br>
So what my idea basically is that to load different scripts using different objects and then use them globally.<br>
<br>
Then problem with this is that the COM object that sets the scripts can only read them.<br>
<br>
Kindly help me. and guide me. Thanks<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=4304180&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=4304180&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4304180" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4304180" data-ref="3_4304180" class="rating-label" name="RateItem_4304180"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4304180/Using-same-concept-with-VBScript.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4304180"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="7460616" msgid="4304180"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3604516_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx3604516xx"></a><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="3604516" parent="0" thread="3604516" href="https://www.codeproject.com/Messages/3604516/About-registering-with-regsvr32.aspx">About registering with regsvr32</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">choidebu</span><span class="date">20-Sep-10  21:18</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3826185">choidebu</a></span></td><td class="date"><span>20-Sep-10  21:18&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3604516_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="3826185" msgid="3604516" votingtype="GoodOrBad" done="true"><a href="#xx3604516xx" onclick="return rateItem(5, 3604516,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3826185);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx3604516xx" onclick="return rateItem(1, 3604516,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3826185);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">First of all thanks to Jeff for your great article. I've seen COM and dlls in a new light now.<br>
I tried compiling your examples against Windows SDK 7.1, Visual C++ 2008
 Compiler but not from the IDE, I use mingw32-make cause that is what i 
understand the most.<br>
<br>
It builds successfully but the dll can't be registered with regsvr32, it
 always says DllRegisterServer entry point not found. Does this means to
 build a COM dll register-able by regsvr32, I have to implement this 
method? If that's the case, can you please point me on how to do this?<br>
<br>
Once again, thank you.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=3604516&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=3604516&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3604516" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF3604516" data-ref="3_3604516" class="rating-label" name="RateItem_3604516"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/3604516/About-registering-with-regsvr32.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_3604516"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="3826185" msgid="3604516"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3612455_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx3612455xx"></a><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="3612455" parent="3604516" thread="3604516" href="https://www.codeproject.com/Messages/3612455/Re-About-registering-with-regsvr32.aspx">Re: About registering with regsvr32</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">choidebu</span><span class="date">28-Sep-10  4:40</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3826185">choidebu</a></span></td><td class="date"><span>28-Sep-10  4:40&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3612455_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="3826185" msgid="3612455" votingtype="GoodOrBad" done="true"><a href="#xx3612455xx" onclick="return rateItem(5, 3612455,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3826185);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx3612455xx" onclick="return rateItem(1, 3612455,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3826185);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,3604516);" href="https://www.codeproject.com/Messages/3604516/About-registering-with-regsvr32.aspx"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>That's ok, I implement the method and now it register/unregister itself smoothly.<br>
But if you ever going to update these articles, may I suggest addressing asynchronous COM call,<br>
 interface marshalling with different threads, etc..<br>
<br>
Regards<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=3612455&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=3612455&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3604516" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF3612455" data-ref="3_3612455" class="rating-label" name="RateItem_3612455"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/3612455/Re-About-registering-with-regsvr32.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_3612455"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="3826185" msgid="3612455"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2471187_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx2471187xx"></a><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2471187" parent="0" thread="2471187" href="https://www.codeproject.com/Messages/2471187/IActiveScriptDebug.aspx">IActiveScriptDebug</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Sergey Alexander Gynech</span><span class="date">18-Mar-08  9:26</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=61556">Sergey Alexander Gynech</a></span></td><td class="date"><span>18-Mar-08  9:26&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2471187_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="61556" msgid="2471187" votingtype="GoodOrBad" done="true"><a href="#xx2471187xx" onclick="return rateItem(5, 2471187,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',61556);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2471187xx" onclick="return rateItem(1, 2471187,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',61556);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Do you know how to implement a smart host with debugging
 feature also? breakpoint, step-by-step execution and variable 
inspection?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=2471187&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=2471187&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2471187" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2471187" data-ref="3_2471187" class="rating-label" name="RateItem_2471187"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2471187/IActiveScriptDebug.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2471187"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="61556" msgid="2471187"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2667638_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx2667638xx"></a><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2667638" parent="2471187" thread="2471187" href="https://www.codeproject.com/Messages/2667638/Re-IActiveScriptDebug.aspx">Re: IActiveScriptDebug</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">7-Aug-08  0:58</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>7-Aug-08  0:58&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2667638_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="2667638" votingtype="GoodOrBad" done="true"><a href="#xx2667638xx" onclick="return rateItem(5, 2667638,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2667638xx" onclick="return rateItem(1, 2667638,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2471187);" href="https://www.codeproject.com/Messages/2471187/IActiveScriptDebug.aspx"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>That's
 in another article in this series. Go to the top of the page, and click
 on my name (under this article's title). That will take you to a page 
listing all of my other articles.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=2667638&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=2667638&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2471187" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2667638" data-ref="3_2667638" class="rating-label" name="RateItem_2667638"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2667638/Re-IActiveScriptDebug.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2667638"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="2667638"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5084382_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx5084382xx"></a><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5084382" parent="2667638" thread="2471187" href="https://www.codeproject.com/Messages/5084382/Re-IActiveScriptDebug.aspx">Re: IActiveScriptDebug</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">EduardoFF</span><span class="date">30-Jun-15  17:13</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=10603764">EduardoFF</a></span></td><td class="date"><span>30-Jun-15  17:13&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5084382_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="10603764" msgid="5084382" votingtype="GoodOrBad" done="true"><a href="#xx5084382xx" onclick="return rateItem(5, 5084382,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',10603764);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5084382xx" onclick="return rateItem(1, 5084382,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',10603764);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2667638);" href="https://www.codeproject.com/Messages/2667638/Re-IActiveScriptDebug.aspx"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Is this article still available? I did not find it in your articles list. Please do you have a link to it? Thanks!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=5084382&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=5084382&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2471187" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5084382" data-ref="3_5084382" class="rating-label" name="RateItem_5084382"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5084382/Re-IActiveScriptDebug.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5084382"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="10603764" msgid="5084382"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2412674_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx2412674xx"></a><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2412674" parent="0" thread="2412674" href="https://www.codeproject.com/Messages/2412674/Jeff-Glatt-and-his-article-COM-in-PlainC.aspx">Jeff Glatt and his article COM in PlainC</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">pogod</span><span class="date">2-Feb-08  3:59</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2593107">pogod</a></span></td><td class="date"><span>2-Feb-08  3:59&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2412674_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="2593107" msgid="2412674" votingtype="GoodOrBad" done="true"><a href="#xx2412674xx" onclick="return rateItem(5, 2412674,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',2593107);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2412674xx" onclick="return rateItem(1, 2412674,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',2593107);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">I am very grateful to Jeff Glatt for his aricle since it
 helped me to understand the essence of COM-technology and interaction 
between a server and a client and that<br>
a client can be at the same time a server.I am now trying to use his methods on programming IPROPERTY interface.<br>
I am from Russia so excuse me for my English.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=2412674&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=2412674&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2412674" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2412674" data-ref="3_2412674" class="rating-label" name="RateItem_2412674"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2412674/Jeff-Glatt-and-his-article-COM-in-PlainC.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2412674"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="2593107" msgid="2412674"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2351078_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx2351078xx"></a><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="2351078" parent="0" thread="2351078" href="https://www.codeproject.com/Messages/2351078/Compiling-problem.aspx">Compiling problem</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">biggun</span><span class="date">8-Dec-07  17:39</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=203593">biggun</a></span></td><td class="date"><span>8-Dec-07  17:39&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2351078_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="203593" msgid="2351078" votingtype="GoodOrBad" done="true"><a href="#xx2351078xx" onclick="return rateItem(5, 2351078,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',203593);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx2351078xx" onclick="return rateItem(1, 2351078,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',203593);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hi, <br>
<br>
  When i try to compile the code, i got the following errors :<br>
Linking...<br>
Main.obj : error LNK2005: _IID_IActiveScriptStats already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IBindEventHandler already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScriptError already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScriptSiteInterruptPoll already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScriptSiteWindow already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScriptSite already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScriptParseProcedure already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScriptParseProcedureOld already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScriptParse already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScript already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _CATID_ActiveScriptParse already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _CATID_ActiveScript already defined in ChooseEngine.obj<br>
Debug/ScriptHost.exe : fatal error LNK1169: one or more multiply defined symbols found<br>
Error executing link.exe.<br>
<br>
What can i do ?<br>
<br>
I use VC++ 6.0 for compiling.<br>
<br>
Stephan<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=2351078&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=2351078&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2351078" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF2351078" data-ref="3_2351078" class="rating-label" name="RateItem_2351078"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/2351078/Compiling-problem.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_2351078"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="203593" msgid="2351078"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4135770_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx4135770xx"></a><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4135770" parent="2351078" thread="2351078" href="https://www.codeproject.com/Messages/4135770/Re-Compiling-problem.aspx">Re: Compiling problem</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">23-Jan-12  4:04</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>23-Jan-12  4:04&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4135770_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="4135770" votingtype="GoodOrBad" done="true"><a href="#xx4135770xx" onclick="return rateItem(5, 4135770,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4135770xx" onclick="return rateItem(1, 4135770,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2351078);" href="https://www.codeproject.com/Messages/2351078/Compiling-problem.aspx"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I
 think this error maybe due to the include files of older versions of VC
 not drawing in initguid.h for C programs where first needed. Try adding
 the line to main.c, right after including windows.h ...<br>
<br>
<div class="pre-action-link" id="premain761751" style="width:100%;display:block;"><span id="prehide761751" onclick="processCodeBlocks.togglePre(761751);">Hide</span>  &nbsp; <span id="preShrink761751" onclick="processCodeBlocks.shrinkExpand(761751);">Shrink</span> <img id="preimg761751" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(761751);">  &nbsp; <span id="copycode761751" onclick="return processCodeBlocks.copyCode(761751);">Copy Code</span></div><pre id="pre761751" style="margin-top: 0px;" class="notranslate" lang="xml">#include <span class="code-keyword">&lt;</span><span class="code-leadattribute">initguid.h</span><span class="code-keyword">&gt;</span></pre><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=4135770&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=4135770&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2351078" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4135770" data-ref="3_4135770" class="rating-label" name="RateItem_4135770"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4135770/Re-Compiling-problem.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4135770"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="4135770"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1888928_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx1888928xx"></a><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1888928" parent="0" thread="1888928" href="https://www.codeproject.com/Messages/1888928/script-output-to-console.aspx">script output to console</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">XBLite</span><span class="date">11-Feb-07  19:28</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1156718">XBLite</a></span></td><td class="date"><span>11-Feb-07  19:28&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1888928_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="1156718" msgid="1888928" votingtype="GoodOrBad" done="true"><a href="#xx1888928xx" onclick="return rateItem(5, 1888928,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1156718);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1888928xx" onclick="return rateItem(1, 1888928,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1156718);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hi, I enjoyed your articles on script hosting<br>
engines. Ok, for vbscript, there is a cscript <br>
command line host to run scripts. This allows <br>
you to use WScript.Echo command to display text<br>
to the command line window.<br>
<br>
How does one display text output (besides in a<br>
message box window) from a script in your C <br>
script hosting program?  Thanks, D.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=1888928&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=1888928&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1888928" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1888928" data-ref="3_1888928" class="rating-label" name="RateItem_1888928"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1888928/script-output-to-console.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1888928"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="1156718" msgid="1888928"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1889084_h0" class="header hover-row">
<td class="subject-line normal vote-hi" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx1889084xx"></a><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1889084" parent="1888928" thread="1888928" href="https://www.codeproject.com/Messages/1889084/Re-script-output-to-console-modified.aspx">Re: script output to console [modified]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">11-Feb-07  22:51</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>11-Feb-07  22:51&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1889084_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="1889084" votingtype="GoodOrBad" done="true"><a href="#xx1889084xx" onclick="return rateItem(5, 1889084,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1889084xx" onclick="return rateItem(1, 1889084,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1888928);" href="https://www.codeproject.com/Messages/1888928/script-output-to-console.aspx"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Read
 the next tutorial in this series. It discusses how you can add your own
 "Objects" to VBScript. When VBscript calls a function in one of your 
own objects, the VB engine calls your IActiveScriptSite's GetItemInfo. 
It passes the name of your object that it wants. You return a pointer to
 one of those objects.<br>
<br>
So, what you need to do is make your own version of an object that is 
called "WScript" (as far as the VB engine is concerned), and contains an
 "Echo" function. In your Echo function, you can append the string to 
the end of some multi-line edit control in your own window.<br>
<br>
NOTE: Change the GUID's in all of the examples below to a unique GUID you create with GUIDGEN.EXE!<br>
<br>
You'll have a IWScript.h file that defines your phony WScript object. It
 needs to be based on an IDispatch in order for VBscript to use it. So 
notice the first 7 functions for an IDispatch. Then we add the Echo 
function. It is passed one string (from the VBScript).<br>
<br>
#undef  INTERFACE<br>
#define INTERFACE IWScript<br>
DECLARE_INTERFACE_ (INTERFACE, IDispatch)<br>
{<br>
 STDMETHOD  (QueryInterface)(THIS_ REFIID, void **) PURE;<br>
 STDMETHOD_ (ULONG, AddRef)(THIS) PURE;<br>
 STDMETHOD_ (ULONG, Release)(THIS) PURE;<br>
 STDMETHOD (GetTypeInfoCount)(THIS_ UINT *) PURE;<br>
 STDMETHOD (GetTypeInfo)(THIS_ UINT, LCID, ITypeInfo **) PURE;<br>
 STDMETHOD (GetIDsOfNames)(THIS_ REFIID, LPOLESTR *, UINT, LCID, DISPID *) PURE;<br>
 STDMETHOD (Invoke)(THIS_ DISPID, REFIID, LCID, WORD, DISPPARAMS *, VARIANT *, EXCEPINFO *, UINT *) PURE;<br>
 STDMETHOD  (Echo)(THIS_ BSTR) PURE;<br>
};<br>
<br>
#define TEXTLIMIT 10000<br>
<br>
extern IUnknown *getWScriptObject(void);<br>
extern void freeWScriptObject(void);<br>
<br>
<br>
<br>
<br>
In your IDL, you need to declare your phony WScript object's vtable:<br>
<br>
[uuid(CD19DEC1-3B5A-11d0-B39A-0080C7BC7884), dual]<br>
interface IWScriptVTable : IDispatch<br>
{<br>
  [id(1)] HRESULT Echo([in] BSTR line);<br>
}<br>
<br>
<br>
<br>
And in your IWSCRIPT.C source for your phony WScript object:<br>
<br>
#define INITGUID<br>
#include &lt;windows.h&gt;<br>
#include &lt;stddef.h&gt;<br>
#include &lt;tchar.h&gt;<br>
#include &lt;objbase.h&gt;<br>
#include &lt;activscp.h&gt;<br>
#include &lt;olectl.h&gt;<br>
#include &lt;cguid.h&gt;<br>
#include "IActiveScriptSite.h"<br>
#include "IWScript.h"<br>
#include "Extern.h" <br>
#include "Resource.h" <br>
<br>
const IID IID_IWScript = {0xCD19DEC1,0x3B5A,0x11d0,{0xB3,0x9A,0x00,0x80,0xC7,0xBC,0x78,0x84}};<br>
<br>
// Our IWScript VTable<br>
static STDMETHODIMP QueryInterface(IWScript *, REFIID, void **);<br>
static STDMETHODIMP_(ULONG) AddRef(IWScript *);<br>
static STDMETHODIMP_(ULONG) Release(IWScript *);<br>
static STDMETHODIMP GetTypeInfoCount(IWScript *, UINT *);<br>
static STDMETHODIMP GetTypeInfo(IWScript *, UINT , LCID , ITypeInfo **);<br>
static STDMETHODIMP GetIDsOfNames(IWScript *, REFIID, OLECHAR **, UINT, LCID, DISPID *);<br>
static STDMETHODIMP Invoke(IWScript *, DISPID, REFIID, LCID, WORD, DISPPARAMS *, VARIANT *, EXCEPINFO *, UINT *);<br>
static STDMETHODIMP Echo(IWScript *, BSTR);<br>
<br>
static const IWScriptVtbl VTable = {<br>
 QueryInterface,<br>
 AddRef,<br>
 Release,<br>
 GetTypeInfoCount,<br>
 GetTypeInfo,<br>
 GetIDsOfNames,<br>
 Invoke,<br>
 Echo};<br>
<br>
// It doesn't make sense to have more than 1 IWScript object,<br>
// so just declare it as a global.<br>
static IWScript WScriptObject = {(IWScriptVtbl *)&amp;VTable};<br>
<br>
static WScriptTypeInfo = 0;<br>
static DWORD Chars = 0;<br>
<br>
IUnknown * getWScriptObject(void)<br>
{<br>
   return((IUnknown *)&amp;WScriptObject);<br>
}<br>
<br>
void freeWScriptObject(void)<br>
{<br>
  if (WScriptTypeInfo) WScriptTypeInfo-&gt;lpVtbl-&gt;Release(WScriptTypeInfo);<br>
}<br>
<br>
static STDMETHODIMP QueryInterface(IWScript *this, REFIID vTableGuid, void **ppv) <br>
{<br>
  if (IsEqualIID(vTableGuid, &amp;IID_IUnknown) || IsEqualIID(vTableGuid, &amp;IID_IDispatch))<br>
    *ppv = this;<br>
  else<br>
  {<br>
    *ppv = 0;<br>
    return(E_NOINTERFACE);<br>
  }<br>
<br>
  return(S_OK);<br>
}<br>
<br>
static STDMETHODIMP_(ULONG) AddRef(IWScript *this)<br>
{<br>
  return(1);<br>
}<br>
 <br>
static STDMETHODIMP_(ULONG) Release(IWScript *this)<br>
{<br>
  return(1);<br>
}<br>
<br>
static STDMETHODIMP GetTypeInfoCount(IWScript *this, UINT *pctinfo)<br>
{<br>
  *pctinfo = 1;<br>
  return(S_OK);<br>
}<br>
 <br>
static STDMETHODIMP GetTypeInfo(IWScript *this, UINT ctinfo, LCID lcid, ITypeInfo **typeInfo)<br>
{<br>
  register HRESULT hr;<br>
<br>
  if (!WScriptTypeInfo &amp;&amp;<br>
    (hr = getITypeInfoFromExe(&amp;IID_IWScript, &amp;WScriptTypeInfo))) return(hr);<br>
<br>
  *typeInfo = WScriptTypeInfo;<br>
<br>
  WScriptTypeInfo-&gt;lpVtbl-&gt;AddRef(WScriptTypeInfo);<br>
<br>
  return(S_OK);<br>
}<br>
<br>
static STDMETHODIMP GetIDsOfNames(IWScript *this, REFIID riid, OLECHAR **rgszNames,<br>
  UINT cNames, LCID lcid, DISPID *rgdispid)<br>
{<br>
  register HRESULT hr;<br>
<br>
  if (!WScriptTypeInfo &amp;&amp;<br>
   (hr = getITypeInfoFromExe(&amp;IID_IWScript, &amp;WScriptTypeInfo))) return(hr);<br>
  return(WScriptTypeInfo-&gt;lpVtbl-&gt;GetIDsOfNames(WScriptTypeInfo, rgszNames, cNames, rgdispid));<br>
}<br>
 <br>
static STDMETHODIMP Invoke(IWScript *this, DISPID id, REFIID riid, LCID lcid,<br>
  WORD flag, DISPPARAMS *params, VARIANT *ret, EXCEPINFO *pei, UINT *pu)<br>
{<br>
  register HRESULT hr;<br>
<br>
  if (!WScriptTypeInfo &amp;&amp;<br>
    (hr = getITypeInfoFromExe(&amp;IID_IWScript, &amp;WScriptTypeInfo))) return(hr);<br>
<br>
  return(WScriptTypeInfo-&gt;lpVtbl-&gt;Invoke(WScriptTypeInfo, this, id, flag, params, ret, pei, pu));<br>
}<br>
<br>
static STDMETHODIMP Echo(IWScript *this, BSTR str)<br>
{<br>
  register HWND child;<br>
<br>
  // Note: If the script is being run in a different thread<br>
  // than the user interface thread, this assumes that both<br>
  // threads will not output to the same edit control<br>
<br>
  // Get the edit control where I display text<br>
  child = GetDlgItem(MainWindow, ICD_MYEDIT);<br>
<br>
  Chars += lstrlenW(str);<br>
  if (Chars &gt;= TEXTLIMIT);<br>
  {<br>
    SendMessage(child, EM_SETSEL, 0, -1);<br>
    Chars = lstrlenW(str);<br>
  }<br>
  else<br>
    SendMessage(child, EM_SETSEL, (WPARAM)-1, -1);<br>
<br>
  // NOTE: Unicode SendMessage<br>
  SendMessageW(child, EM_REPLACESEL, 0, (LPARAM)str);<br>
<br>
  SendMessage(child, EM_SETSEL, (WPARAM)-1, -1);<br>
  SendMessage(child, EM_REPLACESEL, 0, (LPARAM)"\r\n");<br>
  <br>
  return(S_OK);<br>
}<br>
<br>
<br>
<br>
<br>
And of course, your IActiveScriptSite's GetItemInfo:<br>
<br>
#include "IWScript.h"<br>
<br>
static STDMETHODIMP GetItemInfo(MyRealIActiveScriptSite *this, LPCOLESTR objectName,<br>
  DWORD dwReturnMask, IUnknown **objPtr, ITypeInfo **typeInfo)<br>
{<br>
  register HRESULT hr;<br>
<br>
  // Assume failure<br>
  hr = E_FAIL;<br>
  if (dwReturnMask &amp; SCRIPTINFO_IUNKNOWN) *objPtr = 0;<br>
  if (dwReturnMask &amp; SCRIPTINFO_ITYPEINFO) *typeInfo = 0;<br>
<br>
  // Does the engine want our IWScript object (has the string name "WScript")?<br>
  if (!lstrcmpiW(objectName, L"WScript"))<br>
  {<br>
    // Does the engine want a pointer to our IWScript object returned?<br>
    if (dwReturnMask &amp; SCRIPTINFO_IUNKNOWN)<br>
       *objPtr = getWScriptObject();<br>
<br>
    hr = S_OK;<br>
  }<br>
bad:<br>
  return(hr);<br>
}<br>
<br>
<br>
<br>
When you run the script, add your phony WScript object to the VB engine:<br>
<br>
EngineActiveScript-&gt;lpVtbl-&gt;AddNamedItem(EngineActiveScript, L"WScript", SCRIPTITEM_ISVISIBLE|SCRIPTITEM_NOCODE);<br>
<br>
<br>
<br>
<br>
One more thing: Right before your program terminates, make sure you call freeWScriptObject().<br>
<br>
<br>
 -- modified at 21:56 Sunday 11th February, 2007<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=1889084&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=1889084&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1888928" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1889084" data-ref="3_1889084" class="rating-label" name="RateItem_1889084"><span class="rating-result"><span>5.00/5 (1 vote)</span></span></span><a href="https://www.codeproject.com/Messages/1889084/Re-script-output-to-console-modified.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1889084"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1889084"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1889956_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx1889956xx"></a><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1889956" parent="1889084" thread="1888928" href="https://www.codeproject.com/Messages/1889956/Re-script-output-to-console.aspx">Re: script output to console</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">XBLite</span><span class="date">12-Feb-07  9:53</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1156718">XBLite</a></span></td><td class="date"><span>12-Feb-07  9:53&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1889956_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="1156718" msgid="1889956" votingtype="GoodOrBad" done="true"><a href="#xx1889956xx" onclick="return rateItem(5, 1889956,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1156718);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1889956xx" onclick="return rateItem(1, 1889956,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',1156718);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1889084);" href="https://www.codeproject.com/Messages/1889084/Re-script-output-to-console-modified.aspx"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Thanks Jeff, I'll give it a try. Your detailed<br>
response was really appreciated.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=1889956&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=1889956&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1888928" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1889956" data-ref="3_1889956" class="rating-label" name="RateItem_1889956"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1889956/Re-script-output-to-console.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1889956"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="1156718" msgid="1889956"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1831146_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx1831146xx"></a><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1831146" parent="0" thread="1831146" href="https://www.codeproject.com/Messages/1831146/Part-7-modified.aspx">Part 7 ? [modified]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Garth J Lancaster</span><span class="date">5-Jan-07  22:11</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-pro-16.png" title="Professional" alt="professional" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=12169">Garth J Lancaster</a></span></td><td class="date"><span>5-Jan-07  22:11&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1831146_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="12169" msgid="1831146" votingtype="GoodOrBad" done="true"><a href="#xx1831146xx" onclick="return rateItem(5, 1831146,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',12169);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1831146xx" onclick="return rateItem(1, 1831146,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',12169);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hi Jeff - love your work so far - some of this stuff to 
do with ActiveX Hosts just didnt gell until I read this - so many thanks
 to you. <strike>Is Part 7 coming anytime soon - where you'll show how to exchange variables etc ?</strike><br>
<br>
Modified : Sorry - just did another check on CP - didnt see 'Part 7' the first time round - 'goody goody', its there <br>
<br>
cheers, keep up the good work<br>
Garth<br>
<br>
<br>
 -- modified at 21:20 Friday 5th January, 2007<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=1831146&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=1831146&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1831146" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1831146" data-ref="3_1831146" class="rating-label" name="RateItem_1831146"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1831146/Part-7-modified.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1831146"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="12169" msgid="1831146"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1831390_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx1831390xx"></a><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1831390" parent="1831146" thread="1831146" href="https://www.codeproject.com/Messages/1831390/Re-Part-7.aspx">Re: Part 7 ?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">6-Jan-07  4:51</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member" alt="Member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>6-Jan-07  4:51&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1831390_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="88625" msgid="1831390" votingtype="GoodOrBad" done="true"><a href="#xx1831390xx" onclick="return rateItem(5, 1831390,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1831390xx" onclick="return rateItem(1, 1831390,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',88625);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1831146);" href="https://www.codeproject.com/Messages/1831146/Part-7-modified.aspx"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Actually, Part 7 details how to have a script call your own C functions.<br>
<br>
Part 8, which has just been posted, shows how to set/query variables in a script (as well as a few other miscellaneous details).<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=1831390&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=1831390&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1831146" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1831390" data-ref="3_1831390" class="rating-label" name="RateItem_1831390"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/1831390/Re-Part-7.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1831390"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="88625" msgid="1831390"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1831409_h0" class="header hover-row">
<td class="subject-line normal vote-hi" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx1831409xx"></a><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="1831409" parent="1831390" thread="1831146" href="https://www.codeproject.com/Messages/1831409/Re-Part-7.aspx">Re: Part 7 ?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Garth J Lancaster</span><span class="date">6-Jan-07  5:06</span>
</div></td><td class="icon"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-pro-16.png" title="Professional" alt="professional" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=12169">Garth J Lancaster</a></span></td><td class="date"><span>6-Jan-07  5:06&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1831409_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="12169" msgid="1831409" votingtype="GoodOrBad" done="true"><a href="#xx1831409xx" onclick="return rateItem(5, 1831409,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',12169);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx1831409xx" onclick="return rateItem(1, 1831409,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',12169);" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1831390);" href="https://www.codeproject.com/Messages/1831390/Re-Part-7.aspx"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Many Thanks<br>
<br>
Hope you're well &amp; happy<br>
<br>
cheers, Garth<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=1831409&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=325716&amp;select=1831409&amp;floc=/Articles/14905/COM-in-plain-C-Part-6&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1831146" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF1831409" data-ref="3_1831409" class="rating-label" name="RateItem_1831409"><span class="rating-result"><span>5.00/5 (1 vote)</span></span></span><a href="https://www.codeproject.com/Messages/1831409/Re-Part-7.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_1831409"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="12169" msgid="1831409"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellspacing="0" cellpadding="2px">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 14-Jan-20  11:58 &nbsp; &nbsp; Last Update: 14-Jan-20  12:17</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=16"><span class="nav-link selected">1</span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" width="16px" height="16px" align="top"> General &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_news.gif" alt="News" width="16px" height="16px" align="top"> News &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_idea.gif" alt="Suggestion" width="16px" height="16px" align="top"> Suggestion &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_question.gif" alt="Question" width="16px" height="16px" align="top"> Question &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_bug.gif" alt="Bug" width="16px" height="16px" align="top"> Bug &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_answer.gif" alt="Answer" width="16px" height="16px" align="top"> Answer &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_joke.gif" alt="Joke" width="16px" height="16px" align="top"> Joke &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_kudos.gif" alt="Praise" width="16px" height="16px" align="top"> Praise &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_rant.gif" alt="Rant" width="16px" height="16px" align="top"> Rant &nbsp;&nbsp; <img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_admin.gif" alt="Admin" width="16px" height="16px" align="top"> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner">
                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div class="browse-code"><a href="https://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=14905">Browse Code</a></div>
<div><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=14905">View Stats</a></div>
<div><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=14905">Revisions</a></div>
<div><a href="#_comments">Comments (15)</a></div>
<div>Posted 23 Jul 2006</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Cplusplus" data-id="78">C++</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Visual-Studio" data-id="103">Visual-Studio</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/COM" data-id="130">COM</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>87.8K views</div><div>2.1K downloads</div><div>99 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

                <div id="RHSticky" class="container-article-info-sticky">
        		    

<div class="article-summary">

    
    

</div>

				    <div id="ctl00_SectionSponsor" class="padded-top" style="width:160px;margin:10px auto">
					    <div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/Beginners" data-country="US" data-showindicator="true" data-tags="C++, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=160x200&c=474715"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=160x200&c=474715"  width="160px" height="200px" target="_blank"/></a></noscript></div>
				    </div>

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/COM-COMplus/Beginners" data-country="US" data-tags="C++, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5" data-cookieconsent="true"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=160x600&c=474715"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/COM-COMplus/Beginners&sz=160x600&c=474715"  width="160px" height="600px" target="_blank"/></a></noscript></div>
				    </div>

                    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="theme1-background" style="height:2px;margin:5px 0" id="stickyStop"></div>

		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2006 by Jeff Glatt<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2020 <br>
                <br>
				Web03 
				2.8.200113.1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/DFPAudiencePixel.gif" style="border-width:0px;height:1px;width:1px;">



<script type="text/javascript"> // IMMEDIATE script

var readLaterList

var notificationAlert

var followService_ctl00_ActionLinks_ArticleFollow;

var bookmark_medium_true_false_ = null;

function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(null, 14905,2,1,true,true,0,'LargeStars', null, 88625);
}

function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                        if (!$('#' + containerId).attr('alreadyRequested')){
                            $.ajax({
                                url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId+'&wd=130',
                            })
                            .done(function (data) {
                                $('#' + containerId).html(data);
                                $('#' + loadingId).hide();
                            });

                            $('#' + containerId).attr('alreadyRequested', 'true');
                        }
                    }

document.addEventListener('DOMContentLoaded', function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});
function ChkRtctl00_RateArticle(val) {
}

var followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 325716,
};
var subscriptions_ctl00_MessageBoard;
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	processCodeBlocks.Initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	$('#RHSticky').sticky($('#stickyStop'));
	$('#ctl00_StickyBlock').sticky($('#stickyStop'));
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	readLaterList = new ReadLaterList('ReadLaterListIcon', 'ItemsToRead','/script/Bookmarks/WebServices/BookmarkService.aspx','https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=small',true);
	readLaterList.initialise();
	
	notificationAlert = new NotificationAlert('ctl00_MemberBar_Messages_NotificationCount','Notifications','/script/Membership/Ajax/NotificationList.aspx');
	notificationAlert.initialise();
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar && sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc && !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	followService_ctl00_ActionLinks_ArticleFollow = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_ActionLinks_ArticleFollow.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 2,
	        objectId       : 14905
	    },
	    followButtonId   : 'ctl00_ActionLinks_ArticleFollow_FollowBtn',
	    unfollowButtonId : 'ctl00_ActionLinks_ArticleFollow_UnfollowBtn'
	}, false);
	
	bookmark_medium_true_false_ = new Bookmark('[data-type="bookmark"]','https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=medium',false,true);
	bookmark_medium_true_false_.Initialise();
	
	$('#clear-rate_ctl00_RateArticle_RCD').click(function () {    $('#ctl00_RateArticle_RCD').hide(); return false;});
	
	new starRating('#ctl00_RateArticle_RateItemWrapper', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
	  $('#ctl00_RateArticle_VR').mouseenter(function() {     getVotesHistogram(14905,2   ,'ctl00_RateArticle_HistogramR','ctl00_RateArticle_LoadingR');
	  });
	
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 1,
	        objectId       : 88625
	    },
	    followButtonId   : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn',
	    unfollowButtonId : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn'
	}, false);
	
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : true,
	    allowReporting      : false,
	    allowRating         : true,
	    allowRatingDisplay  : true,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://codeproject.freetls.fastly.net',
	    switchMsgCallback   : null,
	    getVoteFormMethod   : getVoteFormHtml,
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    getRatingUrl        : '/script/Ratings/Ajax/GetRatings.aspx',
	    getRatingRefKey     : 'obrs',
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl(forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	var followService = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	var followAttributeIds = [];
	followService.initAttributeUI(undefined, followAttributeIds);

})
</script>










<style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div></body></html>